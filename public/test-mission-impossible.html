<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission Impossible Direct Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #fff;
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #e50914;
            margin-bottom: 20px;
        }
        .test-info {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .url {
            background: #000;
            padding: 10px;
            border-radius: 4px;
            word-break: break-all;
            font-family: monospace;
            font-size: 12px;
            color: #4CAF50;
        }
        video {
            width: 100%;
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
        }
        .status {
            margin-top: 20px;
            padding: 15px;
            background: #1a1a1a;
            border-radius: 8px;
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        button {
            background: #e50914;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #f40612;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé¨ Mission: Impossible - The Final Reckoning (2025)</h1>
        
        <div class="test-info">
            <h2>Direct Stream Test</h2>
            <p><strong>File Path:</strong></p>
            <div class="url" id="videoUrl"></div>
            <div style="margin-top: 15px;">
                <button onclick="testHead()">Test File (HEAD)</button>
                <button onclick="testGet()">Test File (GET)</button>
                <button onclick="playVideo()">Play Video</button>
            </div>
        </div>

        <div id="status" class="status" style="display: none;"></div>

        <div id="videoContainer" style="display: none;">
            <h2>üé• Now Playing</h2>
            <video id="video" controls></video>
        </div>
    </div>

    <script>
        const directUrl = 'https://server2.ftpbd.net/FTP-2/English%20Movies/2025/Mission-Impossible-The-Final-Reckoning-2025/Mission-Impossible-The-Final-Reckoning-2025-1080p-AMZN-WEB-DL-DDP5-1-Atmos-H-264-BYNDR_reencoded.mp4';
        const proxyUrl = '/ftp/FTP-2/English%20Movies/2025/Mission-Impossible-The-Final-Reckoning-2025/Mission-Impossible-The-Final-Reckoning-2025-1080p-AMZN-WEB-DL-DDP5-1-Atmos-H-264-BYNDR_reencoded.mp4';

        document.getElementById('videoUrl').textContent = proxyUrl;

        function showStatus(message, isError = false) {
            const statusDiv = document.getElementById('status');
            statusDiv.style.display = 'block';
            statusDiv.className = 'status ' + (isError ? 'error' : 'success');
            statusDiv.innerHTML = message;
        }

        async function testHead() {
            showStatus('Testing file with HEAD request...');
            
            try {
                const response = await fetch(proxyUrl, { method: 'HEAD' });
                
                const headers = {
                    'Status': response.status + ' ' + response.statusText,
                    'Content-Type': response.headers.get('content-type'),
                    'Content-Length': response.headers.get('content-length'),
                    'Accept-Ranges': response.headers.get('accept-ranges'),
                    'Last-Modified': response.headers.get('last-modified')
                };

                let html = '<h3>HEAD Request Result</h3>';
                
                if (response.ok) {
                    html += '<p class="success">‚úÖ File is accessible!</p>';
                } else {
                    html += '<p class="error">‚ùå File returned error status</p>';
                }

                html += '<table style="width: 100%; margin-top: 10px;">';
                for (const [key, value] of Object.entries(headers)) {
                    if (value) {
                        html += `<tr><td style="padding: 5px;"><strong>${key}:</strong></td><td style="padding: 5px;">${value}</td></tr>`;
                    }
                }
                html += '</table>';

                if (headers['Content-Length']) {
                    const sizeMB = (parseInt(headers['Content-Length']) / 1024 / 1024).toFixed(2);
                    html += `<p style="margin-top: 10px;">File size: <strong>${sizeMB} MB</strong></p>`;
                }

                showStatus(html, !response.ok);
                
            } catch (error) {
                showStatus('<h3>HEAD Request Failed</h3><p class="error">‚ùå ' + error.message + '</p>', true);
            }
        }

        async function testGet() {
            showStatus('Testing file with partial GET request (first 1KB)...');
            
            try {
                const response = await fetch(proxyUrl, { 
                    headers: { 'Range': 'bytes=0-1023' }
                });
                
                let html = '<h3>GET Request Result</h3>';
                
                if (response.ok || response.status === 206) {
                    html += '<p class="success">‚úÖ File can be streamed! (Partial content supported)</p>';
                    html += `<p>Status: ${response.status} ${response.statusText}</p>`;
                    html += `<p>Content-Range: ${response.headers.get('content-range')}</p>`;
                } else {
                    html += '<p class="error">‚ùå Streaming may not work properly</p>';
                    html += `<p>Status: ${response.status} ${response.statusText}</p>`;
                }

                showStatus(html, !response.ok && response.status !== 206);
                
            } catch (error) {
                showStatus('<h3>GET Request Failed</h3><p class="error">‚ùå ' + error.message + '</p>', true);
            }
        }

        function playVideo() {
            const videoContainer = document.getElementById('videoContainer');
            const video = document.getElementById('video');
            
            videoContainer.style.display = 'block';
            video.src = proxyUrl;
            
            video.addEventListener('loadstart', () => {
                showStatus('üì° Loading video...', false);
            });

            video.addEventListener('canplay', () => {
                showStatus('‚úÖ Video ready! Click play to start.', false);
            });

            video.addEventListener('error', (e) => {
                showStatus('‚ùå Video playback error: ' + (video.error?.message || 'Unknown error'), true);
            });

            video.play().catch(err => {
                console.log('Autoplay prevented:', err);
            });

            videoContainer.scrollIntoView({ behavior: 'smooth' });
        }

        // Auto-test on load
        window.addEventListener('load', () => {
            console.log('Mission Impossible test page loaded');
            console.log('Proxy URL:', proxyUrl);
            console.log('Direct URL:', directUrl);
        });
    </script>
</body>
</html>
