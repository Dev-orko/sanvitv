(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function Zb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ip={exports:{}},Ga={},op={exports:{}},Ge={};var Gx;function BC(){if(Gx)return Ge;Gx=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.iterator;function m(D){return D===null||typeof D!="object"?null:(D=h&&D[h]||D["@@iterator"],typeof D=="function"?D:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,x={};function E(D,$,ie){this.props=D,this.context=$,this.refs=x,this.updater=ie||v}E.prototype.isReactComponent={},E.prototype.setState=function(D,$){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,$,"setState")},E.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function b(){}b.prototype=E.prototype;function I(D,$,ie){this.props=D,this.context=$,this.refs=x,this.updater=ie||v}var A=I.prototype=new b;A.constructor=I,g(A,E.prototype),A.isPureReactComponent=!0;var R=Array.isArray,C=Object.prototype.hasOwnProperty,F={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function N(D,$,ie){var ce,ue={},fe=null,Se=null;if($!=null)for(ce in $.ref!==void 0&&(Se=$.ref),$.key!==void 0&&(fe=""+$.key),$)C.call($,ce)&&!k.hasOwnProperty(ce)&&(ue[ce]=$[ce]);var ye=arguments.length-2;if(ye===1)ue.children=ie;else if(1<ye){for(var Ae=Array(ye),Pe=0;Pe<ye;Pe++)Ae[Pe]=arguments[Pe+2];ue.children=Ae}if(D&&D.defaultProps)for(ce in ye=D.defaultProps,ye)ue[ce]===void 0&&(ue[ce]=ye[ce]);return{$$typeof:n,type:D,key:fe,ref:Se,props:ue,_owner:F.current}}function M(D,$){return{$$typeof:n,type:D.type,key:$,ref:D.ref,props:D.props,_owner:D._owner}}function O(D){return typeof D=="object"&&D!==null&&D.$$typeof===n}function H(D){var $={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ie){return $[ie]})}var Z=/\/+/g;function se(D,$){return typeof D=="object"&&D!==null&&D.key!=null?H(""+D.key):$.toString(36)}function U(D,$,ie,ce,ue){var fe=typeof D;(fe==="undefined"||fe==="boolean")&&(D=null);var Se=!1;if(D===null)Se=!0;else switch(fe){case"string":case"number":Se=!0;break;case"object":switch(D.$$typeof){case n:case e:Se=!0}}if(Se)return Se=D,ue=ue(Se),D=ce===""?"."+se(Se,0):ce,R(ue)?(ie="",D!=null&&(ie=D.replace(Z,"$&/")+"/"),U(ue,$,ie,"",function(Pe){return Pe})):ue!=null&&(O(ue)&&(ue=M(ue,ie+(!ue.key||Se&&Se.key===ue.key?"":(""+ue.key).replace(Z,"$&/")+"/")+D)),$.push(ue)),1;if(Se=0,ce=ce===""?".":ce+":",R(D))for(var ye=0;ye<D.length;ye++){fe=D[ye];var Ae=ce+se(fe,ye);Se+=U(fe,$,ie,Ae,ue)}else if(Ae=m(D),typeof Ae=="function")for(D=Ae.call(D),ye=0;!(fe=D.next()).done;)fe=fe.value,Ae=ce+se(fe,ye++),Se+=U(fe,$,ie,Ae,ue);else if(fe==="object")throw $=String(D),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Se}function ne(D,$,ie){if(D==null)return D;var ce=[],ue=0;return U(D,ce,"","",function(fe){return $.call(ie,fe,ue++)}),ce}function q(D){if(D._status===-1){var $=D._result;$=$(),$.then(function(ie){(D._status===0||D._status===-1)&&(D._status=1,D._result=ie)},function(ie){(D._status===0||D._status===-1)&&(D._status=2,D._result=ie)}),D._status===-1&&(D._status=0,D._result=$)}if(D._status===1)return D._result.default;throw D._result}var te={current:null},G={transition:null},Q={ReactCurrentDispatcher:te,ReactCurrentBatchConfig:G,ReactCurrentOwner:F};function ee(){throw Error("act(...) is not supported in production builds of React.")}return Ge.Children={map:ne,forEach:function(D,$,ie){ne(D,function(){$.apply(this,arguments)},ie)},count:function(D){var $=0;return ne(D,function(){$++}),$},toArray:function(D){return ne(D,function($){return $})||[]},only:function(D){if(!O(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},Ge.Component=E,Ge.Fragment=t,Ge.Profiler=s,Ge.PureComponent=I,Ge.StrictMode=r,Ge.Suspense=u,Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q,Ge.act=ee,Ge.cloneElement=function(D,$,ie){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var ce=g({},D.props),ue=D.key,fe=D.ref,Se=D._owner;if($!=null){if($.ref!==void 0&&(fe=$.ref,Se=F.current),$.key!==void 0&&(ue=""+$.key),D.type&&D.type.defaultProps)var ye=D.type.defaultProps;for(Ae in $)C.call($,Ae)&&!k.hasOwnProperty(Ae)&&(ce[Ae]=$[Ae]===void 0&&ye!==void 0?ye[Ae]:$[Ae])}var Ae=arguments.length-2;if(Ae===1)ce.children=ie;else if(1<Ae){ye=Array(Ae);for(var Pe=0;Pe<Ae;Pe++)ye[Pe]=arguments[Pe+2];ce.children=ye}return{$$typeof:n,type:D.type,key:ue,ref:fe,props:ce,_owner:Se}},Ge.createContext=function(D){return D={$$typeof:o,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:i,_context:D},D.Consumer=D},Ge.createElement=N,Ge.createFactory=function(D){var $=N.bind(null,D);return $.type=D,$},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(D){return{$$typeof:l,render:D}},Ge.isValidElement=O,Ge.lazy=function(D){return{$$typeof:f,_payload:{_status:-1,_result:D},_init:q}},Ge.memo=function(D,$){return{$$typeof:d,type:D,compare:$===void 0?null:$}},Ge.startTransition=function(D){var $=G.transition;G.transition={};try{D()}finally{G.transition=$}},Ge.unstable_act=ee,Ge.useCallback=function(D,$){return te.current.useCallback(D,$)},Ge.useContext=function(D){return te.current.useContext(D)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(D){return te.current.useDeferredValue(D)},Ge.useEffect=function(D,$){return te.current.useEffect(D,$)},Ge.useId=function(){return te.current.useId()},Ge.useImperativeHandle=function(D,$,ie){return te.current.useImperativeHandle(D,$,ie)},Ge.useInsertionEffect=function(D,$){return te.current.useInsertionEffect(D,$)},Ge.useLayoutEffect=function(D,$){return te.current.useLayoutEffect(D,$)},Ge.useMemo=function(D,$){return te.current.useMemo(D,$)},Ge.useReducer=function(D,$,ie){return te.current.useReducer(D,$,ie)},Ge.useRef=function(D){return te.current.useRef(D)},Ge.useState=function(D){return te.current.useState(D)},Ge.useSyncExternalStore=function(D,$,ie){return te.current.useSyncExternalStore(D,$,ie)},Ge.useTransition=function(){return te.current.useTransition()},Ge.version="18.3.1",Ge}var Hx;function Pl(){return Hx||(Hx=1,op.exports=BC()),op.exports}var Kx;function UC(){if(Kx)return Ga;Kx=1;var n=Pl(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,d){var f,h={},m=null,v=null;d!==void 0&&(m=""+d),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(v=u.ref);for(f in u)r.call(u,f)&&!i.hasOwnProperty(f)&&(h[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)h[f]===void 0&&(h[f]=u[f]);return{$$typeof:e,type:l,key:m,ref:v,props:h,_owner:s.current}}return Ga.Fragment=t,Ga.jsx=o,Ga.jsxs=o,Ga}var Wx;function $C(){return Wx||(Wx=1,ip.exports=UC()),ip.exports}var S=$C(),P=Pl();const Cn=Zb(P);var cu={},ap={exports:{}},fn={},lp={exports:{}},cp={};var zx;function jC(){return zx||(zx=1,(function(n){function e(G,Q){var ee=G.length;G.push(Q);e:for(;0<ee;){var D=ee-1>>>1,$=G[D];if(0<s($,Q))G[D]=Q,G[ee]=$,ee=D;else break e}}function t(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var Q=G[0],ee=G.pop();if(ee!==Q){G[0]=ee;e:for(var D=0,$=G.length,ie=$>>>1;D<ie;){var ce=2*(D+1)-1,ue=G[ce],fe=ce+1,Se=G[fe];if(0>s(ue,ee))fe<$&&0>s(Se,ue)?(G[D]=Se,G[fe]=ee,D=fe):(G[D]=ue,G[ce]=ee,D=ce);else if(fe<$&&0>s(Se,ee))G[D]=Se,G[fe]=ee,D=fe;else break e}}return Q}function s(G,Q){var ee=G.sortIndex-Q.sortIndex;return ee!==0?ee:G.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],d=[],f=1,h=null,m=3,v=!1,g=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(G){for(var Q=t(d);Q!==null;){if(Q.callback===null)r(d);else if(Q.startTime<=G)r(d),Q.sortIndex=Q.expirationTime,e(u,Q);else break;Q=t(d)}}function R(G){if(x=!1,A(G),!g)if(t(u)!==null)g=!0,q(C);else{var Q=t(d);Q!==null&&te(R,Q.startTime-G)}}function C(G,Q){g=!1,x&&(x=!1,b(N),N=-1),v=!0;var ee=m;try{for(A(Q),h=t(u);h!==null&&(!(h.expirationTime>Q)||G&&!H());){var D=h.callback;if(typeof D=="function"){h.callback=null,m=h.priorityLevel;var $=D(h.expirationTime<=Q);Q=n.unstable_now(),typeof $=="function"?h.callback=$:h===t(u)&&r(u),A(Q)}else r(u);h=t(u)}if(h!==null)var ie=!0;else{var ce=t(d);ce!==null&&te(R,ce.startTime-Q),ie=!1}return ie}finally{h=null,m=ee,v=!1}}var F=!1,k=null,N=-1,M=5,O=-1;function H(){return!(n.unstable_now()-O<M)}function Z(){if(k!==null){var G=n.unstable_now();O=G;var Q=!0;try{Q=k(!0,G)}finally{Q?se():(F=!1,k=null)}}else F=!1}var se;if(typeof I=="function")se=function(){I(Z)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,ne=U.port2;U.port1.onmessage=Z,se=function(){ne.postMessage(null)}}else se=function(){E(Z,0)};function q(G){k=G,F||(F=!0,se())}function te(G,Q){N=E(function(){G(n.unstable_now())},Q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){g||v||(g=!0,q(C))},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(G){switch(m){case 1:case 2:case 3:var Q=3;break;default:Q=m}var ee=m;m=Q;try{return G()}finally{m=ee}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,Q){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ee=m;m=G;try{return Q()}finally{m=ee}},n.unstable_scheduleCallback=function(G,Q,ee){var D=n.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?D+ee:D):ee=D,G){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ee+$,G={id:f++,callback:Q,priorityLevel:G,startTime:ee,expirationTime:$,sortIndex:-1},ee>D?(G.sortIndex=ee,e(d,G),t(u)===null&&G===t(d)&&(x?(b(N),N=-1):x=!0,te(R,ee-D))):(G.sortIndex=$,e(u,G),g||v||(g=!0,q(C))),G},n.unstable_shouldYield=H,n.unstable_wrapCallback=function(G){var Q=m;return function(){var ee=m;m=Q;try{return G.apply(this,arguments)}finally{m=ee}}}})(cp)),cp}var Yx;function VC(){return Yx||(Yx=1,lp.exports=jC()),lp.exports}var qx;function GC(){if(qx)return fn;qx=1;var n=Pl(),e=VC();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,p=1;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function i(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(s[a]=c,a=0;a<c.length;a++)r.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},h={};function m(a){return u.call(h,a)?!0:u.call(f,a)?!1:d.test(a)?h[a]=!0:(f[a]=!0,!1)}function v(a,c,p,y){if(p!==null&&p.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return y?!1:p!==null?!p.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function g(a,c,p,y){if(c===null||typeof c>"u"||v(a,c,p,y))return!0;if(y)return!1;if(p!==null)switch(p.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function x(a,c,p,y,T,w,L){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=y,this.attributeNamespace=T,this.mustUseProperty=p,this.propertyName=a,this.type=c,this.sanitizeURL=w,this.removeEmptyString=L}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){E[a]=new x(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];E[c]=new x(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){E[a]=new x(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){E[a]=new x(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){E[a]=new x(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){E[a]=new x(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){E[a]=new x(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){E[a]=new x(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){E[a]=new x(a,5,!1,a.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function I(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(b,I);E[c]=new x(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(b,I);E[c]=new x(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(b,I);E[c]=new x(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){E[a]=new x(a,1,!1,a.toLowerCase(),null,!1,!1)}),E.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){E[a]=new x(a,1,!1,a.toLowerCase(),null,!0,!0)});function A(a,c,p,y){var T=E.hasOwnProperty(c)?E[c]:null;(T!==null?T.type!==0:y||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(g(c,p,T,y)&&(p=null),y||T===null?m(c)&&(p===null?a.removeAttribute(c):a.setAttribute(c,""+p)):T.mustUseProperty?a[T.propertyName]=p===null?T.type===3?!1:"":p:(c=T.attributeName,y=T.attributeNamespace,p===null?a.removeAttribute(c):(T=T.type,p=T===3||T===4&&p===!0?"":""+p,y?a.setAttributeNS(y,c,p):a.setAttribute(c,p))))}var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),F=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),H=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),ne=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),G=Symbol.iterator;function Q(a){return a===null||typeof a!="object"?null:(a=G&&a[G]||a["@@iterator"],typeof a=="function"?a:null)}var ee=Object.assign,D;function $(a){if(D===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);D=c&&c[1]||""}return`
`+D+a}var ie=!1;function ce(a,c){if(!a||ie)return"";ie=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(X){var y=X}Reflect.construct(a,[],c)}else{try{c.call()}catch(X){y=X}a.call(c.prototype)}else{try{throw Error()}catch(X){y=X}a()}}catch(X){if(X&&y&&typeof X.stack=="string"){for(var T=X.stack.split(`
`),w=y.stack.split(`
`),L=T.length-1,B=w.length-1;1<=L&&0<=B&&T[L]!==w[B];)B--;for(;1<=L&&0<=B;L--,B--)if(T[L]!==w[B]){if(L!==1||B!==1)do if(L--,B--,0>B||T[L]!==w[B]){var j=`
`+T[L].replace(" at new "," at ");return a.displayName&&j.includes("<anonymous>")&&(j=j.replace("<anonymous>",a.displayName)),j}while(1<=L&&0<=B);break}}}finally{ie=!1,Error.prepareStackTrace=p}return(a=a?a.displayName||a.name:"")?$(a):""}function ue(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=ce(a.type,!1),a;case 11:return a=ce(a.type.render,!1),a;case 1:return a=ce(a.type,!0),a;default:return""}}function fe(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case k:return"Fragment";case F:return"Portal";case M:return"Profiler";case N:return"StrictMode";case se:return"Suspense";case U:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case H:return(a.displayName||"Context")+".Consumer";case O:return(a._context.displayName||"Context")+".Provider";case Z:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case ne:return c=a.displayName||null,c!==null?c:fe(a.type)||"Memo";case q:c=a._payload,a=a._init;try{return fe(a(c))}catch{}}return null}function Se(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fe(c);case 8:return c===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function ye(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ae(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Pe(a){var c=Ae(a)?"checked":"value",p=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),y=""+a[c];if(!a.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var T=p.get,w=p.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return T.call(this)},set:function(L){y=""+L,w.call(this,L)}}),Object.defineProperty(a,c,{enumerable:p.enumerable}),{getValue:function(){return y},setValue:function(L){y=""+L},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function De(a){a._valueTracker||(a._valueTracker=Pe(a))}function Te(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var p=c.getValue(),y="";return a&&(y=Ae(a)?a.checked?"true":"false":a.value),a=y,a!==p?(c.setValue(a),!0):!1}function xe(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function _e(a,c){var p=c.checked;return ee({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??a._wrapperState.initialChecked})}function je(a,c){var p=c.defaultValue==null?"":c.defaultValue,y=c.checked!=null?c.checked:c.defaultChecked;p=ye(c.value!=null?c.value:p),a._wrapperState={initialChecked:y,initialValue:p,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function pe(a,c){c=c.checked,c!=null&&A(a,"checked",c,!1)}function Fe(a,c){pe(a,c);var p=ye(c.value),y=c.type;if(p!=null)y==="number"?(p===0&&a.value===""||a.value!=p)&&(a.value=""+p):a.value!==""+p&&(a.value=""+p);else if(y==="submit"||y==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?Ve(a,c.type,p):c.hasOwnProperty("defaultValue")&&Ve(a,c.type,ye(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Xe(a,c,p){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var y=c.type;if(!(y!=="submit"&&y!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,p||c===a.value||(a.value=c),a.defaultValue=c}p=a.name,p!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,p!==""&&(a.name=p)}function Ve(a,c,p){(c!=="number"||xe(a.ownerDocument)!==a)&&(p==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+p&&(a.defaultValue=""+p))}var Ue=Array.isArray;function Je(a,c,p,y){if(a=a.options,c){c={};for(var T=0;T<p.length;T++)c["$"+p[T]]=!0;for(p=0;p<a.length;p++)T=c.hasOwnProperty("$"+a[p].value),a[p].selected!==T&&(a[p].selected=T),T&&y&&(a[p].defaultSelected=!0)}else{for(p=""+ye(p),c=null,T=0;T<a.length;T++){if(a[T].value===p){a[T].selected=!0,y&&(a[T].defaultSelected=!0);return}c!==null||a[T].disabled||(c=a[T])}c!==null&&(c.selected=!0)}}function Dt(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ee({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function Bn(a,c){var p=c.value;if(p==null){if(p=c.children,c=c.defaultValue,p!=null){if(c!=null)throw Error(t(92));if(Ue(p)){if(1<p.length)throw Error(t(93));p=p[0]}c=p}c==null&&(c=""),p=c}a._wrapperState={initialValue:ye(p)}}function xn(a,c){var p=ye(c.value),y=ye(c.defaultValue);p!=null&&(p=""+p,p!==a.value&&(a.value=p),c.defaultValue==null&&a.defaultValue!==p&&(a.defaultValue=p)),y!=null&&(a.defaultValue=""+y)}function St(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function At(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function En(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?At(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var mr,Sn=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,p,y,T){MSApp.execUnsafeLocalFunction(function(){return a(c,p,y,T)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(mr=mr||document.createElement("div"),mr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=mr.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function Jt(a,c){if(c){var p=a.firstChild;if(p&&p===a.lastChild&&p.nodeType===3){p.nodeValue=c;return}}a.textContent=c}var Zt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zo=["Webkit","ms","Moz","O"];Object.keys(Zt).forEach(function(a){Zo.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Zt[c]=Zt[a]})});function si(a,c,p){return c==null||typeof c=="boolean"||c===""?"":p||typeof c!="number"||c===0||Zt.hasOwnProperty(a)&&Zt[a]?(""+c).trim():c+"px"}function Zl(a,c){a=a.style;for(var p in c)if(c.hasOwnProperty(p)){var y=p.indexOf("--")===0,T=si(p,c[p],y);p==="float"&&(p="cssFloat"),y?a.setProperty(p,T):a[p]=T}}var Sf=ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ea(a,c){if(c){if(Sf[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function ta(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var na=null;function zi(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var ra=null,Br=null,Ur=null;function sa(a){if(a=Ra(a)){if(typeof ra!="function")throw Error(t(280));var c=a.stateNode;c&&(c=wc(c),ra(a.stateNode,a.type,c))}}function ec(a){Br?Ur?Ur.push(a):Ur=[a]:Br=a}function ia(){if(Br){var a=Br,c=Ur;if(Ur=Br=null,sa(a),c)for(a=0;a<c.length;a++)sa(c[a])}}function oa(a,c){return a(c)}function tc(){}var Tf=!1;function dy(a,c,p){if(Tf)return a(c,p);Tf=!0;try{return oa(a,c,p)}finally{Tf=!1,(Br!==null||Ur!==null)&&(tc(),ia())}}function aa(a,c){var p=a.stateNode;if(p===null)return null;var y=wc(p);if(y===null)return null;p=y[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(a=a.type,y=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!y;break e;default:a=!1}if(a)return null;if(p&&typeof p!="function")throw Error(t(231,c,typeof p));return p}var bf=!1;if(l)try{var la={};Object.defineProperty(la,"passive",{get:function(){bf=!0}}),window.addEventListener("test",la,la),window.removeEventListener("test",la,la)}catch{bf=!1}function HR(a,c,p,y,T,w,L,B,j){var X=Array.prototype.slice.call(arguments,3);try{c.apply(p,X)}catch(ae){this.onError(ae)}}var ca=!1,nc=null,rc=!1,wf=null,KR={onError:function(a){ca=!0,nc=a}};function WR(a,c,p,y,T,w,L,B,j){ca=!1,nc=null,HR.apply(KR,arguments)}function zR(a,c,p,y,T,w,L,B,j){if(WR.apply(this,arguments),ca){if(ca){var X=nc;ca=!1,nc=null}else throw Error(t(198));rc||(rc=!0,wf=X)}}function ii(a){var c=a,p=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(p=c.return),a=c.return;while(a)}return c.tag===3?p:null}function fy(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function hy(a){if(ii(a)!==a)throw Error(t(188))}function YR(a){var c=a.alternate;if(!c){if(c=ii(a),c===null)throw Error(t(188));return c!==a?null:a}for(var p=a,y=c;;){var T=p.return;if(T===null)break;var w=T.alternate;if(w===null){if(y=T.return,y!==null){p=y;continue}break}if(T.child===w.child){for(w=T.child;w;){if(w===p)return hy(T),a;if(w===y)return hy(T),c;w=w.sibling}throw Error(t(188))}if(p.return!==y.return)p=T,y=w;else{for(var L=!1,B=T.child;B;){if(B===p){L=!0,p=T,y=w;break}if(B===y){L=!0,y=T,p=w;break}B=B.sibling}if(!L){for(B=w.child;B;){if(B===p){L=!0,p=w,y=T;break}if(B===y){L=!0,y=w,p=T;break}B=B.sibling}if(!L)throw Error(t(189))}}if(p.alternate!==y)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?a:c}function py(a){return a=YR(a),a!==null?my(a):null}function my(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=my(a);if(c!==null)return c;a=a.sibling}return null}var gy=e.unstable_scheduleCallback,yy=e.unstable_cancelCallback,qR=e.unstable_shouldYield,XR=e.unstable_requestPaint,Tt=e.unstable_now,QR=e.unstable_getCurrentPriorityLevel,If=e.unstable_ImmediatePriority,vy=e.unstable_UserBlockingPriority,sc=e.unstable_NormalPriority,JR=e.unstable_LowPriority,xy=e.unstable_IdlePriority,ic=null,gr=null;function ZR(a){if(gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(ic,a,void 0,(a.current.flags&128)===128)}catch{}}var Qn=Math.clz32?Math.clz32:nL,eL=Math.log,tL=Math.LN2;function nL(a){return a>>>=0,a===0?32:31-(eL(a)/tL|0)|0}var oc=64,ac=4194304;function ua(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function lc(a,c){var p=a.pendingLanes;if(p===0)return 0;var y=0,T=a.suspendedLanes,w=a.pingedLanes,L=p&268435455;if(L!==0){var B=L&~T;B!==0?y=ua(B):(w&=L,w!==0&&(y=ua(w)))}else L=p&~T,L!==0?y=ua(L):w!==0&&(y=ua(w));if(y===0)return 0;if(c!==0&&c!==y&&(c&T)===0&&(T=y&-y,w=c&-c,T>=w||T===16&&(w&4194240)!==0))return c;if((y&4)!==0&&(y|=p&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=y;0<c;)p=31-Qn(c),T=1<<p,y|=a[p],c&=~T;return y}function rL(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sL(a,c){for(var p=a.suspendedLanes,y=a.pingedLanes,T=a.expirationTimes,w=a.pendingLanes;0<w;){var L=31-Qn(w),B=1<<L,j=T[L];j===-1?((B&p)===0||(B&y)!==0)&&(T[L]=rL(B,c)):j<=c&&(a.expiredLanes|=B),w&=~B}}function Af(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Ey(){var a=oc;return oc<<=1,(oc&4194240)===0&&(oc=64),a}function _f(a){for(var c=[],p=0;31>p;p++)c.push(a);return c}function da(a,c,p){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-Qn(c),a[c]=p}function iL(a,c){var p=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var y=a.eventTimes;for(a=a.expirationTimes;0<p;){var T=31-Qn(p),w=1<<T;c[T]=0,y[T]=-1,a[T]=-1,p&=~w}}function Rf(a,c){var p=a.entangledLanes|=c;for(a=a.entanglements;p;){var y=31-Qn(p),T=1<<y;T&c|a[y]&c&&(a[y]|=c),p&=~T}}var Ze=0;function Sy(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Ty,Lf,by,wy,Iy,Cf=!1,cc=[],ys=null,vs=null,xs=null,fa=new Map,ha=new Map,Es=[],oL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ay(a,c){switch(a){case"focusin":case"focusout":ys=null;break;case"dragenter":case"dragleave":vs=null;break;case"mouseover":case"mouseout":xs=null;break;case"pointerover":case"pointerout":fa.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":ha.delete(c.pointerId)}}function pa(a,c,p,y,T,w){return a===null||a.nativeEvent!==w?(a={blockedOn:c,domEventName:p,eventSystemFlags:y,nativeEvent:w,targetContainers:[T]},c!==null&&(c=Ra(c),c!==null&&Lf(c)),a):(a.eventSystemFlags|=y,c=a.targetContainers,T!==null&&c.indexOf(T)===-1&&c.push(T),a)}function aL(a,c,p,y,T){switch(c){case"focusin":return ys=pa(ys,a,c,p,y,T),!0;case"dragenter":return vs=pa(vs,a,c,p,y,T),!0;case"mouseover":return xs=pa(xs,a,c,p,y,T),!0;case"pointerover":var w=T.pointerId;return fa.set(w,pa(fa.get(w)||null,a,c,p,y,T)),!0;case"gotpointercapture":return w=T.pointerId,ha.set(w,pa(ha.get(w)||null,a,c,p,y,T)),!0}return!1}function _y(a){var c=oi(a.target);if(c!==null){var p=ii(c);if(p!==null){if(c=p.tag,c===13){if(c=fy(p),c!==null){a.blockedOn=c,Iy(a.priority,function(){by(p)});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){a.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}a.blockedOn=null}function uc(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var p=Pf(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(p===null){p=a.nativeEvent;var y=new p.constructor(p.type,p);na=y,p.target.dispatchEvent(y),na=null}else return c=Ra(p),c!==null&&Lf(c),a.blockedOn=p,!1;c.shift()}return!0}function Ry(a,c,p){uc(a)&&p.delete(c)}function lL(){Cf=!1,ys!==null&&uc(ys)&&(ys=null),vs!==null&&uc(vs)&&(vs=null),xs!==null&&uc(xs)&&(xs=null),fa.forEach(Ry),ha.forEach(Ry)}function ma(a,c){a.blockedOn===c&&(a.blockedOn=null,Cf||(Cf=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,lL)))}function ga(a){function c(T){return ma(T,a)}if(0<cc.length){ma(cc[0],a);for(var p=1;p<cc.length;p++){var y=cc[p];y.blockedOn===a&&(y.blockedOn=null)}}for(ys!==null&&ma(ys,a),vs!==null&&ma(vs,a),xs!==null&&ma(xs,a),fa.forEach(c),ha.forEach(c),p=0;p<Es.length;p++)y=Es[p],y.blockedOn===a&&(y.blockedOn=null);for(;0<Es.length&&(p=Es[0],p.blockedOn===null);)_y(p),p.blockedOn===null&&Es.shift()}var Yi=R.ReactCurrentBatchConfig,dc=!0;function cL(a,c,p,y){var T=Ze,w=Yi.transition;Yi.transition=null;try{Ze=1,kf(a,c,p,y)}finally{Ze=T,Yi.transition=w}}function uL(a,c,p,y){var T=Ze,w=Yi.transition;Yi.transition=null;try{Ze=4,kf(a,c,p,y)}finally{Ze=T,Yi.transition=w}}function kf(a,c,p,y){if(dc){var T=Pf(a,c,p,y);if(T===null)qf(a,c,y,fc,p),Ay(a,y);else if(aL(T,a,c,p,y))y.stopPropagation();else if(Ay(a,y),c&4&&-1<oL.indexOf(a)){for(;T!==null;){var w=Ra(T);if(w!==null&&Ty(w),w=Pf(a,c,p,y),w===null&&qf(a,c,y,fc,p),w===T)break;T=w}T!==null&&y.stopPropagation()}else qf(a,c,y,null,p)}}var fc=null;function Pf(a,c,p,y){if(fc=null,a=zi(y),a=oi(a),a!==null)if(c=ii(a),c===null)a=null;else if(p=c.tag,p===13){if(a=fy(c),a!==null)return a;a=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return fc=a,null}function Ly(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(QR()){case If:return 1;case vy:return 4;case sc:case JR:return 16;case xy:return 536870912;default:return 16}default:return 16}}var Ss=null,Df=null,hc=null;function Cy(){if(hc)return hc;var a,c=Df,p=c.length,y,T="value"in Ss?Ss.value:Ss.textContent,w=T.length;for(a=0;a<p&&c[a]===T[a];a++);var L=p-a;for(y=1;y<=L&&c[p-y]===T[w-y];y++);return hc=T.slice(a,1<y?1-y:void 0)}function pc(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function mc(){return!0}function ky(){return!1}function Tn(a){function c(p,y,T,w,L){this._reactName=p,this._targetInst=T,this.type=y,this.nativeEvent=w,this.target=L,this.currentTarget=null;for(var B in a)a.hasOwnProperty(B)&&(p=a[B],this[B]=p?p(w):w[B]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?mc:ky,this.isPropagationStopped=ky,this}return ee(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=mc)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=mc)},persist:function(){},isPersistent:mc}),c}var qi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nf=Tn(qi),ya=ee({},qi,{view:0,detail:0}),dL=Tn(ya),Of,Mf,va,gc=ee({},ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bf,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==va&&(va&&a.type==="mousemove"?(Of=a.screenX-va.screenX,Mf=a.screenY-va.screenY):Mf=Of=0,va=a),Of)},movementY:function(a){return"movementY"in a?a.movementY:Mf}}),Py=Tn(gc),fL=ee({},gc,{dataTransfer:0}),hL=Tn(fL),pL=ee({},ya,{relatedTarget:0}),Ff=Tn(pL),mL=ee({},qi,{animationName:0,elapsedTime:0,pseudoElement:0}),gL=Tn(mL),yL=ee({},qi,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),vL=Tn(yL),xL=ee({},qi,{data:0}),Dy=Tn(xL),EL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},SL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},TL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bL(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=TL[a])?!!c[a]:!1}function Bf(){return bL}var wL=ee({},ya,{key:function(a){if(a.key){var c=EL[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=pc(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?SL[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bf,charCode:function(a){return a.type==="keypress"?pc(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?pc(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),IL=Tn(wL),AL=ee({},gc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ny=Tn(AL),_L=ee({},ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bf}),RL=Tn(_L),LL=ee({},qi,{propertyName:0,elapsedTime:0,pseudoElement:0}),CL=Tn(LL),kL=ee({},gc,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),PL=Tn(kL),DL=[9,13,27,32],Uf=l&&"CompositionEvent"in window,xa=null;l&&"documentMode"in document&&(xa=document.documentMode);var NL=l&&"TextEvent"in window&&!xa,Oy=l&&(!Uf||xa&&8<xa&&11>=xa),My=" ",Fy=!1;function By(a,c){switch(a){case"keyup":return DL.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uy(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Xi=!1;function OL(a,c){switch(a){case"compositionend":return Uy(c);case"keypress":return c.which!==32?null:(Fy=!0,My);case"textInput":return a=c.data,a===My&&Fy?null:a;default:return null}}function ML(a,c){if(Xi)return a==="compositionend"||!Uf&&By(a,c)?(a=Cy(),hc=Df=Ss=null,Xi=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Oy&&c.locale!=="ko"?null:c.data;default:return null}}var FL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $y(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!FL[a.type]:c==="textarea"}function jy(a,c,p,y){ec(y),c=Sc(c,"onChange"),0<c.length&&(p=new Nf("onChange","change",null,p,y),a.push({event:p,listeners:c}))}var Ea=null,Sa=null;function BL(a){iv(a,0)}function yc(a){var c=to(a);if(Te(c))return a}function UL(a,c){if(a==="change")return c}var Vy=!1;if(l){var $f;if(l){var jf="oninput"in document;if(!jf){var Gy=document.createElement("div");Gy.setAttribute("oninput","return;"),jf=typeof Gy.oninput=="function"}$f=jf}else $f=!1;Vy=$f&&(!document.documentMode||9<document.documentMode)}function Hy(){Ea&&(Ea.detachEvent("onpropertychange",Ky),Sa=Ea=null)}function Ky(a){if(a.propertyName==="value"&&yc(Sa)){var c=[];jy(c,Sa,a,zi(a)),dy(BL,c)}}function $L(a,c,p){a==="focusin"?(Hy(),Ea=c,Sa=p,Ea.attachEvent("onpropertychange",Ky)):a==="focusout"&&Hy()}function jL(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return yc(Sa)}function VL(a,c){if(a==="click")return yc(c)}function GL(a,c){if(a==="input"||a==="change")return yc(c)}function HL(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var Jn=typeof Object.is=="function"?Object.is:HL;function Ta(a,c){if(Jn(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var p=Object.keys(a),y=Object.keys(c);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var T=p[y];if(!u.call(c,T)||!Jn(a[T],c[T]))return!1}return!0}function Wy(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function zy(a,c){var p=Wy(a);a=0;for(var y;p;){if(p.nodeType===3){if(y=a+p.textContent.length,a<=c&&y>=c)return{node:p,offset:c-a};a=y}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Wy(p)}}function Yy(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?Yy(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function qy(){for(var a=window,c=xe();c instanceof a.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)a=c.contentWindow;else break;c=xe(a.document)}return c}function Vf(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function KL(a){var c=qy(),p=a.focusedElem,y=a.selectionRange;if(c!==p&&p&&p.ownerDocument&&Yy(p.ownerDocument.documentElement,p)){if(y!==null&&Vf(p)){if(c=y.start,a=y.end,a===void 0&&(a=c),"selectionStart"in p)p.selectionStart=c,p.selectionEnd=Math.min(a,p.value.length);else if(a=(c=p.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var T=p.textContent.length,w=Math.min(y.start,T);y=y.end===void 0?w:Math.min(y.end,T),!a.extend&&w>y&&(T=y,y=w,w=T),T=zy(p,w);var L=zy(p,y);T&&L&&(a.rangeCount!==1||a.anchorNode!==T.node||a.anchorOffset!==T.offset||a.focusNode!==L.node||a.focusOffset!==L.offset)&&(c=c.createRange(),c.setStart(T.node,T.offset),a.removeAllRanges(),w>y?(a.addRange(c),a.extend(L.node,L.offset)):(c.setEnd(L.node,L.offset),a.addRange(c)))}}for(c=[],a=p;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<c.length;p++)a=c[p],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var WL=l&&"documentMode"in document&&11>=document.documentMode,Qi=null,Gf=null,ba=null,Hf=!1;function Xy(a,c,p){var y=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Hf||Qi==null||Qi!==xe(y)||(y=Qi,"selectionStart"in y&&Vf(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),ba&&Ta(ba,y)||(ba=y,y=Sc(Gf,"onSelect"),0<y.length&&(c=new Nf("onSelect","select",null,c,p),a.push({event:c,listeners:y}),c.target=Qi)))}function vc(a,c){var p={};return p[a.toLowerCase()]=c.toLowerCase(),p["Webkit"+a]="webkit"+c,p["Moz"+a]="moz"+c,p}var Ji={animationend:vc("Animation","AnimationEnd"),animationiteration:vc("Animation","AnimationIteration"),animationstart:vc("Animation","AnimationStart"),transitionend:vc("Transition","TransitionEnd")},Kf={},Qy={};l&&(Qy=document.createElement("div").style,"AnimationEvent"in window||(delete Ji.animationend.animation,delete Ji.animationiteration.animation,delete Ji.animationstart.animation),"TransitionEvent"in window||delete Ji.transitionend.transition);function xc(a){if(Kf[a])return Kf[a];if(!Ji[a])return a;var c=Ji[a],p;for(p in c)if(c.hasOwnProperty(p)&&p in Qy)return Kf[a]=c[p];return a}var Jy=xc("animationend"),Zy=xc("animationiteration"),ev=xc("animationstart"),tv=xc("transitionend"),nv=new Map,rv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ts(a,c){nv.set(a,c),i(c,[a])}for(var Wf=0;Wf<rv.length;Wf++){var zf=rv[Wf],zL=zf.toLowerCase(),YL=zf[0].toUpperCase()+zf.slice(1);Ts(zL,"on"+YL)}Ts(Jy,"onAnimationEnd"),Ts(Zy,"onAnimationIteration"),Ts(ev,"onAnimationStart"),Ts("dblclick","onDoubleClick"),Ts("focusin","onFocus"),Ts("focusout","onBlur"),Ts(tv,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qL=new Set("cancel close invalid load scroll toggle".split(" ").concat(wa));function sv(a,c,p){var y=a.type||"unknown-event";a.currentTarget=p,zR(y,c,void 0,a),a.currentTarget=null}function iv(a,c){c=(c&4)!==0;for(var p=0;p<a.length;p++){var y=a[p],T=y.event;y=y.listeners;e:{var w=void 0;if(c)for(var L=y.length-1;0<=L;L--){var B=y[L],j=B.instance,X=B.currentTarget;if(B=B.listener,j!==w&&T.isPropagationStopped())break e;sv(T,B,X),w=j}else for(L=0;L<y.length;L++){if(B=y[L],j=B.instance,X=B.currentTarget,B=B.listener,j!==w&&T.isPropagationStopped())break e;sv(T,B,X),w=j}}}if(rc)throw a=wf,rc=!1,wf=null,a}function ct(a,c){var p=c[th];p===void 0&&(p=c[th]=new Set);var y=a+"__bubble";p.has(y)||(ov(c,a,2,!1),p.add(y))}function Yf(a,c,p){var y=0;c&&(y|=4),ov(p,a,y,c)}var Ec="_reactListening"+Math.random().toString(36).slice(2);function Ia(a){if(!a[Ec]){a[Ec]=!0,r.forEach(function(p){p!=="selectionchange"&&(qL.has(p)||Yf(p,!1,a),Yf(p,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Ec]||(c[Ec]=!0,Yf("selectionchange",!1,c))}}function ov(a,c,p,y){switch(Ly(c)){case 1:var T=cL;break;case 4:T=uL;break;default:T=kf}p=T.bind(null,c,p,a),T=void 0,!bf||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(T=!0),y?T!==void 0?a.addEventListener(c,p,{capture:!0,passive:T}):a.addEventListener(c,p,!0):T!==void 0?a.addEventListener(c,p,{passive:T}):a.addEventListener(c,p,!1)}function qf(a,c,p,y,T){var w=y;if((c&1)===0&&(c&2)===0&&y!==null)e:for(;;){if(y===null)return;var L=y.tag;if(L===3||L===4){var B=y.stateNode.containerInfo;if(B===T||B.nodeType===8&&B.parentNode===T)break;if(L===4)for(L=y.return;L!==null;){var j=L.tag;if((j===3||j===4)&&(j=L.stateNode.containerInfo,j===T||j.nodeType===8&&j.parentNode===T))return;L=L.return}for(;B!==null;){if(L=oi(B),L===null)return;if(j=L.tag,j===5||j===6){y=w=L;continue e}B=B.parentNode}}y=y.return}dy(function(){var X=w,ae=zi(p),le=[];e:{var oe=nv.get(a);if(oe!==void 0){var me=Nf,Ee=a;switch(a){case"keypress":if(pc(p)===0)break e;case"keydown":case"keyup":me=IL;break;case"focusin":Ee="focus",me=Ff;break;case"focusout":Ee="blur",me=Ff;break;case"beforeblur":case"afterblur":me=Ff;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=Py;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=hL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=RL;break;case Jy:case Zy:case ev:me=gL;break;case tv:me=CL;break;case"scroll":me=dL;break;case"wheel":me=PL;break;case"copy":case"cut":case"paste":me=vL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Ny}var be=(c&4)!==0,bt=!be&&a==="scroll",z=be?oe!==null?oe+"Capture":null:oe;be=[];for(var V=X,Y;V!==null;){Y=V;var de=Y.stateNode;if(Y.tag===5&&de!==null&&(Y=de,z!==null&&(de=aa(V,z),de!=null&&be.push(Aa(V,de,Y)))),bt)break;V=V.return}0<be.length&&(oe=new me(oe,Ee,null,p,ae),le.push({event:oe,listeners:be}))}}if((c&7)===0){e:{if(oe=a==="mouseover"||a==="pointerover",me=a==="mouseout"||a==="pointerout",oe&&p!==na&&(Ee=p.relatedTarget||p.fromElement)&&(oi(Ee)||Ee[$r]))break e;if((me||oe)&&(oe=ae.window===ae?ae:(oe=ae.ownerDocument)?oe.defaultView||oe.parentWindow:window,me?(Ee=p.relatedTarget||p.toElement,me=X,Ee=Ee?oi(Ee):null,Ee!==null&&(bt=ii(Ee),Ee!==bt||Ee.tag!==5&&Ee.tag!==6)&&(Ee=null)):(me=null,Ee=X),me!==Ee)){if(be=Py,de="onMouseLeave",z="onMouseEnter",V="mouse",(a==="pointerout"||a==="pointerover")&&(be=Ny,de="onPointerLeave",z="onPointerEnter",V="pointer"),bt=me==null?oe:to(me),Y=Ee==null?oe:to(Ee),oe=new be(de,V+"leave",me,p,ae),oe.target=bt,oe.relatedTarget=Y,de=null,oi(ae)===X&&(be=new be(z,V+"enter",Ee,p,ae),be.target=Y,be.relatedTarget=bt,de=be),bt=de,me&&Ee)t:{for(be=me,z=Ee,V=0,Y=be;Y;Y=Zi(Y))V++;for(Y=0,de=z;de;de=Zi(de))Y++;for(;0<V-Y;)be=Zi(be),V--;for(;0<Y-V;)z=Zi(z),Y--;for(;V--;){if(be===z||z!==null&&be===z.alternate)break t;be=Zi(be),z=Zi(z)}be=null}else be=null;me!==null&&av(le,oe,me,be,!1),Ee!==null&&bt!==null&&av(le,bt,Ee,be,!0)}}e:{if(oe=X?to(X):window,me=oe.nodeName&&oe.nodeName.toLowerCase(),me==="select"||me==="input"&&oe.type==="file")var Ie=UL;else if($y(oe))if(Vy)Ie=GL;else{Ie=jL;var Re=$L}else(me=oe.nodeName)&&me.toLowerCase()==="input"&&(oe.type==="checkbox"||oe.type==="radio")&&(Ie=VL);if(Ie&&(Ie=Ie(a,X))){jy(le,Ie,p,ae);break e}Re&&Re(a,oe,X),a==="focusout"&&(Re=oe._wrapperState)&&Re.controlled&&oe.type==="number"&&Ve(oe,"number",oe.value)}switch(Re=X?to(X):window,a){case"focusin":($y(Re)||Re.contentEditable==="true")&&(Qi=Re,Gf=X,ba=null);break;case"focusout":ba=Gf=Qi=null;break;case"mousedown":Hf=!0;break;case"contextmenu":case"mouseup":case"dragend":Hf=!1,Xy(le,p,ae);break;case"selectionchange":if(WL)break;case"keydown":case"keyup":Xy(le,p,ae)}var Le;if(Uf)e:{switch(a){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else Xi?By(a,p)&&(Ne="onCompositionEnd"):a==="keydown"&&p.keyCode===229&&(Ne="onCompositionStart");Ne&&(Oy&&p.locale!=="ko"&&(Xi||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&Xi&&(Le=Cy()):(Ss=ae,Df="value"in Ss?Ss.value:Ss.textContent,Xi=!0)),Re=Sc(X,Ne),0<Re.length&&(Ne=new Dy(Ne,a,null,p,ae),le.push({event:Ne,listeners:Re}),Le?Ne.data=Le:(Le=Uy(p),Le!==null&&(Ne.data=Le)))),(Le=NL?OL(a,p):ML(a,p))&&(X=Sc(X,"onBeforeInput"),0<X.length&&(ae=new Dy("onBeforeInput","beforeinput",null,p,ae),le.push({event:ae,listeners:X}),ae.data=Le))}iv(le,c)})}function Aa(a,c,p){return{instance:a,listener:c,currentTarget:p}}function Sc(a,c){for(var p=c+"Capture",y=[];a!==null;){var T=a,w=T.stateNode;T.tag===5&&w!==null&&(T=w,w=aa(a,p),w!=null&&y.unshift(Aa(a,w,T)),w=aa(a,c),w!=null&&y.push(Aa(a,w,T))),a=a.return}return y}function Zi(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function av(a,c,p,y,T){for(var w=c._reactName,L=[];p!==null&&p!==y;){var B=p,j=B.alternate,X=B.stateNode;if(j!==null&&j===y)break;B.tag===5&&X!==null&&(B=X,T?(j=aa(p,w),j!=null&&L.unshift(Aa(p,j,B))):T||(j=aa(p,w),j!=null&&L.push(Aa(p,j,B)))),p=p.return}L.length!==0&&a.push({event:c,listeners:L})}var XL=/\r\n?/g,QL=/\u0000|\uFFFD/g;function lv(a){return(typeof a=="string"?a:""+a).replace(XL,`
`).replace(QL,"")}function Tc(a,c,p){if(c=lv(c),lv(a)!==c&&p)throw Error(t(425))}function bc(){}var Xf=null,Qf=null;function Jf(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Zf=typeof setTimeout=="function"?setTimeout:void 0,JL=typeof clearTimeout=="function"?clearTimeout:void 0,cv=typeof Promise=="function"?Promise:void 0,ZL=typeof queueMicrotask=="function"?queueMicrotask:typeof cv<"u"?function(a){return cv.resolve(null).then(a).catch(eC)}:Zf;function eC(a){setTimeout(function(){throw a})}function eh(a,c){var p=c,y=0;do{var T=p.nextSibling;if(a.removeChild(p),T&&T.nodeType===8)if(p=T.data,p==="/$"){if(y===0){a.removeChild(T),ga(c);return}y--}else p!=="$"&&p!=="$?"&&p!=="$!"||y++;p=T}while(p);ga(c)}function bs(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function uv(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var p=a.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return a;c--}else p==="/$"&&c++}a=a.previousSibling}return null}var eo=Math.random().toString(36).slice(2),yr="__reactFiber$"+eo,_a="__reactProps$"+eo,$r="__reactContainer$"+eo,th="__reactEvents$"+eo,tC="__reactListeners$"+eo,nC="__reactHandles$"+eo;function oi(a){var c=a[yr];if(c)return c;for(var p=a.parentNode;p;){if(c=p[$r]||p[yr]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(a=uv(a);a!==null;){if(p=a[yr])return p;a=uv(a)}return c}a=p,p=a.parentNode}return null}function Ra(a){return a=a[yr]||a[$r],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function to(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function wc(a){return a[_a]||null}var nh=[],no=-1;function ws(a){return{current:a}}function ut(a){0>no||(a.current=nh[no],nh[no]=null,no--)}function at(a,c){no++,nh[no]=a.current,a.current=c}var Is={},Ht=ws(Is),an=ws(!1),ai=Is;function ro(a,c){var p=a.type.contextTypes;if(!p)return Is;var y=a.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===c)return y.__reactInternalMemoizedMaskedChildContext;var T={},w;for(w in p)T[w]=c[w];return y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=T),T}function ln(a){return a=a.childContextTypes,a!=null}function Ic(){ut(an),ut(Ht)}function dv(a,c,p){if(Ht.current!==Is)throw Error(t(168));at(Ht,c),at(an,p)}function fv(a,c,p){var y=a.stateNode;if(c=c.childContextTypes,typeof y.getChildContext!="function")return p;y=y.getChildContext();for(var T in y)if(!(T in c))throw Error(t(108,Se(a)||"Unknown",T));return ee({},p,y)}function Ac(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Is,ai=Ht.current,at(Ht,a),at(an,an.current),!0}function hv(a,c,p){var y=a.stateNode;if(!y)throw Error(t(169));p?(a=fv(a,c,ai),y.__reactInternalMemoizedMergedChildContext=a,ut(an),ut(Ht),at(Ht,a)):ut(an),at(an,p)}var jr=null,_c=!1,rh=!1;function pv(a){jr===null?jr=[a]:jr.push(a)}function rC(a){_c=!0,pv(a)}function As(){if(!rh&&jr!==null){rh=!0;var a=0,c=Ze;try{var p=jr;for(Ze=1;a<p.length;a++){var y=p[a];do y=y(!0);while(y!==null)}jr=null,_c=!1}catch(T){throw jr!==null&&(jr=jr.slice(a+1)),gy(If,As),T}finally{Ze=c,rh=!1}}return null}var so=[],io=0,Rc=null,Lc=0,Un=[],$n=0,li=null,Vr=1,Gr="";function ci(a,c){so[io++]=Lc,so[io++]=Rc,Rc=a,Lc=c}function mv(a,c,p){Un[$n++]=Vr,Un[$n++]=Gr,Un[$n++]=li,li=a;var y=Vr;a=Gr;var T=32-Qn(y)-1;y&=~(1<<T),p+=1;var w=32-Qn(c)+T;if(30<w){var L=T-T%5;w=(y&(1<<L)-1).toString(32),y>>=L,T-=L,Vr=1<<32-Qn(c)+T|p<<T|y,Gr=w+a}else Vr=1<<w|p<<T|y,Gr=a}function sh(a){a.return!==null&&(ci(a,1),mv(a,1,0))}function ih(a){for(;a===Rc;)Rc=so[--io],so[io]=null,Lc=so[--io],so[io]=null;for(;a===li;)li=Un[--$n],Un[$n]=null,Gr=Un[--$n],Un[$n]=null,Vr=Un[--$n],Un[$n]=null}var bn=null,wn=null,dt=!1,Zn=null;function gv(a,c){var p=Hn(5,null,null,0);p.elementType="DELETED",p.stateNode=c,p.return=a,c=a.deletions,c===null?(a.deletions=[p],a.flags|=16):c.push(p)}function yv(a,c){switch(a.tag){case 5:var p=a.type;return c=c.nodeType!==1||p.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,bn=a,wn=bs(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,bn=a,wn=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(p=li!==null?{id:Vr,overflow:Gr}:null,a.memoizedState={dehydrated:c,treeContext:p,retryLane:1073741824},p=Hn(18,null,null,0),p.stateNode=c,p.return=a,a.child=p,bn=a,wn=null,!0):!1;default:return!1}}function oh(a){return(a.mode&1)!==0&&(a.flags&128)===0}function ah(a){if(dt){var c=wn;if(c){var p=c;if(!yv(a,c)){if(oh(a))throw Error(t(418));c=bs(p.nextSibling);var y=bn;c&&yv(a,c)?gv(y,p):(a.flags=a.flags&-4097|2,dt=!1,bn=a)}}else{if(oh(a))throw Error(t(418));a.flags=a.flags&-4097|2,dt=!1,bn=a}}}function vv(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;bn=a}function Cc(a){if(a!==bn)return!1;if(!dt)return vv(a),dt=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!Jf(a.type,a.memoizedProps)),c&&(c=wn)){if(oh(a))throw xv(),Error(t(418));for(;c;)gv(a,c),c=bs(c.nextSibling)}if(vv(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var p=a.data;if(p==="/$"){if(c===0){wn=bs(a.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++}a=a.nextSibling}wn=null}}else wn=bn?bs(a.stateNode.nextSibling):null;return!0}function xv(){for(var a=wn;a;)a=bs(a.nextSibling)}function oo(){wn=bn=null,dt=!1}function lh(a){Zn===null?Zn=[a]:Zn.push(a)}var sC=R.ReactCurrentBatchConfig;function La(a,c,p){if(a=p.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var y=p.stateNode}if(!y)throw Error(t(147,a));var T=y,w=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===w?c.ref:(c=function(L){var B=T.refs;L===null?delete B[w]:B[w]=L},c._stringRef=w,c)}if(typeof a!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,a))}return a}function kc(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function Ev(a){var c=a._init;return c(a._payload)}function Sv(a){function c(z,V){if(a){var Y=z.deletions;Y===null?(z.deletions=[V],z.flags|=16):Y.push(V)}}function p(z,V){if(!a)return null;for(;V!==null;)c(z,V),V=V.sibling;return null}function y(z,V){for(z=new Map;V!==null;)V.key!==null?z.set(V.key,V):z.set(V.index,V),V=V.sibling;return z}function T(z,V){return z=Ns(z,V),z.index=0,z.sibling=null,z}function w(z,V,Y){return z.index=Y,a?(Y=z.alternate,Y!==null?(Y=Y.index,Y<V?(z.flags|=2,V):Y):(z.flags|=2,V)):(z.flags|=1048576,V)}function L(z){return a&&z.alternate===null&&(z.flags|=2),z}function B(z,V,Y,de){return V===null||V.tag!==6?(V=Zh(Y,z.mode,de),V.return=z,V):(V=T(V,Y),V.return=z,V)}function j(z,V,Y,de){var Ie=Y.type;return Ie===k?ae(z,V,Y.props.children,de,Y.key):V!==null&&(V.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===q&&Ev(Ie)===V.type)?(de=T(V,Y.props),de.ref=La(z,V,Y),de.return=z,de):(de=tu(Y.type,Y.key,Y.props,null,z.mode,de),de.ref=La(z,V,Y),de.return=z,de)}function X(z,V,Y,de){return V===null||V.tag!==4||V.stateNode.containerInfo!==Y.containerInfo||V.stateNode.implementation!==Y.implementation?(V=ep(Y,z.mode,de),V.return=z,V):(V=T(V,Y.children||[]),V.return=z,V)}function ae(z,V,Y,de,Ie){return V===null||V.tag!==7?(V=yi(Y,z.mode,de,Ie),V.return=z,V):(V=T(V,Y),V.return=z,V)}function le(z,V,Y){if(typeof V=="string"&&V!==""||typeof V=="number")return V=Zh(""+V,z.mode,Y),V.return=z,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case C:return Y=tu(V.type,V.key,V.props,null,z.mode,Y),Y.ref=La(z,null,V),Y.return=z,Y;case F:return V=ep(V,z.mode,Y),V.return=z,V;case q:var de=V._init;return le(z,de(V._payload),Y)}if(Ue(V)||Q(V))return V=yi(V,z.mode,Y,null),V.return=z,V;kc(z,V)}return null}function oe(z,V,Y,de){var Ie=V!==null?V.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Ie!==null?null:B(z,V,""+Y,de);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case C:return Y.key===Ie?j(z,V,Y,de):null;case F:return Y.key===Ie?X(z,V,Y,de):null;case q:return Ie=Y._init,oe(z,V,Ie(Y._payload),de)}if(Ue(Y)||Q(Y))return Ie!==null?null:ae(z,V,Y,de,null);kc(z,Y)}return null}function me(z,V,Y,de,Ie){if(typeof de=="string"&&de!==""||typeof de=="number")return z=z.get(Y)||null,B(V,z,""+de,Ie);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case C:return z=z.get(de.key===null?Y:de.key)||null,j(V,z,de,Ie);case F:return z=z.get(de.key===null?Y:de.key)||null,X(V,z,de,Ie);case q:var Re=de._init;return me(z,V,Y,Re(de._payload),Ie)}if(Ue(de)||Q(de))return z=z.get(Y)||null,ae(V,z,de,Ie,null);kc(V,de)}return null}function Ee(z,V,Y,de){for(var Ie=null,Re=null,Le=V,Ne=V=0,Mt=null;Le!==null&&Ne<Y.length;Ne++){Le.index>Ne?(Mt=Le,Le=null):Mt=Le.sibling;var qe=oe(z,Le,Y[Ne],de);if(qe===null){Le===null&&(Le=Mt);break}a&&Le&&qe.alternate===null&&c(z,Le),V=w(qe,V,Ne),Re===null?Ie=qe:Re.sibling=qe,Re=qe,Le=Mt}if(Ne===Y.length)return p(z,Le),dt&&ci(z,Ne),Ie;if(Le===null){for(;Ne<Y.length;Ne++)Le=le(z,Y[Ne],de),Le!==null&&(V=w(Le,V,Ne),Re===null?Ie=Le:Re.sibling=Le,Re=Le);return dt&&ci(z,Ne),Ie}for(Le=y(z,Le);Ne<Y.length;Ne++)Mt=me(Le,z,Ne,Y[Ne],de),Mt!==null&&(a&&Mt.alternate!==null&&Le.delete(Mt.key===null?Ne:Mt.key),V=w(Mt,V,Ne),Re===null?Ie=Mt:Re.sibling=Mt,Re=Mt);return a&&Le.forEach(function(Os){return c(z,Os)}),dt&&ci(z,Ne),Ie}function be(z,V,Y,de){var Ie=Q(Y);if(typeof Ie!="function")throw Error(t(150));if(Y=Ie.call(Y),Y==null)throw Error(t(151));for(var Re=Ie=null,Le=V,Ne=V=0,Mt=null,qe=Y.next();Le!==null&&!qe.done;Ne++,qe=Y.next()){Le.index>Ne?(Mt=Le,Le=null):Mt=Le.sibling;var Os=oe(z,Le,qe.value,de);if(Os===null){Le===null&&(Le=Mt);break}a&&Le&&Os.alternate===null&&c(z,Le),V=w(Os,V,Ne),Re===null?Ie=Os:Re.sibling=Os,Re=Os,Le=Mt}if(qe.done)return p(z,Le),dt&&ci(z,Ne),Ie;if(Le===null){for(;!qe.done;Ne++,qe=Y.next())qe=le(z,qe.value,de),qe!==null&&(V=w(qe,V,Ne),Re===null?Ie=qe:Re.sibling=qe,Re=qe);return dt&&ci(z,Ne),Ie}for(Le=y(z,Le);!qe.done;Ne++,qe=Y.next())qe=me(Le,z,Ne,qe.value,de),qe!==null&&(a&&qe.alternate!==null&&Le.delete(qe.key===null?Ne:qe.key),V=w(qe,V,Ne),Re===null?Ie=qe:Re.sibling=qe,Re=qe);return a&&Le.forEach(function(FC){return c(z,FC)}),dt&&ci(z,Ne),Ie}function bt(z,V,Y,de){if(typeof Y=="object"&&Y!==null&&Y.type===k&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case C:e:{for(var Ie=Y.key,Re=V;Re!==null;){if(Re.key===Ie){if(Ie=Y.type,Ie===k){if(Re.tag===7){p(z,Re.sibling),V=T(Re,Y.props.children),V.return=z,z=V;break e}}else if(Re.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===q&&Ev(Ie)===Re.type){p(z,Re.sibling),V=T(Re,Y.props),V.ref=La(z,Re,Y),V.return=z,z=V;break e}p(z,Re);break}else c(z,Re);Re=Re.sibling}Y.type===k?(V=yi(Y.props.children,z.mode,de,Y.key),V.return=z,z=V):(de=tu(Y.type,Y.key,Y.props,null,z.mode,de),de.ref=La(z,V,Y),de.return=z,z=de)}return L(z);case F:e:{for(Re=Y.key;V!==null;){if(V.key===Re)if(V.tag===4&&V.stateNode.containerInfo===Y.containerInfo&&V.stateNode.implementation===Y.implementation){p(z,V.sibling),V=T(V,Y.children||[]),V.return=z,z=V;break e}else{p(z,V);break}else c(z,V);V=V.sibling}V=ep(Y,z.mode,de),V.return=z,z=V}return L(z);case q:return Re=Y._init,bt(z,V,Re(Y._payload),de)}if(Ue(Y))return Ee(z,V,Y,de);if(Q(Y))return be(z,V,Y,de);kc(z,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,V!==null&&V.tag===6?(p(z,V.sibling),V=T(V,Y),V.return=z,z=V):(p(z,V),V=Zh(Y,z.mode,de),V.return=z,z=V),L(z)):p(z,V)}return bt}var ao=Sv(!0),Tv=Sv(!1),Pc=ws(null),Dc=null,lo=null,ch=null;function uh(){ch=lo=Dc=null}function dh(a){var c=Pc.current;ut(Pc),a._currentValue=c}function fh(a,c,p){for(;a!==null;){var y=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),a===p)break;a=a.return}}function co(a,c){Dc=a,ch=lo=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(cn=!0),a.firstContext=null)}function jn(a){var c=a._currentValue;if(ch!==a)if(a={context:a,memoizedValue:c,next:null},lo===null){if(Dc===null)throw Error(t(308));lo=a,Dc.dependencies={lanes:0,firstContext:a}}else lo=lo.next=a;return c}var ui=null;function hh(a){ui===null?ui=[a]:ui.push(a)}function bv(a,c,p,y){var T=c.interleaved;return T===null?(p.next=p,hh(c)):(p.next=T.next,T.next=p),c.interleaved=p,Hr(a,y)}function Hr(a,c){a.lanes|=c;var p=a.alternate;for(p!==null&&(p.lanes|=c),p=a,a=a.return;a!==null;)a.childLanes|=c,p=a.alternate,p!==null&&(p.childLanes|=c),p=a,a=a.return;return p.tag===3?p.stateNode:null}var _s=!1;function ph(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wv(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Kr(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function Rs(a,c,p){var y=a.updateQueue;if(y===null)return null;if(y=y.shared,(ze&2)!==0){var T=y.pending;return T===null?c.next=c:(c.next=T.next,T.next=c),y.pending=c,Hr(a,p)}return T=y.interleaved,T===null?(c.next=c,hh(y)):(c.next=T.next,T.next=c),y.interleaved=c,Hr(a,p)}function Nc(a,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194240)!==0)){var y=c.lanes;y&=a.pendingLanes,p|=y,c.lanes=p,Rf(a,p)}}function Iv(a,c){var p=a.updateQueue,y=a.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var T=null,w=null;if(p=p.firstBaseUpdate,p!==null){do{var L={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};w===null?T=w=L:w=w.next=L,p=p.next}while(p!==null);w===null?T=w=c:w=w.next=c}else T=w=c;p={baseState:y.baseState,firstBaseUpdate:T,lastBaseUpdate:w,shared:y.shared,effects:y.effects},a.updateQueue=p;return}a=p.lastBaseUpdate,a===null?p.firstBaseUpdate=c:a.next=c,p.lastBaseUpdate=c}function Oc(a,c,p,y){var T=a.updateQueue;_s=!1;var w=T.firstBaseUpdate,L=T.lastBaseUpdate,B=T.shared.pending;if(B!==null){T.shared.pending=null;var j=B,X=j.next;j.next=null,L===null?w=X:L.next=X,L=j;var ae=a.alternate;ae!==null&&(ae=ae.updateQueue,B=ae.lastBaseUpdate,B!==L&&(B===null?ae.firstBaseUpdate=X:B.next=X,ae.lastBaseUpdate=j))}if(w!==null){var le=T.baseState;L=0,ae=X=j=null,B=w;do{var oe=B.lane,me=B.eventTime;if((y&oe)===oe){ae!==null&&(ae=ae.next={eventTime:me,lane:0,tag:B.tag,payload:B.payload,callback:B.callback,next:null});e:{var Ee=a,be=B;switch(oe=c,me=p,be.tag){case 1:if(Ee=be.payload,typeof Ee=="function"){le=Ee.call(me,le,oe);break e}le=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=be.payload,oe=typeof Ee=="function"?Ee.call(me,le,oe):Ee,oe==null)break e;le=ee({},le,oe);break e;case 2:_s=!0}}B.callback!==null&&B.lane!==0&&(a.flags|=64,oe=T.effects,oe===null?T.effects=[B]:oe.push(B))}else me={eventTime:me,lane:oe,tag:B.tag,payload:B.payload,callback:B.callback,next:null},ae===null?(X=ae=me,j=le):ae=ae.next=me,L|=oe;if(B=B.next,B===null){if(B=T.shared.pending,B===null)break;oe=B,B=oe.next,oe.next=null,T.lastBaseUpdate=oe,T.shared.pending=null}}while(!0);if(ae===null&&(j=le),T.baseState=j,T.firstBaseUpdate=X,T.lastBaseUpdate=ae,c=T.shared.interleaved,c!==null){T=c;do L|=T.lane,T=T.next;while(T!==c)}else w===null&&(T.shared.lanes=0);hi|=L,a.lanes=L,a.memoizedState=le}}function Av(a,c,p){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var y=a[c],T=y.callback;if(T!==null){if(y.callback=null,y=p,typeof T!="function")throw Error(t(191,T));T.call(y)}}}var Ca={},vr=ws(Ca),ka=ws(Ca),Pa=ws(Ca);function di(a){if(a===Ca)throw Error(t(174));return a}function mh(a,c){switch(at(Pa,c),at(ka,a),at(vr,Ca),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:En(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=En(c,a)}ut(vr),at(vr,c)}function uo(){ut(vr),ut(ka),ut(Pa)}function _v(a){di(Pa.current);var c=di(vr.current),p=En(c,a.type);c!==p&&(at(ka,a),at(vr,p))}function gh(a){ka.current===a&&(ut(vr),ut(ka))}var ht=ws(0);function Mc(a){for(var c=a;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var yh=[];function vh(){for(var a=0;a<yh.length;a++)yh[a]._workInProgressVersionPrimary=null;yh.length=0}var Fc=R.ReactCurrentDispatcher,xh=R.ReactCurrentBatchConfig,fi=0,pt=null,Lt=null,Nt=null,Bc=!1,Da=!1,Na=0,iC=0;function Kt(){throw Error(t(321))}function Eh(a,c){if(c===null)return!1;for(var p=0;p<c.length&&p<a.length;p++)if(!Jn(a[p],c[p]))return!1;return!0}function Sh(a,c,p,y,T,w){if(fi=w,pt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Fc.current=a===null||a.memoizedState===null?cC:uC,a=p(y,T),Da){w=0;do{if(Da=!1,Na=0,25<=w)throw Error(t(301));w+=1,Nt=Lt=null,c.updateQueue=null,Fc.current=dC,a=p(y,T)}while(Da)}if(Fc.current=jc,c=Lt!==null&&Lt.next!==null,fi=0,Nt=Lt=pt=null,Bc=!1,c)throw Error(t(300));return a}function Th(){var a=Na!==0;return Na=0,a}function xr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?pt.memoizedState=Nt=a:Nt=Nt.next=a,Nt}function Vn(){if(Lt===null){var a=pt.alternate;a=a!==null?a.memoizedState:null}else a=Lt.next;var c=Nt===null?pt.memoizedState:Nt.next;if(c!==null)Nt=c,Lt=a;else{if(a===null)throw Error(t(310));Lt=a,a={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},Nt===null?pt.memoizedState=Nt=a:Nt=Nt.next=a}return Nt}function Oa(a,c){return typeof c=="function"?c(a):c}function bh(a){var c=Vn(),p=c.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=a;var y=Lt,T=y.baseQueue,w=p.pending;if(w!==null){if(T!==null){var L=T.next;T.next=w.next,w.next=L}y.baseQueue=T=w,p.pending=null}if(T!==null){w=T.next,y=y.baseState;var B=L=null,j=null,X=w;do{var ae=X.lane;if((fi&ae)===ae)j!==null&&(j=j.next={lane:0,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),y=X.hasEagerState?X.eagerState:a(y,X.action);else{var le={lane:ae,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null};j===null?(B=j=le,L=y):j=j.next=le,pt.lanes|=ae,hi|=ae}X=X.next}while(X!==null&&X!==w);j===null?L=y:j.next=B,Jn(y,c.memoizedState)||(cn=!0),c.memoizedState=y,c.baseState=L,c.baseQueue=j,p.lastRenderedState=y}if(a=p.interleaved,a!==null){T=a;do w=T.lane,pt.lanes|=w,hi|=w,T=T.next;while(T!==a)}else T===null&&(p.lanes=0);return[c.memoizedState,p.dispatch]}function wh(a){var c=Vn(),p=c.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=a;var y=p.dispatch,T=p.pending,w=c.memoizedState;if(T!==null){p.pending=null;var L=T=T.next;do w=a(w,L.action),L=L.next;while(L!==T);Jn(w,c.memoizedState)||(cn=!0),c.memoizedState=w,c.baseQueue===null&&(c.baseState=w),p.lastRenderedState=w}return[w,y]}function Rv(){}function Lv(a,c){var p=pt,y=Vn(),T=c(),w=!Jn(y.memoizedState,T);if(w&&(y.memoizedState=T,cn=!0),y=y.queue,Ih(Pv.bind(null,p,y,a),[a]),y.getSnapshot!==c||w||Nt!==null&&Nt.memoizedState.tag&1){if(p.flags|=2048,Ma(9,kv.bind(null,p,y,T,c),void 0,null),Ot===null)throw Error(t(349));(fi&30)!==0||Cv(p,c,T)}return T}function Cv(a,c,p){a.flags|=16384,a={getSnapshot:c,value:p},c=pt.updateQueue,c===null?(c={lastEffect:null,stores:null},pt.updateQueue=c,c.stores=[a]):(p=c.stores,p===null?c.stores=[a]:p.push(a))}function kv(a,c,p,y){c.value=p,c.getSnapshot=y,Dv(c)&&Nv(a)}function Pv(a,c,p){return p(function(){Dv(c)&&Nv(a)})}function Dv(a){var c=a.getSnapshot;a=a.value;try{var p=c();return!Jn(a,p)}catch{return!0}}function Nv(a){var c=Hr(a,1);c!==null&&rr(c,a,1,-1)}function Ov(a){var c=xr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:a},c.queue=a,a=a.dispatch=lC.bind(null,pt,a),[c.memoizedState,a]}function Ma(a,c,p,y){return a={tag:a,create:c,destroy:p,deps:y,next:null},c=pt.updateQueue,c===null?(c={lastEffect:null,stores:null},pt.updateQueue=c,c.lastEffect=a.next=a):(p=c.lastEffect,p===null?c.lastEffect=a.next=a:(y=p.next,p.next=a,a.next=y,c.lastEffect=a)),a}function Mv(){return Vn().memoizedState}function Uc(a,c,p,y){var T=xr();pt.flags|=a,T.memoizedState=Ma(1|c,p,void 0,y===void 0?null:y)}function $c(a,c,p,y){var T=Vn();y=y===void 0?null:y;var w=void 0;if(Lt!==null){var L=Lt.memoizedState;if(w=L.destroy,y!==null&&Eh(y,L.deps)){T.memoizedState=Ma(c,p,w,y);return}}pt.flags|=a,T.memoizedState=Ma(1|c,p,w,y)}function Fv(a,c){return Uc(8390656,8,a,c)}function Ih(a,c){return $c(2048,8,a,c)}function Bv(a,c){return $c(4,2,a,c)}function Uv(a,c){return $c(4,4,a,c)}function $v(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function jv(a,c,p){return p=p!=null?p.concat([a]):null,$c(4,4,$v.bind(null,c,a),p)}function Ah(){}function Vv(a,c){var p=Vn();c=c===void 0?null:c;var y=p.memoizedState;return y!==null&&c!==null&&Eh(c,y[1])?y[0]:(p.memoizedState=[a,c],a)}function Gv(a,c){var p=Vn();c=c===void 0?null:c;var y=p.memoizedState;return y!==null&&c!==null&&Eh(c,y[1])?y[0]:(a=a(),p.memoizedState=[a,c],a)}function Hv(a,c,p){return(fi&21)===0?(a.baseState&&(a.baseState=!1,cn=!0),a.memoizedState=p):(Jn(p,c)||(p=Ey(),pt.lanes|=p,hi|=p,a.baseState=!0),c)}function oC(a,c){var p=Ze;Ze=p!==0&&4>p?p:4,a(!0);var y=xh.transition;xh.transition={};try{a(!1),c()}finally{Ze=p,xh.transition=y}}function Kv(){return Vn().memoizedState}function aC(a,c,p){var y=Ps(a);if(p={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null},Wv(a))zv(c,p);else if(p=bv(a,c,p,y),p!==null){var T=tn();rr(p,a,y,T),Yv(p,c,y)}}function lC(a,c,p){var y=Ps(a),T={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null};if(Wv(a))zv(c,T);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=c.lastRenderedReducer,w!==null))try{var L=c.lastRenderedState,B=w(L,p);if(T.hasEagerState=!0,T.eagerState=B,Jn(B,L)){var j=c.interleaved;j===null?(T.next=T,hh(c)):(T.next=j.next,j.next=T),c.interleaved=T;return}}catch{}finally{}p=bv(a,c,T,y),p!==null&&(T=tn(),rr(p,a,y,T),Yv(p,c,y))}}function Wv(a){var c=a.alternate;return a===pt||c!==null&&c===pt}function zv(a,c){Da=Bc=!0;var p=a.pending;p===null?c.next=c:(c.next=p.next,p.next=c),a.pending=c}function Yv(a,c,p){if((p&4194240)!==0){var y=c.lanes;y&=a.pendingLanes,p|=y,c.lanes=p,Rf(a,p)}}var jc={readContext:jn,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useInsertionEffect:Kt,useLayoutEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useMutableSource:Kt,useSyncExternalStore:Kt,useId:Kt,unstable_isNewReconciler:!1},cC={readContext:jn,useCallback:function(a,c){return xr().memoizedState=[a,c===void 0?null:c],a},useContext:jn,useEffect:Fv,useImperativeHandle:function(a,c,p){return p=p!=null?p.concat([a]):null,Uc(4194308,4,$v.bind(null,c,a),p)},useLayoutEffect:function(a,c){return Uc(4194308,4,a,c)},useInsertionEffect:function(a,c){return Uc(4,2,a,c)},useMemo:function(a,c){var p=xr();return c=c===void 0?null:c,a=a(),p.memoizedState=[a,c],a},useReducer:function(a,c,p){var y=xr();return c=p!==void 0?p(c):c,y.memoizedState=y.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},y.queue=a,a=a.dispatch=aC.bind(null,pt,a),[y.memoizedState,a]},useRef:function(a){var c=xr();return a={current:a},c.memoizedState=a},useState:Ov,useDebugValue:Ah,useDeferredValue:function(a){return xr().memoizedState=a},useTransition:function(){var a=Ov(!1),c=a[0];return a=oC.bind(null,a[1]),xr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,p){var y=pt,T=xr();if(dt){if(p===void 0)throw Error(t(407));p=p()}else{if(p=c(),Ot===null)throw Error(t(349));(fi&30)!==0||Cv(y,c,p)}T.memoizedState=p;var w={value:p,getSnapshot:c};return T.queue=w,Fv(Pv.bind(null,y,w,a),[a]),y.flags|=2048,Ma(9,kv.bind(null,y,w,p,c),void 0,null),p},useId:function(){var a=xr(),c=Ot.identifierPrefix;if(dt){var p=Gr,y=Vr;p=(y&~(1<<32-Qn(y)-1)).toString(32)+p,c=":"+c+"R"+p,p=Na++,0<p&&(c+="H"+p.toString(32)),c+=":"}else p=iC++,c=":"+c+"r"+p.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},uC={readContext:jn,useCallback:Vv,useContext:jn,useEffect:Ih,useImperativeHandle:jv,useInsertionEffect:Bv,useLayoutEffect:Uv,useMemo:Gv,useReducer:bh,useRef:Mv,useState:function(){return bh(Oa)},useDebugValue:Ah,useDeferredValue:function(a){var c=Vn();return Hv(c,Lt.memoizedState,a)},useTransition:function(){var a=bh(Oa)[0],c=Vn().memoizedState;return[a,c]},useMutableSource:Rv,useSyncExternalStore:Lv,useId:Kv,unstable_isNewReconciler:!1},dC={readContext:jn,useCallback:Vv,useContext:jn,useEffect:Ih,useImperativeHandle:jv,useInsertionEffect:Bv,useLayoutEffect:Uv,useMemo:Gv,useReducer:wh,useRef:Mv,useState:function(){return wh(Oa)},useDebugValue:Ah,useDeferredValue:function(a){var c=Vn();return Lt===null?c.memoizedState=a:Hv(c,Lt.memoizedState,a)},useTransition:function(){var a=wh(Oa)[0],c=Vn().memoizedState;return[a,c]},useMutableSource:Rv,useSyncExternalStore:Lv,useId:Kv,unstable_isNewReconciler:!1};function er(a,c){if(a&&a.defaultProps){c=ee({},c),a=a.defaultProps;for(var p in a)c[p]===void 0&&(c[p]=a[p]);return c}return c}function _h(a,c,p,y){c=a.memoizedState,p=p(y,c),p=p==null?c:ee({},c,p),a.memoizedState=p,a.lanes===0&&(a.updateQueue.baseState=p)}var Vc={isMounted:function(a){return(a=a._reactInternals)?ii(a)===a:!1},enqueueSetState:function(a,c,p){a=a._reactInternals;var y=tn(),T=Ps(a),w=Kr(y,T);w.payload=c,p!=null&&(w.callback=p),c=Rs(a,w,T),c!==null&&(rr(c,a,T,y),Nc(c,a,T))},enqueueReplaceState:function(a,c,p){a=a._reactInternals;var y=tn(),T=Ps(a),w=Kr(y,T);w.tag=1,w.payload=c,p!=null&&(w.callback=p),c=Rs(a,w,T),c!==null&&(rr(c,a,T,y),Nc(c,a,T))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var p=tn(),y=Ps(a),T=Kr(p,y);T.tag=2,c!=null&&(T.callback=c),c=Rs(a,T,y),c!==null&&(rr(c,a,y,p),Nc(c,a,y))}};function qv(a,c,p,y,T,w,L){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(y,w,L):c.prototype&&c.prototype.isPureReactComponent?!Ta(p,y)||!Ta(T,w):!0}function Xv(a,c,p){var y=!1,T=Is,w=c.contextType;return typeof w=="object"&&w!==null?w=jn(w):(T=ln(c)?ai:Ht.current,y=c.contextTypes,w=(y=y!=null)?ro(a,T):Is),c=new c(p,w),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Vc,a.stateNode=c,c._reactInternals=a,y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=T,a.__reactInternalMemoizedMaskedChildContext=w),c}function Qv(a,c,p,y){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,y),c.state!==a&&Vc.enqueueReplaceState(c,c.state,null)}function Rh(a,c,p,y){var T=a.stateNode;T.props=p,T.state=a.memoizedState,T.refs={},ph(a);var w=c.contextType;typeof w=="object"&&w!==null?T.context=jn(w):(w=ln(c)?ai:Ht.current,T.context=ro(a,w)),T.state=a.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(_h(a,c,w,p),T.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(c=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),c!==T.state&&Vc.enqueueReplaceState(T,T.state,null),Oc(a,p,T,y),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308)}function fo(a,c){try{var p="",y=c;do p+=ue(y),y=y.return;while(y);var T=p}catch(w){T=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:c,stack:T,digest:null}}function Lh(a,c,p){return{value:a,source:null,stack:p??null,digest:c??null}}function Ch(a,c){try{console.error(c.value)}catch(p){setTimeout(function(){throw p})}}var fC=typeof WeakMap=="function"?WeakMap:Map;function Jv(a,c,p){p=Kr(-1,p),p.tag=3,p.payload={element:null};var y=c.value;return p.callback=function(){qc||(qc=!0,Kh=y),Ch(a,c)},p}function Zv(a,c,p){p=Kr(-1,p),p.tag=3;var y=a.type.getDerivedStateFromError;if(typeof y=="function"){var T=c.value;p.payload=function(){return y(T)},p.callback=function(){Ch(a,c)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(p.callback=function(){Ch(a,c),typeof y!="function"&&(Cs===null?Cs=new Set([this]):Cs.add(this));var L=c.stack;this.componentDidCatch(c.value,{componentStack:L!==null?L:""})}),p}function ex(a,c,p){var y=a.pingCache;if(y===null){y=a.pingCache=new fC;var T=new Set;y.set(c,T)}else T=y.get(c),T===void 0&&(T=new Set,y.set(c,T));T.has(p)||(T.add(p),a=AC.bind(null,a,c,p),c.then(a,a))}function tx(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function nx(a,c,p,y,T){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(c=Kr(-1,1),c.tag=2,Rs(p,c,1))),p.lanes|=1),a):(a.flags|=65536,a.lanes=T,a)}var hC=R.ReactCurrentOwner,cn=!1;function en(a,c,p,y){c.child=a===null?Tv(c,null,p,y):ao(c,a.child,p,y)}function rx(a,c,p,y,T){p=p.render;var w=c.ref;return co(c,T),y=Sh(a,c,p,y,w,T),p=Th(),a!==null&&!cn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~T,Wr(a,c,T)):(dt&&p&&sh(c),c.flags|=1,en(a,c,y,T),c.child)}function sx(a,c,p,y,T){if(a===null){var w=p.type;return typeof w=="function"&&!Jh(w)&&w.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(c.tag=15,c.type=w,ix(a,c,w,y,T)):(a=tu(p.type,null,y,c,c.mode,T),a.ref=c.ref,a.return=c,c.child=a)}if(w=a.child,(a.lanes&T)===0){var L=w.memoizedProps;if(p=p.compare,p=p!==null?p:Ta,p(L,y)&&a.ref===c.ref)return Wr(a,c,T)}return c.flags|=1,a=Ns(w,y),a.ref=c.ref,a.return=c,c.child=a}function ix(a,c,p,y,T){if(a!==null){var w=a.memoizedProps;if(Ta(w,y)&&a.ref===c.ref)if(cn=!1,c.pendingProps=y=w,(a.lanes&T)!==0)(a.flags&131072)!==0&&(cn=!0);else return c.lanes=a.lanes,Wr(a,c,T)}return kh(a,c,p,y,T)}function ox(a,c,p){var y=c.pendingProps,T=y.children,w=a!==null?a.memoizedState:null;if(y.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(po,In),In|=p;else{if((p&1073741824)===0)return a=w!==null?w.baseLanes|p:p,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,at(po,In),In|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=w!==null?w.baseLanes:p,at(po,In),In|=y}else w!==null?(y=w.baseLanes|p,c.memoizedState=null):y=p,at(po,In),In|=y;return en(a,c,T,p),c.child}function ax(a,c){var p=c.ref;(a===null&&p!==null||a!==null&&a.ref!==p)&&(c.flags|=512,c.flags|=2097152)}function kh(a,c,p,y,T){var w=ln(p)?ai:Ht.current;return w=ro(c,w),co(c,T),p=Sh(a,c,p,y,w,T),y=Th(),a!==null&&!cn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~T,Wr(a,c,T)):(dt&&y&&sh(c),c.flags|=1,en(a,c,p,T),c.child)}function lx(a,c,p,y,T){if(ln(p)){var w=!0;Ac(c)}else w=!1;if(co(c,T),c.stateNode===null)Hc(a,c),Xv(c,p,y),Rh(c,p,y,T),y=!0;else if(a===null){var L=c.stateNode,B=c.memoizedProps;L.props=B;var j=L.context,X=p.contextType;typeof X=="object"&&X!==null?X=jn(X):(X=ln(p)?ai:Ht.current,X=ro(c,X));var ae=p.getDerivedStateFromProps,le=typeof ae=="function"||typeof L.getSnapshotBeforeUpdate=="function";le||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(B!==y||j!==X)&&Qv(c,L,y,X),_s=!1;var oe=c.memoizedState;L.state=oe,Oc(c,y,L,T),j=c.memoizedState,B!==y||oe!==j||an.current||_s?(typeof ae=="function"&&(_h(c,p,ae,y),j=c.memoizedState),(B=_s||qv(c,p,B,y,oe,j,X))?(le||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(c.flags|=4194308)):(typeof L.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=j),L.props=y,L.state=j,L.context=X,y=B):(typeof L.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{L=c.stateNode,wv(a,c),B=c.memoizedProps,X=c.type===c.elementType?B:er(c.type,B),L.props=X,le=c.pendingProps,oe=L.context,j=p.contextType,typeof j=="object"&&j!==null?j=jn(j):(j=ln(p)?ai:Ht.current,j=ro(c,j));var me=p.getDerivedStateFromProps;(ae=typeof me=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(B!==le||oe!==j)&&Qv(c,L,y,j),_s=!1,oe=c.memoizedState,L.state=oe,Oc(c,y,L,T);var Ee=c.memoizedState;B!==le||oe!==Ee||an.current||_s?(typeof me=="function"&&(_h(c,p,me,y),Ee=c.memoizedState),(X=_s||qv(c,p,X,y,oe,Ee,j)||!1)?(ae||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(y,Ee,j),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(y,Ee,j)),typeof L.componentDidUpdate=="function"&&(c.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof L.componentDidUpdate!="function"||B===a.memoizedProps&&oe===a.memoizedState||(c.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||B===a.memoizedProps&&oe===a.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=Ee),L.props=y,L.state=Ee,L.context=j,y=X):(typeof L.componentDidUpdate!="function"||B===a.memoizedProps&&oe===a.memoizedState||(c.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||B===a.memoizedProps&&oe===a.memoizedState||(c.flags|=1024),y=!1)}return Ph(a,c,p,y,w,T)}function Ph(a,c,p,y,T,w){ax(a,c);var L=(c.flags&128)!==0;if(!y&&!L)return T&&hv(c,p,!1),Wr(a,c,w);y=c.stateNode,hC.current=c;var B=L&&typeof p.getDerivedStateFromError!="function"?null:y.render();return c.flags|=1,a!==null&&L?(c.child=ao(c,a.child,null,w),c.child=ao(c,null,B,w)):en(a,c,B,w),c.memoizedState=y.state,T&&hv(c,p,!0),c.child}function cx(a){var c=a.stateNode;c.pendingContext?dv(a,c.pendingContext,c.pendingContext!==c.context):c.context&&dv(a,c.context,!1),mh(a,c.containerInfo)}function ux(a,c,p,y,T){return oo(),lh(T),c.flags|=256,en(a,c,p,y),c.child}var Dh={dehydrated:null,treeContext:null,retryLane:0};function Nh(a){return{baseLanes:a,cachePool:null,transitions:null}}function dx(a,c,p){var y=c.pendingProps,T=ht.current,w=!1,L=(c.flags&128)!==0,B;if((B=L)||(B=a!==null&&a.memoizedState===null?!1:(T&2)!==0),B?(w=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(T|=1),at(ht,T&1),a===null)return ah(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(L=y.children,a=y.fallback,w?(y=c.mode,w=c.child,L={mode:"hidden",children:L},(y&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=L):w=nu(L,y,0,null),a=yi(a,y,p,null),w.return=c,a.return=c,w.sibling=a,c.child=w,c.child.memoizedState=Nh(p),c.memoizedState=Dh,a):Oh(c,L));if(T=a.memoizedState,T!==null&&(B=T.dehydrated,B!==null))return pC(a,c,L,y,B,T,p);if(w){w=y.fallback,L=c.mode,T=a.child,B=T.sibling;var j={mode:"hidden",children:y.children};return(L&1)===0&&c.child!==T?(y=c.child,y.childLanes=0,y.pendingProps=j,c.deletions=null):(y=Ns(T,j),y.subtreeFlags=T.subtreeFlags&14680064),B!==null?w=Ns(B,w):(w=yi(w,L,p,null),w.flags|=2),w.return=c,y.return=c,y.sibling=w,c.child=y,y=w,w=c.child,L=a.child.memoizedState,L=L===null?Nh(p):{baseLanes:L.baseLanes|p,cachePool:null,transitions:L.transitions},w.memoizedState=L,w.childLanes=a.childLanes&~p,c.memoizedState=Dh,y}return w=a.child,a=w.sibling,y=Ns(w,{mode:"visible",children:y.children}),(c.mode&1)===0&&(y.lanes=p),y.return=c,y.sibling=null,a!==null&&(p=c.deletions,p===null?(c.deletions=[a],c.flags|=16):p.push(a)),c.child=y,c.memoizedState=null,y}function Oh(a,c){return c=nu({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function Gc(a,c,p,y){return y!==null&&lh(y),ao(c,a.child,null,p),a=Oh(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function pC(a,c,p,y,T,w,L){if(p)return c.flags&256?(c.flags&=-257,y=Lh(Error(t(422))),Gc(a,c,L,y)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(w=y.fallback,T=c.mode,y=nu({mode:"visible",children:y.children},T,0,null),w=yi(w,T,L,null),w.flags|=2,y.return=c,w.return=c,y.sibling=w,c.child=y,(c.mode&1)!==0&&ao(c,a.child,null,L),c.child.memoizedState=Nh(L),c.memoizedState=Dh,w);if((c.mode&1)===0)return Gc(a,c,L,null);if(T.data==="$!"){if(y=T.nextSibling&&T.nextSibling.dataset,y)var B=y.dgst;return y=B,w=Error(t(419)),y=Lh(w,y,void 0),Gc(a,c,L,y)}if(B=(L&a.childLanes)!==0,cn||B){if(y=Ot,y!==null){switch(L&-L){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(y.suspendedLanes|L))!==0?0:T,T!==0&&T!==w.retryLane&&(w.retryLane=T,Hr(a,T),rr(y,a,T,-1))}return Qh(),y=Lh(Error(t(421))),Gc(a,c,L,y)}return T.data==="$?"?(c.flags|=128,c.child=a.child,c=_C.bind(null,a),T._reactRetry=c,null):(a=w.treeContext,wn=bs(T.nextSibling),bn=c,dt=!0,Zn=null,a!==null&&(Un[$n++]=Vr,Un[$n++]=Gr,Un[$n++]=li,Vr=a.id,Gr=a.overflow,li=c),c=Oh(c,y.children),c.flags|=4096,c)}function fx(a,c,p){a.lanes|=c;var y=a.alternate;y!==null&&(y.lanes|=c),fh(a.return,c,p)}function Mh(a,c,p,y,T){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:T}:(w.isBackwards=c,w.rendering=null,w.renderingStartTime=0,w.last=y,w.tail=p,w.tailMode=T)}function hx(a,c,p){var y=c.pendingProps,T=y.revealOrder,w=y.tail;if(en(a,c,y.children,p),y=ht.current,(y&2)!==0)y=y&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&fx(a,p,c);else if(a.tag===19)fx(a,p,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}y&=1}if(at(ht,y),(c.mode&1)===0)c.memoizedState=null;else switch(T){case"forwards":for(p=c.child,T=null;p!==null;)a=p.alternate,a!==null&&Mc(a)===null&&(T=p),p=p.sibling;p=T,p===null?(T=c.child,c.child=null):(T=p.sibling,p.sibling=null),Mh(c,!1,T,p,w);break;case"backwards":for(p=null,T=c.child,c.child=null;T!==null;){if(a=T.alternate,a!==null&&Mc(a)===null){c.child=T;break}a=T.sibling,T.sibling=p,p=T,T=a}Mh(c,!0,p,null,w);break;case"together":Mh(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Hc(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function Wr(a,c,p){if(a!==null&&(c.dependencies=a.dependencies),hi|=c.lanes,(p&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,p=Ns(a,a.pendingProps),c.child=p,p.return=c;a.sibling!==null;)a=a.sibling,p=p.sibling=Ns(a,a.pendingProps),p.return=c;p.sibling=null}return c.child}function mC(a,c,p){switch(c.tag){case 3:cx(c),oo();break;case 5:_v(c);break;case 1:ln(c.type)&&Ac(c);break;case 4:mh(c,c.stateNode.containerInfo);break;case 10:var y=c.type._context,T=c.memoizedProps.value;at(Pc,y._currentValue),y._currentValue=T;break;case 13:if(y=c.memoizedState,y!==null)return y.dehydrated!==null?(at(ht,ht.current&1),c.flags|=128,null):(p&c.child.childLanes)!==0?dx(a,c,p):(at(ht,ht.current&1),a=Wr(a,c,p),a!==null?a.sibling:null);at(ht,ht.current&1);break;case 19:if(y=(p&c.childLanes)!==0,(a.flags&128)!==0){if(y)return hx(a,c,p);c.flags|=128}if(T=c.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),at(ht,ht.current),y)break;return null;case 22:case 23:return c.lanes=0,ox(a,c,p)}return Wr(a,c,p)}var px,Fh,mx,gx;px=function(a,c){for(var p=c.child;p!==null;){if(p.tag===5||p.tag===6)a.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===c)break;for(;p.sibling===null;){if(p.return===null||p.return===c)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Fh=function(){},mx=function(a,c,p,y){var T=a.memoizedProps;if(T!==y){a=c.stateNode,di(vr.current);var w=null;switch(p){case"input":T=_e(a,T),y=_e(a,y),w=[];break;case"select":T=ee({},T,{value:void 0}),y=ee({},y,{value:void 0}),w=[];break;case"textarea":T=Dt(a,T),y=Dt(a,y),w=[];break;default:typeof T.onClick!="function"&&typeof y.onClick=="function"&&(a.onclick=bc)}ea(p,y);var L;p=null;for(X in T)if(!y.hasOwnProperty(X)&&T.hasOwnProperty(X)&&T[X]!=null)if(X==="style"){var B=T[X];for(L in B)B.hasOwnProperty(L)&&(p||(p={}),p[L]="")}else X!=="dangerouslySetInnerHTML"&&X!=="children"&&X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&X!=="autoFocus"&&(s.hasOwnProperty(X)?w||(w=[]):(w=w||[]).push(X,null));for(X in y){var j=y[X];if(B=T?.[X],y.hasOwnProperty(X)&&j!==B&&(j!=null||B!=null))if(X==="style")if(B){for(L in B)!B.hasOwnProperty(L)||j&&j.hasOwnProperty(L)||(p||(p={}),p[L]="");for(L in j)j.hasOwnProperty(L)&&B[L]!==j[L]&&(p||(p={}),p[L]=j[L])}else p||(w||(w=[]),w.push(X,p)),p=j;else X==="dangerouslySetInnerHTML"?(j=j?j.__html:void 0,B=B?B.__html:void 0,j!=null&&B!==j&&(w=w||[]).push(X,j)):X==="children"?typeof j!="string"&&typeof j!="number"||(w=w||[]).push(X,""+j):X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&(s.hasOwnProperty(X)?(j!=null&&X==="onScroll"&&ct("scroll",a),w||B===j||(w=[])):(w=w||[]).push(X,j))}p&&(w=w||[]).push("style",p);var X=w;(c.updateQueue=X)&&(c.flags|=4)}},gx=function(a,c,p,y){p!==y&&(c.flags|=4)};function Fa(a,c){if(!dt)switch(a.tailMode){case"hidden":c=a.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?a.tail=null:p.sibling=null;break;case"collapsed":p=a.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:y.sibling=null}}function Wt(a){var c=a.alternate!==null&&a.alternate.child===a.child,p=0,y=0;if(c)for(var T=a.child;T!==null;)p|=T.lanes|T.childLanes,y|=T.subtreeFlags&14680064,y|=T.flags&14680064,T.return=a,T=T.sibling;else for(T=a.child;T!==null;)p|=T.lanes|T.childLanes,y|=T.subtreeFlags,y|=T.flags,T.return=a,T=T.sibling;return a.subtreeFlags|=y,a.childLanes=p,c}function gC(a,c,p){var y=c.pendingProps;switch(ih(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(c),null;case 1:return ln(c.type)&&Ic(),Wt(c),null;case 3:return y=c.stateNode,uo(),ut(an),ut(Ht),vh(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(a===null||a.child===null)&&(Cc(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Zn!==null&&(Yh(Zn),Zn=null))),Fh(a,c),Wt(c),null;case 5:gh(c);var T=di(Pa.current);if(p=c.type,a!==null&&c.stateNode!=null)mx(a,c,p,y,T),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!y){if(c.stateNode===null)throw Error(t(166));return Wt(c),null}if(a=di(vr.current),Cc(c)){y=c.stateNode,p=c.type;var w=c.memoizedProps;switch(y[yr]=c,y[_a]=w,a=(c.mode&1)!==0,p){case"dialog":ct("cancel",y),ct("close",y);break;case"iframe":case"object":case"embed":ct("load",y);break;case"video":case"audio":for(T=0;T<wa.length;T++)ct(wa[T],y);break;case"source":ct("error",y);break;case"img":case"image":case"link":ct("error",y),ct("load",y);break;case"details":ct("toggle",y);break;case"input":je(y,w),ct("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!w.multiple},ct("invalid",y);break;case"textarea":Bn(y,w),ct("invalid",y)}ea(p,w),T=null;for(var L in w)if(w.hasOwnProperty(L)){var B=w[L];L==="children"?typeof B=="string"?y.textContent!==B&&(w.suppressHydrationWarning!==!0&&Tc(y.textContent,B,a),T=["children",B]):typeof B=="number"&&y.textContent!==""+B&&(w.suppressHydrationWarning!==!0&&Tc(y.textContent,B,a),T=["children",""+B]):s.hasOwnProperty(L)&&B!=null&&L==="onScroll"&&ct("scroll",y)}switch(p){case"input":De(y),Xe(y,w,!0);break;case"textarea":De(y),St(y);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(y.onclick=bc)}y=T,c.updateQueue=y,y!==null&&(c.flags|=4)}else{L=T.nodeType===9?T:T.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=At(p)),a==="http://www.w3.org/1999/xhtml"?p==="script"?(a=L.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof y.is=="string"?a=L.createElement(p,{is:y.is}):(a=L.createElement(p),p==="select"&&(L=a,y.multiple?L.multiple=!0:y.size&&(L.size=y.size))):a=L.createElementNS(a,p),a[yr]=c,a[_a]=y,px(a,c,!1,!1),c.stateNode=a;e:{switch(L=ta(p,y),p){case"dialog":ct("cancel",a),ct("close",a),T=y;break;case"iframe":case"object":case"embed":ct("load",a),T=y;break;case"video":case"audio":for(T=0;T<wa.length;T++)ct(wa[T],a);T=y;break;case"source":ct("error",a),T=y;break;case"img":case"image":case"link":ct("error",a),ct("load",a),T=y;break;case"details":ct("toggle",a),T=y;break;case"input":je(a,y),T=_e(a,y),ct("invalid",a);break;case"option":T=y;break;case"select":a._wrapperState={wasMultiple:!!y.multiple},T=ee({},y,{value:void 0}),ct("invalid",a);break;case"textarea":Bn(a,y),T=Dt(a,y),ct("invalid",a);break;default:T=y}ea(p,T),B=T;for(w in B)if(B.hasOwnProperty(w)){var j=B[w];w==="style"?Zl(a,j):w==="dangerouslySetInnerHTML"?(j=j?j.__html:void 0,j!=null&&Sn(a,j)):w==="children"?typeof j=="string"?(p!=="textarea"||j!=="")&&Jt(a,j):typeof j=="number"&&Jt(a,""+j):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(s.hasOwnProperty(w)?j!=null&&w==="onScroll"&&ct("scroll",a):j!=null&&A(a,w,j,L))}switch(p){case"input":De(a),Xe(a,y,!1);break;case"textarea":De(a),St(a);break;case"option":y.value!=null&&a.setAttribute("value",""+ye(y.value));break;case"select":a.multiple=!!y.multiple,w=y.value,w!=null?Je(a,!!y.multiple,w,!1):y.defaultValue!=null&&Je(a,!!y.multiple,y.defaultValue,!0);break;default:typeof T.onClick=="function"&&(a.onclick=bc)}switch(p){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Wt(c),null;case 6:if(a&&c.stateNode!=null)gx(a,c,a.memoizedProps,y);else{if(typeof y!="string"&&c.stateNode===null)throw Error(t(166));if(p=di(Pa.current),di(vr.current),Cc(c)){if(y=c.stateNode,p=c.memoizedProps,y[yr]=c,(w=y.nodeValue!==p)&&(a=bn,a!==null))switch(a.tag){case 3:Tc(y.nodeValue,p,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Tc(y.nodeValue,p,(a.mode&1)!==0)}w&&(c.flags|=4)}else y=(p.nodeType===9?p:p.ownerDocument).createTextNode(y),y[yr]=c,c.stateNode=y}return Wt(c),null;case 13:if(ut(ht),y=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(dt&&wn!==null&&(c.mode&1)!==0&&(c.flags&128)===0)xv(),oo(),c.flags|=98560,w=!1;else if(w=Cc(c),y!==null&&y.dehydrated!==null){if(a===null){if(!w)throw Error(t(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[yr]=c}else oo(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Wt(c),w=!1}else Zn!==null&&(Yh(Zn),Zn=null),w=!0;if(!w)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=p,c):(y=y!==null,y!==(a!==null&&a.memoizedState!==null)&&y&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(ht.current&1)!==0?Ct===0&&(Ct=3):Qh())),c.updateQueue!==null&&(c.flags|=4),Wt(c),null);case 4:return uo(),Fh(a,c),a===null&&Ia(c.stateNode.containerInfo),Wt(c),null;case 10:return dh(c.type._context),Wt(c),null;case 17:return ln(c.type)&&Ic(),Wt(c),null;case 19:if(ut(ht),w=c.memoizedState,w===null)return Wt(c),null;if(y=(c.flags&128)!==0,L=w.rendering,L===null)if(y)Fa(w,!1);else{if(Ct!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(L=Mc(a),L!==null){for(c.flags|=128,Fa(w,!1),y=L.updateQueue,y!==null&&(c.updateQueue=y,c.flags|=4),c.subtreeFlags=0,y=p,p=c.child;p!==null;)w=p,a=y,w.flags&=14680066,L=w.alternate,L===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=L.childLanes,w.lanes=L.lanes,w.child=L.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=L.memoizedProps,w.memoizedState=L.memoizedState,w.updateQueue=L.updateQueue,w.type=L.type,a=L.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),p=p.sibling;return at(ht,ht.current&1|2),c.child}a=a.sibling}w.tail!==null&&Tt()>mo&&(c.flags|=128,y=!0,Fa(w,!1),c.lanes=4194304)}else{if(!y)if(a=Mc(L),a!==null){if(c.flags|=128,y=!0,p=a.updateQueue,p!==null&&(c.updateQueue=p,c.flags|=4),Fa(w,!0),w.tail===null&&w.tailMode==="hidden"&&!L.alternate&&!dt)return Wt(c),null}else 2*Tt()-w.renderingStartTime>mo&&p!==1073741824&&(c.flags|=128,y=!0,Fa(w,!1),c.lanes=4194304);w.isBackwards?(L.sibling=c.child,c.child=L):(p=w.last,p!==null?p.sibling=L:c.child=L,w.last=L)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=Tt(),c.sibling=null,p=ht.current,at(ht,y?p&1|2:p&1),c):(Wt(c),null);case 22:case 23:return Xh(),y=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==y&&(c.flags|=8192),y&&(c.mode&1)!==0?(In&1073741824)!==0&&(Wt(c),c.subtreeFlags&6&&(c.flags|=8192)):Wt(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function yC(a,c){switch(ih(c),c.tag){case 1:return ln(c.type)&&Ic(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return uo(),ut(an),ut(Ht),vh(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return gh(c),null;case 13:if(ut(ht),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));oo()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return ut(ht),null;case 4:return uo(),null;case 10:return dh(c.type._context),null;case 22:case 23:return Xh(),null;case 24:return null;default:return null}}var Kc=!1,zt=!1,vC=typeof WeakSet=="function"?WeakSet:Set,ve=null;function ho(a,c){var p=a.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(y){xt(a,c,y)}else p.current=null}function Bh(a,c,p){try{p()}catch(y){xt(a,c,y)}}var yx=!1;function xC(a,c){if(Xf=dc,a=qy(),Vf(a)){if("selectionStart"in a)var p={start:a.selectionStart,end:a.selectionEnd};else e:{p=(p=a.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var T=y.anchorOffset,w=y.focusNode;y=y.focusOffset;try{p.nodeType,w.nodeType}catch{p=null;break e}var L=0,B=-1,j=-1,X=0,ae=0,le=a,oe=null;t:for(;;){for(var me;le!==p||T!==0&&le.nodeType!==3||(B=L+T),le!==w||y!==0&&le.nodeType!==3||(j=L+y),le.nodeType===3&&(L+=le.nodeValue.length),(me=le.firstChild)!==null;)oe=le,le=me;for(;;){if(le===a)break t;if(oe===p&&++X===T&&(B=L),oe===w&&++ae===y&&(j=L),(me=le.nextSibling)!==null)break;le=oe,oe=le.parentNode}le=me}p=B===-1||j===-1?null:{start:B,end:j}}else p=null}p=p||{start:0,end:0}}else p=null;for(Qf={focusedElem:a,selectionRange:p},dc=!1,ve=c;ve!==null;)if(c=ve,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,ve=a;else for(;ve!==null;){c=ve;try{var Ee=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Ee!==null){var be=Ee.memoizedProps,bt=Ee.memoizedState,z=c.stateNode,V=z.getSnapshotBeforeUpdate(c.elementType===c.type?be:er(c.type,be),bt);z.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var Y=c.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(de){xt(c,c.return,de)}if(a=c.sibling,a!==null){a.return=c.return,ve=a;break}ve=c.return}return Ee=yx,yx=!1,Ee}function Ba(a,c,p){var y=c.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var T=y=y.next;do{if((T.tag&a)===a){var w=T.destroy;T.destroy=void 0,w!==void 0&&Bh(c,p,w)}T=T.next}while(T!==y)}}function Wc(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var p=c=c.next;do{if((p.tag&a)===a){var y=p.create;p.destroy=y()}p=p.next}while(p!==c)}}function Uh(a){var c=a.ref;if(c!==null){var p=a.stateNode;switch(a.tag){case 5:a=p;break;default:a=p}typeof c=="function"?c(a):c.current=a}}function vx(a){var c=a.alternate;c!==null&&(a.alternate=null,vx(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[yr],delete c[_a],delete c[th],delete c[tC],delete c[nC])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function xx(a){return a.tag===5||a.tag===3||a.tag===4}function Ex(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||xx(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function $h(a,c,p){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?p.nodeType===8?p.parentNode.insertBefore(a,c):p.insertBefore(a,c):(p.nodeType===8?(c=p.parentNode,c.insertBefore(a,p)):(c=p,c.appendChild(a)),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=bc));else if(y!==4&&(a=a.child,a!==null))for($h(a,c,p),a=a.sibling;a!==null;)$h(a,c,p),a=a.sibling}function jh(a,c,p){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?p.insertBefore(a,c):p.appendChild(a);else if(y!==4&&(a=a.child,a!==null))for(jh(a,c,p),a=a.sibling;a!==null;)jh(a,c,p),a=a.sibling}var Bt=null,tr=!1;function Ls(a,c,p){for(p=p.child;p!==null;)Sx(a,c,p),p=p.sibling}function Sx(a,c,p){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(ic,p)}catch{}switch(p.tag){case 5:zt||ho(p,c);case 6:var y=Bt,T=tr;Bt=null,Ls(a,c,p),Bt=y,tr=T,Bt!==null&&(tr?(a=Bt,p=p.stateNode,a.nodeType===8?a.parentNode.removeChild(p):a.removeChild(p)):Bt.removeChild(p.stateNode));break;case 18:Bt!==null&&(tr?(a=Bt,p=p.stateNode,a.nodeType===8?eh(a.parentNode,p):a.nodeType===1&&eh(a,p),ga(a)):eh(Bt,p.stateNode));break;case 4:y=Bt,T=tr,Bt=p.stateNode.containerInfo,tr=!0,Ls(a,c,p),Bt=y,tr=T;break;case 0:case 11:case 14:case 15:if(!zt&&(y=p.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){T=y=y.next;do{var w=T,L=w.destroy;w=w.tag,L!==void 0&&((w&2)!==0||(w&4)!==0)&&Bh(p,c,L),T=T.next}while(T!==y)}Ls(a,c,p);break;case 1:if(!zt&&(ho(p,c),y=p.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=p.memoizedProps,y.state=p.memoizedState,y.componentWillUnmount()}catch(B){xt(p,c,B)}Ls(a,c,p);break;case 21:Ls(a,c,p);break;case 22:p.mode&1?(zt=(y=zt)||p.memoizedState!==null,Ls(a,c,p),zt=y):Ls(a,c,p);break;default:Ls(a,c,p)}}function Tx(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var p=a.stateNode;p===null&&(p=a.stateNode=new vC),c.forEach(function(y){var T=RC.bind(null,a,y);p.has(y)||(p.add(y),y.then(T,T))})}}function nr(a,c){var p=c.deletions;if(p!==null)for(var y=0;y<p.length;y++){var T=p[y];try{var w=a,L=c,B=L;e:for(;B!==null;){switch(B.tag){case 5:Bt=B.stateNode,tr=!1;break e;case 3:Bt=B.stateNode.containerInfo,tr=!0;break e;case 4:Bt=B.stateNode.containerInfo,tr=!0;break e}B=B.return}if(Bt===null)throw Error(t(160));Sx(w,L,T),Bt=null,tr=!1;var j=T.alternate;j!==null&&(j.return=null),T.return=null}catch(X){xt(T,c,X)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)bx(c,a),c=c.sibling}function bx(a,c){var p=a.alternate,y=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(nr(c,a),Er(a),y&4){try{Ba(3,a,a.return),Wc(3,a)}catch(be){xt(a,a.return,be)}try{Ba(5,a,a.return)}catch(be){xt(a,a.return,be)}}break;case 1:nr(c,a),Er(a),y&512&&p!==null&&ho(p,p.return);break;case 5:if(nr(c,a),Er(a),y&512&&p!==null&&ho(p,p.return),a.flags&32){var T=a.stateNode;try{Jt(T,"")}catch(be){xt(a,a.return,be)}}if(y&4&&(T=a.stateNode,T!=null)){var w=a.memoizedProps,L=p!==null?p.memoizedProps:w,B=a.type,j=a.updateQueue;if(a.updateQueue=null,j!==null)try{B==="input"&&w.type==="radio"&&w.name!=null&&pe(T,w),ta(B,L);var X=ta(B,w);for(L=0;L<j.length;L+=2){var ae=j[L],le=j[L+1];ae==="style"?Zl(T,le):ae==="dangerouslySetInnerHTML"?Sn(T,le):ae==="children"?Jt(T,le):A(T,ae,le,X)}switch(B){case"input":Fe(T,w);break;case"textarea":xn(T,w);break;case"select":var oe=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!w.multiple;var me=w.value;me!=null?Je(T,!!w.multiple,me,!1):oe!==!!w.multiple&&(w.defaultValue!=null?Je(T,!!w.multiple,w.defaultValue,!0):Je(T,!!w.multiple,w.multiple?[]:"",!1))}T[_a]=w}catch(be){xt(a,a.return,be)}}break;case 6:if(nr(c,a),Er(a),y&4){if(a.stateNode===null)throw Error(t(162));T=a.stateNode,w=a.memoizedProps;try{T.nodeValue=w}catch(be){xt(a,a.return,be)}}break;case 3:if(nr(c,a),Er(a),y&4&&p!==null&&p.memoizedState.isDehydrated)try{ga(c.containerInfo)}catch(be){xt(a,a.return,be)}break;case 4:nr(c,a),Er(a);break;case 13:nr(c,a),Er(a),T=a.child,T.flags&8192&&(w=T.memoizedState!==null,T.stateNode.isHidden=w,!w||T.alternate!==null&&T.alternate.memoizedState!==null||(Hh=Tt())),y&4&&Tx(a);break;case 22:if(ae=p!==null&&p.memoizedState!==null,a.mode&1?(zt=(X=zt)||ae,nr(c,a),zt=X):nr(c,a),Er(a),y&8192){if(X=a.memoizedState!==null,(a.stateNode.isHidden=X)&&!ae&&(a.mode&1)!==0)for(ve=a,ae=a.child;ae!==null;){for(le=ve=ae;ve!==null;){switch(oe=ve,me=oe.child,oe.tag){case 0:case 11:case 14:case 15:Ba(4,oe,oe.return);break;case 1:ho(oe,oe.return);var Ee=oe.stateNode;if(typeof Ee.componentWillUnmount=="function"){y=oe,p=oe.return;try{c=y,Ee.props=c.memoizedProps,Ee.state=c.memoizedState,Ee.componentWillUnmount()}catch(be){xt(y,p,be)}}break;case 5:ho(oe,oe.return);break;case 22:if(oe.memoizedState!==null){Ax(le);continue}}me!==null?(me.return=oe,ve=me):Ax(le)}ae=ae.sibling}e:for(ae=null,le=a;;){if(le.tag===5){if(ae===null){ae=le;try{T=le.stateNode,X?(w=T.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(B=le.stateNode,j=le.memoizedProps.style,L=j!=null&&j.hasOwnProperty("display")?j.display:null,B.style.display=si("display",L))}catch(be){xt(a,a.return,be)}}}else if(le.tag===6){if(ae===null)try{le.stateNode.nodeValue=X?"":le.memoizedProps}catch(be){xt(a,a.return,be)}}else if((le.tag!==22&&le.tag!==23||le.memoizedState===null||le===a)&&le.child!==null){le.child.return=le,le=le.child;continue}if(le===a)break e;for(;le.sibling===null;){if(le.return===null||le.return===a)break e;ae===le&&(ae=null),le=le.return}ae===le&&(ae=null),le.sibling.return=le.return,le=le.sibling}}break;case 19:nr(c,a),Er(a),y&4&&Tx(a);break;case 21:break;default:nr(c,a),Er(a)}}function Er(a){var c=a.flags;if(c&2){try{e:{for(var p=a.return;p!==null;){if(xx(p)){var y=p;break e}p=p.return}throw Error(t(160))}switch(y.tag){case 5:var T=y.stateNode;y.flags&32&&(Jt(T,""),y.flags&=-33);var w=Ex(a);jh(a,w,T);break;case 3:case 4:var L=y.stateNode.containerInfo,B=Ex(a);$h(a,B,L);break;default:throw Error(t(161))}}catch(j){xt(a,a.return,j)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function EC(a,c,p){ve=a,wx(a)}function wx(a,c,p){for(var y=(a.mode&1)!==0;ve!==null;){var T=ve,w=T.child;if(T.tag===22&&y){var L=T.memoizedState!==null||Kc;if(!L){var B=T.alternate,j=B!==null&&B.memoizedState!==null||zt;B=Kc;var X=zt;if(Kc=L,(zt=j)&&!X)for(ve=T;ve!==null;)L=ve,j=L.child,L.tag===22&&L.memoizedState!==null?_x(T):j!==null?(j.return=L,ve=j):_x(T);for(;w!==null;)ve=w,wx(w),w=w.sibling;ve=T,Kc=B,zt=X}Ix(a)}else(T.subtreeFlags&8772)!==0&&w!==null?(w.return=T,ve=w):Ix(a)}}function Ix(a){for(;ve!==null;){var c=ve;if((c.flags&8772)!==0){var p=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:zt||Wc(5,c);break;case 1:var y=c.stateNode;if(c.flags&4&&!zt)if(p===null)y.componentDidMount();else{var T=c.elementType===c.type?p.memoizedProps:er(c.type,p.memoizedProps);y.componentDidUpdate(T,p.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var w=c.updateQueue;w!==null&&Av(c,w,y);break;case 3:var L=c.updateQueue;if(L!==null){if(p=null,c.child!==null)switch(c.child.tag){case 5:p=c.child.stateNode;break;case 1:p=c.child.stateNode}Av(c,L,p)}break;case 5:var B=c.stateNode;if(p===null&&c.flags&4){p=B;var j=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":j.autoFocus&&p.focus();break;case"img":j.src&&(p.src=j.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var X=c.alternate;if(X!==null){var ae=X.memoizedState;if(ae!==null){var le=ae.dehydrated;le!==null&&ga(le)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}zt||c.flags&512&&Uh(c)}catch(oe){xt(c,c.return,oe)}}if(c===a){ve=null;break}if(p=c.sibling,p!==null){p.return=c.return,ve=p;break}ve=c.return}}function Ax(a){for(;ve!==null;){var c=ve;if(c===a){ve=null;break}var p=c.sibling;if(p!==null){p.return=c.return,ve=p;break}ve=c.return}}function _x(a){for(;ve!==null;){var c=ve;try{switch(c.tag){case 0:case 11:case 15:var p=c.return;try{Wc(4,c)}catch(j){xt(c,p,j)}break;case 1:var y=c.stateNode;if(typeof y.componentDidMount=="function"){var T=c.return;try{y.componentDidMount()}catch(j){xt(c,T,j)}}var w=c.return;try{Uh(c)}catch(j){xt(c,w,j)}break;case 5:var L=c.return;try{Uh(c)}catch(j){xt(c,L,j)}}}catch(j){xt(c,c.return,j)}if(c===a){ve=null;break}var B=c.sibling;if(B!==null){B.return=c.return,ve=B;break}ve=c.return}}var SC=Math.ceil,zc=R.ReactCurrentDispatcher,Vh=R.ReactCurrentOwner,Gn=R.ReactCurrentBatchConfig,ze=0,Ot=null,_t=null,Ut=0,In=0,po=ws(0),Ct=0,Ua=null,hi=0,Yc=0,Gh=0,$a=null,un=null,Hh=0,mo=1/0,zr=null,qc=!1,Kh=null,Cs=null,Xc=!1,ks=null,Qc=0,ja=0,Wh=null,Jc=-1,Zc=0;function tn(){return(ze&6)!==0?Tt():Jc!==-1?Jc:Jc=Tt()}function Ps(a){return(a.mode&1)===0?1:(ze&2)!==0&&Ut!==0?Ut&-Ut:sC.transition!==null?(Zc===0&&(Zc=Ey()),Zc):(a=Ze,a!==0||(a=window.event,a=a===void 0?16:Ly(a.type)),a)}function rr(a,c,p,y){if(50<ja)throw ja=0,Wh=null,Error(t(185));da(a,p,y),((ze&2)===0||a!==Ot)&&(a===Ot&&((ze&2)===0&&(Yc|=p),Ct===4&&Ds(a,Ut)),dn(a,y),p===1&&ze===0&&(c.mode&1)===0&&(mo=Tt()+500,_c&&As()))}function dn(a,c){var p=a.callbackNode;sL(a,c);var y=lc(a,a===Ot?Ut:0);if(y===0)p!==null&&yy(p),a.callbackNode=null,a.callbackPriority=0;else if(c=y&-y,a.callbackPriority!==c){if(p!=null&&yy(p),c===1)a.tag===0?rC(Lx.bind(null,a)):pv(Lx.bind(null,a)),ZL(function(){(ze&6)===0&&As()}),p=null;else{switch(Sy(y)){case 1:p=If;break;case 4:p=vy;break;case 16:p=sc;break;case 536870912:p=xy;break;default:p=sc}p=Fx(p,Rx.bind(null,a))}a.callbackPriority=c,a.callbackNode=p}}function Rx(a,c){if(Jc=-1,Zc=0,(ze&6)!==0)throw Error(t(327));var p=a.callbackNode;if(go()&&a.callbackNode!==p)return null;var y=lc(a,a===Ot?Ut:0);if(y===0)return null;if((y&30)!==0||(y&a.expiredLanes)!==0||c)c=eu(a,y);else{c=y;var T=ze;ze|=2;var w=kx();(Ot!==a||Ut!==c)&&(zr=null,mo=Tt()+500,mi(a,c));do try{wC();break}catch(B){Cx(a,B)}while(!0);uh(),zc.current=w,ze=T,_t!==null?c=0:(Ot=null,Ut=0,c=Ct)}if(c!==0){if(c===2&&(T=Af(a),T!==0&&(y=T,c=zh(a,T))),c===1)throw p=Ua,mi(a,0),Ds(a,y),dn(a,Tt()),p;if(c===6)Ds(a,y);else{if(T=a.current.alternate,(y&30)===0&&!TC(T)&&(c=eu(a,y),c===2&&(w=Af(a),w!==0&&(y=w,c=zh(a,w))),c===1))throw p=Ua,mi(a,0),Ds(a,y),dn(a,Tt()),p;switch(a.finishedWork=T,a.finishedLanes=y,c){case 0:case 1:throw Error(t(345));case 2:gi(a,un,zr);break;case 3:if(Ds(a,y),(y&130023424)===y&&(c=Hh+500-Tt(),10<c)){if(lc(a,0)!==0)break;if(T=a.suspendedLanes,(T&y)!==y){tn(),a.pingedLanes|=a.suspendedLanes&T;break}a.timeoutHandle=Zf(gi.bind(null,a,un,zr),c);break}gi(a,un,zr);break;case 4:if(Ds(a,y),(y&4194240)===y)break;for(c=a.eventTimes,T=-1;0<y;){var L=31-Qn(y);w=1<<L,L=c[L],L>T&&(T=L),y&=~w}if(y=T,y=Tt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*SC(y/1960))-y,10<y){a.timeoutHandle=Zf(gi.bind(null,a,un,zr),y);break}gi(a,un,zr);break;case 5:gi(a,un,zr);break;default:throw Error(t(329))}}}return dn(a,Tt()),a.callbackNode===p?Rx.bind(null,a):null}function zh(a,c){var p=$a;return a.current.memoizedState.isDehydrated&&(mi(a,c).flags|=256),a=eu(a,c),a!==2&&(c=un,un=p,c!==null&&Yh(c)),a}function Yh(a){un===null?un=a:un.push.apply(un,a)}function TC(a){for(var c=a;;){if(c.flags&16384){var p=c.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var y=0;y<p.length;y++){var T=p[y],w=T.getSnapshot;T=T.value;try{if(!Jn(w(),T))return!1}catch{return!1}}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ds(a,c){for(c&=~Gh,c&=~Yc,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var p=31-Qn(c),y=1<<p;a[p]=-1,c&=~y}}function Lx(a){if((ze&6)!==0)throw Error(t(327));go();var c=lc(a,0);if((c&1)===0)return dn(a,Tt()),null;var p=eu(a,c);if(a.tag!==0&&p===2){var y=Af(a);y!==0&&(c=y,p=zh(a,y))}if(p===1)throw p=Ua,mi(a,0),Ds(a,c),dn(a,Tt()),p;if(p===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,gi(a,un,zr),dn(a,Tt()),null}function qh(a,c){var p=ze;ze|=1;try{return a(c)}finally{ze=p,ze===0&&(mo=Tt()+500,_c&&As())}}function pi(a){ks!==null&&ks.tag===0&&(ze&6)===0&&go();var c=ze;ze|=1;var p=Gn.transition,y=Ze;try{if(Gn.transition=null,Ze=1,a)return a()}finally{Ze=y,Gn.transition=p,ze=c,(ze&6)===0&&As()}}function Xh(){In=po.current,ut(po)}function mi(a,c){a.finishedWork=null,a.finishedLanes=0;var p=a.timeoutHandle;if(p!==-1&&(a.timeoutHandle=-1,JL(p)),_t!==null)for(p=_t.return;p!==null;){var y=p;switch(ih(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Ic();break;case 3:uo(),ut(an),ut(Ht),vh();break;case 5:gh(y);break;case 4:uo();break;case 13:ut(ht);break;case 19:ut(ht);break;case 10:dh(y.type._context);break;case 22:case 23:Xh()}p=p.return}if(Ot=a,_t=a=Ns(a.current,null),Ut=In=c,Ct=0,Ua=null,Gh=Yc=hi=0,un=$a=null,ui!==null){for(c=0;c<ui.length;c++)if(p=ui[c],y=p.interleaved,y!==null){p.interleaved=null;var T=y.next,w=p.pending;if(w!==null){var L=w.next;w.next=T,y.next=L}p.pending=y}ui=null}return a}function Cx(a,c){do{var p=_t;try{if(uh(),Fc.current=jc,Bc){for(var y=pt.memoizedState;y!==null;){var T=y.queue;T!==null&&(T.pending=null),y=y.next}Bc=!1}if(fi=0,Nt=Lt=pt=null,Da=!1,Na=0,Vh.current=null,p===null||p.return===null){Ct=1,Ua=c,_t=null;break}e:{var w=a,L=p.return,B=p,j=c;if(c=Ut,B.flags|=32768,j!==null&&typeof j=="object"&&typeof j.then=="function"){var X=j,ae=B,le=ae.tag;if((ae.mode&1)===0&&(le===0||le===11||le===15)){var oe=ae.alternate;oe?(ae.updateQueue=oe.updateQueue,ae.memoizedState=oe.memoizedState,ae.lanes=oe.lanes):(ae.updateQueue=null,ae.memoizedState=null)}var me=tx(L);if(me!==null){me.flags&=-257,nx(me,L,B,w,c),me.mode&1&&ex(w,X,c),c=me,j=X;var Ee=c.updateQueue;if(Ee===null){var be=new Set;be.add(j),c.updateQueue=be}else Ee.add(j);break e}else{if((c&1)===0){ex(w,X,c),Qh();break e}j=Error(t(426))}}else if(dt&&B.mode&1){var bt=tx(L);if(bt!==null){(bt.flags&65536)===0&&(bt.flags|=256),nx(bt,L,B,w,c),lh(fo(j,B));break e}}w=j=fo(j,B),Ct!==4&&(Ct=2),$a===null?$a=[w]:$a.push(w),w=L;do{switch(w.tag){case 3:w.flags|=65536,c&=-c,w.lanes|=c;var z=Jv(w,j,c);Iv(w,z);break e;case 1:B=j;var V=w.type,Y=w.stateNode;if((w.flags&128)===0&&(typeof V.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(Cs===null||!Cs.has(Y)))){w.flags|=65536,c&=-c,w.lanes|=c;var de=Zv(w,B,c);Iv(w,de);break e}}w=w.return}while(w!==null)}Dx(p)}catch(Ie){c=Ie,_t===p&&p!==null&&(_t=p=p.return);continue}break}while(!0)}function kx(){var a=zc.current;return zc.current=jc,a===null?jc:a}function Qh(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Ot===null||(hi&268435455)===0&&(Yc&268435455)===0||Ds(Ot,Ut)}function eu(a,c){var p=ze;ze|=2;var y=kx();(Ot!==a||Ut!==c)&&(zr=null,mi(a,c));do try{bC();break}catch(T){Cx(a,T)}while(!0);if(uh(),ze=p,zc.current=y,_t!==null)throw Error(t(261));return Ot=null,Ut=0,Ct}function bC(){for(;_t!==null;)Px(_t)}function wC(){for(;_t!==null&&!qR();)Px(_t)}function Px(a){var c=Mx(a.alternate,a,In);a.memoizedProps=a.pendingProps,c===null?Dx(a):_t=c,Vh.current=null}function Dx(a){var c=a;do{var p=c.alternate;if(a=c.return,(c.flags&32768)===0){if(p=gC(p,c,In),p!==null){_t=p;return}}else{if(p=yC(p,c),p!==null){p.flags&=32767,_t=p;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Ct=6,_t=null;return}}if(c=c.sibling,c!==null){_t=c;return}_t=c=a}while(c!==null);Ct===0&&(Ct=5)}function gi(a,c,p){var y=Ze,T=Gn.transition;try{Gn.transition=null,Ze=1,IC(a,c,p,y)}finally{Gn.transition=T,Ze=y}return null}function IC(a,c,p,y){do go();while(ks!==null);if((ze&6)!==0)throw Error(t(327));p=a.finishedWork;var T=a.finishedLanes;if(p===null)return null;if(a.finishedWork=null,a.finishedLanes=0,p===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var w=p.lanes|p.childLanes;if(iL(a,w),a===Ot&&(_t=Ot=null,Ut=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Xc||(Xc=!0,Fx(sc,function(){return go(),null})),w=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||w){w=Gn.transition,Gn.transition=null;var L=Ze;Ze=1;var B=ze;ze|=4,Vh.current=null,xC(a,p),bx(p,a),KL(Qf),dc=!!Xf,Qf=Xf=null,a.current=p,EC(p),XR(),ze=B,Ze=L,Gn.transition=w}else a.current=p;if(Xc&&(Xc=!1,ks=a,Qc=T),w=a.pendingLanes,w===0&&(Cs=null),ZR(p.stateNode),dn(a,Tt()),c!==null)for(y=a.onRecoverableError,p=0;p<c.length;p++)T=c[p],y(T.value,{componentStack:T.stack,digest:T.digest});if(qc)throw qc=!1,a=Kh,Kh=null,a;return(Qc&1)!==0&&a.tag!==0&&go(),w=a.pendingLanes,(w&1)!==0?a===Wh?ja++:(ja=0,Wh=a):ja=0,As(),null}function go(){if(ks!==null){var a=Sy(Qc),c=Gn.transition,p=Ze;try{if(Gn.transition=null,Ze=16>a?16:a,ks===null)var y=!1;else{if(a=ks,ks=null,Qc=0,(ze&6)!==0)throw Error(t(331));var T=ze;for(ze|=4,ve=a.current;ve!==null;){var w=ve,L=w.child;if((ve.flags&16)!==0){var B=w.deletions;if(B!==null){for(var j=0;j<B.length;j++){var X=B[j];for(ve=X;ve!==null;){var ae=ve;switch(ae.tag){case 0:case 11:case 15:Ba(8,ae,w)}var le=ae.child;if(le!==null)le.return=ae,ve=le;else for(;ve!==null;){ae=ve;var oe=ae.sibling,me=ae.return;if(vx(ae),ae===X){ve=null;break}if(oe!==null){oe.return=me,ve=oe;break}ve=me}}}var Ee=w.alternate;if(Ee!==null){var be=Ee.child;if(be!==null){Ee.child=null;do{var bt=be.sibling;be.sibling=null,be=bt}while(be!==null)}}ve=w}}if((w.subtreeFlags&2064)!==0&&L!==null)L.return=w,ve=L;else e:for(;ve!==null;){if(w=ve,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:Ba(9,w,w.return)}var z=w.sibling;if(z!==null){z.return=w.return,ve=z;break e}ve=w.return}}var V=a.current;for(ve=V;ve!==null;){L=ve;var Y=L.child;if((L.subtreeFlags&2064)!==0&&Y!==null)Y.return=L,ve=Y;else e:for(L=V;ve!==null;){if(B=ve,(B.flags&2048)!==0)try{switch(B.tag){case 0:case 11:case 15:Wc(9,B)}}catch(Ie){xt(B,B.return,Ie)}if(B===L){ve=null;break e}var de=B.sibling;if(de!==null){de.return=B.return,ve=de;break e}ve=B.return}}if(ze=T,As(),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(ic,a)}catch{}y=!0}return y}finally{Ze=p,Gn.transition=c}}return!1}function Nx(a,c,p){c=fo(p,c),c=Jv(a,c,1),a=Rs(a,c,1),c=tn(),a!==null&&(da(a,1,c),dn(a,c))}function xt(a,c,p){if(a.tag===3)Nx(a,a,p);else for(;c!==null;){if(c.tag===3){Nx(c,a,p);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Cs===null||!Cs.has(y))){a=fo(p,a),a=Zv(c,a,1),c=Rs(c,a,1),a=tn(),c!==null&&(da(c,1,a),dn(c,a));break}}c=c.return}}function AC(a,c,p){var y=a.pingCache;y!==null&&y.delete(c),c=tn(),a.pingedLanes|=a.suspendedLanes&p,Ot===a&&(Ut&p)===p&&(Ct===4||Ct===3&&(Ut&130023424)===Ut&&500>Tt()-Hh?mi(a,0):Gh|=p),dn(a,c)}function Ox(a,c){c===0&&((a.mode&1)===0?c=1:(c=ac,ac<<=1,(ac&130023424)===0&&(ac=4194304)));var p=tn();a=Hr(a,c),a!==null&&(da(a,c,p),dn(a,p))}function _C(a){var c=a.memoizedState,p=0;c!==null&&(p=c.retryLane),Ox(a,p)}function RC(a,c){var p=0;switch(a.tag){case 13:var y=a.stateNode,T=a.memoizedState;T!==null&&(p=T.retryLane);break;case 19:y=a.stateNode;break;default:throw Error(t(314))}y!==null&&y.delete(c),Ox(a,p)}var Mx;Mx=function(a,c,p){if(a!==null)if(a.memoizedProps!==c.pendingProps||an.current)cn=!0;else{if((a.lanes&p)===0&&(c.flags&128)===0)return cn=!1,mC(a,c,p);cn=(a.flags&131072)!==0}else cn=!1,dt&&(c.flags&1048576)!==0&&mv(c,Lc,c.index);switch(c.lanes=0,c.tag){case 2:var y=c.type;Hc(a,c),a=c.pendingProps;var T=ro(c,Ht.current);co(c,p),T=Sh(null,c,y,a,T,p);var w=Th();return c.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,ln(y)?(w=!0,Ac(c)):w=!1,c.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,ph(c),T.updater=Vc,c.stateNode=T,T._reactInternals=c,Rh(c,y,a,p),c=Ph(null,c,y,!0,w,p)):(c.tag=0,dt&&w&&sh(c),en(null,c,T,p),c=c.child),c;case 16:y=c.elementType;e:{switch(Hc(a,c),a=c.pendingProps,T=y._init,y=T(y._payload),c.type=y,T=c.tag=CC(y),a=er(y,a),T){case 0:c=kh(null,c,y,a,p);break e;case 1:c=lx(null,c,y,a,p);break e;case 11:c=rx(null,c,y,a,p);break e;case 14:c=sx(null,c,y,er(y.type,a),p);break e}throw Error(t(306,y,""))}return c;case 0:return y=c.type,T=c.pendingProps,T=c.elementType===y?T:er(y,T),kh(a,c,y,T,p);case 1:return y=c.type,T=c.pendingProps,T=c.elementType===y?T:er(y,T),lx(a,c,y,T,p);case 3:e:{if(cx(c),a===null)throw Error(t(387));y=c.pendingProps,w=c.memoizedState,T=w.element,wv(a,c),Oc(c,y,null,p);var L=c.memoizedState;if(y=L.element,w.isDehydrated)if(w={element:y,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},c.updateQueue.baseState=w,c.memoizedState=w,c.flags&256){T=fo(Error(t(423)),c),c=ux(a,c,y,p,T);break e}else if(y!==T){T=fo(Error(t(424)),c),c=ux(a,c,y,p,T);break e}else for(wn=bs(c.stateNode.containerInfo.firstChild),bn=c,dt=!0,Zn=null,p=Tv(c,null,y,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(oo(),y===T){c=Wr(a,c,p);break e}en(a,c,y,p)}c=c.child}return c;case 5:return _v(c),a===null&&ah(c),y=c.type,T=c.pendingProps,w=a!==null?a.memoizedProps:null,L=T.children,Jf(y,T)?L=null:w!==null&&Jf(y,w)&&(c.flags|=32),ax(a,c),en(a,c,L,p),c.child;case 6:return a===null&&ah(c),null;case 13:return dx(a,c,p);case 4:return mh(c,c.stateNode.containerInfo),y=c.pendingProps,a===null?c.child=ao(c,null,y,p):en(a,c,y,p),c.child;case 11:return y=c.type,T=c.pendingProps,T=c.elementType===y?T:er(y,T),rx(a,c,y,T,p);case 7:return en(a,c,c.pendingProps,p),c.child;case 8:return en(a,c,c.pendingProps.children,p),c.child;case 12:return en(a,c,c.pendingProps.children,p),c.child;case 10:e:{if(y=c.type._context,T=c.pendingProps,w=c.memoizedProps,L=T.value,at(Pc,y._currentValue),y._currentValue=L,w!==null)if(Jn(w.value,L)){if(w.children===T.children&&!an.current){c=Wr(a,c,p);break e}}else for(w=c.child,w!==null&&(w.return=c);w!==null;){var B=w.dependencies;if(B!==null){L=w.child;for(var j=B.firstContext;j!==null;){if(j.context===y){if(w.tag===1){j=Kr(-1,p&-p),j.tag=2;var X=w.updateQueue;if(X!==null){X=X.shared;var ae=X.pending;ae===null?j.next=j:(j.next=ae.next,ae.next=j),X.pending=j}}w.lanes|=p,j=w.alternate,j!==null&&(j.lanes|=p),fh(w.return,p,c),B.lanes|=p;break}j=j.next}}else if(w.tag===10)L=w.type===c.type?null:w.child;else if(w.tag===18){if(L=w.return,L===null)throw Error(t(341));L.lanes|=p,B=L.alternate,B!==null&&(B.lanes|=p),fh(L,p,c),L=w.sibling}else L=w.child;if(L!==null)L.return=w;else for(L=w;L!==null;){if(L===c){L=null;break}if(w=L.sibling,w!==null){w.return=L.return,L=w;break}L=L.return}w=L}en(a,c,T.children,p),c=c.child}return c;case 9:return T=c.type,y=c.pendingProps.children,co(c,p),T=jn(T),y=y(T),c.flags|=1,en(a,c,y,p),c.child;case 14:return y=c.type,T=er(y,c.pendingProps),T=er(y.type,T),sx(a,c,y,T,p);case 15:return ix(a,c,c.type,c.pendingProps,p);case 17:return y=c.type,T=c.pendingProps,T=c.elementType===y?T:er(y,T),Hc(a,c),c.tag=1,ln(y)?(a=!0,Ac(c)):a=!1,co(c,p),Xv(c,y,T),Rh(c,y,T,p),Ph(null,c,y,!0,a,p);case 19:return hx(a,c,p);case 22:return ox(a,c,p)}throw Error(t(156,c.tag))};function Fx(a,c){return gy(a,c)}function LC(a,c,p,y){this.tag=a,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hn(a,c,p,y){return new LC(a,c,p,y)}function Jh(a){return a=a.prototype,!(!a||!a.isReactComponent)}function CC(a){if(typeof a=="function")return Jh(a)?1:0;if(a!=null){if(a=a.$$typeof,a===Z)return 11;if(a===ne)return 14}return 2}function Ns(a,c){var p=a.alternate;return p===null?(p=Hn(a.tag,c,a.key,a.mode),p.elementType=a.elementType,p.type=a.type,p.stateNode=a.stateNode,p.alternate=a,a.alternate=p):(p.pendingProps=c,p.type=a.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=a.flags&14680064,p.childLanes=a.childLanes,p.lanes=a.lanes,p.child=a.child,p.memoizedProps=a.memoizedProps,p.memoizedState=a.memoizedState,p.updateQueue=a.updateQueue,c=a.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=a.sibling,p.index=a.index,p.ref=a.ref,p}function tu(a,c,p,y,T,w){var L=2;if(y=a,typeof a=="function")Jh(a)&&(L=1);else if(typeof a=="string")L=5;else e:switch(a){case k:return yi(p.children,T,w,c);case N:L=8,T|=8;break;case M:return a=Hn(12,p,c,T|2),a.elementType=M,a.lanes=w,a;case se:return a=Hn(13,p,c,T),a.elementType=se,a.lanes=w,a;case U:return a=Hn(19,p,c,T),a.elementType=U,a.lanes=w,a;case te:return nu(p,T,w,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case O:L=10;break e;case H:L=9;break e;case Z:L=11;break e;case ne:L=14;break e;case q:L=16,y=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=Hn(L,p,c,T),c.elementType=a,c.type=y,c.lanes=w,c}function yi(a,c,p,y){return a=Hn(7,a,y,c),a.lanes=p,a}function nu(a,c,p,y){return a=Hn(22,a,y,c),a.elementType=te,a.lanes=p,a.stateNode={isHidden:!1},a}function Zh(a,c,p){return a=Hn(6,a,null,c),a.lanes=p,a}function ep(a,c,p){return c=Hn(4,a.children!==null?a.children:[],a.key,c),c.lanes=p,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function kC(a,c,p,y,T){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_f(0),this.expirationTimes=_f(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_f(0),this.identifierPrefix=y,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function tp(a,c,p,y,T,w,L,B,j){return a=new kC(a,c,p,B,j),c===1?(c=1,w===!0&&(c|=8)):c=0,w=Hn(3,null,null,c),a.current=w,w.stateNode=a,w.memoizedState={element:y,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},ph(w),a}function PC(a,c,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:y==null?null:""+y,children:a,containerInfo:c,implementation:p}}function Bx(a){if(!a)return Is;a=a._reactInternals;e:{if(ii(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(ln(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var p=a.type;if(ln(p))return fv(a,p,c)}return c}function Ux(a,c,p,y,T,w,L,B,j){return a=tp(p,y,!0,a,T,w,L,B,j),a.context=Bx(null),p=a.current,y=tn(),T=Ps(p),w=Kr(y,T),w.callback=c??null,Rs(p,w,T),a.current.lanes=T,da(a,T,y),dn(a,y),a}function ru(a,c,p,y){var T=c.current,w=tn(),L=Ps(T);return p=Bx(p),c.context===null?c.context=p:c.pendingContext=p,c=Kr(w,L),c.payload={element:a},y=y===void 0?null:y,y!==null&&(c.callback=y),a=Rs(T,c,L),a!==null&&(rr(a,T,L,w),Nc(a,T,L)),L}function su(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function $x(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var p=a.retryLane;a.retryLane=p!==0&&p<c?p:c}}function np(a,c){$x(a,c),(a=a.alternate)&&$x(a,c)}function DC(){return null}var jx=typeof reportError=="function"?reportError:function(a){console.error(a)};function rp(a){this._internalRoot=a}iu.prototype.render=rp.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));ru(a,c,null,null)},iu.prototype.unmount=rp.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;pi(function(){ru(null,a,null,null)}),c[$r]=null}};function iu(a){this._internalRoot=a}iu.prototype.unstable_scheduleHydration=function(a){if(a){var c=wy();a={blockedOn:null,target:a,priority:c};for(var p=0;p<Es.length&&c!==0&&c<Es[p].priority;p++);Es.splice(p,0,a),p===0&&_y(a)}};function sp(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function ou(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function Vx(){}function NC(a,c,p,y,T){if(T){if(typeof y=="function"){var w=y;y=function(){var X=su(L);w.call(X)}}var L=Ux(c,y,a,0,null,!1,!1,"",Vx);return a._reactRootContainer=L,a[$r]=L.current,Ia(a.nodeType===8?a.parentNode:a),pi(),L}for(;T=a.lastChild;)a.removeChild(T);if(typeof y=="function"){var B=y;y=function(){var X=su(j);B.call(X)}}var j=tp(a,0,!1,null,null,!1,!1,"",Vx);return a._reactRootContainer=j,a[$r]=j.current,Ia(a.nodeType===8?a.parentNode:a),pi(function(){ru(c,j,p,y)}),j}function au(a,c,p,y,T){var w=p._reactRootContainer;if(w){var L=w;if(typeof T=="function"){var B=T;T=function(){var j=su(L);B.call(j)}}ru(c,L,a,T)}else L=NC(p,c,a,T,y);return su(L)}Ty=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var p=ua(c.pendingLanes);p!==0&&(Rf(c,p|1),dn(c,Tt()),(ze&6)===0&&(mo=Tt()+500,As()))}break;case 13:pi(function(){var y=Hr(a,1);if(y!==null){var T=tn();rr(y,a,1,T)}}),np(a,1)}},Lf=function(a){if(a.tag===13){var c=Hr(a,134217728);if(c!==null){var p=tn();rr(c,a,134217728,p)}np(a,134217728)}},by=function(a){if(a.tag===13){var c=Ps(a),p=Hr(a,c);if(p!==null){var y=tn();rr(p,a,c,y)}np(a,c)}},wy=function(){return Ze},Iy=function(a,c){var p=Ze;try{return Ze=a,c()}finally{Ze=p}},ra=function(a,c,p){switch(c){case"input":if(Fe(a,p),c=p.name,p.type==="radio"&&c!=null){for(p=a;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<p.length;c++){var y=p[c];if(y!==a&&y.form===a.form){var T=wc(y);if(!T)throw Error(t(90));Te(y),Fe(y,T)}}}break;case"textarea":xn(a,p);break;case"select":c=p.value,c!=null&&Je(a,!!p.multiple,c,!1)}},oa=qh,tc=pi;var OC={usingClientEntryPoint:!1,Events:[Ra,to,wc,ec,ia,qh]},Va={findFiberByHostInstance:oi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MC={bundleType:Va.bundleType,version:Va.version,rendererPackageName:Va.rendererPackageName,rendererConfig:Va.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=py(a),a===null?null:a.stateNode},findFiberByHostInstance:Va.findFiberByHostInstance||DC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lu.isDisabled&&lu.supportsFiber)try{ic=lu.inject(MC),gr=lu}catch{}}return fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OC,fn.createPortal=function(a,c){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sp(c))throw Error(t(200));return PC(a,c,null,p)},fn.createRoot=function(a,c){if(!sp(a))throw Error(t(299));var p=!1,y="",T=jx;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(T=c.onRecoverableError)),c=tp(a,1,!1,null,null,p,!1,y,T),a[$r]=c.current,Ia(a.nodeType===8?a.parentNode:a),new rp(c)},fn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=py(c),a=a===null?null:a.stateNode,a},fn.flushSync=function(a){return pi(a)},fn.hydrate=function(a,c,p){if(!ou(c))throw Error(t(200));return au(null,a,c,!0,p)},fn.hydrateRoot=function(a,c,p){if(!sp(a))throw Error(t(405));var y=p!=null&&p.hydratedSources||null,T=!1,w="",L=jx;if(p!=null&&(p.unstable_strictMode===!0&&(T=!0),p.identifierPrefix!==void 0&&(w=p.identifierPrefix),p.onRecoverableError!==void 0&&(L=p.onRecoverableError)),c=Ux(c,null,a,1,p??null,T,!1,w,L),a[$r]=c.current,Ia(a),y)for(a=0;a<y.length;a++)p=y[a],T=p._getVersion,T=T(p._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[p,T]:c.mutableSourceEagerHydrationData.push(p,T);return new iu(c)},fn.render=function(a,c,p){if(!ou(c))throw Error(t(200));return au(null,a,c,!1,p)},fn.unmountComponentAtNode=function(a){if(!ou(a))throw Error(t(40));return a._reactRootContainer?(pi(function(){au(null,null,a,!1,function(){a._reactRootContainer=null,a[$r]=null})}),!0):!1},fn.unstable_batchedUpdates=qh,fn.unstable_renderSubtreeIntoContainer=function(a,c,p,y){if(!ou(p))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return au(a,c,p,!1,y)},fn.version="18.3.1-next-f1338f8080-20240426",fn}var Xx;function ew(){if(Xx)return ap.exports;Xx=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ap.exports=GC(),ap.exports}var Qx;function HC(){if(Qx)return cu;Qx=1;var n=ew();return cu.createRoot=n.createRoot,cu.hydrateRoot=n.hydrateRoot,cu}var KC=HC(),up={exports:{}},dp={};var Jx;function WC(){if(Jx)return dp;Jx=1;var n=Pl();function e(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var t=typeof Object.is=="function"?Object.is:e,r=n.useSyncExternalStore,s=n.useRef,i=n.useEffect,o=n.useMemo,l=n.useDebugValue;return dp.useSyncExternalStoreWithSelector=function(u,d,f,h,m){var v=s(null);if(v.current===null){var g={hasValue:!1,value:null};v.current=g}else g=v.current;v=o(function(){function E(C){if(!b){if(b=!0,I=C,C=h(C),m!==void 0&&g.hasValue){var F=g.value;if(m(F,C))return A=F}return A=C}if(F=A,t(I,C))return F;var k=h(C);return m!==void 0&&m(F,k)?(I=C,F):(I=C,A=k)}var b=!1,I,A,R=f===void 0?null:f;return[function(){return E(d())},R===null?void 0:function(){return E(R())}]},[d,f,h,m]);var x=r(u,v[0],v[1]);return i(function(){g.hasValue=!0,g.value=x},[x]),l(x),x},dp}var Zx;function zC(){return Zx||(Zx=1,up.exports=WC()),up.exports}zC();function YC(n){n()}function qC(){let n=null,e=null;return{clear(){n=null,e=null},notify(){YC(()=>{let t=n;for(;t;)t.callback(),t=t.next})},get(){const t=[];let r=n;for(;r;)t.push(r),r=r.next;return t},subscribe(t){let r=!0;const s=e={callback:t,next:null,prev:e};return s.prev?s.prev.next=s:n=s,function(){!r||n===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:n=s.next)}}}}var eE={notify(){},get:()=>[]};function XC(n,e){let t,r=eE,s=0,i=!1;function o(x){f();const E=r.subscribe(x);let b=!1;return()=>{b||(b=!0,E(),h())}}function l(){r.notify()}function u(){g.onStateChange&&g.onStateChange()}function d(){return i}function f(){s++,t||(t=n.subscribe(u),r=qC())}function h(){s--,t&&s===0&&(t(),t=void 0,r.clear(),r=eE)}function m(){i||(i=!0,f())}function v(){i&&(i=!1,h())}const g={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:u,isSubscribed:d,trySubscribe:m,tryUnsubscribe:v,getListeners:()=>r};return g}var QC=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",JC=QC(),ZC=()=>typeof navigator<"u"&&navigator.product==="ReactNative",ek=ZC(),tk=()=>JC||ek?P.useLayoutEffect:P.useEffect,nk=tk(),rk=Symbol.for("react-redux-context"),sk=typeof globalThis<"u"?globalThis:{};function ik(){if(!P.createContext)return{};const n=sk[rk]??=new Map;let e=n.get(P.createContext);return e||(e=P.createContext(null),n.set(P.createContext,e)),e}var ok=ik();function ak(n){const{children:e,context:t,serverState:r,store:s}=n,i=P.useMemo(()=>{const u=XC(s);return{store:s,subscription:u,getServerState:r?()=>r:void 0}},[s,r]),o=P.useMemo(()=>s.getState(),[s]);nk(()=>{const{subscription:u}=i;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),o!==s.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[i,o]);const l=t||ok;return P.createElement(l.Provider,{value:i},e)}var lk=ak;var tE="popstate";function ck(n={}){function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Tm("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:fl(s)}return dk(e,t,null,n)}function ft(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function dr(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function uk(){return Math.random().toString(36).substring(2,10)}function nE(n,e){return{usr:n.state,key:n.key,idx:e}}function Tm(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Wo(e):e,state:t,key:e&&e.key||r||uk()}}function fl({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Wo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function dk(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l="POP",u=null,d=f();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function f(){return(o.state||{idx:null}).idx}function h(){l="POP";let E=f(),b=E==null?null:E-d;d=E,u&&u({action:l,location:x.location,delta:b})}function m(E,b){l="PUSH";let I=Tm(x.location,E,b);d=f()+1;let A=nE(I,d),R=x.createHref(I);try{o.pushState(A,"",R)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;s.location.assign(R)}i&&u&&u({action:l,location:x.location,delta:1})}function v(E,b){l="REPLACE";let I=Tm(x.location,E,b);d=f();let A=nE(I,d),R=x.createHref(I);o.replaceState(A,"",R),i&&u&&u({action:l,location:x.location,delta:0})}function g(E){return fk(E)}let x={get action(){return l},get location(){return n(s,o)},listen(E){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(tE,h),u=E,()=>{s.removeEventListener(tE,h),u=null}},createHref(E){return e(s,E)},createURL:g,encodeLocation(E){let b=g(E);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:m,replace:v,go(E){return o.go(E)}};return x}function fk(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ft(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:fl(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function tw(n,e,t="/"){return hk(n,e,t,!1)}function hk(n,e,t,r){let s=typeof e=="string"?Wo(e):e,i=cs(s.pathname||"/",t);if(i==null)return null;let o=nw(n);pk(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=Ik(i);l=bk(o[u],d,r)}return l}function nw(n,e=[],t=[],r="",s=!1){let i=(o,l,u=s,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(r)&&u)return;ft(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length)}let h=ss([r,f.relativePath]),m=t.concat(f);o.children&&o.children.length>0&&(ft(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),nw(o.children,e,m,h,u)),!(o.path==null&&!o.index)&&e.push({path:h,score:Sk(h,o.index),routesMeta:m})};return n.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))i(o,l);else for(let u of rw(o.path))i(o,l,!0,u)}),e}function rw(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=rw(r.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&l.push(...o),l.map(u=>n.startsWith("/")&&u===""?"/":u)}function pk(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Tk(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var mk=/^:[\w-]+$/,gk=3,yk=2,vk=1,xk=10,Ek=-2,rE=n=>n==="*";function Sk(n,e){let t=n.split("/"),r=t.length;return t.some(rE)&&(r+=Ek),e&&(r+=yk),t.filter(s=>!rE(s)).reduce((s,i)=>s+(mk.test(i)?gk:i===""?vk:xk),r)}function Tk(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function bk(n,e,t=!1){let{routesMeta:r}=n,s={},i="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],d=l===r.length-1,f=i==="/"?e:e.slice(i.length)||"/",h=nd({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},f),m=u.route;if(!h&&d&&t&&!r[r.length-1].route.index&&(h=nd({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},f)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:ss([i,h.pathname]),pathnameBase:Lk(ss([i,h.pathnameBase])),route:m}),h.pathnameBase!=="/"&&(i=ss([i,h.pathnameBase]))}return o}function nd(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=wk(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,{paramName:f,isOptional:h},m)=>{if(f==="*"){let g=l[m]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const v=l[m];return h&&!v?d[f]=void 0:d[f]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:n}}function wk(n,e=!1,t=!0){dr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Ik(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return dr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function cs(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function Ak(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Wo(n):n;return{pathname:t?t.startsWith("/")?t:_k(t,e):e,search:Ck(r),hash:kk(s)}}function _k(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function fp(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Rk(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Dg(n){let e=Rk(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Ng(n,e,t,r=!1){let s;typeof n=="string"?s=Wo(n):(s={...n},ft(!s.pathname||!s.pathname.includes("?"),fp("?","pathname","search",s)),ft(!s.pathname||!s.pathname.includes("#"),fp("#","pathname","hash",s)),ft(!s.search||!s.search.includes("#"),fp("#","search","hash",s)));let i=n===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=t;else{let h=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),h-=1;s.pathname=m.join("/")}l=h>=0?e[h]:"/"}let u=Ak(s,l),d=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}var ss=n=>n.join("/").replace(/\/\/+/g,"/"),Lk=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Ck=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,kk=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Pk(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var sw=["POST","PUT","PATCH","DELETE"];new Set(sw);var Dk=["GET",...sw];new Set(Dk);var zo=P.createContext(null);zo.displayName="DataRouter";var Gd=P.createContext(null);Gd.displayName="DataRouterState";P.createContext(!1);var iw=P.createContext({isTransitioning:!1});iw.displayName="ViewTransition";var Nk=P.createContext(new Map);Nk.displayName="Fetchers";var Ok=P.createContext(null);Ok.displayName="Await";var fr=P.createContext(null);fr.displayName="Navigation";var Dl=P.createContext(null);Dl.displayName="Location";var hr=P.createContext({outlet:null,matches:[],isDataRoute:!1});hr.displayName="Route";var Og=P.createContext(null);Og.displayName="RouteError";function Mk(n,{relative:e}={}){ft(Yo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=P.useContext(fr),{hash:s,pathname:i,search:o}=Nl(n,{relative:e}),l=i;return t!=="/"&&(l=i==="/"?t:ss([t,i])),r.createHref({pathname:l,search:o,hash:s})}function Yo(){return P.useContext(Dl)!=null}function Mn(){return ft(Yo(),"useLocation() may be used only in the context of a <Router> component."),P.useContext(Dl).location}var ow="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function aw(n){P.useContext(fr).static||P.useLayoutEffect(n)}function Qt(){let{isDataRoute:n}=P.useContext(hr);return n?Xk():Fk()}function Fk(){ft(Yo(),"useNavigate() may be used only in the context of a <Router> component.");let n=P.useContext(zo),{basename:e,navigator:t}=P.useContext(fr),{matches:r}=P.useContext(hr),{pathname:s}=Mn(),i=JSON.stringify(Dg(r)),o=P.useRef(!1);return aw(()=>{o.current=!0}),P.useCallback((u,d={})=>{if(dr(o.current,ow),!o.current)return;if(typeof u=="number"){t.go(u);return}let f=Ng(u,JSON.parse(i),s,d.relative==="path");n==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:ss([e,f.pathname])),(d.replace?t.replace:t.push)(f,d.state,d)},[e,t,i,s,n])}P.createContext(null);function Bk(){let{matches:n}=P.useContext(hr),e=n[n.length-1];return e?e.params:{}}function Nl(n,{relative:e}={}){let{matches:t}=P.useContext(hr),{pathname:r}=Mn(),s=JSON.stringify(Dg(t));return P.useMemo(()=>Ng(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function Uk(n,e){return lw(n,e)}function lw(n,e,t,r,s){ft(Yo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=P.useContext(fr),{matches:o}=P.useContext(hr),l=o[o.length-1],u=l?l.params:{},d=l?l.pathname:"/",f=l?l.pathnameBase:"/",h=l&&l.route;{let I=h&&h.path||"";cw(d,!h||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let m=Mn(),v;if(e){let I=typeof e=="string"?Wo(e):e;ft(f==="/"||I.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${I.pathname}" was given in the \`location\` prop.`),v=I}else v=m;let g=v.pathname||"/",x=g;if(f!=="/"){let I=f.replace(/^\//,"").split("/");x="/"+g.replace(/^\//,"").split("/").slice(I.length).join("/")}let E=tw(n,{pathname:x});dr(h||E!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),dr(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=Hk(E&&E.map(I=>Object.assign({},I,{params:Object.assign({},u,I.params),pathname:ss([f,i.encodeLocation?i.encodeLocation(I.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?f:ss([f,i.encodeLocation?i.encodeLocation(I.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathnameBase])})),o,t,r,s);return e&&b?P.createElement(Dl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},b):b}function $k(){let n=qk(),e=Pk(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=P.createElement(P.Fragment,null,P.createElement("p",null," Hey developer "),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:i},"ErrorBoundary")," or"," ",P.createElement("code",{style:i},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),t?P.createElement("pre",{style:s},t):null,o)}var jk=P.createElement($k,null),Vk=class extends P.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.unstable_onError?this.props.unstable_onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?P.createElement(hr.Provider,{value:this.props.routeContext},P.createElement(Og.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Gk({routeContext:n,match:e,children:t}){let r=P.useContext(zo);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),P.createElement(hr.Provider,{value:n},t)}function Hk(n,e=[],t=null,r=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let i=n,o=t?.errors;if(o!=null){let d=i.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);ft(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,u=-1;if(t)for(let d=0;d<i.length;d++){let f=i[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:m}=t,v=f.route.loader&&!h.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||v){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,f,h)=>{let m,v=!1,g=null,x=null;t&&(m=o&&f.route.id?o[f.route.id]:void 0,g=f.route.errorElement||jk,l&&(u<0&&h===0?(cw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,x=null):u===h&&(v=!0,x=f.route.hydrateFallbackElement||null)));let E=e.concat(i.slice(0,h+1)),b=()=>{let I;return m?I=g:v?I=x:f.route.Component?I=P.createElement(f.route.Component,null):f.route.element?I=f.route.element:I=d,P.createElement(Gk,{match:f,routeContext:{outlet:d,matches:E,isDataRoute:t!=null},children:I})};return t&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?P.createElement(Vk,{location:t.location,revalidation:t.revalidation,component:g,error:m,children:b(),routeContext:{outlet:null,matches:E,isDataRoute:!0},unstable_onError:r}):b()},null)}function Mg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Kk(n){let e=P.useContext(zo);return ft(e,Mg(n)),e}function Wk(n){let e=P.useContext(Gd);return ft(e,Mg(n)),e}function zk(n){let e=P.useContext(hr);return ft(e,Mg(n)),e}function Fg(n){let e=zk(n),t=e.matches[e.matches.length-1];return ft(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Yk(){return Fg("useRouteId")}function qk(){let n=P.useContext(Og),e=Wk("useRouteError"),t=Fg("useRouteError");return n!==void 0?n:e.errors?.[t]}function Xk(){let{router:n}=Kk("useNavigate"),e=Fg("useNavigate"),t=P.useRef(!1);return aw(()=>{t.current=!0}),P.useCallback(async(s,i={})=>{dr(t.current,ow),t.current&&(typeof s=="number"?n.navigate(s):await n.navigate(s,{fromRouteId:e,...i}))},[n,e])}var sE={};function cw(n,e,t){!e&&!sE[n]&&(sE[n]=!0,dr(!1,t))}P.memo(Qk);function Qk({routes:n,future:e,state:t,unstable_onError:r}){return lw(n,void 0,t,r,e)}function uw({to:n,replace:e,state:t,relative:r}){ft(Yo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=P.useContext(fr);dr(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=P.useContext(hr),{pathname:o}=Mn(),l=Qt(),u=Ng(n,Dg(i),o,r==="path"),d=JSON.stringify(u);return P.useEffect(()=>{l(JSON.parse(d),{replace:e,state:t,relative:r})},[l,d,r,e,t]),null}function wr(n){ft(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Jk({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:i=!1}){ft(!Yo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),l=P.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof t=="string"&&(t=Wo(t));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:m="default"}=t,v=P.useMemo(()=>{let g=cs(u,o);return g==null?null:{location:{pathname:g,search:d,hash:f,state:h,key:m},navigationType:r}},[o,u,d,f,h,m,r]);return dr(v!=null,`<Router basename="${o}"> is not able to match the URL "${u}${d}${f}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:P.createElement(fr.Provider,{value:l},P.createElement(Dl.Provider,{children:e,value:v}))}function iE({children:n,location:e}){return Uk(bm(n),e)}function bm(n,e=[]){let t=[];return P.Children.forEach(n,(r,s)=>{if(!P.isValidElement(r))return;let i=[...e,s];if(r.type===P.Fragment){t.push.apply(t,bm(r.props.children,i));return}ft(r.type===wr,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ft(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=bm(r.props.children,i)),t.push(o)}),t}var Fu="get",Bu="application/x-www-form-urlencoded";function Hd(n){return n!=null&&typeof n.tagName=="string"}function Zk(n){return Hd(n)&&n.tagName.toLowerCase()==="button"}function eP(n){return Hd(n)&&n.tagName.toLowerCase()==="form"}function tP(n){return Hd(n)&&n.tagName.toLowerCase()==="input"}function nP(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function rP(n,e){return n.button===0&&(!e||e==="_self")&&!nP(n)}var uu=null;function sP(){if(uu===null)try{new FormData(document.createElement("form"),0),uu=!1}catch{uu=!0}return uu}var iP=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function hp(n){return n!=null&&!iP.has(n)?(dr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bu}"`),null):n}function oP(n,e){let t,r,s,i,o;if(eP(n)){let l=n.getAttribute("action");r=l?cs(l,e):null,t=n.getAttribute("method")||Fu,s=hp(n.getAttribute("enctype"))||Bu,i=new FormData(n)}else if(Zk(n)||tP(n)&&(n.type==="submit"||n.type==="image")){let l=n.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||l.getAttribute("action");if(r=u?cs(u,e):null,t=n.getAttribute("formmethod")||l.getAttribute("method")||Fu,s=hp(n.getAttribute("formenctype"))||hp(l.getAttribute("enctype"))||Bu,i=new FormData(l,n),!sP()){let{name:d,type:f,value:h}=n;if(f==="image"){let m=d?`${d}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else d&&i.append(d,h)}}else{if(Hd(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Fu,r=null,s=Bu,o=n}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Bg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function aP(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&cs(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function lP(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function cP(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function uP(n,e,t){let r=await Promise.all(n.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await lP(i,t);return o.links?o.links():[]}return[]}));return pP(r.flat(1).filter(cP).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function oE(n,e,t,r,s,i){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,l=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return i==="assets"?e.filter((u,d)=>o(u,d)||l(u,d)):i==="data"?e.filter((u,d)=>{let f=r.routes[u.route.id];if(!f||!f.hasLoader)return!1;if(o(u,d)||l(u,d))return!0;if(u.route.shouldRevalidate){let h=u.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function dP(n,e,{includeHydrateFallback:t}={}){return fP(n.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function fP(n){return[...new Set(n)]}function hP(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function pP(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let i=JSON.stringify(hP(s));return t.has(i)||(t.add(i),r.push({key:i,link:s})),r},[])}function dw(){let n=P.useContext(zo);return Bg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function mP(){let n=P.useContext(Gd);return Bg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Ug=P.createContext(void 0);Ug.displayName="FrameworkContext";function fw(){let n=P.useContext(Ug);return Bg(n,"You must render this element inside a <HydratedRouter> element"),n}function gP(n,e){let t=P.useContext(Ug),[r,s]=P.useState(!1),[i,o]=P.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:d,onMouseLeave:f,onTouchStart:h}=e,m=P.useRef(null);P.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let x=b=>{b.forEach(I=>{o(I.isIntersecting)})},E=new IntersectionObserver(x,{threshold:.5});return m.current&&E.observe(m.current),()=>{E.disconnect()}}},[n]),P.useEffect(()=>{if(r){let x=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(x)}}},[r]);let v=()=>{s(!0)},g=()=>{s(!1),o(!1)};return t?n!=="intent"?[i,m,{}]:[i,m,{onFocus:Ha(l,v),onBlur:Ha(u,g),onMouseEnter:Ha(d,v),onMouseLeave:Ha(f,g),onTouchStart:Ha(h,v)}]:[!1,m,{}]}function Ha(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function yP({page:n,...e}){let{router:t}=dw(),r=P.useMemo(()=>tw(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?P.createElement(xP,{page:n,matches:r,...e}):null}function vP(n){let{manifest:e,routeModules:t}=fw(),[r,s]=P.useState([]);return P.useEffect(()=>{let i=!1;return uP(n,e,t).then(o=>{i||s(o)}),()=>{i=!0}},[n,e,t]),r}function xP({page:n,matches:e,...t}){let r=Mn(),{manifest:s,routeModules:i}=fw(),{basename:o}=dw(),{loaderData:l,matches:u}=mP(),d=P.useMemo(()=>oE(n,e,u,s,r,"data"),[n,e,u,s,r]),f=P.useMemo(()=>oE(n,e,u,s,r,"assets"),[n,e,u,s,r]),h=P.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let g=new Set,x=!1;if(e.forEach(b=>{let I=s.routes[b.route.id];!I||!I.hasLoader||(!d.some(A=>A.route.id===b.route.id)&&b.route.id in l&&i[b.route.id]?.shouldRevalidate||I.hasClientLoader?x=!0:g.add(b.route.id))}),g.size===0)return[];let E=aP(n,o,"data");return x&&g.size>0&&E.searchParams.set("_routes",e.filter(b=>g.has(b.route.id)).map(b=>b.route.id).join(",")),[E.pathname+E.search]},[o,l,r,s,d,e,n,i]),m=P.useMemo(()=>dP(f,s),[f,s]),v=vP(f);return P.createElement(P.Fragment,null,h.map(g=>P.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...t})),m.map(g=>P.createElement("link",{key:g,rel:"modulepreload",href:g,...t})),v.map(({key:g,link:x})=>P.createElement("link",{key:g,nonce:t.nonce,...x})))}function EP(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var hw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{hw&&(window.__reactRouterVersion="7.9.4")}catch{}function SP({basename:n,children:e,window:t}){let r=P.useRef();r.current==null&&(r.current=ck({window:t,v5Compat:!0}));let s=r.current,[i,o]=P.useState({action:s.action,location:s.location}),l=P.useCallback(u=>{P.startTransition(()=>o(u))},[o]);return P.useLayoutEffect(()=>s.listen(l),[s,l]),P.createElement(Jk,{basename:n,children:e,location:i.location,navigationType:i.action,navigator:s})}var pw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mw=P.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:l,target:u,to:d,preventScrollReset:f,viewTransition:h,...m},v){let{basename:g}=P.useContext(fr),x=typeof d=="string"&&pw.test(d),E,b=!1;if(typeof d=="string"&&x&&(E=d,hw))try{let M=new URL(window.location.href),O=d.startsWith("//")?new URL(M.protocol+d):new URL(d),H=cs(O.pathname,g);O.origin===M.origin&&H!=null?d=H+O.search+O.hash:b=!0}catch{dr(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let I=Mk(d,{relative:s}),[A,R,C]=gP(r,m),F=IP(d,{replace:o,state:l,target:u,preventScrollReset:f,relative:s,viewTransition:h});function k(M){e&&e(M),M.defaultPrevented||F(M)}let N=P.createElement("a",{...m,...C,href:E||I,onClick:b||i?e:k,ref:EP(v,R),target:u,"data-discover":!x&&t==="render"?"true":void 0});return A&&!x?P.createElement(P.Fragment,null,N,P.createElement(yP,{page:I})):N});mw.displayName="Link";var TP=P.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:l,children:u,...d},f){let h=Nl(o,{relative:d.relative}),m=Mn(),v=P.useContext(Gd),{navigator:g,basename:x}=P.useContext(fr),E=v!=null&&CP(h)&&l===!0,b=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,I=m.pathname,A=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(I=I.toLowerCase(),A=A?A.toLowerCase():null,b=b.toLowerCase()),A&&x&&(A=cs(A,x)||A);const R=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let C=I===b||!s&&I.startsWith(b)&&I.charAt(R)==="/",F=A!=null&&(A===b||!s&&A.startsWith(b)&&A.charAt(b.length)==="/"),k={isActive:C,isPending:F,isTransitioning:E},N=C?e:void 0,M;typeof r=="function"?M=r(k):M=[r,C?"active":null,F?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let O=typeof i=="function"?i(k):i;return P.createElement(mw,{...d,"aria-current":N,className:M,ref:f,style:O,to:o,viewTransition:l},typeof u=="function"?u(k):u)});TP.displayName="NavLink";var bP=P.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:i,method:o=Fu,action:l,onSubmit:u,relative:d,preventScrollReset:f,viewTransition:h,...m},v)=>{let g=RP(),x=LP(l,{relative:d}),E=o.toLowerCase()==="get"?"get":"post",b=typeof l=="string"&&pw.test(l),I=A=>{if(u&&u(A),A.defaultPrevented)return;A.preventDefault();let R=A.nativeEvent.submitter,C=R?.getAttribute("formmethod")||o;g(R||A.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:s,state:i,relative:d,preventScrollReset:f,viewTransition:h})};return P.createElement("form",{ref:v,method:E,action:x,onSubmit:r?u:I,...m,"data-discover":!b&&n==="render"?"true":void 0})});bP.displayName="Form";function wP(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gw(n){let e=P.useContext(zo);return ft(e,wP(n)),e}function IP(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let l=Qt(),u=Mn(),d=Nl(n,{relative:i});return P.useCallback(f=>{if(rP(f,e)){f.preventDefault();let h=t!==void 0?t:fl(u)===fl(d);l(n,{replace:h,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[u,l,d,t,r,e,n,s,i,o])}var AP=0,_P=()=>`__${String(++AP)}__`;function RP(){let{router:n}=gw("useSubmit"),{basename:e}=P.useContext(fr),t=Yk();return P.useCallback(async(r,s={})=>{let{action:i,method:o,encType:l,formData:u,body:d}=oP(r,e);if(s.navigate===!1){let f=s.fetcherKey||_P();await n.fetch(f,t,s.action||i,{preventScrollReset:s.preventScrollReset,formData:u,body:d,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await n.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:u,body:d,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,e,t])}function LP(n,{relative:e}={}){let{basename:t}=P.useContext(fr),r=P.useContext(hr);ft(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...Nl(n||".",{relative:e})},o=Mn();if(n==null){i.search=o.search;let l=new URLSearchParams(i.search),u=l.getAll("index");if(u.some(f=>f==="")){l.delete("index"),u.filter(h=>h).forEach(h=>l.append("index",h));let f=l.toString();i.search=f?`?${f}`:""}}return(!n||n===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:ss([t,i.pathname])),fl(i)}function CP(n,{relative:e}={}){let t=P.useContext(iw);ft(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=gw("useViewTransitionState"),s=Nl(n,{relative:e});if(!t.isTransitioning)return!1;let i=cs(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=cs(t.nextLocation.pathname,r)||t.nextLocation.pathname;return nd(s.pathname,o)!=null||nd(s.pathname,i)!=null}var kP=ew();const PP=Zb(kP),yw=P.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"}),Kd=P.createContext({}),Wd=P.createContext(null),zd=typeof document<"u",$g=zd?P.useLayoutEffect:P.useEffect,vw=P.createContext({strict:!1}),jg=n=>n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),DP="framerAppearId",xw="data-"+jg(DP);function NP(n,e,t,r){const{visualElement:s}=P.useContext(Kd),i=P.useContext(vw),o=P.useContext(Wd),l=P.useContext(yw).reducedMotion,u=P.useRef();r=r||i.renderer,!u.current&&r&&(u.current=r(n,{visualState:e,parent:s,props:t,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const d=u.current;P.useInsertionEffect(()=>{d&&d.update(t,o)});const f=P.useRef(!!(t[xw]&&!window.HandoffComplete));return $g(()=>{d&&(d.render(),f.current&&d.animationState&&d.animationState.animateChanges())}),P.useEffect(()=>{d&&(d.updateFeatures(),!f.current&&d.animationState&&d.animationState.animateChanges(),f.current&&(f.current=!1,window.HandoffComplete=!0))}),d}function wo(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function OP(n,e,t){return P.useCallback(r=>{r&&n.mount&&n.mount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):wo(t)&&(t.current=r))},[e])}function hl(n){return typeof n=="string"||Array.isArray(n)}function Yd(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Vg=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Gg=["initial",...Vg];function qd(n){return Yd(n.animate)||Gg.some(e=>hl(n[e]))}function Ew(n){return!!(qd(n)||n.variants)}function MP(n,e){if(qd(n)){const{initial:t,animate:r}=n;return{initial:t===!1||hl(t)?t:void 0,animate:hl(r)?r:void 0}}return n.inherit!==!1?e:{}}function FP(n){const{initial:e,animate:t}=MP(n,P.useContext(Kd));return P.useMemo(()=>({initial:e,animate:t}),[aE(e),aE(t)])}function aE(n){return Array.isArray(n)?n.join(" "):n}const lE={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},pl={};for(const n in lE)pl[n]={isEnabled:e=>lE[n].some(t=>!!e[t])};function BP(n){for(const e in n)pl[e]={...pl[e],...n[e]}}const Hg=P.createContext({}),Sw=P.createContext({}),UP=Symbol.for("motionComponentSymbol");function $P({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:s}){n&&BP(n);function i(l,u){let d;const f={...P.useContext(yw),...l,layoutId:jP(l)},{isStatic:h}=f,m=FP(l),v=r(l,h);if(!h&&zd){m.visualElement=NP(s,v,f,e);const g=P.useContext(Sw),x=P.useContext(vw).strict;m.visualElement&&(d=m.visualElement.loadFeatures(f,x,n,g))}return P.createElement(Kd.Provider,{value:m},d&&m.visualElement?P.createElement(d,{visualElement:m.visualElement,...f}):null,t(s,l,OP(v,m.visualElement,u),v,h,m.visualElement))}const o=P.forwardRef(i);return o[UP]=s,o}function jP({layoutId:n}){const e=P.useContext(Hg).id;return e&&n!==void 0?e+"-"+n:n}function VP(n){function e(r,s={}){return $P(n(r,s))}if(typeof Proxy>"u")return e;const t=new Map;return new Proxy(e,{get:(r,s)=>(t.has(s)||t.set(s,e(s)),t.get(s))})}const GP=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Kg(n){return typeof n!="string"||n.includes("-")?!1:!!(GP.indexOf(n)>-1||/[A-Z]/.test(n))}const rd={};function HP(n){Object.assign(rd,n)}const Ol=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Hi=new Set(Ol);function Tw(n,{layout:e,layoutId:t}){return Hi.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!rd[n]||n==="opacity")}const vn=n=>!!(n&&n.getVelocity),KP={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},WP=Ol.length;function zP(n,{enableHardwareAcceleration:e=!0,allowTransformNone:t=!0},r,s){let i="";for(let o=0;o<WP;o++){const l=Ol[o];if(n[l]!==void 0){const u=KP[l]||l;i+=`${u}(${n[l]}) `}}return e&&!n.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(n,r?"":i):t&&r&&(i="none"),i}const bw=n=>e=>typeof e=="string"&&e.startsWith(n),ww=bw("--"),wm=bw("var(--"),YP=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,qP=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Js=(n,e,t)=>Math.min(Math.max(t,n),e),Ki={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},nl={...Ki,transform:n=>Js(0,1,n)},du={...Ki,default:1},rl=n=>Math.round(n*1e5)/1e5,Xd=/(-)?([\d]*\.?[\d])+/g,Iw=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,XP=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Ml(n){return typeof n=="string"}const Fl=n=>({test:e=>Ml(e)&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Us=Fl("deg"),Cr=Fl("%"),Ce=Fl("px"),QP=Fl("vh"),JP=Fl("vw"),cE={...Cr,parse:n=>Cr.parse(n)/100,transform:n=>Cr.transform(n*100)},uE={...Ki,transform:Math.round},Aw={borderWidth:Ce,borderTopWidth:Ce,borderRightWidth:Ce,borderBottomWidth:Ce,borderLeftWidth:Ce,borderRadius:Ce,radius:Ce,borderTopLeftRadius:Ce,borderTopRightRadius:Ce,borderBottomRightRadius:Ce,borderBottomLeftRadius:Ce,width:Ce,maxWidth:Ce,height:Ce,maxHeight:Ce,size:Ce,top:Ce,right:Ce,bottom:Ce,left:Ce,padding:Ce,paddingTop:Ce,paddingRight:Ce,paddingBottom:Ce,paddingLeft:Ce,margin:Ce,marginTop:Ce,marginRight:Ce,marginBottom:Ce,marginLeft:Ce,rotate:Us,rotateX:Us,rotateY:Us,rotateZ:Us,scale:du,scaleX:du,scaleY:du,scaleZ:du,skew:Us,skewX:Us,skewY:Us,distance:Ce,translateX:Ce,translateY:Ce,translateZ:Ce,x:Ce,y:Ce,z:Ce,perspective:Ce,transformPerspective:Ce,opacity:nl,originX:cE,originY:cE,originZ:Ce,zIndex:uE,fillOpacity:nl,strokeOpacity:nl,numOctaves:uE};function Wg(n,e,t,r){const{style:s,vars:i,transform:o,transformOrigin:l}=n;let u=!1,d=!1,f=!0;for(const h in e){const m=e[h];if(ww(h)){i[h]=m;continue}const v=Aw[h],g=qP(m,v);if(Hi.has(h)){if(u=!0,o[h]=g,!f)continue;m!==(v.default||0)&&(f=!1)}else h.startsWith("origin")?(d=!0,l[h]=g):s[h]=g}if(e.transform||(u||r?s.transform=zP(n.transform,t,f,r):s.transform&&(s.transform="none")),d){const{originX:h="50%",originY:m="50%",originZ:v=0}=l;s.transformOrigin=`${h} ${m} ${v}`}}const zg=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function _w(n,e,t){for(const r in e)!vn(e[r])&&!Tw(r,t)&&(n[r]=e[r])}function ZP({transformTemplate:n},e,t){return P.useMemo(()=>{const r=zg();return Wg(r,e,{enableHardwareAcceleration:!t},n),Object.assign({},r.vars,r.style)},[e])}function eD(n,e,t){const r=n.style||{},s={};return _w(s,r,n),Object.assign(s,ZP(n,e,t)),n.transformValues?n.transformValues(s):s}function tD(n,e,t){const r={},s=eD(n,e,t);return n.drag&&n.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(r.tabIndex=0),r.style=s,r}const nD=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function sd(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||nD.has(n)}let Rw=n=>!sd(n);function rD(n){n&&(Rw=e=>e.startsWith("on")?!sd(e):n(e))}try{rD(require("@emotion/is-prop-valid").default)}catch{}function sD(n,e,t){const r={};for(const s in n)s==="values"&&typeof n.values=="object"||(Rw(s)||t===!0&&sd(s)||!e&&!sd(s)||n.draggable&&s.startsWith("onDrag"))&&(r[s]=n[s]);return r}function dE(n,e,t){return typeof n=="string"?n:Ce.transform(e+t*n)}function iD(n,e,t){const r=dE(e,n.x,n.width),s=dE(t,n.y,n.height);return`${r} ${s}`}const oD={offset:"stroke-dashoffset",array:"stroke-dasharray"},aD={offset:"strokeDashoffset",array:"strokeDasharray"};function lD(n,e,t=1,r=0,s=!0){n.pathLength=1;const i=s?oD:aD;n[i.offset]=Ce.transform(-r);const o=Ce.transform(e),l=Ce.transform(t);n[i.array]=`${o} ${l}`}function Yg(n,{attrX:e,attrY:t,attrScale:r,originX:s,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...d},f,h,m){if(Wg(n,d,f,m),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:v,style:g,dimensions:x}=n;v.transform&&(x&&(g.transform=v.transform),delete v.transform),x&&(s!==void 0||i!==void 0||g.transform)&&(g.transformOrigin=iD(x,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(v.x=e),t!==void 0&&(v.y=t),r!==void 0&&(v.scale=r),o!==void 0&&lD(v,o,l,u,!1)}const Lw=()=>({...zg(),attrs:{}}),qg=n=>typeof n=="string"&&n.toLowerCase()==="svg";function cD(n,e,t,r){const s=P.useMemo(()=>{const i=Lw();return Yg(i,e,{enableHardwareAcceleration:!1},qg(r),n.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(n.style){const i={};_w(i,n.style,n),s.style={...i,...s.style}}return s}function uD(n=!1){return(t,r,s,{latestValues:i},o)=>{const u=(Kg(t)?cD:tD)(r,i,o,t),f={...sD(r,typeof t=="string",n),...u,ref:s},{children:h}=r,m=P.useMemo(()=>vn(h)?h.get():h,[h]);return P.createElement(t,{...f,children:m})}}function Cw(n,{style:e,vars:t},r,s){Object.assign(n.style,e,s&&s.getProjectionStyles(r));for(const i in t)n.style.setProperty(i,t[i])}const kw=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Pw(n,e,t,r){Cw(n,e,void 0,r);for(const s in e.attrs)n.setAttribute(kw.has(s)?s:jg(s),e.attrs[s])}function Xg(n,e){const{style:t}=n,r={};for(const s in t)(vn(t[s])||e.style&&vn(e.style[s])||Tw(s,n))&&(r[s]=t[s]);return r}function Dw(n,e){const t=Xg(n,e);for(const r in n)if(vn(n[r])||vn(e[r])){const s=Ol.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;t[s]=n[r]}return t}function Qg(n,e,t,r={},s={}){return typeof e=="function"&&(e=e(t!==void 0?t:n.custom,r,s)),typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"&&(e=e(t!==void 0?t:n.custom,r,s)),e}function Nw(n){const e=P.useRef(null);return e.current===null&&(e.current=n()),e.current}const id=n=>Array.isArray(n),dD=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),fD=n=>id(n)?n[n.length-1]||0:n;function Uu(n){const e=vn(n)?n.get():n;return dD(e)?e.toValue():e}function hD({scrapeMotionValuesFromProps:n,createRenderState:e,onMount:t},r,s,i){const o={latestValues:pD(r,s,i,n),renderState:e()};return t&&(o.mount=l=>t(r,l,o)),o}const Ow=n=>(e,t)=>{const r=P.useContext(Kd),s=P.useContext(Wd),i=()=>hD(n,e,r,s);return t?i():Nw(i)};function pD(n,e,t,r){const s={},i=r(n,{});for(const m in i)s[m]=Uu(i[m]);let{initial:o,animate:l}=n;const u=qd(n),d=Ew(n);e&&d&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const h=f?l:o;return h&&typeof h!="boolean"&&!Yd(h)&&(Array.isArray(h)?h:[h]).forEach(v=>{const g=Qg(n,v);if(!g)return;const{transitionEnd:x,transition:E,...b}=g;for(const I in b){let A=b[I];if(Array.isArray(A)){const R=f?A.length-1:0;A=A[R]}A!==null&&(s[I]=A)}for(const I in x)s[I]=x[I]}),s}const It=n=>n;class fE{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const t=this.order.indexOf(e);t!==-1&&(this.order.splice(t,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function mD(n){let e=new fE,t=new fE,r=0,s=!1,i=!1;const o=new WeakSet,l={schedule:(u,d=!1,f=!1)=>{const h=f&&s,m=h?e:t;return d&&o.add(u),m.add(u)&&h&&s&&(r=e.order.length),u},cancel:u=>{t.remove(u),o.delete(u)},process:u=>{if(s){i=!0;return}if(s=!0,[e,t]=[t,e],t.clear(),r=e.order.length,r)for(let d=0;d<r;d++){const f=e.order[d];f(u),o.has(f)&&(l.schedule(f),n())}s=!1,i&&(i=!1,l.process(u))}};return l}const fu=["prepare","read","update","preRender","render","postRender"],gD=40;function yD(n,e){let t=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=fu.reduce((h,m)=>(h[m]=mD(()=>t=!0),h),{}),o=h=>i[h].process(s),l=()=>{const h=performance.now();t=!1,s.delta=r?1e3/60:Math.max(Math.min(h-s.timestamp,gD),1),s.timestamp=h,s.isProcessing=!0,fu.forEach(o),s.isProcessing=!1,t&&e&&(r=!1,n(l))},u=()=>{t=!0,r=!0,s.isProcessing||n(l)};return{schedule:fu.reduce((h,m)=>{const v=i[m];return h[m]=(g,x=!1,E=!1)=>(t||u(),v.schedule(g,x,E)),h},{}),cancel:h=>fu.forEach(m=>i[m].cancel(h)),state:s,steps:i}}const{schedule:lt,cancel:us,state:Yt,steps:pp}=yD(typeof requestAnimationFrame<"u"?requestAnimationFrame:It,!0),vD={useVisualState:Ow({scrapeMotionValuesFromProps:Dw,createRenderState:Lw,onMount:(n,e,{renderState:t,latestValues:r})=>{lt.read(()=>{try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}),lt.render(()=>{Yg(t,r,{enableHardwareAcceleration:!1},qg(e.tagName),n.transformTemplate),Pw(e,t)})}})},xD={useVisualState:Ow({scrapeMotionValuesFromProps:Xg,createRenderState:zg})};function ED(n,{forwardMotionProps:e=!1},t,r){return{...Kg(n)?vD:xD,preloadedFeatures:t,useRender:uD(e),createVisualElement:r,Component:n}}function ts(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}const Mw=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1;function Qd(n,e="page"){return{point:{x:n[e+"X"],y:n[e+"Y"]}}}const SD=n=>e=>Mw(e)&&n(e,Qd(e));function is(n,e,t,r){return ts(n,e,SD(t),r)}const TD=(n,e)=>t=>e(n(t)),zs=(...n)=>n.reduce(TD);function Fw(n){let e=null;return()=>{const t=()=>{e=null};return e===null?(e=n,t):!1}}const hE=Fw("dragHorizontal"),pE=Fw("dragVertical");function Bw(n){let e=!1;if(n==="y")e=pE();else if(n==="x")e=hE();else{const t=hE(),r=pE();t&&r?e=()=>{t(),r()}:(t&&t(),r&&r())}return e}function Uw(){const n=Bw(!0);return n?(n(),!1):!0}class ri{constructor(e){this.isMounted=!1,this.node=e}update(){}}function mE(n,e){const t="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),s=(i,o)=>{if(i.pointerType==="touch"||Uw())return;const l=n.getProps();n.animationState&&l.whileHover&&n.animationState.setActive("whileHover",e),l[r]&&lt.update(()=>l[r](i,o))};return is(n.current,t,s,{passive:!n.getProps()[r]})}class bD extends ri{mount(){this.unmount=zs(mE(this.node,!0),mE(this.node,!1))}unmount(){}}class wD extends ri{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=zs(ts(this.node.current,"focus",()=>this.onFocus()),ts(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const $w=(n,e)=>e?n===e?!0:$w(n,e.parentElement):!1;function mp(n,e){if(!e)return;const t=new PointerEvent("pointer"+n);e(t,Qd(t))}class ID extends ri{constructor(){super(...arguments),this.removeStartListeners=It,this.removeEndListeners=It,this.removeAccessibleListeners=It,this.startPointerPress=(e,t)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),i=is(window,"pointerup",(l,u)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:f,globalTapTarget:h}=this.node.getProps();lt.update(()=>{!h&&!$w(this.node.current,l.target)?f&&f(l,u):d&&d(l,u)})},{passive:!(r.onTap||r.onPointerUp)}),o=is(window,"pointercancel",(l,u)=>this.cancelPress(l,u),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=zs(i,o),this.startPress(e,t)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||mp("up",(u,d)=>{const{onTap:f}=this.node.getProps();f&&lt.update(()=>f(u,d))})};this.removeEndListeners(),this.removeEndListeners=ts(this.node.current,"keyup",o),mp("down",(l,u)=>{this.startPress(l,u)})},t=ts(this.node.current,"keydown",e),r=()=>{this.isPressing&&mp("cancel",(i,o)=>this.cancelPress(i,o))},s=ts(this.node.current,"blur",r);this.removeAccessibleListeners=zs(t,s)}}startPress(e,t){this.isPressing=!0;const{onTapStart:r,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&lt.update(()=>r(e,t))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!Uw()}cancelPress(e,t){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&lt.update(()=>r(e,t))}mount(){const e=this.node.getProps(),t=is(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=ts(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=zs(t,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Im=new WeakMap,gp=new WeakMap,AD=n=>{const e=Im.get(n.target);e&&e(n)},_D=n=>{n.forEach(AD)};function RD({root:n,...e}){const t=n||document;gp.has(t)||gp.set(t,{});const r=gp.get(t),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(_D,{root:n,...e})),r[s]}function LD(n,e,t){const r=RD(e);return Im.set(n,t),r.observe(n),()=>{Im.delete(n),r.unobserve(n)}}const CD={some:0,all:1};class kD extends ri{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:s="some",once:i}=e,o={root:t?t.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:CD[s]},l=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:f,onViewportLeave:h}=this.node.getProps(),m=d?f:h;m&&m(u)};return LD(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(PD(e,t))&&this.startObserver()}unmount(){}}function PD({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const DD={inView:{Feature:kD},tap:{Feature:ID},focus:{Feature:wD},hover:{Feature:bD}};function jw(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function ND(n){const e={};return n.values.forEach((t,r)=>e[r]=t.get()),e}function OD(n){const e={};return n.values.forEach((t,r)=>e[r]=t.getVelocity()),e}function Jd(n,e,t){const r=n.getProps();return Qg(r,e,t!==void 0?t:r.custom,ND(n),OD(n))}let Jg=It;const ki=n=>n*1e3,os=n=>n/1e3,MD={current:!1},Vw=n=>Array.isArray(n)&&typeof n[0]=="number";function Gw(n){return!!(!n||typeof n=="string"&&Hw[n]||Vw(n)||Array.isArray(n)&&n.every(Gw))}const Xa=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,Hw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Xa([0,.65,.55,1]),circOut:Xa([.55,0,1,.45]),backIn:Xa([.31,.01,.66,-.59]),backOut:Xa([.33,1.53,.69,.99])};function Kw(n){if(n)return Vw(n)?Xa(n):Array.isArray(n)?n.map(Kw):Hw[n]}function FD(n,e,t,{delay:r=0,duration:s,repeat:i=0,repeatType:o="loop",ease:l,times:u}={}){const d={[e]:t};u&&(d.offset=u);const f=Kw(l);return Array.isArray(f)&&(d.easing=f),n.animate(d,{delay:r,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function BD(n,{repeat:e,repeatType:t="loop"}){const r=e&&t!=="loop"&&e%2===1?0:n.length-1;return n[r]}const Ww=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,UD=1e-7,$D=12;function jD(n,e,t,r,s){let i,o,l=0;do o=e+(t-e)/2,i=Ww(o,r,s)-n,i>0?t=o:e=o;while(Math.abs(i)>UD&&++l<$D);return o}function Bl(n,e,t,r){if(n===e&&t===r)return It;const s=i=>jD(i,0,1,n,t);return i=>i===0||i===1?i:Ww(s(i),e,r)}const VD=Bl(.42,0,1,1),GD=Bl(0,0,.58,1),zw=Bl(.42,0,.58,1),HD=n=>Array.isArray(n)&&typeof n[0]!="number",Yw=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,qw=n=>e=>1-n(1-e),Zg=n=>1-Math.sin(Math.acos(n)),Xw=qw(Zg),KD=Yw(Zg),Qw=Bl(.33,1.53,.69,.99),e0=qw(Qw),WD=Yw(e0),zD=n=>(n*=2)<1?.5*e0(n):.5*(2-Math.pow(2,-10*(n-1))),YD={linear:It,easeIn:VD,easeInOut:zw,easeOut:GD,circIn:Zg,circInOut:KD,circOut:Xw,backIn:e0,backInOut:WD,backOut:Qw,anticipate:zD},gE=n=>{if(Array.isArray(n)){Jg(n.length===4);const[e,t,r,s]=n;return Bl(e,t,r,s)}else if(typeof n=="string")return YD[n];return n},t0=(n,e)=>t=>!!(Ml(t)&&XP.test(t)&&t.startsWith(n)||e&&Object.prototype.hasOwnProperty.call(t,e)),Jw=(n,e,t)=>r=>{if(!Ml(r))return r;const[s,i,o,l]=r.match(Xd);return{[n]:parseFloat(s),[e]:parseFloat(i),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},qD=n=>Js(0,255,n),yp={...Ki,transform:n=>Math.round(qD(n))},_i={test:t0("rgb","red"),parse:Jw("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+yp.transform(n)+", "+yp.transform(e)+", "+yp.transform(t)+", "+rl(nl.transform(r))+")"};function XD(n){let e="",t="",r="",s="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),s=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),s=n.substring(4,5),e+=e,t+=t,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const Am={test:t0("#"),parse:XD,transform:_i.transform},Io={test:t0("hsl","hue"),parse:Jw("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Cr.transform(rl(e))+", "+Cr.transform(rl(t))+", "+rl(nl.transform(r))+")"},nn={test:n=>_i.test(n)||Am.test(n)||Io.test(n),parse:n=>_i.test(n)?_i.parse(n):Io.test(n)?Io.parse(n):Am.parse(n),transform:n=>Ml(n)?n:n.hasOwnProperty("red")?_i.transform(n):Io.transform(n)},yt=(n,e,t)=>-t*n+t*e+n;function vp(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function QD({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let s=0,i=0,o=0;if(!e)s=i=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;s=vp(u,l,n+1/3),i=vp(u,l,n),o=vp(u,l,n-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}const xp=(n,e,t)=>{const r=n*n;return Math.sqrt(Math.max(0,t*(e*e-r)+r))},JD=[Am,_i,Io],ZD=n=>JD.find(e=>e.test(n));function yE(n){const e=ZD(n);let t=e.parse(n);return e===Io&&(t=QD(t)),t}const Zw=(n,e)=>{const t=yE(n),r=yE(e),s={...t};return i=>(s.red=xp(t.red,r.red,i),s.green=xp(t.green,r.green,i),s.blue=xp(t.blue,r.blue,i),s.alpha=yt(t.alpha,r.alpha,i),_i.transform(s))};function eN(n){var e,t;return isNaN(n)&&Ml(n)&&(((e=n.match(Xd))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(Iw))===null||t===void 0?void 0:t.length)||0)>0}const e1={regex:YP,countKey:"Vars",token:"${v}",parse:It},t1={regex:Iw,countKey:"Colors",token:"${c}",parse:nn.parse},n1={regex:Xd,countKey:"Numbers",token:"${n}",parse:Ki.parse};function Ep(n,{regex:e,countKey:t,token:r,parse:s}){const i=n.tokenised.match(e);i&&(n["num"+t]=i.length,n.tokenised=n.tokenised.replace(e,r),n.values.push(...i.map(s)))}function od(n){const e=n.toString(),t={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return t.value.includes("var(--")&&Ep(t,e1),Ep(t,t1),Ep(t,n1),t}function r1(n){return od(n).values}function s1(n){const{values:e,numColors:t,numVars:r,tokenised:s}=od(n),i=e.length;return o=>{let l=s;for(let u=0;u<i;u++)u<r?l=l.replace(e1.token,o[u]):u<r+t?l=l.replace(t1.token,nn.transform(o[u])):l=l.replace(n1.token,rl(o[u]));return l}}const tN=n=>typeof n=="number"?0:n;function nN(n){const e=r1(n);return s1(n)(e.map(tN))}const Zs={test:eN,parse:r1,createTransformer:s1,getAnimatableNone:nN},i1=(n,e)=>t=>`${t>0?e:n}`;function o1(n,e){return typeof n=="number"?t=>yt(n,e,t):nn.test(n)?Zw(n,e):n.startsWith("var(")?i1(n,e):l1(n,e)}const a1=(n,e)=>{const t=[...n],r=t.length,s=n.map((i,o)=>o1(i,e[o]));return i=>{for(let o=0;o<r;o++)t[o]=s[o](i);return t}},rN=(n,e)=>{const t={...n,...e},r={};for(const s in t)n[s]!==void 0&&e[s]!==void 0&&(r[s]=o1(n[s],e[s]));return s=>{for(const i in r)t[i]=r[i](s);return t}},l1=(n,e)=>{const t=Zs.createTransformer(e),r=od(n),s=od(e);return r.numVars===s.numVars&&r.numColors===s.numColors&&r.numNumbers>=s.numNumbers?zs(a1(r.values,s.values),t):i1(n,e)},ml=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},vE=(n,e)=>t=>yt(n,e,t);function sN(n){return typeof n=="number"?vE:typeof n=="string"?nn.test(n)?Zw:l1:Array.isArray(n)?a1:typeof n=="object"?rN:vE}function iN(n,e,t){const r=[],s=t||sN(n[0]),i=n.length-1;for(let o=0;o<i;o++){let l=s(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||It:e;l=zs(u,l)}r.push(l)}return r}function c1(n,e,{clamp:t=!0,ease:r,mixer:s}={}){const i=n.length;if(Jg(i===e.length),i===1)return()=>e[0];n[0]>n[i-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=iN(e,r,s),l=o.length,u=d=>{let f=0;if(l>1)for(;f<n.length-2&&!(d<n[f+1]);f++);const h=ml(n[f],n[f+1],d);return o[f](h)};return t?d=>u(Js(n[0],n[i-1],d)):u}function oN(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const s=ml(0,e,r);n.push(yt(t,1,s))}}function aN(n){const e=[0];return oN(e,n.length-1),e}function lN(n,e){return n.map(t=>t*e)}function cN(n,e){return n.map(()=>e||zw).splice(0,n.length-1)}function ad({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const s=HD(r)?r.map(gE):gE(r),i={done:!1,value:e[0]},o=lN(t&&t.length===e.length?t:aN(e),n),l=c1(o,e,{ease:Array.isArray(s)?s:cN(e,s)});return{calculatedDuration:n,next:u=>(i.value=l(u),i.done=u>=n,i)}}function u1(n,e){return e?n*(1e3/e):0}const uN=5;function d1(n,e,t){const r=Math.max(e-uN,0);return u1(t-n(r),e-r)}const Sp=.001,dN=.01,fN=10,hN=.05,pN=1;function mN({duration:n=800,bounce:e=.25,velocity:t=0,mass:r=1}){let s,i,o=1-e;o=Js(hN,pN,o),n=Js(dN,fN,os(n)),o<1?(s=d=>{const f=d*o,h=f*n,m=f-t,v=_m(d,o),g=Math.exp(-h);return Sp-m/v*g},i=d=>{const h=d*o*n,m=h*t+t,v=Math.pow(o,2)*Math.pow(d,2)*n,g=Math.exp(-h),x=_m(Math.pow(d,2),o);return(-s(d)+Sp>0?-1:1)*((m-v)*g)/x}):(s=d=>{const f=Math.exp(-d*n),h=(d-t)*n+1;return-Sp+f*h},i=d=>{const f=Math.exp(-d*n),h=(t-d)*(n*n);return f*h});const l=5/n,u=yN(s,i,l);if(n=ki(n),isNaN(u))return{stiffness:100,damping:10,duration:n};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:n}}}const gN=12;function yN(n,e,t){let r=t;for(let s=1;s<gN;s++)r=r-n(r)/e(r);return r}function _m(n,e){return n*Math.sqrt(1-e*e)}const vN=["duration","bounce"],xN=["stiffness","damping","mass"];function xE(n,e){return e.some(t=>n[t]!==void 0)}function EN(n){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...n};if(!xE(n,xN)&&xE(n,vN)){const t=mN(n);e={...e,...t,mass:1},e.isResolvedFromDuration=!0}return e}function f1({keyframes:n,restDelta:e,restSpeed:t,...r}){const s=n[0],i=n[n.length-1],o={done:!1,value:s},{stiffness:l,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:m}=EN({...r,velocity:-os(r.velocity||0)}),v=h||0,g=u/(2*Math.sqrt(l*d)),x=i-s,E=os(Math.sqrt(l/d)),b=Math.abs(x)<5;t||(t=b?.01:2),e||(e=b?.005:.5);let I;if(g<1){const A=_m(E,g);I=R=>{const C=Math.exp(-g*E*R);return i-C*((v+g*E*x)/A*Math.sin(A*R)+x*Math.cos(A*R))}}else if(g===1)I=A=>i-Math.exp(-E*A)*(x+(v+E*x)*A);else{const A=E*Math.sqrt(g*g-1);I=R=>{const C=Math.exp(-g*E*R),F=Math.min(A*R,300);return i-C*((v+g*E*x)*Math.sinh(F)+A*x*Math.cosh(F))/A}}return{calculatedDuration:m&&f||null,next:A=>{const R=I(A);if(m)o.done=A>=f;else{let C=v;A!==0&&(g<1?C=d1(I,A,R):C=0);const F=Math.abs(C)<=t,k=Math.abs(i-R)<=e;o.done=F&&k}return o.value=o.done?i:R,o}}}function EE({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:u,restDelta:d=.5,restSpeed:f}){const h=n[0],m={done:!1,value:h},v=N=>l!==void 0&&N<l||u!==void 0&&N>u,g=N=>l===void 0?u:u===void 0||Math.abs(l-N)<Math.abs(u-N)?l:u;let x=t*e;const E=h+x,b=o===void 0?E:o(E);b!==E&&(x=b-h);const I=N=>-x*Math.exp(-N/r),A=N=>b+I(N),R=N=>{const M=I(N),O=A(N);m.done=Math.abs(M)<=d,m.value=m.done?b:O};let C,F;const k=N=>{v(m.value)&&(C=N,F=f1({keyframes:[m.value,g(m.value)],velocity:d1(A,N,m.value),damping:s,stiffness:i,restDelta:d,restSpeed:f}))};return k(0),{calculatedDuration:null,next:N=>{let M=!1;return!F&&C===void 0&&(M=!0,R(N),k(N)),C!==void 0&&N>C?F.next(N-C):(!M&&R(N),m)}}}const SN=n=>{const e=({timestamp:t})=>n(t);return{start:()=>lt.update(e,!0),stop:()=>us(e),now:()=>Yt.isProcessing?Yt.timestamp:performance.now()}},SE=2e4;function TE(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<SE;)e+=t,r=n.next(e);return e>=SE?1/0:e}const TN={decay:EE,inertia:EE,tween:ad,keyframes:ad,spring:f1};function ld({autoplay:n=!0,delay:e=0,driver:t=SN,keyframes:r,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:l="loop",onPlay:u,onStop:d,onComplete:f,onUpdate:h,...m}){let v=1,g=!1,x,E;const b=()=>{E=new Promise(D=>{x=D})};b();let I;const A=TN[s]||ad;let R;A!==ad&&typeof r[0]!="number"&&(R=c1([0,100],r,{clamp:!1}),r=[0,100]);const C=A({...m,keyframes:r});let F;l==="mirror"&&(F=A({...m,keyframes:[...r].reverse(),velocity:-(m.velocity||0)}));let k="idle",N=null,M=null,O=null;C.calculatedDuration===null&&i&&(C.calculatedDuration=TE(C));const{calculatedDuration:H}=C;let Z=1/0,se=1/0;H!==null&&(Z=H+o,se=Z*(i+1)-o);let U=0;const ne=D=>{if(M===null)return;v>0&&(M=Math.min(M,D)),v<0&&(M=Math.min(D-se/v,M)),N!==null?U=N:U=Math.round(D-M)*v;const $=U-e*(v>=0?1:-1),ie=v>=0?$<0:$>se;U=Math.max($,0),k==="finished"&&N===null&&(U=se);let ce=U,ue=C;if(i){const Ae=Math.min(U,se)/Z;let Pe=Math.floor(Ae),De=Ae%1;!De&&Ae>=1&&(De=1),De===1&&Pe--,Pe=Math.min(Pe,i+1),!!(Pe%2)&&(l==="reverse"?(De=1-De,o&&(De-=o/Z)):l==="mirror"&&(ue=F)),ce=Js(0,1,De)*Z}const fe=ie?{done:!1,value:r[0]}:ue.next(ce);R&&(fe.value=R(fe.value));let{done:Se}=fe;!ie&&H!==null&&(Se=v>=0?U>=se:U<=0);const ye=N===null&&(k==="finished"||k==="running"&&Se);return h&&h(fe.value),ye&&G(),fe},q=()=>{I&&I.stop(),I=void 0},te=()=>{k="idle",q(),x(),b(),M=O=null},G=()=>{k="finished",f&&f(),q(),x()},Q=()=>{if(g)return;I||(I=t(ne));const D=I.now();u&&u(),N!==null?M=D-N:(!M||k==="finished")&&(M=D),k==="finished"&&b(),O=M,N=null,k="running",I.start()};n&&Q();const ee={then(D,$){return E.then(D,$)},get time(){return os(U)},set time(D){D=ki(D),U=D,N!==null||!I||v===0?N=D:M=I.now()-D/v},get duration(){const D=C.calculatedDuration===null?TE(C):C.calculatedDuration;return os(D)},get speed(){return v},set speed(D){D===v||!I||(v=D,ee.time=os(U))},get state(){return k},play:Q,pause:()=>{k="paused",N=U},stop:()=>{g=!0,k!=="idle"&&(k="idle",d&&d(),te())},cancel:()=>{O!==null&&ne(O),te()},complete:()=>{k="finished"},sample:D=>(M=0,ne(D))};return ee}function bN(n){let e;return()=>(e===void 0&&(e=n()),e)}const wN=bN(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),IN=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),hu=10,AN=2e4,_N=(n,e)=>e.type==="spring"||n==="backgroundColor"||!Gw(e.ease);function RN(n,e,{onUpdate:t,onComplete:r,...s}){if(!(wN()&&IN.has(e)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,u,d=!1;const f=()=>{u=new Promise(A=>{l=A})};f();let{keyframes:h,duration:m=300,ease:v,times:g}=s;if(_N(e,s)){const A=ld({...s,repeat:0,delay:0});let R={done:!1,value:h[0]};const C=[];let F=0;for(;!R.done&&F<AN;)R=A.sample(F),C.push(R.value),F+=hu;g=void 0,h=C,m=F-hu,v="linear"}const x=FD(n.owner.current,e,h,{...s,duration:m,ease:v,times:g}),E=()=>{d=!1,x.cancel()},b=()=>{d=!0,lt.update(E),l(),f()};return x.onfinish=()=>{d||(n.set(BD(h,s)),r&&r(),b())},{then(A,R){return u.then(A,R)},attachTimeline(A){return x.timeline=A,x.onfinish=null,It},get time(){return os(x.currentTime||0)},set time(A){x.currentTime=ki(A)},get speed(){return x.playbackRate},set speed(A){x.playbackRate=A},get duration(){return os(m)},play:()=>{o||(x.play(),us(E))},pause:()=>x.pause(),stop:()=>{if(o=!0,x.playState==="idle")return;const{currentTime:A}=x;if(A){const R=ld({...s,autoplay:!1});n.setWithVelocity(R.sample(A-hu).value,R.sample(A).value,hu)}b()},complete:()=>{d||x.finish()},cancel:b}}function LN({keyframes:n,delay:e,onUpdate:t,onComplete:r}){const s=()=>(t&&t(n[n.length-1]),r&&r(),{time:0,speed:1,duration:0,play:It,pause:It,stop:It,then:i=>(i(),Promise.resolve()),cancel:It,complete:It});return e?ld({keyframes:[0,1],duration:0,delay:e,onComplete:s}):s()}const CN={type:"spring",stiffness:500,damping:25,restSpeed:10},kN=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),PN={type:"keyframes",duration:.8},DN={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},NN=(n,{keyframes:e})=>e.length>2?PN:Hi.has(n)?n.startsWith("scale")?kN(e[1]):CN:DN,Rm=(n,e)=>n==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Zs.test(e)||e==="0")&&!e.startsWith("url(")),ON=new Set(["brightness","contrast","saturate","opacity"]);function MN(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(Xd)||[];if(!r)return n;const s=t.replace(r,"");let i=ON.has(e)?1:0;return r!==t&&(i*=100),e+"("+i+s+")"}const FN=/([a-z-]*)\(.*?\)/g,Lm={...Zs,getAnimatableNone:n=>{const e=n.match(FN);return e?e.map(MN).join(" "):n}},BN={...Aw,color:nn,backgroundColor:nn,outlineColor:nn,fill:nn,stroke:nn,borderColor:nn,borderTopColor:nn,borderRightColor:nn,borderBottomColor:nn,borderLeftColor:nn,filter:Lm,WebkitFilter:Lm},n0=n=>BN[n];function h1(n,e){let t=n0(n);return t!==Lm&&(t=Zs),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const p1=n=>/^0[^.\s]+$/.test(n);function UN(n){if(typeof n=="number")return n===0;if(n!==null)return n==="none"||n==="0"||p1(n)}function $N(n,e,t,r){const s=Rm(e,t);let i;Array.isArray(t)?i=[...t]:i=[null,t];const o=r.from!==void 0?r.from:n.get();let l;const u=[];for(let d=0;d<i.length;d++)i[d]===null&&(i[d]=d===0?o:i[d-1]),UN(i[d])&&u.push(d),typeof i[d]=="string"&&i[d]!=="none"&&i[d]!=="0"&&(l=i[d]);if(s&&u.length&&l)for(let d=0;d<u.length;d++){const f=u[d];i[f]=h1(e,l)}return i}function jN({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:l,from:u,elapsed:d,...f}){return!!Object.keys(f).length}function r0(n,e){return n[e]||n.default||n}const VN={skipAnimations:!1},s0=(n,e,t,r={})=>s=>{const i=r0(r,n)||{},o=i.delay||r.delay||0;let{elapsed:l=0}=r;l=l-ki(o);const u=$N(e,n,t,i),d=u[0],f=u[u.length-1],h=Rm(n,d),m=Rm(n,f);let v={keyframes:u,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:g=>{e.set(g),i.onUpdate&&i.onUpdate(g)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(jN(i)||(v={...v,...NN(n,v)}),v.duration&&(v.duration=ki(v.duration)),v.repeatDelay&&(v.repeatDelay=ki(v.repeatDelay)),!h||!m||MD.current||i.type===!1||VN.skipAnimations)return LN(v);if(!r.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const g=RN(e,n,v);if(g)return g}return ld(v)};function cd(n){return!!(vn(n)&&n.add)}const m1=n=>/^\-?\d*\.?\d+$/.test(n);function i0(n,e){n.indexOf(e)===-1&&n.push(e)}function o0(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class a0{constructor(){this.subscriptions=[]}add(e){return i0(this.subscriptions,e),()=>o0(this.subscriptions,e)}notify(e,t,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,t,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const GN=n=>!isNaN(parseFloat(n));class HN{constructor(e,t={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,s=!0)=>{this.prev=this.current,this.current=r;const{delta:i,timestamp:o}=Yt;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,lt.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>lt.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=GN(this.current),this.owner=t.owner}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new a0);const r=this.events[e].add(t);return e==="change"?()=>{r(),lt.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?u1(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Fo(n,e){return new HN(n,e)}const g1=n=>e=>e.test(n),KN={test:n=>n==="auto",parse:n=>n},y1=[Ki,Ce,Cr,Us,JP,QP,KN],Ka=n=>y1.find(g1(n)),WN=[...y1,nn,Zs],zN=n=>WN.find(g1(n));function YN(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Fo(t))}function qN(n,e){const t=Jd(n,e);let{transitionEnd:r={},transition:s={},...i}=t?n.makeTargetAnimatable(t,!1):{};i={...i,...r};for(const o in i){const l=fD(i[o]);YN(n,o,l)}}function XN(n,e,t){var r,s;const i=Object.keys(e).filter(l=>!n.hasValue(l)),o=i.length;if(o)for(let l=0;l<o;l++){const u=i[l],d=e[u];let f=null;Array.isArray(d)&&(f=d[0]),f===null&&(f=(s=(r=t[u])!==null&&r!==void 0?r:n.readValue(u))!==null&&s!==void 0?s:e[u]),f!=null&&(typeof f=="string"&&(m1(f)||p1(f))?f=parseFloat(f):!zN(f)&&Zs.test(d)&&(f=h1(u,d)),n.addValue(u,Fo(f,{owner:n})),t[u]===void 0&&(t[u]=f),f!==null&&n.setBaseTarget(u,f))}}function QN(n,e){return e?(e[n]||e.default||e).from:void 0}function JN(n,e,t){const r={};for(const s in n){const i=QN(s,e);if(i!==void 0)r[s]=i;else{const o=t.getValue(s);o&&(r[s]=o.get())}}return r}function ZN({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function eO(n,e){const t=n.get();if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}else return t!==e}function v1(n,e,{delay:t=0,transitionOverride:r,type:s}={}){let{transition:i=n.getDefaultTransition(),transitionEnd:o,...l}=n.makeTargetAnimatable(e);const u=n.getValue("willChange");r&&(i=r);const d=[],f=s&&n.animationState&&n.animationState.getState()[s];for(const h in l){const m=n.getValue(h),v=l[h];if(!m||v===void 0||f&&ZN(f,h))continue;const g={delay:t,elapsed:0,...r0(i||{},h)};if(window.HandoffAppearAnimations){const b=n.getProps()[xw];if(b){const I=window.HandoffAppearAnimations(b,h,m,lt);I!==null&&(g.elapsed=I,g.isHandoff=!0)}}let x=!g.isHandoff&&!eO(m,v);if(g.type==="spring"&&(m.getVelocity()||g.velocity)&&(x=!1),m.animation&&(x=!1),x)continue;m.start(s0(h,m,v,n.shouldReduceMotion&&Hi.has(h)?{type:!1}:g));const E=m.animation;cd(u)&&(u.add(h),E.then(()=>u.remove(h))),d.push(E)}return o&&Promise.all(d).then(()=>{o&&qN(n,o)}),d}function Cm(n,e,t={}){const r=Jd(n,e,t.custom);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const i=r?()=>Promise.all(v1(n,r,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=s;return tO(n,e,d+u,f,h,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,d]=l==="beforeChildren"?[i,o]:[o,i];return u().then(()=>d())}else return Promise.all([i(),o(t.delay)])}function tO(n,e,t=0,r=0,s=1,i){const o=[],l=(n.variantChildren.size-1)*r,u=s===1?(d=0)=>d*r:(d=0)=>l-d*r;return Array.from(n.variantChildren).sort(nO).forEach((d,f)=>{d.notify("AnimationStart",e),o.push(Cm(d,e,{...i,delay:t+u(f)}).then(()=>d.notify("AnimationComplete",e)))}),Promise.all(o)}function nO(n,e){return n.sortNodePosition(e)}function rO(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>Cm(n,i,t));r=Promise.all(s)}else if(typeof e=="string")r=Cm(n,e,t);else{const s=typeof e=="function"?Jd(n,e,t.custom):e;r=Promise.all(v1(n,s,t))}return r.then(()=>n.notify("AnimationComplete",e))}const sO=[...Vg].reverse(),iO=Vg.length;function oO(n){return e=>Promise.all(e.map(({animation:t,options:r})=>rO(n,t,r)))}function aO(n){let e=oO(n);const t=cO();let r=!0;const s=(u,d)=>{const f=Jd(n,d);if(f){const{transition:h,transitionEnd:m,...v}=f;u={...u,...v,...m}}return u};function i(u){e=u(n)}function o(u,d){const f=n.getProps(),h=n.getVariantContext(!0)||{},m=[],v=new Set;let g={},x=1/0;for(let b=0;b<iO;b++){const I=sO[b],A=t[I],R=f[I]!==void 0?f[I]:h[I],C=hl(R),F=I===d?A.isActive:null;F===!1&&(x=b);let k=R===h[I]&&R!==f[I]&&C;if(k&&r&&n.manuallyAnimateOnMount&&(k=!1),A.protectedKeys={...g},!A.isActive&&F===null||!R&&!A.prevProp||Yd(R)||typeof R=="boolean")continue;let M=lO(A.prevProp,R)||I===d&&A.isActive&&!k&&C||b>x&&C,O=!1;const H=Array.isArray(R)?R:[R];let Z=H.reduce(s,{});F===!1&&(Z={});const{prevResolvedValues:se={}}=A,U={...se,...Z},ne=q=>{M=!0,v.has(q)&&(O=!0,v.delete(q)),A.needsAnimating[q]=!0};for(const q in U){const te=Z[q],G=se[q];if(g.hasOwnProperty(q))continue;let Q=!1;id(te)&&id(G)?Q=!jw(te,G):Q=te!==G,Q?te!==void 0?ne(q):v.add(q):te!==void 0&&v.has(q)?ne(q):A.protectedKeys[q]=!0}A.prevProp=R,A.prevResolvedValues=Z,A.isActive&&(g={...g,...Z}),r&&n.blockInitialAnimation&&(M=!1),M&&(!k||O)&&m.push(...H.map(q=>({animation:q,options:{type:I,...u}})))}if(v.size){const b={};v.forEach(I=>{const A=n.getBaseTarget(I);A!==void 0&&(b[I]=A)}),m.push({animation:b})}let E=!!m.length;return r&&(f.initial===!1||f.initial===f.animate)&&!n.manuallyAnimateOnMount&&(E=!1),r=!1,E?e(m):Promise.resolve()}function l(u,d,f){var h;if(t[u].isActive===d)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(v=>{var g;return(g=v.animationState)===null||g===void 0?void 0:g.setActive(u,d)}),t[u].isActive=d;const m=o(f,u);for(const v in t)t[v].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>t}}function lO(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!jw(e,n):!1}function vi(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function cO(){return{animate:vi(!0),whileInView:vi(),whileHover:vi(),whileTap:vi(),whileDrag:vi(),whileFocus:vi(),exit:vi()}}class uO extends ri{constructor(e){super(e),e.animationState||(e.animationState=aO(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),Yd(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){}}let dO=0;class fO extends ri{constructor(){super(...arguments),this.id=dO++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t,custom:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const hO={animation:{Feature:uO},exit:{Feature:fO}},bE=(n,e)=>Math.abs(n-e);function pO(n,e){const t=bE(n.x,e.x),r=bE(n.y,e.y);return Math.sqrt(t**2+r**2)}class x1{constructor(e,t,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=bp(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,v=pO(h.offset,{x:0,y:0})>=3;if(!m&&!v)return;const{point:g}=h,{timestamp:x}=Yt;this.history.push({...g,timestamp:x});const{onStart:E,onMove:b}=this.handlers;m||(E&&E(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,h)},this.handlePointerMove=(h,m)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=Tp(m,this.transformPagePoint),lt.update(this.updatePoint,!0)},this.handlePointerUp=(h,m)=>{this.end();const{onEnd:v,onSessionEnd:g,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=bp(h.type==="pointercancel"?this.lastMoveEventInfo:Tp(m,this.transformPagePoint),this.history);this.startEvent&&v&&v(h,E),g&&g(h,E)},!Mw(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=r,this.contextWindow=s||window;const o=Qd(e),l=Tp(o,this.transformPagePoint),{point:u}=l,{timestamp:d}=Yt;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=t;f&&f(e,bp(l,this.history)),this.removeListeners=zs(is(this.contextWindow,"pointermove",this.handlePointerMove),is(this.contextWindow,"pointerup",this.handlePointerUp),is(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),us(this.updatePoint)}}function Tp(n,e){return e?{point:e(n.point)}:n}function wE(n,e){return{x:n.x-e.x,y:n.y-e.y}}function bp({point:n},e){return{point:n,delta:wE(n,E1(e)),offset:wE(n,mO(e)),velocity:gO(e,.1)}}function mO(n){return n[0]}function E1(n){return n[n.length-1]}function gO(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const s=E1(n);for(;t>=0&&(r=n[t],!(s.timestamp-r.timestamp>ki(e)));)t--;if(!r)return{x:0,y:0};const i=os(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Nn(n){return n.max-n.min}function km(n,e=0,t=.01){return Math.abs(n-e)<=t}function IE(n,e,t,r=.5){n.origin=r,n.originPoint=yt(e.min,e.max,n.origin),n.scale=Nn(t)/Nn(e),(km(n.scale,1,1e-4)||isNaN(n.scale))&&(n.scale=1),n.translate=yt(t.min,t.max,n.origin)-n.originPoint,(km(n.translate)||isNaN(n.translate))&&(n.translate=0)}function sl(n,e,t,r){IE(n.x,e.x,t.x,r?r.originX:void 0),IE(n.y,e.y,t.y,r?r.originY:void 0)}function AE(n,e,t){n.min=t.min+e.min,n.max=n.min+Nn(e)}function yO(n,e,t){AE(n.x,e.x,t.x),AE(n.y,e.y,t.y)}function _E(n,e,t){n.min=e.min-t.min,n.max=n.min+Nn(e)}function il(n,e,t){_E(n.x,e.x,t.x),_E(n.y,e.y,t.y)}function vO(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?yt(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?yt(t,n,r.max):Math.min(n,t)),n}function RE(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function xO(n,{top:e,left:t,bottom:r,right:s}){return{x:RE(n.x,t,s),y:RE(n.y,e,r)}}function LE(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function EO(n,e){return{x:LE(n.x,e.x),y:LE(n.y,e.y)}}function SO(n,e){let t=.5;const r=Nn(n),s=Nn(e);return s>r?t=ml(e.min,e.max-r,n.min):r>s&&(t=ml(n.min,n.max-s,e.min)),Js(0,1,t)}function TO(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const Pm=.35;function bO(n=Pm){return n===!1?n=0:n===!0&&(n=Pm),{x:CE(n,"left","right"),y:CE(n,"top","bottom")}}function CE(n,e,t){return{min:kE(n,e),max:kE(n,t)}}function kE(n,e){return typeof n=="number"?n:n[e]||0}const PE=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ao=()=>({x:PE(),y:PE()}),DE=()=>({min:0,max:0}),Rt=()=>({x:DE(),y:DE()});function Wn(n){return[n("x"),n("y")]}function S1({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function wO({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function IO(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function wp(n){return n===void 0||n===1}function Dm({scale:n,scaleX:e,scaleY:t}){return!wp(n)||!wp(e)||!wp(t)}function Si(n){return Dm(n)||T1(n)||n.z||n.rotate||n.rotateX||n.rotateY}function T1(n){return NE(n.x)||NE(n.y)}function NE(n){return n&&n!=="0%"}function ud(n,e,t){const r=n-t,s=e*r;return t+s}function OE(n,e,t,r,s){return s!==void 0&&(n=ud(n,s,r)),ud(n,t,r)+e}function Nm(n,e=0,t=1,r,s){n.min=OE(n.min,e,t,r,s),n.max=OE(n.max,e,t,r,s)}function b1(n,{x:e,y:t}){Nm(n.x,e.translate,e.scale,e.originPoint),Nm(n.y,t.translate,t.scale,t.originPoint)}function AO(n,e,t,r=!1){const s=t.length;if(!s)return;e.x=e.y=1;let i,o;for(let l=0;l<s;l++){i=t[l],o=i.projectionDelta;const u=i.instance;u&&u.style&&u.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&_o(n,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,b1(n,o)),r&&Si(i.latestValues)&&_o(n,i.latestValues))}e.x=ME(e.x),e.y=ME(e.y)}function ME(n){return Number.isInteger(n)||n>1.0000000000001||n<.999999999999?n:1}function $s(n,e){n.min=n.min+e,n.max=n.max+e}function FE(n,e,[t,r,s]){const i=e[s]!==void 0?e[s]:.5,o=yt(n.min,n.max,i);Nm(n,e[t],e[r],o,e.scale)}const _O=["x","scaleX","originX"],RO=["y","scaleY","originY"];function _o(n,e){FE(n.x,e,_O),FE(n.y,e,RO)}function w1(n,e){return S1(IO(n.getBoundingClientRect(),e))}function LO(n,e,t){const r=w1(n,t),{scroll:s}=e;return s&&($s(r.x,s.offset.x),$s(r.y,s.offset.y)),r}const I1=({current:n})=>n?n.ownerDocument.defaultView:null,CO=new WeakMap;class kO{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Rt(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Qd(f,"page").point)},i=(f,h)=>{const{drag:m,dragPropagation:v,onDragStart:g}=this.getProps();if(m&&!v&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=Bw(m),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Wn(E=>{let b=this.getAxisMotionValue(E).get()||0;if(Cr.test(b)){const{projection:I}=this.visualElement;if(I&&I.layout){const A=I.layout.layoutBox[E];A&&(b=Nn(A)*(parseFloat(b)/100))}}this.originPoint[E]=b}),g&&lt.update(()=>g(f,h),!1,!0);const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(f,h)=>{const{dragPropagation:m,dragDirectionLock:v,onDirectionLock:g,onDrag:x}=this.getProps();if(!m&&!this.openGlobalLock)return;const{offset:E}=h;if(v&&this.currentDirection===null){this.currentDirection=PO(E),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,E),this.updateAxis("y",h.point,E),this.visualElement.render(),x&&x(f,h)},l=(f,h)=>this.stop(f,h),u=()=>Wn(f=>{var h;return this.getAnimationState(f)==="paused"&&((h=this.getAxisMotionValue(f).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new x1(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:I1(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=t;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&lt.update(()=>i(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:s}=this.getProps();if(!r||!pu(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=vO(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;t&&wo(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=xO(s.layoutBox,t):this.constraints=!1,this.elastic=bO(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Wn(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=TO(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!wo(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=LO(r,s.root,this.visualElement.getTransformPagePoint());let o=EO(s.layout.layoutBox,i);if(t){const l=t(wO(o));this.hasMutatedConstraints=!!l,l&&(o=S1(l))}return o}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},d=Wn(f=>{if(!pu(f,t,this.currentDirection))return;let h=u&&u[f]||{};o&&(h={min:0,max:0});const m=s?200:1e6,v=s?40:1e7,g={type:"inertia",velocity:r?e[f]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(f,g)});return Promise.all(d).then(l)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return r.start(s0(e,r,0,t))}stopAnimation(){Wn(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Wn(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),s=r[t];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Wn(t=>{const{drag:r}=this.getProps();if(!pu(t,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(t);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[t];i.set(e[t]-yt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!wo(t)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Wn(o=>{const l=this.getAxisMotionValue(o);if(l){const u=l.get();s[o]=SO({min:u,max:u},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Wn(o=>{if(!pu(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];l.set(yt(u,d,s[o]))})}addListeners(){if(!this.visualElement.current)return;CO.set(this.visualElement,this);const e=this.visualElement.current,t=is(e,"pointerdown",u=>{const{drag:d,dragListener:f=!0}=this.getProps();d&&f&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();wo(u)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),r();const o=ts(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(Wn(f=>{const h=this.getAxisMotionValue(f);h&&(this.originPoint[f]+=u[f].translate,h.set(h.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=Pm,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function pu(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function PO(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class DO extends ri{constructor(e){super(e),this.removeGroupControls=It,this.removeListeners=It,this.controls=new kO(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||It}unmount(){this.removeGroupControls(),this.removeListeners()}}const BE=n=>(e,t)=>{n&&lt.update(()=>n(e,t))};class NO extends ri{constructor(){super(...arguments),this.removePointerDownListener=It}onPointerDown(e){this.session=new x1(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:I1(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:BE(e),onStart:BE(t),onMove:r,onEnd:(i,o)=>{delete this.session,s&&lt.update(()=>s(i,o))}}}mount(){this.removePointerDownListener=is(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function OO(){const n=P.useContext(Wd);if(n===null)return[!0,null];const{isPresent:e,onExitComplete:t,register:r}=n,s=P.useId();return P.useEffect(()=>r(s),[]),!e&&t?[!1,()=>t&&t(s)]:[!0]}const $u={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function UE(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Wa={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ce.test(n))n=parseFloat(n);else return n;const t=UE(n,e.target.x),r=UE(n,e.target.y);return`${t}% ${r}%`}},MO={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,s=Zs.parse(n);if(s.length>5)return r;const i=Zs.createTransformer(n),o=typeof s[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;s[0+o]/=l,s[1+o]/=u;const d=yt(l,u,.5);return typeof s[2+o]=="number"&&(s[2+o]/=d),typeof s[3+o]=="number"&&(s[3+o]/=d),i(s)}};class FO extends Cn.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;HP(BO),i&&(t.group&&t.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),$u.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:s,isPresent:i}=this.props,o=r.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||lt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function A1(n){const[e,t]=OO(),r=P.useContext(Hg);return Cn.createElement(FO,{...n,layoutGroup:r,switchLayoutGroup:P.useContext(Sw),isPresent:e,safeToRemove:t})}const BO={borderRadius:{...Wa,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Wa,borderTopRightRadius:Wa,borderBottomLeftRadius:Wa,borderBottomRightRadius:Wa,boxShadow:MO},_1=["TopLeft","TopRight","BottomLeft","BottomRight"],UO=_1.length,$E=n=>typeof n=="string"?parseFloat(n):n,jE=n=>typeof n=="number"||Ce.test(n);function $O(n,e,t,r,s,i){s?(n.opacity=yt(0,t.opacity!==void 0?t.opacity:1,jO(r)),n.opacityExit=yt(e.opacity!==void 0?e.opacity:1,0,VO(r))):i&&(n.opacity=yt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let o=0;o<UO;o++){const l=`border${_1[o]}Radius`;let u=VE(e,l),d=VE(t,l);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||jE(u)===jE(d)?(n[l]=Math.max(yt($E(u),$E(d),r),0),(Cr.test(d)||Cr.test(u))&&(n[l]+="%")):n[l]=d}(e.rotate||t.rotate)&&(n.rotate=yt(e.rotate||0,t.rotate||0,r))}function VE(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const jO=R1(0,.5,Xw),VO=R1(.5,.95,It);function R1(n,e,t){return r=>r<n?0:r>e?1:t(ml(n,e,r))}function GE(n,e){n.min=e.min,n.max=e.max}function Kn(n,e){GE(n.x,e.x),GE(n.y,e.y)}function HE(n,e,t,r,s){return n-=e,n=ud(n,1/t,r),s!==void 0&&(n=ud(n,1/s,r)),n}function GO(n,e=0,t=1,r=.5,s,i=n,o=n){if(Cr.test(e)&&(e=parseFloat(e),e=yt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=yt(i.min,i.max,r);n===i&&(l-=e),n.min=HE(n.min,e,t,l,s),n.max=HE(n.max,e,t,l,s)}function KE(n,e,[t,r,s],i,o){GO(n,e[t],e[r],e[s],e.scale,i,o)}const HO=["x","scaleX","originX"],KO=["y","scaleY","originY"];function WE(n,e,t,r){KE(n.x,e,HO,t?t.x:void 0,r?r.x:void 0),KE(n.y,e,KO,t?t.y:void 0,r?r.y:void 0)}function zE(n){return n.translate===0&&n.scale===1}function L1(n){return zE(n.x)&&zE(n.y)}function WO(n,e){return n.x.min===e.x.min&&n.x.max===e.x.max&&n.y.min===e.y.min&&n.y.max===e.y.max}function C1(n,e){return Math.round(n.x.min)===Math.round(e.x.min)&&Math.round(n.x.max)===Math.round(e.x.max)&&Math.round(n.y.min)===Math.round(e.y.min)&&Math.round(n.y.max)===Math.round(e.y.max)}function YE(n){return Nn(n.x)/Nn(n.y)}class zO{constructor(){this.members=[]}add(e){i0(this.members,e),e.scheduleRender()}remove(e){if(o0(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(s=>e===s);if(t===0)return!1;let r;for(let s=t;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function qE(n,e,t){let r="";const s=n.x.translate/e.x,i=n.y.translate/e.y;if((s||i)&&(r=`translate3d(${s}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{rotate:u,rotateX:d,rotateY:f}=t;u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),f&&(r+=`rotateY(${f}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const YO=(n,e)=>n.depth-e.depth;class qO{constructor(){this.children=[],this.isDirty=!1}add(e){i0(this.children,e),this.isDirty=!0}remove(e){o0(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(YO),this.isDirty=!1,this.children.forEach(e)}}function XO(n,e){const t=performance.now(),r=({timestamp:s})=>{const i=s-t;i>=e&&(us(r),n(i-e))};return lt.read(r,!0),()=>us(r)}function QO(n){window.MotionDebug&&window.MotionDebug.record(n)}function JO(n){return n instanceof SVGElement&&n.tagName!=="svg"}function ZO(n,e,t){const r=vn(n)?n:Fo(n);return r.start(s0("",r,e,t)),r.animation}const XE=["","X","Y","Z"],e2={visibility:"hidden"},QE=1e3;let t2=0;const Ti={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function k1({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},l=e?.()){this.id=t2++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Ti.totalNodes=Ti.resolvedTargetDeltas=Ti.recalculatedProjection=0,this.nodes.forEach(s2),this.nodes.forEach(c2),this.nodes.forEach(u2),this.nodes.forEach(i2),QO(Ti)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new qO)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new a0),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=JO(o),this.instance=o;const{layoutId:u,layout:d,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||u)&&(this.isLayoutDirty=!0),n){let h;const m=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=XO(m,250),$u.hasAnimatedSinceResize&&($u.hasAnimatedSinceResize=!1,this.nodes.forEach(ZE))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||d)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:m,hasRelativeTargetChanged:v,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||f.getDefaultTransition()||m2,{onLayoutAnimationStart:E,onLayoutAnimationComplete:b}=f.getProps(),I=!this.targetLayout||!C1(this.targetLayout,g)||v,A=!m&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||A||m&&(I||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,A);const R={...r0(x,"layout"),onPlay:E,onComplete:b};(f.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R)}else m||ZE(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,us(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(d2),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const h=this.path[f];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(JE);return}this.isUpdating||this.nodes.forEach(a2),this.isUpdating=!1,this.nodes.forEach(l2),this.nodes.forEach(n2),this.nodes.forEach(r2),this.clearAllSnapshots();const l=performance.now();Yt.delta=Js(0,1e3/60,l-Yt.timestamp),Yt.timestamp=l,Yt.isProcessing=!0,pp.update.process(Yt),pp.preRender.process(Yt),pp.render.process(Yt),Yt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(o2),this.sharedNodes.forEach(f2)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,lt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){lt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Rt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:r(this.instance),offset:t(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!L1(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,f=d!==this.prevTransformTemplateValue;o&&(l||Si(this.latestValues)||f)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),g2(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Rt();const l=o.measureViewportBox(),{scroll:u}=this.root;return u&&($s(l.x,u.offset.x),$s(l.y,u.offset.y)),l}removeElementScroll(o){const l=Rt();Kn(l,o);for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;if(d!==this.root&&f&&h.layoutScroll){if(f.isRoot){Kn(l,o);const{scroll:m}=this.root;m&&($s(l.x,-m.offset.x),$s(l.y,-m.offset.y))}$s(l.x,f.offset.x),$s(l.y,f.offset.y)}}return l}applyTransform(o,l=!1){const u=Rt();Kn(u,o);for(let d=0;d<this.path.length;d++){const f=this.path[d];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&_o(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Si(f.latestValues)&&_o(u,f.latestValues)}return Si(this.latestValues)&&_o(u,this.latestValues),u}removeTransform(o){const l=Rt();Kn(l,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Si(d.latestValues))continue;Dm(d.latestValues)&&d.updateSnapshot();const f=Rt(),h=d.measurePageBox();Kn(f,h),WE(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,f)}return Si(this.latestValues)&&WE(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Yt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==u;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:m}=this.options;if(!(!this.layout||!(h||m))){if(this.resolvedRelativeTargetAt=Yt.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Rt(),this.relativeTargetOrigin=Rt(),il(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),Kn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Rt(),this.targetWithTransforms=Rt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),yO(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Kn(this.target,this.layout.layoutBox),b1(this.target,this.targetDelta)):Kn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Rt(),this.relativeTargetOrigin=Rt(),il(this.relativeTargetOrigin,this.target,v.target),Kn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ti.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Dm(this.parent.latestValues)||T1(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(d=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Yt.timestamp&&(d=!1),d)return;const{layout:f,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||h))return;Kn(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,v=this.treeScale.y;AO(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:g}=l;if(!g){this.projectionTransform&&(this.projectionDelta=Ao(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Ao(),this.projectionDeltaWithTransform=Ao());const x=this.projectionTransform;sl(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=qE(this.projectionDelta,this.treeScale),(this.projectionTransform!==x||this.treeScale.x!==m||this.treeScale.y!==v)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),Ti.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const u=this.snapshot,d=u?u.latestValues:{},f={...this.latestValues},h=Ao();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=Rt(),v=u?u.source:void 0,g=this.layout?this.layout.source:void 0,x=v!==g,E=this.getStack(),b=!E||E.members.length<=1,I=!!(x&&!b&&this.options.crossfade===!0&&!this.path.some(p2));this.animationProgress=0;let A;this.mixTargetDelta=R=>{const C=R/1e3;eS(h.x,o.x,C),eS(h.y,o.y,C),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(il(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),h2(this.relativeTarget,this.relativeTargetOrigin,m,C),A&&WO(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=Rt()),Kn(A,this.relativeTarget)),x&&(this.animationValues=f,$O(f,d,this.latestValues,C,I,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(us(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=lt.update(()=>{$u.hasAnimatedSinceResize=!0,this.currentAnimation=ZO(0,QE,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(QE),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:d,latestValues:f}=o;if(!(!l||!u||!d)){if(this!==o&&this.layout&&d&&P1(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||Rt();const h=Nn(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+h;const m=Nn(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}Kn(l,u),_o(l,f),sl(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new zO),this.sharedNodes.get(o).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.rotate||u.rotateX||u.rotateY||u.rotateZ)&&(l=!0),!l)return;const d={};for(let f=0;f<XE.length;f++){const h="rotate"+XE[f];u[h]&&(d[h]=u[h],o.setStaticValue(h,0))}o.render();for(const f in d)o.setStaticValue(f,d[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return e2;const d={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=Uu(o?.pointerEvents)||"",d.transform=f?f(this.latestValues,""):"none",d;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=Uu(o?.pointerEvents)||""),this.hasProjected&&!Si(this.latestValues)&&(x.transform=f?f({},""):"none",this.hasProjected=!1),x}const m=h.animationValues||h.latestValues;this.applyTransformsToTarget(),d.transform=qE(this.projectionDeltaWithTransform,this.treeScale,m),f&&(d.transform=f(m,d.transform));const{x:v,y:g}=this.projectionDelta;d.transformOrigin=`${v.origin*100}% ${g.origin*100}% 0`,h.animationValues?d.opacity=h===this?(u=(l=m.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:d.opacity=h===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const x in rd){if(m[x]===void 0)continue;const{correct:E,applyTo:b}=rd[x],I=d.transform==="none"?m[x]:E(m[x],h);if(b){const A=b.length;for(let R=0;R<A;R++)d[b[R]]=I}else d[x]=I}return this.options.layoutId&&(d.pointerEvents=h===this?Uu(o?.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(JE),this.root.sharedNodes.clear()}}}function n2(n){n.updateLayout()}function r2(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=n.layout,{animationType:i}=n.options,o=t.source!==n.layout.source;i==="size"?Wn(h=>{const m=o?t.measuredBox[h]:t.layoutBox[h],v=Nn(m);m.min=r[h].min,m.max=m.min+v}):P1(i,t.layoutBox,r)&&Wn(h=>{const m=o?t.measuredBox[h]:t.layoutBox[h],v=Nn(r[h]);m.max=m.min+v,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+v)});const l=Ao();sl(l,r,t.layoutBox);const u=Ao();o?sl(u,n.applyTransform(s,!0),t.measuredBox):sl(u,r,t.layoutBox);const d=!L1(l);let f=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:m,layout:v}=h;if(m&&v){const g=Rt();il(g,t.layoutBox,m.layoutBox);const x=Rt();il(x,r,v.layoutBox),C1(g,x)||(f=!0),h.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=g,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function s2(n){Ti.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function i2(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function o2(n){n.clearSnapshot()}function JE(n){n.clearMeasurements()}function a2(n){n.isLayoutDirty=!1}function l2(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function ZE(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function c2(n){n.resolveTargetDelta()}function u2(n){n.calcProjection()}function d2(n){n.resetRotation()}function f2(n){n.removeLeadSnapshot()}function eS(n,e,t){n.translate=yt(e.translate,0,t),n.scale=yt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function tS(n,e,t,r){n.min=yt(e.min,t.min,r),n.max=yt(e.max,t.max,r)}function h2(n,e,t,r){tS(n.x,e.x,t.x,r),tS(n.y,e.y,t.y,r)}function p2(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const m2={duration:.45,ease:[.4,0,.1,1]},nS=n=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(n),rS=nS("applewebkit/")&&!nS("chrome/")?Math.round:It;function sS(n){n.min=rS(n.min),n.max=rS(n.max)}function g2(n){sS(n.x),sS(n.y)}function P1(n,e,t){return n==="position"||n==="preserve-aspect"&&!km(YE(e),YE(t),.2)}const y2=k1({attachResizeListener:(n,e)=>ts(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ip={current:void 0},D1=k1({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!Ip.current){const n=new y2({});n.mount(window),n.setOptions({layoutScroll:!0}),Ip.current=n}return Ip.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),v2={pan:{Feature:NO},drag:{Feature:DO,ProjectionNode:D1,MeasureLayout:A1}},x2=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function E2(n){const e=x2.exec(n);if(!e)return[,];const[,t,r]=e;return[t,r]}function Om(n,e,t=1){const[r,s]=E2(n);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return m1(o)?parseFloat(o):o}else return wm(s)?Om(s,e,t+1):s}function S2(n,{...e},t){const r=n.current;if(!(r instanceof Element))return{target:e,transitionEnd:t};t&&(t={...t}),n.values.forEach(s=>{const i=s.get();if(!wm(i))return;const o=Om(i,r);o&&s.set(o)});for(const s in e){const i=e[s];if(!wm(i))continue;const o=Om(i,r);o&&(e[s]=o,t||(t={}),t[s]===void 0&&(t[s]=i))}return{target:e,transitionEnd:t}}const T2=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),N1=n=>T2.has(n),b2=n=>Object.keys(n).some(N1),iS=n=>n===Ki||n===Ce,oS=(n,e)=>parseFloat(n.split(", ")[e]),aS=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/);if(s)return oS(s[1],e);{const i=r.match(/^matrix\((.+)\)$/);return i?oS(i[1],n):0}},w2=new Set(["x","y","z"]),I2=Ol.filter(n=>!w2.has(n));function A2(n){const e=[];return I2.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e.length&&n.render(),e}const Bo={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:aS(4,13),y:aS(5,14)};Bo.translateX=Bo.x;Bo.translateY=Bo.y;const _2=(n,e,t)=>{const r=e.measureViewportBox(),s=e.current,i=getComputedStyle(s),{display:o}=i,l={};o==="none"&&e.setStaticValue("display",n.display||"block"),t.forEach(d=>{l[d]=Bo[d](r,i)}),e.render();const u=e.measureViewportBox();return t.forEach(d=>{const f=e.getValue(d);f&&f.jump(l[d]),n[d]=Bo[d](u,i)}),n},R2=(n,e,t={},r={})=>{e={...e},r={...r};const s=Object.keys(e).filter(N1);let i=[],o=!1;const l=[];if(s.forEach(u=>{const d=n.getValue(u);if(!n.hasValue(u))return;let f=t[u],h=Ka(f);const m=e[u];let v;if(id(m)){const g=m.length,x=m[0]===null?1:0;f=m[x],h=Ka(f);for(let E=x;E<g&&m[E]!==null;E++)v?Jg(Ka(m[E])===v):v=Ka(m[E])}else v=Ka(m);if(h!==v)if(iS(h)&&iS(v)){const g=d.get();typeof g=="string"&&d.set(parseFloat(g)),typeof m=="string"?e[u]=parseFloat(m):Array.isArray(m)&&v===Ce&&(e[u]=m.map(parseFloat))}else h?.transform&&v?.transform&&(f===0||m===0)?f===0?d.set(v.transform(f)):e[u]=h.transform(m):(o||(i=A2(n),o=!0),l.push(u),r[u]=r[u]!==void 0?r[u]:e[u],d.jump(m))}),l.length){const u=l.indexOf("height")>=0?window.pageYOffset:null,d=_2(e,n,l);return i.length&&i.forEach(([f,h])=>{n.getValue(f).set(h)}),n.render(),zd&&u!==null&&window.scrollTo({top:u}),{target:d,transitionEnd:r}}else return{target:e,transitionEnd:r}};function L2(n,e,t,r){return b2(e)?R2(n,e,t,r):{target:e,transitionEnd:r}}const C2=(n,e,t,r)=>{const s=S2(n,e,r);return e=s.target,r=s.transitionEnd,L2(n,e,t,r)},Mm={current:null},O1={current:!1};function k2(){if(O1.current=!0,!!zd)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Mm.current=n.matches;n.addListener(e),e()}else Mm.current=!1}function P2(n,e,t){const{willChange:r}=e;for(const s in e){const i=e[s],o=t[s];if(vn(i))n.addValue(s,i),cd(r)&&r.add(s);else if(vn(o))n.addValue(s,Fo(i,{owner:n})),cd(r)&&r.remove(s);else if(o!==i)if(n.hasValue(s)){const l=n.getValue(s);!l.hasAnimated&&l.set(i)}else{const l=n.getStaticValue(s);n.addValue(s,Fo(l!==void 0?l:i,{owner:n}))}}for(const s in t)e[s]===void 0&&n.removeValue(s);return e}const lS=new WeakMap,M1=Object.keys(pl),D2=M1.length,cS=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],N2=Gg.length;class O2{constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:s,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>lt.render(this.render,!1,!0);const{latestValues:l,renderState:u}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=qd(t),this.isVariantNode=Ew(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(t,{});for(const h in f){const m=f[h];l[h]!==void 0&&vn(m)&&(m.set(l[h],!1),cd(d)&&d.add(h))}}scrapeMotionValuesFromProps(e,t){return{}}mount(e){this.current=e,lS.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),O1.current||k2(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Mm.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){lS.delete(this.current),this.projection&&this.projection.unmount(),us(this.notifyUpdate),us(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,t){const r=Hi.has(e),s=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&lt.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=t.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{s(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...t},r,s,i){let o,l;for(let u=0;u<D2;u++){const d=M1[u],{isEnabled:f,Feature:h,ProjectionNode:m,MeasureLayout:v}=pl[d];m&&(o=m),f(t)&&(!this.features[d]&&h&&(this.features[d]=new h(this)),v&&(l=v))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:u,layout:d,drag:f,dragConstraints:h,layoutScroll:m,layoutRoot:v}=t;this.projection.setOptions({layoutId:u,layout:d,alwaysMeasureLayout:!!f||h&&wo(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:i,layoutScroll:m,layoutRoot:v})}return l}updateFeatures(){for(const e in this.features){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Rt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}makeTargetAnimatable(e,t=!0){return this.makeTargetAnimatableFromInstance(e,this.props,t)}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<cS.length;r++){const s=cS[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=e["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=P2(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const t={};for(let r=0;r<N2;r++){const s=Gg[r],i=this.props[s];(hl(i)||i===!1)&&(t[s]=i)}return t}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){t!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,t)),this.values.set(e,t),this.latestValues[e]=t.get()}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Fo(t,{owner:this}),this.addValue(e,r)),r}readValue(e){var t;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(t=this.getBaseTargetFromProps(this.props,e))!==null&&t!==void 0?t:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props,s=typeof r=="string"||typeof r=="object"?(t=Qg(this.props,r))===null||t===void 0?void 0:t[e]:void 0;if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!vn(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new a0),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class F1 extends O2{sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:t,...r},{transformValues:s},i){let o=JN(r,e||{},this);if(s&&(t&&(t=s(t)),r&&(r=s(r)),o&&(o=s(o))),i){XN(this,r,o);const l=C2(this,r,o,t);t=l.transitionEnd,r=l.target}return{transition:e,transitionEnd:t,...r}}}function M2(n){return window.getComputedStyle(n)}class F2 extends F1{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,t){if(Hi.has(t)){const r=n0(t);return r&&r.default||0}else{const r=M2(e),s=(ww(t)?r.getPropertyValue(t):r[t])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:t}){return w1(e,t)}build(e,t,r,s){Wg(e,t,r,s.transformTemplate)}scrapeMotionValuesFromProps(e,t){return Xg(e,t)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;vn(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}renderInstance(e,t,r,s){Cw(e,t,r,s)}}class B2 extends F1{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Hi.has(t)){const r=n0(t);return r&&r.default||0}return t=kw.has(t)?t:jg(t),e.getAttribute(t)}measureInstanceViewportBox(){return Rt()}scrapeMotionValuesFromProps(e,t){return Dw(e,t)}build(e,t,r,s){Yg(e,t,r,this.isSVGTag,s.transformTemplate)}renderInstance(e,t,r,s){Pw(e,t,r,s)}mount(e){this.isSVGTag=qg(e.tagName),super.mount(e)}}const U2=(n,e)=>Kg(n)?new B2(e,{enableHardwareAcceleration:!1}):new F2(e,{enableHardwareAcceleration:!0}),$2={layout:{ProjectionNode:D1,MeasureLayout:A1}},j2={...hO,...DD,...v2,...$2},Ke=VP((n,e)=>ED(n,e,j2,U2));function B1(){const n=P.useRef(!1);return $g(()=>(n.current=!0,()=>{n.current=!1}),[]),n}function V2(){const n=B1(),[e,t]=P.useState(0),r=P.useCallback(()=>{n.current&&t(e+1)},[e]);return[P.useCallback(()=>lt.postRender(r),[r]),e]}class G2 extends P.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function H2({children:n,isPresent:e}){const t=P.useId(),r=P.useRef(null),s=P.useRef({width:0,height:0,top:0,left:0});return P.useInsertionEffect(()=>{const{width:i,height:o,top:l,left:u}=s.current;if(e||!r.current||!i||!o)return;r.current.dataset.motionPopId=t;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[e]),P.createElement(G2,{isPresent:e,childRef:r,sizeRef:s},P.cloneElement(n,{ref:r}))}const Ap=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o})=>{const l=Nw(K2),u=P.useId(),d=P.useMemo(()=>({id:u,initial:e,isPresent:t,custom:s,onExitComplete:f=>{l.set(f,!0);for(const h of l.values())if(!h)return;r&&r()},register:f=>(l.set(f,!1),()=>l.delete(f))}),i?void 0:[t]);return P.useMemo(()=>{l.forEach((f,h)=>l.set(h,!1))},[t]),P.useEffect(()=>{!t&&!l.size&&r&&r()},[t]),o==="popLayout"&&(n=P.createElement(H2,{isPresent:t},n)),P.createElement(Wd.Provider,{value:d},n)};function K2(){return new Map}function W2(n){return P.useEffect(()=>()=>n(),[])}const bi=n=>n.key||"";function z2(n,e){n.forEach(t=>{const r=bi(t);e.set(r,t)})}function Y2(n){const e=[];return P.Children.forEach(n,t=>{P.isValidElement(t)&&e.push(t)}),e}const Uo=({children:n,custom:e,initial:t=!0,onExitComplete:r,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const l=P.useContext(Hg).forceRender||V2()[0],u=B1(),d=Y2(n);let f=d;const h=P.useRef(new Map).current,m=P.useRef(f),v=P.useRef(new Map).current,g=P.useRef(!0);if($g(()=>{g.current=!1,z2(d,v),m.current=f}),W2(()=>{g.current=!0,v.clear(),h.clear()}),g.current)return P.createElement(P.Fragment,null,f.map(I=>P.createElement(Ap,{key:bi(I),isPresent:!0,initial:t?void 0:!1,presenceAffectsLayout:i,mode:o},I)));f=[...f];const x=m.current.map(bi),E=d.map(bi),b=x.length;for(let I=0;I<b;I++){const A=x[I];E.indexOf(A)===-1&&!h.has(A)&&h.set(A,void 0)}return o==="wait"&&h.size&&(f=[]),h.forEach((I,A)=>{if(E.indexOf(A)!==-1)return;const R=v.get(A);if(!R)return;const C=x.indexOf(A);let F=I;if(!F){const k=()=>{h.delete(A);const N=Array.from(v.keys()).filter(M=>!E.includes(M));if(N.forEach(M=>v.delete(M)),m.current=d.filter(M=>{const O=bi(M);return O===A||N.includes(O)}),!h.size){if(u.current===!1)return;l(),r&&r()}};F=P.createElement(Ap,{key:bi(R),isPresent:!1,onExitComplete:k,custom:e,presenceAffectsLayout:i,mode:o},R),h.set(A,F)}f.splice(C,0,F)}),f=f.map(I=>{const A=I.key;return h.has(A)?I:P.createElement(Ap,{key:bi(I),isPresent:!0,presenceAffectsLayout:i,mode:o},I)}),P.createElement(P.Fragment,null,h.size?f:f.map(I=>P.cloneElement(I)))};var U1={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},uS=Cn.createContext&&Cn.createContext(U1),Ys=function(){return Ys=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s])}return n},Ys.apply(this,arguments)},q2=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};function $1(n){return n&&n.map(function(e,t){return Cn.createElement(e.tag,Ys({key:t},e.attr),$1(e.child))})}function We(n){return function(e){return Cn.createElement(X2,Ys({attr:Ys({},n.attr)},e),$1(n.child))}}function X2(n){var e=function(t){var r=n.attr,s=n.size,i=n.title,o=q2(n,["attr","size","title"]),l=s||t.size||"1em",u;return t.className&&(u=t.className),n.className&&(u=(u?u+" ":"")+n.className),Cn.createElement("svg",Ys({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:u,style:Ys(Ys({color:n.color||t.color},t.style),n.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&Cn.createElement("title",null,i),n.children)};return uS!==void 0?Cn.createElement(uS.Consumer,null,function(t){return e(t)}):e(U1)}function Q2(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"}},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"}}]})(n)}function J2(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"}},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"}}]})(n)}function j1(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}},{tag:"path",attr:{d:"M13.73 21a2 2 0 0 1-3.46 0"}}]})(n)}function Z2(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"}},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"}}]})(n)}function dd(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"}}]})(n)}function eM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"}}]})(n)}function V1(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"}}]})(n)}function l0(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"polyline",attr:{points:"12 6 12 12 16 14"}}]})(n)}function G1(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"7 10 12 15 17 10"}},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"}}]})(n)}function tM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"}}]})(n)}function nM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}}]})(n)}function $o(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}},{tag:"line",attr:{x1:"7",y1:"2",x2:"7",y2:"22"}},{tag:"line",attr:{x1:"17",y1:"2",x2:"17",y2:"22"}},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"}},{tag:"line",attr:{x1:"2",y1:"7",x2:"7",y2:"7"}},{tag:"line",attr:{x1:"2",y1:"17",x2:"7",y2:"17"}},{tag:"line",attr:{x1:"17",y1:"17",x2:"22",y2:"17"}},{tag:"line",attr:{x1:"17",y1:"7",x2:"22",y2:"7"}}]})(n)}function H1(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"}}]})(n)}function K1(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"}}]})(n)}function rM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"}},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"}}]})(n)}function sM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"}}]})(n)}function W1(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}},{tag:"polyline",attr:{points:"16 17 21 12 16 7"}},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"}}]})(n)}function iM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}},{tag:"polyline",attr:{points:"22,6 12,13 2,6"}}]})(n)}function oM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"}}]})(n)}function aM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"}}]})(n)}function kn(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 3 19 12 5 21 5 3"}}]})(n)}function z1(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"}},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}}]})(n)}function fd(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"2"}},{tag:"path",attr:{d:"M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"}}]})(n)}function hd(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"}},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}}]})(n)}function lM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"2",x2:"11",y2:"13"}},{tag:"polygon",attr:{points:"22 2 15 22 11 13 2 9 22 2"}}]})(n)}function Y1(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"}}]})(n)}function cM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"5",r:"3"}},{tag:"circle",attr:{cx:"6",cy:"12",r:"3"}},{tag:"circle",attr:{cx:"18",cy:"19",r:"3"}},{tag:"line",attr:{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}},{tag:"line",attr:{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"}}]})(n)}function gl(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"}}]})(n)}function uM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"}}]})(n)}function dM(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"}}]})(n)}function pd(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"}},{tag:"polyline",attr:{points:"17 6 23 6 23 12"}}]})(n)}function Zd(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"15",rx:"2",ry:"2"}},{tag:"polyline",attr:{points:"17 2 12 7 7 2"}}]})(n)}function q1(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"}}]})(n)}function c0(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(n)}function dS(n){return We({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}}]})(n)}function X1(n,e){return function(){return n.apply(e,arguments)}}const{toString:fM}=Object.prototype,{getPrototypeOf:u0}=Object,{iterator:ef,toStringTag:Q1}=Symbol,tf=(n=>e=>{const t=fM.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),pr=n=>(n=n.toLowerCase(),e=>tf(e)===n),nf=n=>e=>typeof e===n,{isArray:qo}=Array,jo=nf("undefined");function Ul(n){return n!==null&&!jo(n)&&n.constructor!==null&&!jo(n.constructor)&&gn(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const J1=pr("ArrayBuffer");function hM(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&J1(n.buffer),e}const pM=nf("string"),gn=nf("function"),Z1=nf("number"),$l=n=>n!==null&&typeof n=="object",mM=n=>n===!0||n===!1,ju=n=>{if(tf(n)!=="object")return!1;const e=u0(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Q1 in n)&&!(ef in n)},gM=n=>{if(!$l(n)||Ul(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},yM=pr("Date"),vM=pr("File"),xM=pr("Blob"),EM=pr("FileList"),SM=n=>$l(n)&&gn(n.pipe),TM=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||gn(n.append)&&((e=tf(n))==="formdata"||e==="object"&&gn(n.toString)&&n.toString()==="[object FormData]"))},bM=pr("URLSearchParams"),[wM,IM,AM,_M]=["ReadableStream","Request","Response","Headers"].map(pr),RM=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function jl(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),qo(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{if(Ul(n))return;const i=t?Object.getOwnPropertyNames(n):Object.keys(n),o=i.length;let l;for(r=0;r<o;r++)l=i[r],e.call(null,n[l],l,n)}}function eI(n,e){if(Ul(n))return null;e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const Ri=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,tI=n=>!jo(n)&&n!==Ri;function Fm(){const{caseless:n,skipUndefined:e}=tI(this)&&this||{},t={},r=(s,i)=>{const o=n&&eI(t,i)||i;ju(t[o])&&ju(s)?t[o]=Fm(t[o],s):ju(s)?t[o]=Fm({},s):qo(s)?t[o]=s.slice():(!e||!jo(s))&&(t[o]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&jl(arguments[s],r);return t}const LM=(n,e,t,{allOwnKeys:r}={})=>(jl(e,(s,i)=>{t&&gn(s)?n[i]=X1(s,t):n[i]=s},{allOwnKeys:r}),n),CM=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),kM=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},PM=(n,e,t,r)=>{let s,i,o;const l={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),i=s.length;i-- >0;)o=s[i],(!r||r(o,n,e))&&!l[o]&&(e[o]=n[o],l[o]=!0);n=t!==!1&&u0(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},DM=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},NM=n=>{if(!n)return null;if(qo(n))return n;let e=n.length;if(!Z1(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},OM=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&u0(Uint8Array)),MM=(n,e)=>{const r=(n&&n[ef]).call(n);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(n,i[0],i[1])}},FM=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},BM=pr("HTMLFormElement"),UM=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),fS=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),$M=pr("RegExp"),nI=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};jl(t,(s,i)=>{let o;(o=e(s,i,n))!==!1&&(r[i]=o||s)}),Object.defineProperties(n,r)},jM=n=>{nI(n,(e,t)=>{if(gn(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(gn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},VM=(n,e)=>{const t={},r=s=>{s.forEach(i=>{t[i]=!0})};return qo(n)?r(n):r(String(n).split(e)),t},GM=()=>{},HM=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function KM(n){return!!(n&&gn(n.append)&&n[Q1]==="FormData"&&n[ef])}const WM=n=>{const e=new Array(10),t=(r,s)=>{if($l(r)){if(e.indexOf(r)>=0)return;if(Ul(r))return r;if(!("toJSON"in r)){e[s]=r;const i=qo(r)?[]:{};return jl(r,(o,l)=>{const u=t(o,s+1);!jo(u)&&(i[l]=u)}),e[s]=void 0,i}}return r};return t(n,0)},zM=pr("AsyncFunction"),YM=n=>n&&($l(n)||gn(n))&&gn(n.then)&&gn(n.catch),rI=((n,e)=>n?setImmediate:e?((t,r)=>(Ri.addEventListener("message",({source:s,data:i})=>{s===Ri&&i===t&&r.length&&r.shift()()},!1),s=>{r.push(s),Ri.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",gn(Ri.postMessage)),qM=typeof queueMicrotask<"u"?queueMicrotask.bind(Ri):typeof process<"u"&&process.nextTick||rI,XM=n=>n!=null&&gn(n[ef]),J={isArray:qo,isArrayBuffer:J1,isBuffer:Ul,isFormData:TM,isArrayBufferView:hM,isString:pM,isNumber:Z1,isBoolean:mM,isObject:$l,isPlainObject:ju,isEmptyObject:gM,isReadableStream:wM,isRequest:IM,isResponse:AM,isHeaders:_M,isUndefined:jo,isDate:yM,isFile:vM,isBlob:xM,isRegExp:$M,isFunction:gn,isStream:SM,isURLSearchParams:bM,isTypedArray:OM,isFileList:EM,forEach:jl,merge:Fm,extend:LM,trim:RM,stripBOM:CM,inherits:kM,toFlatObject:PM,kindOf:tf,kindOfTest:pr,endsWith:DM,toArray:NM,forEachEntry:MM,matchAll:FM,isHTMLForm:BM,hasOwnProperty:fS,hasOwnProp:fS,reduceDescriptors:nI,freezeMethods:jM,toObjectSet:VM,toCamelCase:UM,noop:GM,toFiniteNumber:HM,findKey:eI,global:Ri,isContextDefined:tI,isSpecCompliantForm:KM,toJSONObject:WM,isAsyncFn:zM,isThenable:YM,setImmediate:rI,asap:qM,isIterable:XM};function Be(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}J.inherits(Be,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:J.toJSONObject(this.config),code:this.code,status:this.status}}});const sI=Be.prototype,iI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{iI[n]={value:n}});Object.defineProperties(Be,iI);Object.defineProperty(sI,"isAxiosError",{value:!0});Be.from=(n,e,t,r,s,i)=>{const o=Object.create(sI);J.toFlatObject(n,o,function(f){return f!==Error.prototype},d=>d!=="isAxiosError");const l=n&&n.message?n.message:"Error",u=e==null&&n?n.code:e;return Be.call(o,l,u,t,r,s),n&&o.cause==null&&Object.defineProperty(o,"cause",{value:n,configurable:!0}),o.name=n&&n.name||"Error",i&&Object.assign(o,i),o};const QM=null;function Bm(n){return J.isPlainObject(n)||J.isArray(n)}function oI(n){return J.endsWith(n,"[]")?n.slice(0,-2):n}function hS(n,e,t){return n?n.concat(e).map(function(s,i){return s=oI(s),!t&&i?"["+s+"]":s}).join(t?".":""):e}function JM(n){return J.isArray(n)&&!n.some(Bm)}const ZM=J.toFlatObject(J,{},null,function(e){return/^is[A-Z]/.test(e)});function rf(n,e,t){if(!J.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=J.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,E){return!J.isUndefined(E[x])});const r=t.metaTokens,s=t.visitor||f,i=t.dots,o=t.indexes,u=(t.Blob||typeof Blob<"u"&&Blob)&&J.isSpecCompliantForm(e);if(!J.isFunction(s))throw new TypeError("visitor must be a function");function d(g){if(g===null)return"";if(J.isDate(g))return g.toISOString();if(J.isBoolean(g))return g.toString();if(!u&&J.isBlob(g))throw new Be("Blob is not supported. Use a Buffer instead.");return J.isArrayBuffer(g)||J.isTypedArray(g)?u&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function f(g,x,E){let b=g;if(g&&!E&&typeof g=="object"){if(J.endsWith(x,"{}"))x=r?x:x.slice(0,-2),g=JSON.stringify(g);else if(J.isArray(g)&&JM(g)||(J.isFileList(g)||J.endsWith(x,"[]"))&&(b=J.toArray(g)))return x=oI(x),b.forEach(function(A,R){!(J.isUndefined(A)||A===null)&&e.append(o===!0?hS([x],R,i):o===null?x:x+"[]",d(A))}),!1}return Bm(g)?!0:(e.append(hS(E,x,i),d(g)),!1)}const h=[],m=Object.assign(ZM,{defaultVisitor:f,convertValue:d,isVisitable:Bm});function v(g,x){if(!J.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+x.join("."));h.push(g),J.forEach(g,function(b,I){(!(J.isUndefined(b)||b===null)&&s.call(e,b,J.isString(I)?I.trim():I,x,m))===!0&&v(b,x?x.concat(I):[I])}),h.pop()}}if(!J.isObject(n))throw new TypeError("data must be an object");return v(n),e}function pS(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function d0(n,e){this._pairs=[],n&&rf(n,this,e)}const aI=d0.prototype;aI.append=function(e,t){this._pairs.push([e,t])};aI.toString=function(e){const t=e?function(r){return e.call(this,r,pS)}:pS;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function eF(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function lI(n,e,t){if(!e)return n;const r=t&&t.encode||eF;J.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let i;if(s?i=s(e,t):i=J.isURLSearchParams(e)?e.toString():new d0(e,t).toString(r),i){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+i}return n}class mS{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){J.forEach(this.handlers,function(r){r!==null&&e(r)})}}const cI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},tF=typeof URLSearchParams<"u"?URLSearchParams:d0,nF=typeof FormData<"u"?FormData:null,rF=typeof Blob<"u"?Blob:null,sF={isBrowser:!0,classes:{URLSearchParams:tF,FormData:nF,Blob:rF},protocols:["http","https","file","blob","url","data"]},f0=typeof window<"u"&&typeof document<"u",Um=typeof navigator=="object"&&navigator||void 0,iF=f0&&(!Um||["ReactNative","NativeScript","NS"].indexOf(Um.product)<0),oF=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",aF=f0&&window.location.href||"http://localhost",lF=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:f0,hasStandardBrowserEnv:iF,hasStandardBrowserWebWorkerEnv:oF,navigator:Um,origin:aF},Symbol.toStringTag,{value:"Module"})),Xt={...lF,...sF};function cF(n,e){return rf(n,new Xt.classes.URLSearchParams,{visitor:function(t,r,s,i){return Xt.isNode&&J.isBuffer(t)?(this.append(r,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function uF(n){return J.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function dF(n){const e={},t=Object.keys(n);let r;const s=t.length;let i;for(r=0;r<s;r++)i=t[r],e[i]=n[i];return e}function uI(n){function e(t,r,s,i){let o=t[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),u=i>=t.length;return o=!o&&J.isArray(s)?s.length:o,u?(J.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!l):((!s[o]||!J.isObject(s[o]))&&(s[o]=[]),e(t,r,s[o],i)&&J.isArray(s[o])&&(s[o]=dF(s[o])),!l)}if(J.isFormData(n)&&J.isFunction(n.entries)){const t={};return J.forEachEntry(n,(r,s)=>{e(uF(r),s,t,0)}),t}return null}function fF(n,e,t){if(J.isString(n))try{return(e||JSON.parse)(n),J.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Vl={transitional:cI,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,i=J.isObject(e);if(i&&J.isHTMLForm(e)&&(e=new FormData(e)),J.isFormData(e))return s?JSON.stringify(uI(e)):e;if(J.isArrayBuffer(e)||J.isBuffer(e)||J.isStream(e)||J.isFile(e)||J.isBlob(e)||J.isReadableStream(e))return e;if(J.isArrayBufferView(e))return e.buffer;if(J.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return cF(e,this.formSerializer).toString();if((l=J.isFileList(e))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return rf(l?{"files[]":e}:e,u&&new u,this.formSerializer)}}return i||s?(t.setContentType("application/json",!1),fF(e)):e}],transformResponse:[function(e){const t=this.transitional||Vl.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(J.isResponse(e)||J.isReadableStream(e))return e;if(e&&J.isString(e)&&(r&&!this.responseType||s)){const o=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Be.from(l,Be.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Xt.classes.FormData,Blob:Xt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};J.forEach(["delete","get","head","post","put","patch"],n=>{Vl.headers[n]={}});const hF=J.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),pF=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(o){s=o.indexOf(":"),t=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!t||e[t]&&hF[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},gS=Symbol("internals");function za(n){return n&&String(n).trim().toLowerCase()}function Vu(n){return n===!1||n==null?n:J.isArray(n)?n.map(Vu):String(n)}function mF(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const gF=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function _p(n,e,t,r,s){if(J.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!J.isString(e)){if(J.isString(r))return e.indexOf(r)!==-1;if(J.isRegExp(r))return r.test(e)}}function yF(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function vF(n,e){const t=J.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,i,o){return this[r].call(this,e,s,i,o)},configurable:!0})})}let yn=class{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function i(l,u,d){const f=za(u);if(!f)throw new Error("header name must be a non-empty string");const h=J.findKey(s,f);(!h||s[h]===void 0||d===!0||d===void 0&&s[h]!==!1)&&(s[h||u]=Vu(l))}const o=(l,u)=>J.forEach(l,(d,f)=>i(d,f,u));if(J.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(J.isString(e)&&(e=e.trim())&&!gF(e))o(pF(e),t);else if(J.isObject(e)&&J.isIterable(e)){let l={},u,d;for(const f of e){if(!J.isArray(f))throw TypeError("Object iterator must return a key-value pair");l[d=f[0]]=(u=l[d])?J.isArray(u)?[...u,f[1]]:[u,f[1]]:f[1]}o(l,t)}else e!=null&&i(t,e,r);return this}get(e,t){if(e=za(e),e){const r=J.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return mF(s);if(J.isFunction(t))return t.call(this,s,r);if(J.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=za(e),e){const r=J.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||_p(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function i(o){if(o=za(o),o){const l=J.findKey(r,o);l&&(!t||_p(r,r[l],l,t))&&(delete r[l],s=!0)}}return J.isArray(e)?e.forEach(i):i(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const i=t[r];(!e||_p(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const t=this,r={};return J.forEach(this,(s,i)=>{const o=J.findKey(r,i);if(o){t[o]=Vu(s),delete t[i];return}const l=e?yF(i):String(i).trim();l!==i&&delete t[i],t[l]=Vu(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return J.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&J.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[gS]=this[gS]={accessors:{}}).accessors,s=this.prototype;function i(o){const l=za(o);r[l]||(vF(s,o),r[l]=!0)}return J.isArray(e)?e.forEach(i):i(e),this}};yn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);J.reduceDescriptors(yn.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});J.freezeMethods(yn);function Rp(n,e){const t=this||Vl,r=e||t,s=yn.from(r.headers);let i=r.data;return J.forEach(n,function(l){i=l.call(t,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function dI(n){return!!(n&&n.__CANCEL__)}function Xo(n,e,t){Be.call(this,n??"canceled",Be.ERR_CANCELED,e,t),this.name="CanceledError"}J.inherits(Xo,Be,{__CANCEL__:!0});function fI(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new Be("Request failed with status code "+t.status,[Be.ERR_BAD_REQUEST,Be.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function xF(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function EF(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(u){const d=Date.now(),f=r[i];o||(o=d),t[s]=u,r[s]=d;let h=i,m=0;for(;h!==s;)m+=t[h++],h=h%n;if(s=(s+1)%n,s===i&&(i=(i+1)%n),d-o<e)return;const v=f&&d-f;return v?Math.round(m*1e3/v):void 0}}function SF(n,e){let t=0,r=1e3/e,s,i;const o=(d,f=Date.now())=>{t=f,s=null,i&&(clearTimeout(i),i=null),n(...d)};return[(...d)=>{const f=Date.now(),h=f-t;h>=r?o(d,f):(s=d,i||(i=setTimeout(()=>{i=null,o(s)},r-h)))},()=>s&&o(s)]}const md=(n,e,t=3)=>{let r=0;const s=EF(50,250);return SF(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,u=o-r,d=s(u),f=o<=l;r=o;const h={loaded:o,total:l,progress:l?o/l:void 0,bytes:u,rate:d||void 0,estimated:d&&l&&f?(l-o)/d:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};n(h)},t)},yS=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},vS=n=>(...e)=>J.asap(()=>n(...e)),TF=Xt.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,Xt.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(Xt.origin),Xt.navigator&&/(msie|trident)/i.test(Xt.navigator.userAgent)):()=>!0,bF=Xt.hasStandardBrowserEnv?{write(n,e,t,r,s,i){const o=[n+"="+encodeURIComponent(e)];J.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),J.isString(r)&&o.push("path="+r),J.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function wF(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function IF(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function hI(n,e,t){let r=!wF(e);return n&&(r||t==!1)?IF(n,e):e}const xS=n=>n instanceof yn?{...n}:n;function Ni(n,e){e=e||{};const t={};function r(d,f,h,m){return J.isPlainObject(d)&&J.isPlainObject(f)?J.merge.call({caseless:m},d,f):J.isPlainObject(f)?J.merge({},f):J.isArray(f)?f.slice():f}function s(d,f,h,m){if(J.isUndefined(f)){if(!J.isUndefined(d))return r(void 0,d,h,m)}else return r(d,f,h,m)}function i(d,f){if(!J.isUndefined(f))return r(void 0,f)}function o(d,f){if(J.isUndefined(f)){if(!J.isUndefined(d))return r(void 0,d)}else return r(void 0,f)}function l(d,f,h){if(h in e)return r(d,f);if(h in n)return r(void 0,d)}const u={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,f,h)=>s(xS(d),xS(f),h,!0)};return J.forEach(Object.keys({...n,...e}),function(f){const h=u[f]||s,m=h(n[f],e[f],f);J.isUndefined(m)&&h!==l||(t[f]=m)}),t}const pI=n=>{const e=Ni({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=e;if(e.headers=o=yn.from(o),e.url=lI(hI(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),J.isFormData(t)){if(Xt.hasStandardBrowserEnv||Xt.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(J.isFunction(t.getHeaders)){const u=t.getHeaders(),d=["content-type","content-length"];Object.entries(u).forEach(([f,h])=>{d.includes(f.toLowerCase())&&o.set(f,h)})}}if(Xt.hasStandardBrowserEnv&&(r&&J.isFunction(r)&&(r=r(e)),r||r!==!1&&TF(e.url))){const u=s&&i&&bF.read(i);u&&o.set(s,u)}return e},AF=typeof XMLHttpRequest<"u",_F=AF&&function(n){return new Promise(function(t,r){const s=pI(n);let i=s.data;const o=yn.from(s.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:d}=s,f,h,m,v,g;function x(){v&&v(),g&&g(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let E=new XMLHttpRequest;E.open(s.method.toUpperCase(),s.url,!0),E.timeout=s.timeout;function b(){if(!E)return;const A=yn.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),C={data:!l||l==="text"||l==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:A,config:n,request:E};fI(function(k){t(k),x()},function(k){r(k),x()},C),E=null}"onloadend"in E?E.onloadend=b:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(b)},E.onabort=function(){E&&(r(new Be("Request aborted",Be.ECONNABORTED,n,E)),E=null)},E.onerror=function(R){const C=R&&R.message?R.message:"Network Error",F=new Be(C,Be.ERR_NETWORK,n,E);F.event=R||null,r(F),E=null},E.ontimeout=function(){let R=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const C=s.transitional||cI;s.timeoutErrorMessage&&(R=s.timeoutErrorMessage),r(new Be(R,C.clarifyTimeoutError?Be.ETIMEDOUT:Be.ECONNABORTED,n,E)),E=null},i===void 0&&o.setContentType(null),"setRequestHeader"in E&&J.forEach(o.toJSON(),function(R,C){E.setRequestHeader(C,R)}),J.isUndefined(s.withCredentials)||(E.withCredentials=!!s.withCredentials),l&&l!=="json"&&(E.responseType=s.responseType),d&&([m,g]=md(d,!0),E.addEventListener("progress",m)),u&&E.upload&&([h,v]=md(u),E.upload.addEventListener("progress",h),E.upload.addEventListener("loadend",v)),(s.cancelToken||s.signal)&&(f=A=>{E&&(r(!A||A.type?new Xo(null,n,E):A),E.abort(),E=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const I=xF(s.url);if(I&&Xt.protocols.indexOf(I)===-1){r(new Be("Unsupported protocol "+I+":",Be.ERR_BAD_REQUEST,n));return}E.send(i||null)})},RF=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,s;const i=function(d){if(!s){s=!0,l();const f=d instanceof Error?d:this.reason;r.abort(f instanceof Be?f:new Xo(f instanceof Error?f.message:f))}};let o=e&&setTimeout(()=>{o=null,i(new Be(`timeout ${e} of ms exceeded`,Be.ETIMEDOUT))},e);const l=()=>{n&&(o&&clearTimeout(o),o=null,n.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),n=null)};n.forEach(d=>d.addEventListener("abort",i));const{signal:u}=r;return u.unsubscribe=()=>J.asap(l),u}},LF=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,s;for(;r<t;)s=r+e,yield n.slice(r,s),r=s},CF=async function*(n,e){for await(const t of kF(n))yield*LF(t,e)},kF=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},ES=(n,e,t,r)=>{const s=CF(n,e);let i=0,o,l=u=>{o||(o=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:d,value:f}=await s.next();if(d){l(),u.close();return}let h=f.byteLength;if(t){let m=i+=h;t(m)}u.enqueue(new Uint8Array(f))}catch(d){throw l(d),d}},cancel(u){return l(u),s.return()}},{highWaterMark:2})},SS=64*1024,{isFunction:mu}=J,PF=(({Request:n,Response:e})=>({Request:n,Response:e}))(J.global),{ReadableStream:TS,TextEncoder:bS}=J.global,wS=(n,...e)=>{try{return!!n(...e)}catch{return!1}},DF=n=>{n=J.merge.call({skipUndefined:!0},PF,n);const{fetch:e,Request:t,Response:r}=n,s=e?mu(e):typeof fetch=="function",i=mu(t),o=mu(r);if(!s)return!1;const l=s&&mu(TS),u=s&&(typeof bS=="function"?(g=>x=>g.encode(x))(new bS):async g=>new Uint8Array(await new t(g).arrayBuffer())),d=i&&l&&wS(()=>{let g=!1;const x=new t(Xt.origin,{body:new TS,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!x}),f=o&&l&&wS(()=>J.isReadableStream(new r("").body)),h={stream:f&&(g=>g.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!h[g]&&(h[g]=(x,E)=>{let b=x&&x[g];if(b)return b.call(x);throw new Be(`Response type '${g}' is not supported`,Be.ERR_NOT_SUPPORT,E)})});const m=async g=>{if(g==null)return 0;if(J.isBlob(g))return g.size;if(J.isSpecCompliantForm(g))return(await new t(Xt.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(J.isArrayBufferView(g)||J.isArrayBuffer(g))return g.byteLength;if(J.isURLSearchParams(g)&&(g=g+""),J.isString(g))return(await u(g)).byteLength},v=async(g,x)=>{const E=J.toFiniteNumber(g.getContentLength());return E??m(x)};return async g=>{let{url:x,method:E,data:b,signal:I,cancelToken:A,timeout:R,onDownloadProgress:C,onUploadProgress:F,responseType:k,headers:N,withCredentials:M="same-origin",fetchOptions:O}=pI(g),H=e||fetch;k=k?(k+"").toLowerCase():"text";let Z=RF([I,A&&A.toAbortSignal()],R),se=null;const U=Z&&Z.unsubscribe&&(()=>{Z.unsubscribe()});let ne;try{if(F&&d&&E!=="get"&&E!=="head"&&(ne=await v(N,b))!==0){let D=new t(x,{method:"POST",body:b,duplex:"half"}),$;if(J.isFormData(b)&&($=D.headers.get("content-type"))&&N.setContentType($),D.body){const[ie,ce]=yS(ne,md(vS(F)));b=ES(D.body,SS,ie,ce)}}J.isString(M)||(M=M?"include":"omit");const q=i&&"credentials"in t.prototype,te={...O,signal:Z,method:E.toUpperCase(),headers:N.normalize().toJSON(),body:b,duplex:"half",credentials:q?M:void 0};se=i&&new t(x,te);let G=await(i?H(se,O):H(x,te));const Q=f&&(k==="stream"||k==="response");if(f&&(C||Q&&U)){const D={};["status","statusText","headers"].forEach(ue=>{D[ue]=G[ue]});const $=J.toFiniteNumber(G.headers.get("content-length")),[ie,ce]=C&&yS($,md(vS(C),!0))||[];G=new r(ES(G.body,SS,ie,()=>{ce&&ce(),U&&U()}),D)}k=k||"text";let ee=await h[J.findKey(h,k)||"text"](G,g);return!Q&&U&&U(),await new Promise((D,$)=>{fI(D,$,{data:ee,headers:yn.from(G.headers),status:G.status,statusText:G.statusText,config:g,request:se})})}catch(q){throw U&&U(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new Be("Network Error",Be.ERR_NETWORK,g,se),{cause:q.cause||q}):Be.from(q,q&&q.code,g,se)}}},NF=new Map,mI=n=>{let e=n?n.env:{};const{fetch:t,Request:r,Response:s}=e,i=[r,s,t];let o=i.length,l=o,u,d,f=NF;for(;l--;)u=i[l],d=f.get(u),d===void 0&&f.set(u,d=l?new Map:DF(e)),f=d;return d};mI();const $m={http:QM,xhr:_F,fetch:{get:mI}};J.forEach($m,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const IS=n=>`- ${n}`,OF=n=>J.isFunction(n)||n===null||n===!1,gI={getAdapter:(n,e)=>{n=J.isArray(n)?n:[n];const{length:t}=n;let r,s;const i={};for(let o=0;o<t;o++){r=n[o];let l;if(s=r,!OF(r)&&(s=$m[(l=String(r)).toLowerCase()],s===void 0))throw new Be(`Unknown adapter '${l}'`);if(s&&(J.isFunction(s)||(s=s.get(e))))break;i[l||"#"+o]=s}if(!s){const o=Object.entries(i).map(([u,d])=>`adapter ${u} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=t?o.length>1?`since :
`+o.map(IS).join(`
`):" "+IS(o[0]):"as no adapter specified";throw new Be("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return s},adapters:$m};function Lp(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Xo(null,n)}function AS(n){return Lp(n),n.headers=yn.from(n.headers),n.data=Rp.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),gI.getAdapter(n.adapter||Vl.adapter,n)(n).then(function(r){return Lp(n),r.data=Rp.call(n,n.transformResponse,r),r.headers=yn.from(r.headers),r},function(r){return dI(r)||(Lp(n),r&&r.response&&(r.response.data=Rp.call(n,n.transformResponse,r.response),r.response.headers=yn.from(r.response.headers))),Promise.reject(r)})}const yI="1.12.2",sf={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{sf[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const _S={};sf.transitional=function(e,t,r){function s(i,o){return"[Axios v"+yI+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,l)=>{if(e===!1)throw new Be(s(o," has been removed"+(t?" in "+t:"")),Be.ERR_DEPRECATED);return t&&!_S[o]&&(_S[o]=!0,console.warn(s(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,o,l):!0}};sf.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function MF(n,e,t){if(typeof n!="object")throw new Be("options must be an object",Be.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const i=r[s],o=e[i];if(o){const l=n[i],u=l===void 0||o(l,i,n);if(u!==!0)throw new Be("option "+i+" must be "+u,Be.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Be("Unknown option "+i,Be.ERR_BAD_OPTION)}}const Gu={assertOptions:MF,validators:sf},Sr=Gu.validators;let Pi=class{constructor(e){this.defaults=e||{},this.interceptors={request:new mS,response:new mS}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ni(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:i}=t;r!==void 0&&Gu.assertOptions(r,{silentJSONParsing:Sr.transitional(Sr.boolean),forcedJSONParsing:Sr.transitional(Sr.boolean),clarifyTimeoutError:Sr.transitional(Sr.boolean)},!1),s!=null&&(J.isFunction(s)?t.paramsSerializer={serialize:s}:Gu.assertOptions(s,{encode:Sr.function,serialize:Sr.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Gu.assertOptions(t,{baseUrl:Sr.spelling("baseURL"),withXsrfToken:Sr.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&J.merge(i.common,i[t.method]);i&&J.forEach(["delete","get","head","post","put","patch","common"],g=>{delete i[g]}),t.headers=yn.concat(o,i);const l=[];let u=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(t)===!1||(u=u&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const d=[];this.interceptors.response.forEach(function(x){d.push(x.fulfilled,x.rejected)});let f,h=0,m;if(!u){const g=[AS.bind(this),void 0];for(g.unshift(...l),g.push(...d),m=g.length,f=Promise.resolve(t);h<m;)f=f.then(g[h++],g[h++]);return f}m=l.length;let v=t;for(;h<m;){const g=l[h++],x=l[h++];try{v=g(v)}catch(E){x.call(this,E);break}}try{f=AS.call(this,v)}catch(g){return Promise.reject(g)}for(h=0,m=d.length;h<m;)f=f.then(d[h++],d[h++]);return f}getUri(e){e=Ni(this.defaults,e);const t=hI(e.baseURL,e.url,e.allowAbsoluteUrls);return lI(t,e.params,e.paramsSerializer)}};J.forEach(["delete","get","head","options"],function(e){Pi.prototype[e]=function(t,r){return this.request(Ni(r||{},{method:e,url:t,data:(r||{}).data}))}});J.forEach(["post","put","patch"],function(e){function t(r){return function(i,o,l){return this.request(Ni(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Pi.prototype[e]=t(),Pi.prototype[e+"Form"]=t(!0)});let FF=class vI{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(l=>{r.subscribe(l),i=l}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},e(function(i,o,l){r.reason||(r.reason=new Xo(i,o,l),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new vI(function(s){e=s}),cancel:e}}};function BF(n){return function(t){return n.apply(null,t)}}function UF(n){return J.isObject(n)&&n.isAxiosError===!0}const jm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(jm).forEach(([n,e])=>{jm[e]=n});function xI(n){const e=new Pi(n),t=X1(Pi.prototype.request,e);return J.extend(t,Pi.prototype,e,{allOwnKeys:!0}),J.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return xI(Ni(n,s))},t}const Qe=xI(Vl);Qe.Axios=Pi;Qe.CanceledError=Xo;Qe.CancelToken=FF;Qe.isCancel=dI;Qe.VERSION=yI;Qe.toFormData=rf;Qe.AxiosError=Be;Qe.Cancel=Qe.CanceledError;Qe.all=function(e){return Promise.all(e)};Qe.spread=BF;Qe.isAxiosError=UF;Qe.mergeConfig=Ni;Qe.AxiosHeaders=yn;Qe.formToJSON=n=>uI(J.isHTMLForm(n)?new FormData(n):n);Qe.getAdapter=gI.getAdapter;Qe.HttpStatusCode=jm;Qe.default=Qe;const{Axios:iW,AxiosError:oW,CanceledError:aW,isCancel:lW,CancelToken:cW,VERSION:uW,all:dW,Cancel:fW,isAxiosError:hW,spread:pW,toFormData:mW,AxiosHeaders:gW,HttpStatusCode:yW,formToJSON:vW,getAdapter:xW,mergeConfig:EW}=Qe,nt={TMDB_API_KEY:"3ccf3bbfa9b25213ac74c50f96d238d0",TMDB_READ_TOKEN:"eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzY2NmM2JiZmE5YjI1MjEzYWM3NGM1MGY5NmQyMzhkMCIsIm5iZiI6MTczMjk3NDAwMy4wNjIsInN1YiI6IjY3NGIxNWIzMDExNzg1MWNkMDFjMjQ4OCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ._aQY-s2iBoSka9Sc7Iry4EpXgPjBWm__HSIvnrxNtZ4",TMDB_BASE_URL:"https://api.themoviedb.org/3",TMDB_IMAGE_BASE_URL:"https://image.tmdb.org/t/p"},$F=()=>{};var RS={};const EI=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},jF=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],l=n[t++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},SI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,l=o?n[s+1]:0,u=s+2<n.length,d=u?n[s+2]:0,f=i>>2,h=(i&3)<<4|l>>4;let m=(l&15)<<2|d>>6,v=d&63;u||(v=64,o||(m=64)),r.push(t[f],t[h],t[m],t[v])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(EI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):jF(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],l=s<n.length?t[n.charAt(s)]:0;++s;const d=s<n.length?t[n.charAt(s)]:64;++s;const h=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||l==null||d==null||h==null)throw new VF;const m=i<<2|l>>4;if(r.push(m),d!==64){const v=l<<4&240|d>>2;if(r.push(v),h!==64){const g=d<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class VF extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GF=function(n){const e=EI(n);return SI.encodeByteArray(e,!0)},TI=function(n){return GF(n).replace(/\./g,"")},bI=function(n){try{return SI.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function HF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const KF=()=>HF().__FIREBASE_DEFAULTS__,WF=()=>{if(typeof process>"u"||typeof RS>"u")return;const n=RS.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},zF=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&bI(n[1]);return e&&JSON.parse(e)},h0=()=>{try{return $F()||KF()||WF()||zF()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},YF=n=>h0()?.emulatorHosts?.[n],wI=()=>h0()?.config,II=n=>h0()?.[`_${n}`];class qF{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function of(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function XF(n){return(await fetch(n,{credentials:"include"})).ok}const ol={};function QF(){const n={prod:[],emulator:[]};for(const e of Object.keys(ol))ol[e]?n.emulator.push(e):n.prod.push(e);return n}function JF(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let LS=!1;function ZF(n,e){if(typeof window>"u"||typeof document>"u"||!of(window.location.host)||ol[n]===e||ol[n]||LS)return;ol[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=QF().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function l(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{LS=!0,o()},m}function f(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function h(){const m=JF(r),v=t("text"),g=document.getElementById(v)||document.createElement("span"),x=t("learnmore"),E=document.getElementById(x)||document.createElement("a"),b=t("preprendIcon"),I=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const A=m.element;l(A),f(E,x);const R=d();u(I,b),A.append(I,g,E,R),document.body.appendChild(A)}i?(g.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function on(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eB(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(on())}function tB(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function AI(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function nB(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rB(){const n=on();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function _I(){try{return typeof indexedDB=="object"}catch{return!1}}function RI(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}function sB(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const iB="FirebaseError";class Mr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=iB,Object.setPrototypeOf(this,Mr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wi.prototype.create)}}class Wi{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?oB(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Mr(s,l,r)}}function oB(n,e){return n.replace(aB,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const aB=/\{\$([^}]+)}/g;function lB(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Oi(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(CS(i)&&CS(o)){if(!Oi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function CS(n){return n!==null&&typeof n=="object"}function Gl(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Qa(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ja(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function cB(n,e){const t=new uB(n,e);return t.subscribe.bind(t)}class uB{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");dB(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Cp),s.error===void 0&&(s.error=Cp),s.complete===void 0&&(s.complete=Cp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dB(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Cp(){}const fB=1e3,hB=2,pB=14400*1e3,mB=.5;function kS(n,e=fB,t=hB){const r=e*Math.pow(t,n),s=Math.round(mB*r*(Math.random()-.5)*2);return Math.min(pB,r+s)}function Fn(n){return n&&n._delegate?n._delegate:n}class Dr{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const wi="[DEFAULT]";class gB{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new qF;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vB(e))try{this.getOrInitializeService({instanceIdentifier:wi})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=wi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wi){return this.instances.has(e)}getOptions(e=wi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:yB(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=wi){return this.component?this.component.multipleInstances?e:wi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yB(n){return n===wi?void 0:n}function vB(n){return n.instantiationMode==="EAGER"}class xB{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new gB(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var st;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(st||(st={}));const EB={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},SB=st.INFO,TB={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},bB=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=TB[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let p0=class{constructor(e){this.name=e,this._logLevel=SB,this._logHandler=bB,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in st))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?EB[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...e),this._logHandler(this,st.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...e),this._logHandler(this,st.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,st.INFO,...e),this._logHandler(this,st.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,st.WARN,...e),this._logHandler(this,st.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...e),this._logHandler(this,st.ERROR,...e)}};const wB=(n,e)=>e.some(t=>n instanceof t);let PS,DS;function IB(){return PS||(PS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function AB(){return DS||(DS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const LI=new WeakMap,Vm=new WeakMap,CI=new WeakMap,kp=new WeakMap,m0=new WeakMap;function _B(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(qs(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&LI.set(t,n)}).catch(()=>{}),m0.set(e,n),e}function RB(n){if(Vm.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Vm.set(n,e)}let Gm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Vm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||CI.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return qs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function LB(n){Gm=n(Gm)}function CB(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Pp(this),e,...t);return CI.set(r,e.sort?e.sort():[e]),qs(r)}:AB().includes(n)?function(...e){return n.apply(Pp(this),e),qs(LI.get(this))}:function(...e){return qs(n.apply(Pp(this),e))}}function kB(n){return typeof n=="function"?CB(n):(n instanceof IDBTransaction&&RB(n),wB(n,IB())?new Proxy(n,Gm):n)}function qs(n){if(n instanceof IDBRequest)return _B(n);if(kp.has(n))return kp.get(n);const e=kB(n);return e!==n&&(kp.set(n,e),m0.set(e,n)),e}const Pp=n=>m0.get(n);function kI(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),l=qs(o);return r&&o.addEventListener("upgradeneeded",u=>{r(qs(o.result),u.oldVersion,u.newVersion,qs(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const PB=["get","getKey","getAll","getAllKeys","count"],DB=["put","add","delete","clear"],Dp=new Map;function NS(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Dp.get(e))return Dp.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=DB.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||PB.includes(t)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[t](...l),s&&u.done]))[0]};return Dp.set(e,i),i}LB(n=>({...n,get:(e,t,r)=>NS(e,t)||n.get(e,t,r),has:(e,t)=>!!NS(e,t)||n.has(e,t)}));class NB{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(OB(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function OB(n){return n.getComponent()?.type==="VERSION"}const Hm="@firebase/app",OS="0.14.6";const ds=new p0("@firebase/app"),MB="@firebase/app-compat",FB="@firebase/analytics-compat",BB="@firebase/analytics",UB="@firebase/app-check-compat",$B="@firebase/app-check",jB="@firebase/auth",VB="@firebase/auth-compat",GB="@firebase/database",HB="@firebase/data-connect",KB="@firebase/database-compat",WB="@firebase/functions",zB="@firebase/functions-compat",YB="@firebase/installations",qB="@firebase/installations-compat",XB="@firebase/messaging",QB="@firebase/messaging-compat",JB="@firebase/performance",ZB="@firebase/performance-compat",eU="@firebase/remote-config",tU="@firebase/remote-config-compat",nU="@firebase/storage",rU="@firebase/storage-compat",sU="@firebase/firestore",iU="@firebase/ai",oU="@firebase/firestore-compat",aU="firebase",lU="12.6.0";const Km="[DEFAULT]",cU={[Hm]:"fire-core",[MB]:"fire-core-compat",[BB]:"fire-analytics",[FB]:"fire-analytics-compat",[$B]:"fire-app-check",[UB]:"fire-app-check-compat",[jB]:"fire-auth",[VB]:"fire-auth-compat",[GB]:"fire-rtdb",[HB]:"fire-data-connect",[KB]:"fire-rtdb-compat",[WB]:"fire-fn",[zB]:"fire-fn-compat",[YB]:"fire-iid",[qB]:"fire-iid-compat",[XB]:"fire-fcm",[QB]:"fire-fcm-compat",[JB]:"fire-perf",[ZB]:"fire-perf-compat",[eU]:"fire-rc",[tU]:"fire-rc-compat",[nU]:"fire-gcs",[rU]:"fire-gcs-compat",[sU]:"fire-fst",[oU]:"fire-fst-compat",[iU]:"fire-vertex","fire-js":"fire-js",[aU]:"fire-js-all"};const gd=new Map,uU=new Map,Wm=new Map;function MS(n,e){try{n.container.addComponent(e)}catch(t){ds.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function fs(n){const e=n.name;if(Wm.has(e))return ds.debug(`There were multiple attempts to register component ${e}.`),!1;Wm.set(e,n);for(const t of gd.values())MS(t,n);for(const t of uU.values())MS(t,n);return!0}function Qo(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function zn(n){return n==null?!1:n.settings!==void 0}const dU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xs=new Wi("app","Firebase",dU);class fU{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Dr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xs.create("app-deleted",{appName:this._name})}}const Hl=lU;function PI(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Km,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Xs.create("bad-app-name",{appName:String(s)});if(t||(t=wI()),!t)throw Xs.create("no-options");const i=gd.get(s);if(i){if(Oi(t,i.options)&&Oi(r,i.config))return i;throw Xs.create("duplicate-app",{appName:s})}const o=new xB(s);for(const u of Wm.values())o.addComponent(u);const l=new fU(t,r,o);return gd.set(s,l),l}function DI(n=Km){const e=gd.get(n);if(!e&&n===Km&&wI())return PI();if(!e)throw Xs.create("no-app",{appName:n});return e}function kr(n,e,t){let r=cU[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ds.warn(o.join(" "));return}fs(new Dr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const hU="firebase-heartbeat-database",pU=1,yl="firebase-heartbeat-store";let Np=null;function NI(){return Np||(Np=kI(hU,pU,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(yl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Xs.create("idb-open",{originalErrorMessage:n.message})})),Np}async function mU(n){try{const t=(await NI()).transaction(yl),r=await t.objectStore(yl).get(OI(n));return await t.done,r}catch(e){if(e instanceof Mr)ds.warn(e.message);else{const t=Xs.create("idb-get",{originalErrorMessage:e?.message});ds.warn(t.message)}}}async function FS(n,e){try{const r=(await NI()).transaction(yl,"readwrite");await r.objectStore(yl).put(e,OI(n)),await r.done}catch(t){if(t instanceof Mr)ds.warn(t.message);else{const r=Xs.create("idb-set",{originalErrorMessage:t?.message});ds.warn(r.message)}}}function OI(n){return`${n.name}!${n.options.appId}`}const gU=1024,yU=30;class vU{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new EU(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=BS();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>yU){const s=SU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ds.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=BS(),{heartbeatsToSend:t,unsentEntries:r}=xU(this._heartbeatsCache.heartbeats),s=TI(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return ds.warn(e),""}}}function BS(){return new Date().toISOString().substring(0,10)}function xU(n,e=gU){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),US(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),US(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class EU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _I()?RI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await mU(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return FS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return FS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function US(n){return TI(JSON.stringify({version:2,heartbeats:n})).length}function SU(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function TU(n){fs(new Dr("platform-logger",e=>new NB(e),"PRIVATE")),fs(new Dr("heartbeat",e=>new vU(e),"PRIVATE")),kr(Hm,OS,n),kr(Hm,OS,"esm2020"),kr("fire-js","")}TU("");function MI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const bU=MI,FI=new Wi("auth","Firebase",MI());const yd=new p0("@firebase/auth");function wU(n,...e){yd.logLevel<=st.WARN&&yd.warn(`Auth (${Hl}): ${n}`,...e)}function Hu(n,...e){yd.logLevel<=st.ERROR&&yd.error(`Auth (${Hl}): ${n}`,...e)}function Yn(n,...e){throw y0(n,...e)}function lr(n,...e){return y0(n,...e)}function g0(n,e,t){const r={...bU(),[e]:t};return new Wi("auth","Firebase",r).create(e,{appName:n.name})}function as(n){return g0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function IU(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Yn(n,"argument-error"),g0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function y0(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return FI.create(n,...e)}function ke(n,e,...t){if(!n)throw y0(e,...t)}function ns(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Hu(e),new Error(e)}function hs(n,e){n||ns(e)}function zm(){return typeof self<"u"&&self.location?.href||""}function AU(){return $S()==="http:"||$S()==="https:"}function $S(){return typeof self<"u"&&self.location?.protocol||null}function _U(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(AU()||AI()||"connection"in navigator)?navigator.onLine:!0}function RU(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Kl{constructor(e,t){this.shortDelay=e,this.longDelay=t,hs(t>e,"Short delay should be less than long delay!"),this.isMobile=eB()||nB()}get(){return _U()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function v0(n,e){hs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class BI{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ns("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ns("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ns("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const LU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const CU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],kU=new Kl(3e4,6e4);function ms(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Fr(n,e,t,r,s={}){return UI(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Gl({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...i};return tB()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&of(n.emulatorConfig.host)&&(d.credentials="include"),BI.fetch()(await $I(n,n.config.apiHost,t,l),d)})}async function UI(n,e,t){n._canInitEmulator=!1;const r={...LU,...e};try{const s=new DU(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw gu(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw gu(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw gu(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw gu(n,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw g0(n,f,d);Yn(n,f)}}catch(s){if(s instanceof Mr)throw s;Yn(n,"network-request-failed",{message:String(s)})}}async function Wl(n,e,t,r,s={}){const i=await Fr(n,e,t,r,s);return"mfaPendingCredential"in i&&Yn(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function $I(n,e,t,r){const s=`${e}${t}?${r}`,i=n,o=i.config.emulator?v0(n.config,s):`${n.config.apiScheme}://${s}`;return CU.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function PU(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class DU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(lr(this.auth,"network-request-failed")),kU.get())})}}function gu(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=lr(n,e,r);return s.customData._tokenResponse=t,s}function jS(n){return n!==void 0&&n.enterprise!==void 0}class NU{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return PU(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function OU(n,e){return Fr(n,"GET","/v2/recaptchaConfig",ms(n,e))}async function MU(n,e){return Fr(n,"POST","/v1/accounts:delete",e)}async function vd(n,e){return Fr(n,"POST","/v1/accounts:lookup",e)}function al(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function FU(n,e=!1){const t=Fn(n),r=await t.getIdToken(e),s=x0(r);ke(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:al(Op(s.auth_time)),issuedAtTime:al(Op(s.iat)),expirationTime:al(Op(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Op(n){return Number(n)*1e3}function x0(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Hu("JWT malformed, contained fewer than 3 sections"),null;try{const s=bI(t);return s?JSON.parse(s):(Hu("Failed to decode base64 JWT payload"),null)}catch(s){return Hu("Caught error parsing JWT payload as JSON",s?.toString()),null}}function VS(n){const e=x0(n);return ke(e,"internal-error"),ke(typeof e.exp<"u","internal-error"),ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Vo(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Mr&&BU(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function BU({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class UU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ym{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=al(this.lastLoginAt),this.creationTime=al(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function xd(n){const e=n.auth,t=await n.getIdToken(),r=await Vo(n,vd(e,{idToken:t}));ke(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?jI(s.providerUserInfo):[],o=jU(n.providerData,i),l=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!o?.length,d=l?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Ym(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function $U(n){const e=Fn(n);await xd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function jU(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function jI(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function VU(n,e){const t=await UI(n,{},async()=>{const r=Gl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=await $I(n,s,"/v1/token",`key=${i}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return n.emulatorConfig&&of(n.emulatorConfig.host)&&(u.credentials="include"),BI.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function GU(n,e){return Fr(n,"POST","/v2/accounts:revokeToken",ms(n,e))}class Lo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ke(e.idToken,"internal-error"),ke(typeof e.idToken<"u","internal-error"),ke(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):VS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ke(e.length!==0,"internal-error");const t=VS(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await VU(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Lo;return r&&(ke(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ke(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ke(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Lo,this.toJSON())}_performRefresh(){return ns("not implemented")}}function Ms(n,e){ke(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ar{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new UU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ym(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Vo(this,this.stsTokenManager.getToken(this.auth,e));return ke(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return FU(this,e)}reload(){return $U(this)}_assign(e){this!==e&&(ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ar({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await xd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zn(this.auth.app))return Promise.reject(as(this.auth));const e=await this.getIdToken();return await Vo(this,MU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:h,emailVerified:m,isAnonymous:v,providerData:g,stsTokenManager:x}=t;ke(h&&x,e,"internal-error");const E=Lo.fromJSON(this.name,x);ke(typeof h=="string",e,"internal-error"),Ms(r,e.name),Ms(s,e.name),ke(typeof m=="boolean",e,"internal-error"),ke(typeof v=="boolean",e,"internal-error"),Ms(i,e.name),Ms(o,e.name),Ms(l,e.name),Ms(u,e.name),Ms(d,e.name),Ms(f,e.name);const b=new ar({uid:h,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:i,tenantId:l,stsTokenManager:E,createdAt:d,lastLoginAt:f});return g&&Array.isArray(g)&&(b.providerData=g.map(I=>({...I}))),u&&(b._redirectEventId=u),b}static async _fromIdTokenResponse(e,t,r=!1){const s=new Lo;s.updateFromServerResponse(t);const i=new ar({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await xd(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ke(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?jI(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!i?.length,l=new Lo;l.updateFromIdToken(r);const u=new ar({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Ym(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(u,d),u}}const GS=new Map;function rs(n){hs(n instanceof Function,"Expected a class definition");let e=GS.get(n);return e?(hs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,GS.set(n,e),e)}class VI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}VI.type="NONE";const HS=VI;function Ku(n,e,t){return`firebase:${n}:${e}:${t}`}class Co{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ku(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ku("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await vd(this.auth,{idToken:e}).catch(()=>{});return t?ar._fromGetAccountInfoResponse(this.auth,t,e):null}return ar._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Co(rs(HS),e,r);const s=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||rs(HS);const o=Ku(r,e.config.apiKey,e.name);let l=null;for(const d of t)try{const f=await d._get(o);if(f){let h;if(typeof f=="string"){const m=await vd(e,{idToken:f}).catch(()=>{});if(!m)break;h=await ar._fromGetAccountInfoResponse(e,m,f)}else h=ar._fromJSON(e,f);d!==i&&(l=h),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Co(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(t.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Co(i,e,r))}}function KS(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(WI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(GI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(YI(e))return"Blackberry";if(qI(e))return"Webos";if(HI(e))return"Safari";if((e.includes("chrome/")||KI(e))&&!e.includes("edge/"))return"Chrome";if(zI(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function GI(n=on()){return/firefox\//i.test(n)}function HI(n=on()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function KI(n=on()){return/crios\//i.test(n)}function WI(n=on()){return/iemobile/i.test(n)}function zI(n=on()){return/android/i.test(n)}function YI(n=on()){return/blackberry/i.test(n)}function qI(n=on()){return/webos/i.test(n)}function E0(n=on()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function HU(n=on()){return E0(n)&&!!window.navigator?.standalone}function KU(){return rB()&&document.documentMode===10}function XI(n=on()){return E0(n)||zI(n)||qI(n)||YI(n)||/windows phone/i.test(n)||WI(n)}function QI(n,e=[]){let t;switch(n){case"Browser":t=KS(on());break;case"Worker":t=`${KS(on())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Hl}/${r}`}class WU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function zU(n,e={}){return Fr(n,"GET","/v2/passwordPolicy",ms(n,e))}const YU=6;class qU{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??YU,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class XU{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new WS(this),this.idTokenSubscription=new WS(this),this.beforeStateQueue=new WU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=FI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=rs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Co.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await vd(this,{idToken:e}),r=await ar._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(zn(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=r?._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===o)&&l?.user&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await xd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=RU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zn(this.app))return Promise.reject(as(this));const t=e?Fn(e):null;return t&&ke(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zn(this.app)?Promise.reject(as(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zn(this.app)?Promise.reject(as(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(rs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await zU(this),t=new qU(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Wi("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await GU(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&rs(e)||this._popupRedirectResolver;ke(t,this,"argument-error"),this.redirectPersistenceManager=await Co.create(this,[rs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=QI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(zn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&wU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function gs(n){return Fn(n)}class WS{constructor(e){this.auth=e,this.observer=null,this.addObserver=cB(t=>this.observer=t)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let af={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function QU(n){af=n}function JI(n){return af.loadJS(n)}function JU(){return af.recaptchaEnterpriseScript}function ZU(){return af.gapiScript}function e$(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class t${constructor(){this.enterprise=new n$}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class n${ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const r$="recaptcha-enterprise",ZI="NO_RECAPTCHA";class s${constructor(e){this.type=r$,this.auth=gs(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{OU(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new NU(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{l(u)})})}function s(i,o,l){const u=window.grecaptcha;jS(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(ZI)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new t$().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!t&&jS(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=JU();u.length!==0&&(u+=l),JI(u).then(()=>{s(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function zS(n,e,t,r=!1,s=!1){const i=new s$(n);let o;if(s)o=ZI;else try{o=await i.verify(t)}catch{o=await i.verify(t,!0)}const l={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,d=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Ed(n,e,t,r,s){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await zS(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await zS(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}function i$(n,e){const t=Qo(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Oi(i,e??{}))return s;Yn(s,"already-initialized")}return t.initialize({options:e})}function o$(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(rs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function a$(n,e,t){const r=gs(n);ke(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=eA(e),{host:o,port:l}=l$(e),u=l===null?"":`:${l}`,d={url:`${i}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ke(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ke(Oi(d,r.config.emulator)&&Oi(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,of(o)?(XF(`${i}//${o}${u}`),ZF("Auth",!0)):c$()}function eA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function l$(n){const e=eA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:YS(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:YS(o)}}}function YS(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function c$(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class S0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ns("not implemented")}_getIdTokenResponse(e){return ns("not implemented")}_linkToIdToken(e,t){return ns("not implemented")}_getReauthenticationResolver(e){return ns("not implemented")}}async function u$(n,e){return Fr(n,"POST","/v1/accounts:signUp",e)}async function d$(n,e){return Wl(n,"POST","/v1/accounts:signInWithPassword",ms(n,e))}async function f$(n,e){return Fr(n,"POST","/v1/accounts:sendOobCode",ms(n,e))}async function h$(n,e){return f$(n,e)}async function p$(n,e){return Wl(n,"POST","/v1/accounts:signInWithEmailLink",ms(n,e))}async function m$(n,e){return Wl(n,"POST","/v1/accounts:signInWithEmailLink",ms(n,e))}class vl extends S0{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new vl(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new vl(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ed(e,t,"signInWithPassword",d$);case"emailLink":return p$(e,{email:this._email,oobCode:this._password});default:Yn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ed(e,r,"signUpPassword",u$);case"emailLink":return m$(e,{idToken:t,email:this._email,oobCode:this._password});default:Yn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ko(n,e){return Wl(n,"POST","/v1/accounts:signInWithIdp",ms(n,e))}const g$="http://localhost";class Mi extends S0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Mi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Yn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const o=new Mi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return ko(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ko(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ko(e,t)}buildRequest(){const e={requestUri:g$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Gl(t)}return e}}function y$(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function v$(n){const e=Qa(Ja(n)).link,t=e?Qa(Ja(e)).deep_link_id:null,r=Qa(Ja(n)).deep_link_id;return(r?Qa(Ja(r)).link:null)||r||t||e||n}class T0{constructor(e){const t=Qa(Ja(e)),r=t.apiKey??null,s=t.oobCode??null,i=y$(t.mode??null);ke(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=v$(e);try{return new T0(t)}catch{return null}}}class Jo{constructor(){this.providerId=Jo.PROVIDER_ID}static credential(e,t){return vl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=T0.parseLink(t);return ke(r,"argument-error"),vl._fromEmailAndCode(e,r.code,r.tenantId)}}Jo.PROVIDER_ID="password";Jo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Jo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class b0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class zl extends b0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Gs extends zl{constructor(){super("facebook.com")}static credential(e){return Mi._fromParams({providerId:Gs.PROVIDER_ID,signInMethod:Gs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gs.credentialFromTaggedObject(e)}static credentialFromError(e){return Gs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gs.credential(e.oauthAccessToken)}catch{return null}}}Gs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gs.PROVIDER_ID="facebook.com";class Jr extends zl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Mi._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Jr.credential(t,r)}catch{return null}}}Jr.GOOGLE_SIGN_IN_METHOD="google.com";Jr.PROVIDER_ID="google.com";class Hs extends zl{constructor(){super("github.com")}static credential(e){return Mi._fromParams({providerId:Hs.PROVIDER_ID,signInMethod:Hs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hs.credentialFromTaggedObject(e)}static credentialFromError(e){return Hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hs.credential(e.oauthAccessToken)}catch{return null}}}Hs.GITHUB_SIGN_IN_METHOD="github.com";Hs.PROVIDER_ID="github.com";class Ks extends zl{constructor(){super("twitter.com")}static credential(e,t){return Mi._fromParams({providerId:Ks.PROVIDER_ID,signInMethod:Ks.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ks.credentialFromTaggedObject(e)}static credentialFromError(e){return Ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ks.credential(t,r)}catch{return null}}}Ks.TWITTER_SIGN_IN_METHOD="twitter.com";Ks.PROVIDER_ID="twitter.com";async function x$(n,e){return Wl(n,"POST","/v1/accounts:signUp",ms(n,e))}class Fi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await ar._fromIdTokenResponse(e,r,s),o=qS(r);return new Fi({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=qS(r);return new Fi({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function qS(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Sd extends Mr{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Sd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Sd(e,t,r,s)}}function tA(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Sd._fromErrorAndOperation(n,i,e,r):i})}async function E$(n,e,t=!1){const r=await Vo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Fi._forOperation(n,"link",r)}async function S$(n,e,t=!1){const{auth:r}=n;if(zn(r.app))return Promise.reject(as(r));const s="reauthenticate";try{const i=await Vo(n,tA(r,s,e,n),t);ke(i.idToken,r,"internal-error");const o=x0(i.idToken);ke(o,r,"internal-error");const{sub:l}=o;return ke(n.uid===l,r,"user-mismatch"),Fi._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&Yn(r,"user-mismatch"),i}}async function nA(n,e,t=!1){if(zn(n.app))return Promise.reject(as(n));const r="signIn",s=await tA(n,r,e),i=await Fi._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function T$(n,e){return nA(gs(n),e)}async function rA(n){const e=gs(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function b$(n,e,t){const r=gs(n);await Ed(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",h$)}async function w$(n,e,t){if(zn(n.app))return Promise.reject(as(n));const r=gs(n),o=await Ed(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",x$).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&rA(n),u}),l=await Fi._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function I$(n,e,t){return zn(n.app)?Promise.reject(as(n)):T$(Fn(n),Jo.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&rA(n),r})}async function A$(n,e){return Fr(n,"POST","/v1/accounts:update",e)}async function _$(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Fn(n),i={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Vo(r,A$(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const l=r.providerData.find(({providerId:u})=>u==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function R$(n,e,t,r){return Fn(n).onIdTokenChanged(e,t,r)}function L$(n,e,t){return Fn(n).beforeAuthStateChanged(e,t)}function C$(n,e,t,r){return Fn(n).onAuthStateChanged(e,t,r)}function k$(n){return Fn(n).signOut()}const Td="__sak";class sA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Td,"1"),this.storage.removeItem(Td),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const P$=1e3,D$=10;class iA extends sA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=XI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);KU()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,D$):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},P$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}iA.type="LOCAL";const N$=iA;class oA extends sA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}oA.type="SESSION";const aA=oA;function O$(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class lf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new lf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(t.origin,i)),u=await O$(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lf.receivers=[];function w0(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class M${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const d=w0("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const m=h;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Pr(){return window}function F$(n){Pr().location.href=n}function lA(){return typeof Pr().WorkerGlobalScope<"u"&&typeof Pr().importScripts=="function"}async function B$(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function U$(){return navigator?.serviceWorker?.controller||null}function $$(){return lA()?self:null}const cA="firebaseLocalStorageDb",j$=1,bd="firebaseLocalStorage",uA="fbase_key";class Yl{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function cf(n,e){return n.transaction([bd],e?"readwrite":"readonly").objectStore(bd)}function V$(){const n=indexedDB.deleteDatabase(cA);return new Yl(n).toPromise()}function qm(){const n=indexedDB.open(cA,j$);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(bd,{keyPath:uA})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(bd)?e(r):(r.close(),await V$(),e(await qm()))})})}async function XS(n,e,t){const r=cf(n,!0).put({[uA]:e,value:t});return new Yl(r).toPromise()}async function G$(n,e){const t=cf(n,!1).get(e),r=await new Yl(t).toPromise();return r===void 0?null:r.value}function QS(n,e){const t=cf(n,!0).delete(e);return new Yl(t).toPromise()}const H$=800,K$=3;class dA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qm(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>K$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return lA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lf._getInstance($$()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await B$(),!this.activeServiceWorker)return;this.sender=new M$(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||U$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await qm();return await XS(e,Td,"1"),await QS(e,Td),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>XS(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>G$(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>QS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=cf(s,!1).getAll();return new Yl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),H$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}dA.type="LOCAL";const W$=dA;new Kl(3e4,6e4);function fA(n,e){return e?rs(e):(ke(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class I0 extends S0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ko(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ko(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ko(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function z$(n){return nA(n.auth,new I0(n),n.bypassAuthState)}function Y$(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),S$(t,new I0(n),n.bypassAuthState)}async function q$(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),E$(t,new I0(n),n.bypassAuthState)}class hA{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return z$;case"linkViaPopup":case"linkViaRedirect":return q$;case"reauthViaPopup":case"reauthViaRedirect":return Y$;default:Yn(this.auth,"internal-error")}}resolve(e){hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const X$=new Kl(2e3,1e4);async function Q$(n,e,t){if(zn(n.app))return Promise.reject(lr(n,"operation-not-supported-in-this-environment"));const r=gs(n);IU(n,e,b0);const s=fA(r,t);return new Li(r,"signInViaPopup",e,s).executeNotNull()}class Li extends hA{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Li.currentPopupAction&&Li.currentPopupAction.cancel(),Li.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ke(e,this.auth,"internal-error"),e}async onExecution(){hs(this.filter.length===1,"Popup operations only handle one event");const e=w0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(lr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Li.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,X$.get())};e()}}Li.currentPopupAction=null;const J$="pendingRedirect",Wu=new Map;class Z$ extends hA{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Wu.get(this.auth._key());if(!e){try{const r=await e3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Wu.set(this.auth._key(),e)}return this.bypassAuthState||Wu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function e3(n,e){const t=r3(e),r=n3(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function t3(n,e){Wu.set(n._key(),e)}function n3(n){return rs(n._redirectPersistence)}function r3(n){return Ku(J$,n.config.apiKey,n.name)}async function s3(n,e,t=!1){if(zn(n.app))return Promise.reject(as(n));const r=gs(n),s=fA(r,e),o=await new Z$(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const i3=600*1e3;class o3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!a3(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!pA(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(lr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=i3&&this.cachedEventUids.clear(),this.cachedEventUids.has(JS(e))}saveEventToCache(e){this.cachedEventUids.add(JS(e)),this.lastProcessedEventTime=Date.now()}}function JS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function pA({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function a3(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pA(n);default:return!1}}async function l3(n,e={}){return Fr(n,"GET","/v1/projects",e)}const c3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,u3=/^https?/;async function d3(n){if(n.config.emulator)return;const{authorizedDomains:e}=await l3(n);for(const t of e)try{if(f3(t))return}catch{}Yn(n,"unauthorized-domain")}function f3(n){const e=zm(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!u3.test(t))return!1;if(c3.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const h3=new Kl(3e4,6e4);function ZS(){const n=Pr().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function p3(n){return new Promise((e,t)=>{function r(){ZS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ZS(),t(lr(n,"network-request-failed"))},timeout:h3.get()})}if(Pr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Pr().gapi?.load)r();else{const s=e$("iframefcb");return Pr()[s]=()=>{gapi.load?r():t(lr(n,"network-request-failed"))},JI(`${ZU()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw zu=null,e})}let zu=null;function m3(n){return zu=zu||p3(n),zu}const g3=new Kl(5e3,15e3),y3="__/auth/iframe",v3="emulator/auth/iframe",x3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},E3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function S3(n){const e=n.config;ke(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?v0(e,v3):`https://${n.config.authDomain}/${y3}`,r={apiKey:e.apiKey,appName:n.name,v:Hl},s=E3.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Gl(r).slice(1)}`}async function T3(n){const e=await m3(n),t=Pr().gapi;return ke(t,n,"internal-error"),e.open({where:document.body,url:S3(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:x3,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=lr(n,"network-request-failed"),l=Pr().setTimeout(()=>{i(o)},g3.get());function u(){Pr().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}const b3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},w3=500,I3=600,A3="_blank",_3="http://localhost";class eT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function R3(n,e,t,r=w3,s=I3){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u={...b3,width:r.toString(),height:s.toString(),top:i,left:o},d=on().toLowerCase();t&&(l=KI(d)?A3:t),GI(d)&&(e=e||_3,u.scrollbars="yes");const f=Object.entries(u).reduce((m,[v,g])=>`${m}${v}=${g},`,"");if(HU(d)&&l!=="_self")return L3(e||"",l),new eT(null);const h=window.open(e||"",l,f);ke(h,n,"popup-blocked");try{h.focus()}catch{}return new eT(h)}function L3(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const C3="__/auth/handler",k3="emulator/auth/handler",P3=encodeURIComponent("fac");async function tT(n,e,t,r,s,i){ke(n.config.authDomain,n,"auth-domain-config-required"),ke(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Hl,eventId:s};if(e instanceof b0){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",lB(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))o[f]=h}if(e instanceof zl){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),d=u?`#${P3}=${encodeURIComponent(u)}`:"";return`${D3(n)}?${Gl(l).slice(1)}${d}`}function D3({config:n}){return n.emulator?v0(n,k3):`https://${n.authDomain}/${C3}`}const Mp="webStorageSupport";class N3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=aA,this._completeRedirectFn=s3,this._overrideRedirectResult=t3}async _openPopup(e,t,r,s){hs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await tT(e,t,r,zm(),s);return R3(e,i,w0())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await tT(e,t,r,zm(),s);return F$(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(hs(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await T3(e),r=new o3(e);return t.register("authEvent",s=>(ke(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mp,{type:Mp},s=>{const i=s?.[0]?.[Mp];i!==void 0&&t(!!i),Yn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=d3(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return XI()||HI()||E0()}}const O3=N3;var nT="@firebase/auth",rT="1.11.1";class M3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function F3(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function B3(n){fs(new Dr("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ke(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:QI(n)},d=new XU(r,s,i,u);return o$(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),fs(new Dr("auth-internal",e=>{const t=gs(e.getProvider("auth").getImmediate());return(r=>new M3(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),kr(nT,rT,F3(n)),kr(nT,rT,"esm2020")}const U3=300,$3=II("authIdTokenMaxAge")||U3;let sT=null;const j3=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>$3)return;const s=t?.token;sT!==s&&(sT=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function V3(n=DI()){const e=Qo(n,"auth");if(e.isInitialized())return e.getImmediate();const t=i$(n,{popupRedirectResolver:O3,persistence:[W$,N$,aA]}),r=II("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=j3(i.toString());L$(t,o,()=>o(t.currentUser)),R$(t,l=>o(l))}}const s=YF("auth");return s&&a$(t,`http://${s}`),t}function G3(){return document.getElementsByTagName("head")?.[0]??document}QU({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=lr("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",G3().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});B3("Browser");var H3="firebase",K3="12.6.0";kr(H3,K3,"app");const mA="@firebase/installations",A0="0.6.19";const gA=1e4,yA=`w:${A0}`,vA="FIS_v2",W3="https://firebaseinstallations.googleapis.com/v1",z3=3600*1e3,Y3="installations",q3="Installations";const X3={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Bi=new Wi(Y3,q3,X3);function xA(n){return n instanceof Mr&&n.code.includes("request-failed")}function EA({projectId:n}){return`${W3}/projects/${n}/installations`}function SA(n){return{token:n.token,requestStatus:2,expiresIn:J3(n.expiresIn),creationTime:Date.now()}}async function TA(n,e){const r=(await e.json()).error;return Bi.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function bA({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function Q3(n,{refreshToken:e}){const t=bA(n);return t.append("Authorization",Z3(e)),t}async function wA(n){const e=await n();return e.status>=500&&e.status<600?n():e}function J3(n){return Number(n.replace("s","000"))}function Z3(n){return`${vA} ${n}`}async function ej({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=EA(n),s=bA(n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:t,authVersion:vA,appId:n.appId,sdkVersion:yA},l={method:"POST",headers:s,body:JSON.stringify(o)},u=await wA(()=>fetch(r,l));if(u.ok){const d=await u.json();return{fid:d.fid||t,registrationStatus:2,refreshToken:d.refreshToken,authToken:SA(d.authToken)}}else throw await TA("Create Installation",u)}function IA(n){return new Promise(e=>{setTimeout(e,n)})}function tj(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}const nj=/^[cdef][\w-]{21}$/,Xm="";function rj(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=sj(n);return nj.test(t)?t:Xm}catch{return Xm}}function sj(n){return tj(n).substr(0,22)}function uf(n){return`${n.appName}!${n.appId}`}const AA=new Map;function _A(n,e){const t=uf(n);RA(t,e),ij(t,e)}function RA(n,e){const t=AA.get(n);if(t)for(const r of t)r(e)}function ij(n,e){const t=oj();t&&t.postMessage({key:n,fid:e}),aj()}let Ci=null;function oj(){return!Ci&&"BroadcastChannel"in self&&(Ci=new BroadcastChannel("[Firebase] FID Change"),Ci.onmessage=n=>{RA(n.data.key,n.data.fid)}),Ci}function aj(){AA.size===0&&Ci&&(Ci.close(),Ci=null)}const lj="firebase-installations-database",cj=1,Ui="firebase-installations-store";let Fp=null;function _0(){return Fp||(Fp=kI(lj,cj,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Ui)}}})),Fp}async function wd(n,e){const t=uf(n),s=(await _0()).transaction(Ui,"readwrite"),i=s.objectStore(Ui),o=await i.get(t);return await i.put(e,t),await s.done,(!o||o.fid!==e.fid)&&_A(n,e.fid),e}async function LA(n){const e=uf(n),r=(await _0()).transaction(Ui,"readwrite");await r.objectStore(Ui).delete(e),await r.done}async function df(n,e){const t=uf(n),s=(await _0()).transaction(Ui,"readwrite"),i=s.objectStore(Ui),o=await i.get(t),l=e(o);return l===void 0?await i.delete(t):await i.put(l,t),await s.done,l&&(!o||o.fid!==l.fid)&&_A(n,l.fid),l}async function R0(n){let e;const t=await df(n.appConfig,r=>{const s=uj(r),i=dj(n,s);return e=i.registrationPromise,i.installationEntry});return t.fid===Xm?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function uj(n){const e=n||{fid:rj(),registrationStatus:0};return CA(e)}function dj(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Bi.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=fj(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:hj(n)}:{installationEntry:e}}async function fj(n,e){try{const t=await ej(n,e);return wd(n.appConfig,t)}catch(t){throw xA(t)&&t.customData.serverCode===409?await LA(n.appConfig):await wd(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function hj(n){let e=await iT(n.appConfig);for(;e.registrationStatus===1;)await IA(100),e=await iT(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await R0(n);return r||t}return e}function iT(n){return df(n,e=>{if(!e)throw Bi.create("installation-not-found");return CA(e)})}function CA(n){return pj(n)?{fid:n.fid,registrationStatus:0}:n}function pj(n){return n.registrationStatus===1&&n.registrationTime+gA<Date.now()}async function mj({appConfig:n,heartbeatServiceProvider:e},t){const r=gj(n,t),s=Q3(n,t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:yA,appId:n.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},u=await wA(()=>fetch(r,l));if(u.ok){const d=await u.json();return SA(d)}else throw await TA("Generate Auth Token",u)}function gj(n,{fid:e}){return`${EA(n)}/${e}/authTokens:generate`}async function L0(n,e=!1){let t;const r=await df(n.appConfig,i=>{if(!kA(i))throw Bi.create("not-registered");const o=i.authToken;if(!e&&xj(o))return i;if(o.requestStatus===1)return t=yj(n,e),i;{if(!navigator.onLine)throw Bi.create("app-offline");const l=Sj(i);return t=vj(n,l),l}});return t?await t:r.authToken}async function yj(n,e){let t=await oT(n.appConfig);for(;t.authToken.requestStatus===1;)await IA(100),t=await oT(n.appConfig);const r=t.authToken;return r.requestStatus===0?L0(n,e):r}function oT(n){return df(n,e=>{if(!kA(e))throw Bi.create("not-registered");const t=e.authToken;return Tj(t)?{...e,authToken:{requestStatus:0}}:e})}async function vj(n,e){try{const t=await mj(n,e),r={...e,authToken:t};return await wd(n.appConfig,r),t}catch(t){if(xA(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await LA(n.appConfig);else{const r={...e,authToken:{requestStatus:0}};await wd(n.appConfig,r)}throw t}}function kA(n){return n!==void 0&&n.registrationStatus===2}function xj(n){return n.requestStatus===2&&!Ej(n)}function Ej(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+z3}function Sj(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function Tj(n){return n.requestStatus===1&&n.requestTime+gA<Date.now()}async function bj(n){const e=n,{installationEntry:t,registrationPromise:r}=await R0(e);return r?r.catch(console.error):L0(e).catch(console.error),t.fid}async function wj(n,e=!1){const t=n;return await Ij(t),(await L0(t,e)).token}async function Ij(n){const{registrationPromise:e}=await R0(n);e&&await e}function Aj(n){if(!n||!n.options)throw Bp("App Configuration");if(!n.name)throw Bp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Bp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Bp(n){return Bi.create("missing-app-config-values",{valueName:n})}const PA="installations",_j="installations-internal",Rj=n=>{const e=n.getProvider("app").getImmediate(),t=Aj(e),r=Qo(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Lj=n=>{const e=n.getProvider("app").getImmediate(),t=Qo(e,PA).getImmediate();return{getId:()=>bj(t),getToken:s=>wj(t,s)}};function Cj(){fs(new Dr(PA,Rj,"PUBLIC")),fs(new Dr(_j,Lj,"PRIVATE"))}Cj();kr(mA,A0);kr(mA,A0,"esm2020");const Id="analytics",kj="firebase_id",Pj="origin",Dj=60*1e3,Nj="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",C0="https://www.googletagmanager.com/gtag/js";const sn=new p0("@firebase/analytics");const Oj={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Pn=new Wi("analytics","Analytics",Oj);function Mj(n){if(!n.startsWith(C0)){const e=Pn.create("invalid-gtag-resource",{gtagURL:n});return sn.warn(e.message),""}return n}function DA(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function Fj(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function Bj(n,e){const t=Fj("firebase-js-sdk-policy",{createScriptURL:Mj}),r=document.createElement("script"),s=`${C0}?l=${n}&id=${e}`;r.src=t?t?.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function Uj(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function $j(n,e,t,r,s,i){const o=r[s];try{if(o)await e[o];else{const u=(await DA(t)).find(d=>d.measurementId===s);u&&await e[u.appId]}}catch(l){sn.error(l)}n("config",s,i)}async function jj(n,e,t,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const l=await DA(t);for(const u of o){const d=l.find(h=>h.measurementId===u),f=d&&e[d.appId];if(f)i.push(f);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),n("event",r,s||{})}catch(i){sn.error(i)}}function Vj(n,e,t,r){async function s(i,...o){try{if(i==="event"){const[l,u]=o;await jj(n,e,t,l,u)}else if(i==="config"){const[l,u]=o;await $j(n,e,t,r,l,u)}else if(i==="consent"){const[l,u]=o;n("consent",l,u)}else if(i==="get"){const[l,u,d]=o;n("get",l,u,d)}else if(i==="set"){const[l]=o;n("set",l)}else n(i,...o)}catch(l){sn.error(l)}}return s}function Gj(n,e,t,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=Vj(i,n,e,t),{gtagCore:i,wrappedGtag:window[s]}}function Hj(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(C0)&&t.src.includes(n))return t;return null}const Kj=30,Wj=1e3;class zj{constructor(e={},t=Wj){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const NA=new zj;function Yj(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function qj(n){const{appId:e,apiKey:t}=n,r={method:"GET",headers:Yj(t)},s=Nj.replace("{app-id}",e),i=await fetch(s,r);if(i.status!==200&&i.status!==304){let o="";try{const l=await i.json();l.error?.message&&(o=l.error.message)}catch{}throw Pn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:o})}return i.json()}async function Xj(n,e=NA,t){const{appId:r,apiKey:s,measurementId:i}=n.options;if(!r)throw Pn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Pn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new Zj;return setTimeout(async()=>{l.abort()},Dj),OA({appId:r,apiKey:s,measurementId:i},o,l,e)}async function OA(n,{throttleEndTimeMillis:e,backoffCount:t},r,s=NA){const{appId:i,measurementId:o}=n;try{await Qj(r,e)}catch(l){if(o)return sn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l?.message}]`),{appId:i,measurementId:o};throw l}try{const l=await qj(n);return s.deleteThrottleMetadata(i),l}catch(l){const u=l;if(!Jj(u)){if(s.deleteThrottleMetadata(i),o)return sn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${u?.message}]`),{appId:i,measurementId:o};throw l}const d=Number(u?.customData?.httpStatus)===503?kS(t,s.intervalMillis,Kj):kS(t,s.intervalMillis),f={throttleEndTimeMillis:Date.now()+d,backoffCount:t+1};return s.setThrottleMetadata(i,f),sn.debug(`Calling attemptFetch again in ${d} millis`),OA(n,f,r,s)}}function Qj(n,e){return new Promise((t,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(i),r(Pn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Jj(n){if(!(n instanceof Mr)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class Zj{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function e4(n,e,t,r,s){if(s&&s.global){n("event",t,r);return}else{const i=await e,o={...r,send_to:i};n("event",t,o)}}async function t4(n,e,t,r){if(r&&r.global){const s={};for(const i of Object.keys(t))s[`user_properties.${i}`]=t[i];return n("set",s),Promise.resolve()}else{const s=await e;n("config",s,{update:!0,user_properties:t})}}async function n4(){if(_I())try{await RI()}catch(n){return sn.warn(Pn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return sn.warn(Pn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function r4(n,e,t,r,s,i,o){const l=Xj(n);l.then(m=>{t[m.measurementId]=m.appId,n.options.measurementId&&m.measurementId!==n.options.measurementId&&sn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>sn.error(m)),e.push(l);const u=n4().then(m=>{if(m)return r.getId()}),[d,f]=await Promise.all([l,u]);Hj(i)||Bj(i,d.measurementId),s("js",new Date);const h=o?.config??{};return h[Pj]="firebase",h.update=!0,f!=null&&(h[kj]=f),s("config",d.measurementId,h),d.measurementId}class s4{constructor(e){this.app=e}_delete(){return delete Po[this.app.options.appId],Promise.resolve()}}let Po={},aT=[];const lT={};let Up="dataLayer",i4="gtag",cT,k0,uT=!1;function o4(){const n=[];if(AI()&&n.push("This is a browser extension environment."),sB()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),t=Pn.create("invalid-analytics-context",{errorInfo:e});sn.warn(t.message)}}function a4(n,e,t){o4();const r=n.options.appId;if(!r)throw Pn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)sn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Pn.create("no-api-key");if(Po[r]!=null)throw Pn.create("already-exists",{id:r});if(!uT){Uj(Up);const{wrappedGtag:i,gtagCore:o}=Gj(Po,aT,lT,Up,i4);k0=i,cT=o,uT=!0}return Po[r]=r4(n,aT,lT,e,cT,Up,t),new s4(n)}function l4(n=DI()){n=Fn(n);const e=Qo(n,Id);return e.isInitialized()?e.getImmediate():c4(n)}function c4(n,e={}){const t=Qo(n,Id);if(t.isInitialized()){const s=t.getImmediate();if(Oi(e,t.getOptions()))return s;throw Pn.create("already-initialized")}return t.initialize({options:e})}function u4(n,e,t){n=Fn(n),t4(k0,Po[n.app.options.appId],e,t).catch(r=>sn.error(r))}function d4(n,e,t,r){n=Fn(n),e4(k0,Po[n.app.options.appId],e,t,r).catch(s=>sn.error(s))}const dT="@firebase/analytics",fT="0.10.19";function f4(){fs(new Dr(Id,(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return a4(r,s,t)},"PUBLIC")),fs(new Dr("analytics-internal",n,"PRIVATE")),kr(dT,fT),kr(dT,fT,"esm2020");function n(e){try{const t=e.getProvider(Id).getImmediate();return{logEvent:(r,s,i)=>d4(t,r,s,i),setUserProperties:(r,s)=>u4(t,r,s)}}catch(t){throw Pn.create("interop-component-reg-failed",{reason:t})}}}f4();const h4={apiKey:"AIzaSyCsZKuPmVud2n9397NBlUa6h0wxyhTyJlM",authDomain:"sanviplex.firebaseapp.com",projectId:"sanviplex",storageBucket:"sanviplex.firebasestorage.app",messagingSenderId:"77277700152",appId:"1:77277700152:web:474871d469afb365bf46cd",measurementId:"G-7RM2F7FP2V"},MA=PI(h4),yo=V3(MA);typeof window<"u"&&l4(MA);const FA=P.createContext(void 0),ql=()=>{const n=P.useContext(FA);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},p4=({children:n})=>{const[e,t]=P.useState(null),[r,s]=P.useState(!0);P.useEffect(()=>C$(yo,m=>{t(m),s(!1)}),[]);const f={user:e,loading:r,signup:async(h,m,v)=>{const g=await w$(yo,h,m);g.user&&await _$(g.user,{displayName:v})},login:async(h,m)=>{if(h==="orko"&&m==="owner"){t({uid:"owner-orko",email:"orko@sanvitv.com",displayName:"Orko",photoURL:"/orko.jpeg",emailVerified:!0,isAnonymous:!1,metadata:{},providerData:[],refreshToken:"",tenantId:null,delete:async()=>{},getIdToken:async()=>"",getIdTokenResult:async()=>({}),reload:async()=>{},toJSON:()=>({}),providerId:"owner-rank"}),localStorage.setItem("ownerRank","true");return}localStorage.removeItem("ownerRank"),await I$(yo,h,m)},logout:async()=>{localStorage.removeItem("ownerRank"),t(null),await k$(yo)},loginWithGoogle:async()=>{const h=new Jr;await Q$(yo,h)},resetPassword:async h=>{await b$(yo,h)}};return S.jsx(FA.Provider,{value:f,children:n})};function m4(n){return We({attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}},{tag:"path",attr:{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}},{tag:"path",attr:{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}},{tag:"path",attr:{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`}}]})(n)}const BA=({isOpen:n,onClose:e,initialMode:t="login"})=>{const[r,s]=P.useState(t),[i,o]=P.useState(""),[l,u]=P.useState(""),[d,f]=P.useState(""),[h,m]=P.useState(!1),[v,g]=P.useState(""),[x,E]=P.useState(!1),[b,I]=P.useState(!1),{signup:A,login:R,loginWithGoogle:C,resetPassword:F}=ql(),k=Qt(),N=async O=>{O.preventDefault(),g(""),E(!0);try{if(r==="signup"){if(!d.trim()){g("Please enter your name"),E(!1);return}await A(i,l,d)}else if(r==="login")i==="orko"&&l==="owner"?await R(i,l):await R(i,l);else if(r==="reset"){await F(i),I(!0),E(!1);return}e(),k("/")}catch(H){g(H.message||"An error occurred")}finally{E(!1)}},M=async()=>{g(""),E(!0);try{await C(),e(),k("/")}catch(O){g(O.message||"An error occurred")}finally{E(!1)}};return n?S.jsx(Uo,{children:S.jsx(Ke.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-[300] flex items-center justify-center p-4",onClick:e,children:S.jsxs(Ke.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:25},className:"relative w-full max-w-md",onClick:O=>O.stopPropagation(),children:[S.jsx("button",{onClick:e,className:"absolute -top-12 right-0 p-2 text-white/60 hover:text-white transition-colors",children:S.jsx(c0,{size:28})}),S.jsxs("div",{className:"bg-gradient-to-br from-neutral-900 to-black rounded-2xl p-8 shadow-2xl border border-white/10",children:[S.jsxs("div",{className:"text-center mb-8",children:[S.jsx("h1",{className:"text-4xl font-black text-red-600 mb-2",children:"SANVITV"}),S.jsxs("p",{className:"text-gray-400 text-sm",children:[r==="login"&&"Welcome back! Sign in to continue",r==="signup"&&"Create your account to get started",r==="reset"&&"Reset your password"]})]}),r==="reset"&&b?S.jsxs("div",{className:"text-center py-8",children:[S.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:S.jsx("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),S.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Check your email"}),S.jsxs("p",{className:"text-gray-400 mb-6",children:["We've sent a password reset link to ",i]}),S.jsx("button",{onClick:()=>{s("login"),I(!1)},className:"text-red-500 hover:text-red-400 font-semibold",children:"Back to login"})]}):S.jsxs("form",{onSubmit:N,className:"space-y-4",children:[r==="signup"&&S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Full Name"}),S.jsxs("div",{className:"relative",children:[S.jsx(q1,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),S.jsx("input",{type:"text",value:d,onChange:O=>f(O.target.value),className:"w-full pl-12 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-red-500 transition-colors",placeholder:"Enter your name",required:r==="signup"})]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:r==="login"?"Email or Username":"Email"}),S.jsxs("div",{className:"relative",children:[S.jsx(iM,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),S.jsx("input",{type:r==="login"?"text":"email",value:i,onChange:O=>o(O.target.value),className:"w-full pl-12 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-red-500 transition-colors",placeholder:r==="login"?"Enter email or username":"Enter your email",required:!0})]})]}),r!=="reset"&&S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),S.jsxs("div",{className:"relative",children:[S.jsx(sM,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),S.jsx("input",{type:h?"text":"password",value:l,onChange:O=>u(O.target.value),className:"w-full pl-12 pr-12 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-red-500 transition-colors",placeholder:"Enter your password",required:!0,minLength:6}),S.jsx("button",{type:"button",onClick:()=>m(!h),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white transition-colors",children:h?S.jsx(tM,{size:20}):S.jsx(nM,{size:20})})]}),r==="signup"&&S.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"At least 6 characters"})]}),v&&S.jsx("div",{className:"bg-red-500/10 border border-red-500/50 rounded-lg p-3",children:S.jsx("p",{className:"text-red-500 text-sm",children:v})}),r==="login"&&S.jsx("div",{className:"text-right",children:S.jsx("button",{type:"button",onClick:()=>s("reset"),className:"text-sm text-gray-400 hover:text-red-500 transition-colors",children:"Forgot password?"})}),S.jsx("button",{type:"submit",disabled:x,className:"w-full py-3 bg-red-600 hover:bg-red-700 disabled:bg-red-600/50 text-white font-bold rounded-xl transition-all transform hover:scale-[1.02] active:scale-[0.98] disabled:cursor-not-allowed",children:x?S.jsxs("div",{className:"flex items-center justify-center gap-2",children:[S.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Processing..."]}):S.jsxs(S.Fragment,{children:[r==="login"&&"Sign In",r==="signup"&&"Create Account",r==="reset"&&"Send Reset Link"]})}),r!=="reset"&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"relative py-4",children:[S.jsx("div",{className:"absolute inset-0 flex items-center",children:S.jsx("div",{className:"w-full border-t border-white/10"})}),S.jsx("div",{className:"relative flex justify-center text-sm",children:S.jsx("span",{className:"px-4 bg-gradient-to-br from-neutral-900 to-black text-gray-400",children:"Or continue with"})})]}),S.jsxs("button",{type:"button",onClick:M,disabled:x,className:"w-full py-3 bg-white hover:bg-gray-100 disabled:bg-gray-300 text-gray-900 font-semibold rounded-xl transition-all transform hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-3 disabled:cursor-not-allowed",children:[S.jsx(m4,{size:24}),"Continue with Google"]})]}),S.jsx("div",{className:"text-center pt-4",children:r==="login"?S.jsxs("p",{className:"text-gray-400",children:["Don't have an account?"," ",S.jsx("button",{type:"button",onClick:()=>{s("signup"),g("")},className:"text-red-500 hover:text-red-400 font-semibold transition-colors",children:"Sign up"})]}):r==="signup"?S.jsxs("p",{className:"text-gray-400",children:["Already have an account?"," ",S.jsx("button",{type:"button",onClick:()=>{s("login"),g("")},className:"text-red-500 hover:text-red-400 font-semibold transition-colors",children:"Sign in"})]}):S.jsx("button",{type:"button",onClick:()=>{s("login"),g(""),I(!1)},className:"text-red-500 hover:text-red-400 font-semibold transition-colors",children:"Back to login"})})]})]})]})})}):null},cr=Ke.div,hT=Ke.button,$p={name:"Orko Biswas",plan:"Developer"},UA=[{id:1,title:"New Episode Available",message:"Succession S4E10 is now streaming",time:"2m ago",type:"new",read:!1},{id:2,title:"Download Complete",message:"Oppenheimer (2023) is ready to watch",time:"1h ago",type:"download",read:!1},{id:3,title:"Watchlist Update",message:"Dune: Part Two is now available",time:"3h ago",type:"update",read:!0},{id:4,title:"Top Pick For You",message:"Based on your interest in Sci-Fi",time:"1d ago",type:"recommend",read:!0}],Qm=["Inception","The Bear","Stranger Things"],g4=()=>{const[n,e]=P.useState(0);return P.useEffect(()=>{const t=()=>e(window.pageYOffset);return window.addEventListener("scroll",t),t(),()=>window.removeEventListener("scroll",t)},[]),n},$A=(n,e)=>{const[t,r]=P.useState(n);return P.useEffect(()=>{const s=setTimeout(()=>r(n),e);return()=>clearTimeout(s)},[n,e]),t},y4=()=>{const n=Qt(),e=Mn(),t=()=>{e.pathname==="/"?window.location.reload():(n("/"),window.scrollTo({top:0,behavior:"smooth"}))};return S.jsx("div",{onClick:t,className:"flex items-center cursor-pointer select-none touch-target",children:S.jsx("div",{className:"relative",children:S.jsx("span",{className:"text-[18px] sm:text-[24px] md:text-[28px] font-black tracking-[-0.05em] leading-none",style:{fontFamily:"system-ui, -apple-system, sans-serif",fontStretch:"condensed",letterSpacing:"-0.02em"},children:S.jsx("span",{className:"text-[#E50914]",children:"SANVITV"})})})})},v4=()=>{const n=Qt(),e=Mn(),t=[{label:"Home",path:"/"},{label:"Movies",path:"/movies"},{label:"Series",path:"/series"},{label:"New & Popular",path:"/new-popular"},{label:"Live TV",path:"/live-tv",live:!0}];return S.jsx("nav",{className:"hidden md:flex items-center gap-1 lg:gap-2",children:t.map(r=>{const s=e.pathname===r.path;return S.jsxs("button",{onClick:()=>n(r.path),className:`relative px-2 lg:px-4 py-2 text-xs lg:text-sm font-medium rounded-lg transition-colors duration-300 ${s?"text-white":"text-neutral-400 hover:text-white"}`,children:[S.jsxs("span",{className:"flex items-center gap-1.5",children:[r.label,r.live&&S.jsxs("span",{className:"relative flex h-2 w-2",children:[S.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-75"}),S.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-red-600"})]})]}),s&&S.jsx(cr,{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-red-600",layoutId:"underline",transition:{type:"spring",stiffness:300,damping:30}})]},r.label)})})},x4=()=>{const n=Qt(),[e,t]=P.useState(""),[r,s]=P.useState(!1),[i,o]=P.useState([]),[l,u]=P.useState(!1),[d,f]=P.useState(()=>{const x=localStorage.getItem("searchHistory");return x?JSON.parse(x):Qm}),h=$A(e,500);P.useEffect(()=>{if(!h||h.trim().length<2){o([]),u(!1);return}(async()=>{u(!0);try{const b=(await Qe.get(`${nt.TMDB_BASE_URL}/search/multi?api_key=${nt.TMDB_API_KEY}&query=${encodeURIComponent(h)}&page=1`)).data.results.filter(I=>I.media_type==="movie"||I.media_type==="tv").slice(0,6);o(b)}catch(E){console.error("Search error:",E),o([])}finally{u(!1)}})()},[h]);const m=x=>{const E=x.title||x.name||"",b=[E,...d.filter(I=>I!==E)].slice(0,5);f(b),localStorage.setItem("searchHistory",JSON.stringify(b)),n(`/${x.media_type}/${x.id}`),t(""),s(!1)},v=x=>{t(x)},g=()=>{f([]),localStorage.removeItem("searchHistory")};return S.jsxs("div",{className:"relative hidden md:block",children:[S.jsxs(cr,{className:"relative flex items-center",animate:{width:r?260:180},transition:{type:"spring",stiffness:400,damping:30},children:[S.jsx(hd,{className:"absolute left-3 text-neutral-500 pointer-events-none",size:16}),S.jsx("input",{type:"text",placeholder:"Search...",value:e,onChange:x=>t(x.target.value),onFocus:()=>s(!0),onBlur:()=>setTimeout(()=>s(!1),200),className:"w-full h-9 pl-10 pr-3 bg-neutral-800/50 text-white text-sm placeholder-neutral-500 border border-transparent rounded-full transition-colors duration-300 focus:outline-none focus:border-neutral-600 focus:bg-neutral-800"})]}),S.jsx(Uo,{children:r&&(e.length>0||Qm.length>0)&&S.jsx(cr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute top-full left-0 mt-2 w-full max-w-[350px] bg-neutral-900/80 backdrop-blur-xl border border-neutral-700 rounded-xl shadow-2xl overflow-hidden",children:l?S.jsx("div",{className:"flex items-center justify-center p-6",children:S.jsx("div",{className:"w-6 h-6 border-2 border-red-600 border-t-transparent rounded-full animate-spin"})}):i.length>0?i.map(x=>S.jsxs("div",{onClick:()=>m(x),className:"flex items-center gap-3 p-3 hover:bg-neutral-800 cursor-pointer transition-colors",children:[x.poster_path?S.jsx("img",{src:`https://image.tmdb.org/t/p/w92${x.poster_path}`,alt:x.title||x.name,className:"w-10 h-14 object-cover rounded"}):S.jsx("div",{className:"w-10 h-14 bg-neutral-700 rounded flex items-center justify-center",children:x.media_type==="tv"?S.jsx(Zd,{className:"text-neutral-500"}):S.jsx($o,{className:"text-neutral-500"})}),S.jsxs("div",{className:"flex-1",children:[S.jsx("p",{className:"font-semibold text-white text-sm line-clamp-1",children:x.title||x.name}),S.jsxs("p",{className:"text-xs text-neutral-400",children:[x.media_type==="tv"?"TV Series":"Movie",x.release_date&&`  ${x.release_date.split("-")[0]}`]})]})]},x.id)):e.length>1?S.jsxs("p",{className:"text-center text-sm text-neutral-400 p-4",children:['No results for "',e,'"']}):S.jsxs("div",{className:"p-2",children:[S.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[S.jsx("h4",{className:"text-xs font-semibold text-neutral-500 uppercase",children:"Recent Searches"}),d.length>0&&S.jsx("button",{onClick:g,className:"text-xs text-neutral-500 hover:text-red-500 transition-colors",children:"Clear"})]}),d.length>0?d.map((x,E)=>S.jsxs("div",{onClick:()=>v(x),className:"flex items-center gap-3 p-3 hover:bg-neutral-800 rounded-md cursor-pointer text-sm text-neutral-200",children:[S.jsx(l0,{className:"text-neutral-500"}),S.jsx("span",{children:x})]},E)):S.jsx("p",{className:"text-center text-xs text-neutral-500 p-4",children:"No recent searches"})]})})})]})},jA=({children:n,onClose:e})=>{const t=P.useRef(null);return P.useEffect(()=>{const r=s=>{t.current&&!t.current.contains(s.target)&&e()};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[e]),S.jsx(cr,{ref:t,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{type:"spring",damping:25,stiffness:400},className:"absolute top-full right-0 mt-3 w-[calc(100vw-2rem)] max-w-[360px] sm:max-w-[400px] rounded-2xl overflow-hidden shadow-2xl z-[110]",style:{background:"rgba(10, 10, 10, 0.75)",backdropFilter:"blur(40px) saturate(180%)",WebkitBackdropFilter:"blur(40px) saturate(180%)",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 25px 70px rgba(0, 0, 0, 0.7), 0 10px 30px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:n})},E4=({onClose:n})=>{const[e,t]=P.useState(UA),r=i=>{t(o=>o.map(l=>l.id===i?{...l,read:!0}:l))},s=e.filter(i=>!i.read).length;return S.jsxs(jA,{onClose:n,children:[S.jsx("div",{className:"p-4 flex items-center justify-between border-b border-neutral-800/30",children:S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("h3",{className:"font-semibold text-white text-base",children:"Notifications"}),s>0&&S.jsx("span",{className:"px-2 py-0.5 bg-red-600 rounded-full text-[10px] font-bold text-white",children:s})]})}),S.jsx("div",{className:"max-h-[400px] overflow-y-auto scrollbar-thin scrollbar-thumb-red-900/30 scrollbar-track-transparent p-2",children:e.length>0?e.map((i,o)=>S.jsx(cr,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:o*.05,type:"spring",stiffness:300,damping:20},className:"group relative mb-2 last:mb-0",children:S.jsxs(Ke.div,{className:"p-3 rounded-lg cursor-pointer overflow-hidden relative",onClick:()=>r(i.id),whileHover:{scale:1.02},whileTap:{scale:.98},style:{background:"rgba(255, 255, 255, 0.03)",border:i.read?"1px solid rgba(255, 255, 255, 0.06)":"1px solid rgba(239, 68, 68, 0.3)"},children:[!i.read&&S.jsx(Ke.div,{className:"absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-red-500 to-red-600",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:o*.05+.2}}),S.jsx("div",{className:"flex items-start gap-3 relative z-10",children:S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[S.jsx("h4",{className:"font-medium text-white text-sm line-clamp-1 flex-1",children:i.title}),!i.read&&S.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full shadow-[0_0_8px_rgba(239,68,68,0.8)]"})]}),S.jsx("p",{className:"text-neutral-400 text-xs mb-1.5 line-clamp-1",children:i.message}),S.jsx("span",{className:"text-[10px] text-neutral-600",children:i.time})]})})]})},i.id)):S.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center",children:[S.jsx("div",{className:"w-14 h-14 rounded-full bg-neutral-900/50 flex items-center justify-center mb-3",children:S.jsx(j1,{className:"text-neutral-600",size:24})}),S.jsx("p",{className:"text-neutral-500 text-sm",children:"No notifications"})]})})]})},S4=({onClose:n})=>{const e=Qt(),{user:t,logout:r}=ql(),s=localStorage.getItem("ownerRank")==="true",i=[{icon:q1,label:"My Profile",path:"/profile"},{icon:H1,label:"Watchlist",path:"/watchlist"},{icon:G1,label:"Downloads",path:"/downloads"},{icon:Y1,label:"Settings",path:"/settings"}],o=u=>{e(u),n()},l=async()=>{try{await r(),n()}catch(u){console.error("Error signing out:",u)}};return S.jsxs(jA,{onClose:n,children:[S.jsxs("div",{className:"p-5 border-b border-neutral-800/30",children:[S.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[S.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden ring-2 ring-red-500/30 shadow-lg bg-red-600/20 flex items-center justify-center",children:t?.photoURL?S.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-full h-full object-cover"}):S.jsx("span",{className:"text-white font-bold text-lg",children:t?.displayName?.charAt(0).toUpperCase()||t?.email?.charAt(0).toUpperCase()||"U"})}),S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsx("h3",{className:"font-semibold text-white text-base line-clamp-1",children:t?.displayName||"User"}),S.jsx("p",{className:"text-neutral-500 text-xs line-clamp-1",children:t?.email})]})]}),s&&S.jsxs(Ke.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1},className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full",style:{background:"linear-gradient(135deg, rgba(234, 179, 8, 0.15), rgba(202, 138, 4, 0.1))",border:"1px solid rgba(234, 179, 8, 0.3)",boxShadow:"0 0 20px rgba(234, 179, 8, 0.2)"},children:[S.jsx(J2,{className:"text-yellow-500",size:14}),S.jsx("span",{className:"text-yellow-500 text-xs font-bold uppercase tracking-wide",children:"Owner Rank"})]})]}),S.jsx("div",{className:"p-3 space-y-1",children:i.map((u,d)=>S.jsxs(hT,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:d*.05,type:"spring",stiffness:300,damping:20},whileHover:{x:4},whileTap:{scale:.98},onClick:()=>o(u.path),className:"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left group transition-all",style:{background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.06)"},children:[S.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-600/10 flex items-center justify-center group-hover:bg-red-600/20 transition-colors",children:S.jsx(u.icon,{className:"text-red-400 group-hover:text-red-300 transition-colors",size:16})}),S.jsx("span",{className:"text-neutral-300 text-sm font-medium group-hover:text-white transition-colors flex-1",children:u.label}),S.jsx(Ke.div,{initial:{opacity:0,x:-5},whileHover:{opacity:1,x:0},className:"text-neutral-600",children:S.jsx(kn,{size:12,className:"rotate-180"})})]},u.label))}),S.jsx("div",{className:"p-3 border-t border-white/5",children:S.jsxs(hT,{whileHover:{x:4},whileTap:{scale:.98},onClick:l,className:"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left group transition-all",style:{background:"rgba(239, 68, 68, 0.08)",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[S.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-600/20 flex items-center justify-center group-hover:bg-red-600/30 transition-colors",children:S.jsx(W1,{className:"text-red-400 group-hover:text-red-300 transition-colors",size:16})}),S.jsx("span",{className:"text-red-400 text-sm font-medium group-hover:text-red-300 transition-colors flex-1",children:"Sign Out"})]})})]})},T4=({isOpen:n,onClose:e})=>{const t=Qt(),r=Mn(),s=[{icon:K1,label:"Home",path:"/"},{icon:$o,label:"Movies",path:"/movies"},{icon:Zd,label:"Series",path:"/series"},{icon:pd,label:"New & Popular",path:"/new-popular"},{icon:fd,label:"Live TV",path:"/live-tv",live:!0},{icon:H1,label:"My Watchlist",path:"/watchlist"},{icon:G1,label:"Downloads",path:"/downloads"},{icon:Y1,label:"Settings",path:"/settings"}],i=o=>{t(o),e()};return S.jsx(Uo,{children:n&&S.jsxs(S.Fragment,{children:[S.jsx(cr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 md:hidden"}),S.jsxs(cr,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed left-0 top-0 bottom-0 w-[85vw] max-w-[320px] bg-neutral-900 z-50 md:hidden overflow-y-auto hide-scrollbar-mobile",children:[S.jsxs("div",{className:"p-4 border-b border-neutral-800 flex items-center justify-between sticky top-0 bg-neutral-900 z-10",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden ring-2 ring-red-500/30",children:S.jsx("img",{src:"/orko.jpeg",alt:$p.name,className:"w-full h-full object-cover"})}),S.jsxs("div",{children:[S.jsx("h3",{className:"font-bold text-white text-sm line-clamp-1",children:$p.name}),S.jsx("p",{className:"text-neutral-400 text-xs",children:$p.plan})]})]}),S.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-neutral-800 transition-colors touch-target",children:S.jsx(c0,{className:"text-white",size:22})})]}),S.jsx("div",{className:"p-2 mt-2",children:s.map((o,l)=>{const u=r.pathname===o.path;return S.jsx(cr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:l*.05},children:S.jsxs("button",{onClick:()=>i(o.path),className:`w-full flex items-center gap-4 p-4 rounded-lg transition-colors touch-target ${u?"bg-red-600 text-white":"text-neutral-300 hover:bg-neutral-800"}`,children:[S.jsx(o.icon,{size:22}),S.jsx("span",{className:"font-medium text-base flex-1 text-left",children:o.label}),o.live&&S.jsxs("span",{className:"relative flex h-2.5 w-2.5",children:[S.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-75"}),S.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-red-600"})]})]})},o.path)})}),S.jsx("div",{className:"p-4 mt-auto border-t border-neutral-800",children:S.jsxs("button",{className:"w-full flex items-center gap-4 p-4 rounded-lg text-red-500 hover:bg-neutral-800 transition-colors touch-target",children:[S.jsx(W1,{size:22}),S.jsx("span",{className:"font-medium text-base",children:"Sign Out"})]})})]})]})})},b4=({isOpen:n,onClose:e})=>{const t=Qt(),[r,s]=P.useState(""),[i,o]=P.useState([]),[l,u]=P.useState(!1),[d,f]=P.useState(()=>{const E=localStorage.getItem("searchHistory");return E?JSON.parse(E):Qm}),h=$A(r,500),m=P.useRef(null);P.useEffect(()=>{n&&m.current&&setTimeout(()=>m.current?.focus(),100)},[n]),P.useEffect(()=>{if(!h||h.trim().length<2){o([]),u(!1);return}(async()=>{u(!0);try{const I=(await Qe.get(`${nt.TMDB_BASE_URL}/search/multi?api_key=${nt.TMDB_API_KEY}&query=${encodeURIComponent(h)}&page=1`)).data.results.filter(A=>A.media_type==="movie"||A.media_type==="tv").slice(0,10);o(I)}catch(b){console.error("Search error:",b),o([])}finally{u(!1)}})()},[h]);const v=E=>{const b=E.title||E.name||"",I=[b,...d.filter(A=>A!==b)].slice(0,5);f(I),localStorage.setItem("searchHistory",JSON.stringify(I)),t(`/${E.media_type}/${E.id}`),s(""),e()},g=E=>{s(E)},x=()=>{f([]),localStorage.removeItem("searchHistory")};return S.jsx(Uo,{children:n&&S.jsxs(cr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-neutral-900 z-50 md:hidden flex flex-col",children:[S.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-neutral-800",children:[S.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-neutral-800 transition-colors touch-target",children:S.jsx(c0,{className:"text-white",size:22})}),S.jsxs("div",{className:"flex-1 relative",children:[S.jsx(hd,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-neutral-500",size:18}),S.jsx("input",{ref:m,type:"text",placeholder:"Search movies & series...",value:r,onChange:E=>s(E.target.value),className:"w-full h-12 pl-12 pr-4 bg-neutral-800 text-white text-base placeholder-neutral-500 rounded-full focus:outline-none focus:ring-2 focus:ring-red-600 touch-target"})]})]}),S.jsx("div",{className:"flex-1 overflow-y-auto hide-scrollbar-mobile",children:l?S.jsx("div",{className:"flex items-center justify-center p-12",children:S.jsx("div",{className:"w-8 h-8 border-2 border-red-600 border-t-transparent rounded-full animate-spin"})}):i.length>0?S.jsx("div",{className:"p-2",children:i.map(E=>S.jsxs("div",{onClick:()=>v(E),className:"flex items-center gap-4 p-4 hover:bg-neutral-800 rounded-lg cursor-pointer transition-colors touch-target",children:[E.poster_path?S.jsx("img",{src:`https://image.tmdb.org/t/p/w92${E.poster_path}`,alt:E.title||E.name,className:"w-12 h-16 object-cover rounded"}):S.jsx("div",{className:"w-12 h-16 bg-neutral-700 rounded flex items-center justify-center",children:E.media_type==="tv"?S.jsx(Zd,{className:"text-neutral-500",size:20}):S.jsx($o,{className:"text-neutral-500",size:20})}),S.jsxs("div",{className:"flex-1",children:[S.jsx("p",{className:"font-semibold text-white text-base line-clamp-1",children:E.title||E.name}),S.jsxs("p",{className:"text-sm text-neutral-400",children:[E.media_type==="tv"?"TV Series":"Movie",E.release_date&&`  ${E.release_date.split("-")[0]}`]})]})]},E.id))}):r.length>1?S.jsxs("div",{className:"text-center p-12",children:[S.jsx(hd,{className:"mx-auto text-neutral-600 mb-3",size:40}),S.jsxs("p",{className:"text-neutral-400",children:['No results for "',r,'"']})]}):S.jsxs("div",{className:"p-4",children:[S.jsxs("div",{className:"flex items-center justify-between mb-4",children:[S.jsx("h4",{className:"text-sm font-semibold text-neutral-400 uppercase",children:"Recent Searches"}),d.length>0&&S.jsx("button",{onClick:x,className:"text-sm text-neutral-500 hover:text-red-500 transition-colors touch-target",children:"Clear"})]}),d.length>0?S.jsx("div",{className:"space-y-2",children:d.map((E,b)=>S.jsxs("div",{onClick:()=>g(E),className:"flex items-center gap-4 p-4 hover:bg-neutral-800 rounded-lg cursor-pointer text-base text-neutral-200 touch-target",children:[S.jsx(l0,{className:"text-neutral-500",size:20}),S.jsx("span",{children:E})]},b))}):S.jsx("p",{className:"text-center text-neutral-500 p-8",children:"No recent searches"})]})})]})})};function w4(){const n=g4(),[e,t]=P.useState(null),[r,s]=P.useState(!1),[i,o]=P.useState(!1),[l,u]=P.useState(!1),{user:d}=ql(),f=n>10,h=P.useCallback(()=>{t(null),s(!1),o(!1)},[]),m=UA.filter(v=>!v.read).length;return S.jsxs(S.Fragment,{children:[S.jsx(T4,{isOpen:r,onClose:()=>s(!1)}),S.jsx(b4,{isOpen:i,onClose:()=>o(!1)}),S.jsx(cr,{className:"fixed top-0 left-0 right-0 z-[100] transition-all duration-300 rounded-b-[32px] overflow-visible",animate:{background:f?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(40px) saturate(180%)",WebkitBackdropFilter:"blur(40px) saturate(180%)"},style:{boxShadow:f?"0 8px 32px rgba(0, 0, 0, 0.3)":"none",border:f?"2px solid rgba(255, 255, 255, 0.12)":"2px solid rgba(255, 255, 255, 0.08)",borderTop:"none"},children:S.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-4 md:px-6 h-16 sm:h-18 md:h-20 max-w-7xl mx-auto",children:[S.jsxs("div",{className:"flex items-center gap-3 sm:gap-8",children:[S.jsx("button",{onClick:()=>s(!0),className:"hidden md:hidden p-3 rounded-full text-neutral-300 hover:text-white hover:bg-neutral-700/50 transition-colors touch-target active:scale-95",children:S.jsx(aM,{size:24})}),S.jsx(y4,{}),S.jsx(v4,{})]}),S.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 md:gap-4",children:[S.jsx(x4,{}),S.jsx("button",{onClick:()=>o(!0),className:"md:hidden p-3 rounded-full text-neutral-300 hover:text-white hover:bg-neutral-700/50 transition-colors touch-target active:scale-95",children:S.jsx(hd,{size:22})}),S.jsxs("div",{className:"relative",children:[S.jsxs(Ke.button,{onClick:()=>t(v=>v==="notifications"?null:"notifications"),className:"relative p-2.5 sm:p-2.5 rounded-full text-neutral-300 transition-all touch-target active:scale-90",animate:{backgroundColor:e==="notifications"?"rgba(239, 68, 68, 0.2)":"rgba(255, 255, 255, 0)",color:e==="notifications"?"#ef4444":"#d4d4d8",scale:e==="notifications"?.95:1},whileHover:{scale:1.05,backgroundColor:e==="notifications"?"rgba(239, 68, 68, 0.25)":"rgba(115, 115, 115, 0.3)"},whileTap:{scale:.9},transition:{duration:.2},children:[m>0&&S.jsx(cr,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:15},className:"absolute -top-0.5 -right-0.5 min-w-[20px] h-5 px-1 bg-gradient-to-br from-red-500 to-red-600 rounded-full flex items-center justify-center text-[10px] font-bold text-white border-2 border-neutral-900 shadow-lg",children:m}),S.jsx(Ke.div,{animate:{rotate:e==="notifications"?[0,-10,10,-10,0]:0},transition:{duration:.5},children:S.jsx(j1,{size:22})})]}),S.jsx(Uo,{children:e==="notifications"&&S.jsx(E4,{onClose:h})})]}),S.jsx("div",{className:"relative",children:d?S.jsxs(S.Fragment,{children:[S.jsx(Ke.button,{onClick:()=>t(v=>v==="profile"?null:"profile"),className:"relative w-10 h-10 sm:w-10 sm:h-10 rounded-full overflow-hidden touch-target shadow-lg transition-all ring-2 active:scale-90 bg-red-600/20 flex items-center justify-center",animate:{scale:e==="profile"?.95:1},style:{boxShadow:e==="profile"?"0 0 0 4px rgba(239, 68, 68, 0.3), 0 8px 24px rgba(239, 68, 68, 0.4)":"0 0 0 2px rgba(239, 68, 68, 0.2), 0 4px 12px rgba(0, 0, 0, 0.3)"},whileHover:{scale:e==="profile"?.95:1.05},whileTap:{scale:.9},transition:{duration:.2},children:d.photoURL?S.jsx("img",{src:d.photoURL,alt:"Profile",className:"w-full h-full object-cover"}):S.jsx("span",{className:"text-white font-bold",children:d.displayName?.charAt(0).toUpperCase()||d.email?.charAt(0).toUpperCase()||"U"})}),S.jsx(Uo,{children:e==="profile"&&S.jsx(S4,{onClose:h})})]}):S.jsx(Ke.button,{onClick:()=>u(!0),className:"px-4 py-2 bg-red-600 text-white rounded-full font-medium text-sm touch-target",whileHover:{scale:1.05,backgroundColor:"#dc2626"},whileTap:{scale:.95},transition:{duration:.2},children:"Login"})})]})]})}),S.jsx(BA,{isOpen:l,onClose:()=>u(!1)})]})}const I4=()=>{const n=Qt(),e=Mn(),t=[{icon:K1,label:"Home",path:"/"},{icon:$o,label:"Movies",path:"/movies"},{icon:Zd,label:"Series",path:"/series"},{icon:pd,label:"Popular",path:"/new-popular"},{icon:fd,label:"Live TV",path:"/live-tv"}];return S.jsx(Ke.nav,{initial:{y:100},animate:{y:0},className:"md:hidden fixed bottom-0 left-0 right-0 z-50 pb-safe",style:{background:"rgba(10, 10, 10, 0.95)",backdropFilter:"blur(20px) saturate(180%)",WebkitBackdropFilter:"blur(20px) saturate(180%)",borderTop:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 -10px 40px rgba(0, 0, 0, 0.5)"},children:S.jsx("div",{className:"flex items-center justify-around px-2 py-2 safe-area-inset-bottom",children:t.map(r=>{const s=e.pathname===r.path,i=r.icon;return S.jsxs(Ke.button,{onClick:()=>n(r.path),className:"relative flex flex-col items-center justify-center px-3 py-2 rounded-xl transition-all touch-target min-w-[60px]",whileTap:{scale:.9},style:{background:s?"rgba(239, 68, 68, 0.15)":"transparent"},children:[S.jsx(Ke.div,{animate:{scale:s?1.1:1,color:s?"#ef4444":"#a3a3a3"},transition:{duration:.2},children:S.jsx(i,{size:22,strokeWidth:s?2.5:2})}),S.jsx(Ke.span,{className:"text-[10px] font-medium mt-1",animate:{color:s?"#ef4444":"#737373",fontWeight:s?600:500},transition:{duration:.2},children:r.label})]},r.path)})})})};function A4(n){return Object.prototype.toString.call(n)==="[object Object]"}function pT(n){return A4(n)||Array.isArray(n)}function _4(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function P0(n,e){const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;const s=JSON.stringify(Object.keys(n.breakpoints||{})),i=JSON.stringify(Object.keys(e.breakpoints||{}));return s!==i?!1:t.every(o=>{const l=n[o],u=e[o];return typeof l=="function"?`${l}`==`${u}`:!pT(l)||!pT(u)?l===u:P0(l,u)})}function mT(n){return n.concat().sort((e,t)=>e.name>t.name?1:-1).map(e=>e.options)}function R4(n,e){if(n.length!==e.length)return!1;const t=mT(n),r=mT(e);return t.every((s,i)=>{const o=r[i];return P0(s,o)})}function D0(n){return typeof n=="number"}function Jm(n){return typeof n=="string"}function ff(n){return typeof n=="boolean"}function gT(n){return Object.prototype.toString.call(n)==="[object Object]"}function vt(n){return Math.abs(n)}function N0(n){return Math.sign(n)}function ll(n,e){return vt(n-e)}function L4(n,e){if(n===0||e===0||vt(n)<=vt(e))return 0;const t=ll(vt(n),vt(e));return vt(t/n)}function C4(n){return Math.round(n*100)/100}function xl(n){return El(n).map(Number)}function ur(n){return n[Xl(n)]}function Xl(n){return Math.max(0,n.length-1)}function O0(n,e){return e===Xl(n)}function yT(n,e=0){return Array.from(Array(n),(t,r)=>e+r)}function El(n){return Object.keys(n)}function VA(n,e){return[n,e].reduce((t,r)=>(El(r).forEach(s=>{const i=t[s],o=r[s],l=gT(i)&&gT(o);t[s]=l?VA(i,o):o}),t),{})}function Zm(n,e){return typeof e.MouseEvent<"u"&&n instanceof e.MouseEvent}function k4(n,e){const t={start:r,center:s,end:i};function r(){return 0}function s(u){return i(u)/2}function i(u){return e-u}function o(u,d){return Jm(n)?t[n](u):n(e,u,d)}return{measure:o}}function Sl(){let n=[];function e(s,i,o,l={passive:!0}){let u;if("addEventListener"in s)s.addEventListener(i,o,l),u=()=>s.removeEventListener(i,o,l);else{const d=s;d.addListener(o),u=()=>d.removeListener(o)}return n.push(u),r}function t(){n=n.filter(s=>s())}const r={add:e,clear:t};return r}function P4(n,e,t,r){const s=Sl(),i=1e3/60;let o=null,l=0,u=0;function d(){s.add(n,"visibilitychange",()=>{n.hidden&&g()})}function f(){v(),s.clear()}function h(E){if(!u)return;o||(o=E,t(),t());const b=E-o;for(o=E,l+=b;l>=i;)t(),l-=i;const I=l/i;r(I),u&&(u=e.requestAnimationFrame(h))}function m(){u||(u=e.requestAnimationFrame(h))}function v(){e.cancelAnimationFrame(u),o=null,l=0,u=0}function g(){o=null,l=0}return{init:d,destroy:f,start:m,stop:v,update:t,render:r}}function D4(n,e){const t=e==="rtl",r=n==="y",s=r?"y":"x",i=r?"x":"y",o=!r&&t?-1:1,l=f(),u=h();function d(g){const{height:x,width:E}=g;return r?x:E}function f(){return r?"top":t?"right":"left"}function h(){return r?"bottom":t?"left":"right"}function m(g){return g*o}return{scroll:s,cross:i,startEdge:l,endEdge:u,measureSize:d,direction:m}}function $i(n=0,e=0){const t=vt(n-e);function r(d){return d<n}function s(d){return d>e}function i(d){return r(d)||s(d)}function o(d){return i(d)?r(d)?n:e:d}function l(d){return t?d-t*Math.ceil((d-e)/t):d}return{length:t,max:e,min:n,constrain:o,reachedAny:i,reachedMax:s,reachedMin:r,removeOffset:l}}function GA(n,e,t){const{constrain:r}=$i(0,n),s=n+1;let i=o(e);function o(m){return t?vt((s+m)%s):r(m)}function l(){return i}function u(m){return i=o(m),h}function d(m){return f().set(l()+m)}function f(){return GA(n,l(),t)}const h={get:l,set:u,add:d,clone:f};return h}function N4(n,e,t,r,s,i,o,l,u,d,f,h,m,v,g,x,E,b,I){const{cross:A,direction:R}=n,C=["INPUT","SELECT","TEXTAREA"],F={passive:!1},k=Sl(),N=Sl(),M=$i(50,225).constrain(v.measure(20)),O={mouse:300,touch:400},H={mouse:500,touch:600},Z=g?43:25;let se=!1,U=0,ne=0,q=!1,te=!1,G=!1,Q=!1;function ee(Te){if(!I)return;function xe(je){(ff(I)||I(Te,je))&&fe(je)}const _e=e;k.add(_e,"dragstart",je=>je.preventDefault(),F).add(_e,"touchmove",()=>{},F).add(_e,"touchend",()=>{}).add(_e,"touchstart",xe).add(_e,"mousedown",xe).add(_e,"touchcancel",ye).add(_e,"contextmenu",ye).add(_e,"click",Ae,!0)}function D(){k.clear(),N.clear()}function $(){const Te=Q?t:e;N.add(Te,"touchmove",Se,F).add(Te,"touchend",ye).add(Te,"mousemove",Se,F).add(Te,"mouseup",ye)}function ie(Te){const xe=Te.nodeName||"";return C.includes(xe)}function ce(){return(g?H:O)[Q?"mouse":"touch"]}function ue(Te,xe){const _e=h.add(N0(Te)*-1),je=f.byDistance(Te,!g).distance;return g||vt(Te)<M?je:E&&xe?je*.5:f.byIndex(_e.get(),0).distance}function fe(Te){const xe=Zm(Te,r);Q=xe,G=g&&xe&&!Te.buttons&&se,se=ll(s.get(),o.get())>=2,!(xe&&Te.button!==0)&&(ie(Te.target)||(q=!0,i.pointerDown(Te),d.useFriction(0).useDuration(0),s.set(o),$(),U=i.readPoint(Te),ne=i.readPoint(Te,A),m.emit("pointerDown")))}function Se(Te){if(!Zm(Te,r)&&Te.touches.length>=2)return ye(Te);const _e=i.readPoint(Te),je=i.readPoint(Te,A),pe=ll(_e,U),Fe=ll(je,ne);if(!te&&!Q&&(!Te.cancelable||(te=pe>Fe,!te)))return ye(Te);const Xe=i.pointerMove(Te);pe>x&&(G=!0),d.useFriction(.3).useDuration(.75),l.start(),s.add(R(Xe)),Te.preventDefault()}function ye(Te){const _e=f.byDistance(0,!1).index!==h.get(),je=i.pointerUp(Te)*ce(),pe=ue(R(je),_e),Fe=L4(je,pe),Xe=Z-10*Fe,Ve=b+Fe/50;te=!1,q=!1,N.clear(),d.useDuration(Xe).useFriction(Ve),u.distance(pe,!g),Q=!1,m.emit("pointerUp")}function Ae(Te){G&&(Te.stopPropagation(),Te.preventDefault(),G=!1)}function Pe(){return q}return{init:ee,destroy:D,pointerDown:Pe}}function O4(n,e){let r,s;function i(h){return h.timeStamp}function o(h,m){const g=`client${(m||n.scroll)==="x"?"X":"Y"}`;return(Zm(h,e)?h:h.touches[0])[g]}function l(h){return r=h,s=h,o(h)}function u(h){const m=o(h)-o(s),v=i(h)-i(r)>170;return s=h,v&&(r=h),m}function d(h){if(!r||!s)return 0;const m=o(s)-o(r),v=i(h)-i(r),g=i(h)-i(s)>170,x=m/v;return v&&!g&&vt(x)>.1?x:0}return{pointerDown:l,pointerMove:u,pointerUp:d,readPoint:o}}function M4(){function n(t){const{offsetTop:r,offsetLeft:s,offsetWidth:i,offsetHeight:o}=t;return{top:r,right:s+i,bottom:r+o,left:s,width:i,height:o}}return{measure:n}}function F4(n){function e(r){return n*(r/100)}return{measure:e}}function B4(n,e,t,r,s,i,o){const l=[n].concat(r);let u,d,f=[],h=!1;function m(E){return s.measureSize(o.measure(E))}function v(E){if(!i)return;d=m(n),f=r.map(m);function b(I){for(const A of I){if(h)return;const R=A.target===n,C=r.indexOf(A.target),F=R?d:f[C],k=m(R?n:r[C]);if(vt(k-F)>=.5){E.reInit(),e.emit("resize");break}}}u=new ResizeObserver(I=>{(ff(i)||i(E,I))&&b(I)}),t.requestAnimationFrame(()=>{l.forEach(I=>u.observe(I))})}function g(){h=!0,u&&u.disconnect()}return{init:v,destroy:g}}function U4(n,e,t,r,s,i){let o=0,l=0,u=s,d=i,f=n.get(),h=0;function m(){const F=r.get()-n.get(),k=!u;let N=0;return k?(o=0,t.set(r),n.set(r),N=F):(t.set(n),o+=F/u,o*=d,f+=o,n.add(o),N=f-h),l=N0(N),h=f,C}function v(){const F=r.get()-e.get();return vt(F)<.001}function g(){return u}function x(){return l}function E(){return o}function b(){return A(s)}function I(){return R(i)}function A(F){return u=F,C}function R(F){return d=F,C}const C={direction:x,duration:g,velocity:E,seek:m,settled:v,useBaseFriction:I,useBaseDuration:b,useFriction:R,useDuration:A};return C}function $4(n,e,t,r,s){const i=s.measure(10),o=s.measure(50),l=$i(.1,.99);let u=!1;function d(){return!(u||!n.reachedAny(t.get())||!n.reachedAny(e.get()))}function f(v){if(!d())return;const g=n.reachedMin(e.get())?"min":"max",x=vt(n[g]-e.get()),E=t.get()-e.get(),b=l.constrain(x/o);t.subtract(E*b),!v&&vt(E)<i&&(t.set(n.constrain(t.get())),r.useDuration(25).useBaseFriction())}function h(v){u=!v}return{shouldConstrain:d,constrain:f,toggleActive:h}}function j4(n,e,t,r,s){const i=$i(-e+n,0),o=h(),l=f(),u=m();function d(g,x){return ll(g,x)<=1}function f(){const g=o[0],x=ur(o),E=o.lastIndexOf(g),b=o.indexOf(x)+1;return $i(E,b)}function h(){return t.map((g,x)=>{const{min:E,max:b}=i,I=i.constrain(g),A=!x,R=O0(t,x);return A?b:R||d(E,I)?E:d(b,I)?b:I}).map(g=>parseFloat(g.toFixed(3)))}function m(){if(e<=n+s)return[i.max];if(r==="keepSnaps")return o;const{min:g,max:x}=l;return o.slice(g,x)}return{snapsContained:u,scrollContainLimit:l}}function V4(n,e,t){const r=e[0],s=t?r-n:ur(e);return{limit:$i(s,r)}}function G4(n,e,t,r){const i=e.min+.1,o=e.max+.1,{reachedMin:l,reachedMax:u}=$i(i,o);function d(m){return m===1?u(t.get()):m===-1?l(t.get()):!1}function f(m){if(!d(m))return;const v=n*(m*-1);r.forEach(g=>g.add(v))}return{loop:f}}function H4(n){const{max:e,length:t}=n;function r(i){const o=i-e;return t?o/-t:0}return{get:r}}function K4(n,e,t,r,s){const{startEdge:i,endEdge:o}=n,{groupSlides:l}=s,u=h().map(e.measure),d=m(),f=v();function h(){return l(r).map(x=>ur(x)[o]-x[0][i]).map(vt)}function m(){return r.map(x=>t[i]-x[i]).map(x=>-vt(x))}function v(){return l(d).map(x=>x[0]).map((x,E)=>x+u[E])}return{snaps:d,snapsAligned:f}}function W4(n,e,t,r,s,i){const{groupSlides:o}=s,{min:l,max:u}=r,d=f();function f(){const m=o(i),v=!n||e==="keepSnaps";return t.length===1?[i]:v?m:m.slice(l,u).map((g,x,E)=>{const b=!x,I=O0(E,x);if(b){const A=ur(E[0])+1;return yT(A)}if(I){const A=Xl(i)-ur(E)[0]+1;return yT(A,ur(E)[0])}return g})}return{slideRegistry:d}}function z4(n,e,t,r,s){const{reachedAny:i,removeOffset:o,constrain:l}=r;function u(g){return g.concat().sort((x,E)=>vt(x)-vt(E))[0]}function d(g){const x=n?o(g):l(g),E=e.map((I,A)=>({diff:f(I-x,0),index:A})).sort((I,A)=>vt(I.diff)-vt(A.diff)),{index:b}=E[0];return{index:b,distance:x}}function f(g,x){const E=[g,g+t,g-t];if(!n)return g;if(!x)return u(E);const b=E.filter(I=>N0(I)===x);return b.length?u(b):ur(E)-t}function h(g,x){const E=e[g]-s.get(),b=f(E,x);return{index:g,distance:b}}function m(g,x){const E=s.get()+g,{index:b,distance:I}=d(E),A=!n&&i(E);if(!x||A)return{index:b,distance:g};const R=e[b]-I,C=g+f(R,0);return{index:b,distance:C}}return{byDistance:m,byIndex:h,shortcut:f}}function Y4(n,e,t,r,s,i,o){function l(h){const m=h.distance,v=h.index!==e.get();i.add(m),m&&(r.duration()?n.start():(n.update(),n.render(1),n.update())),v&&(t.set(e.get()),e.set(h.index),o.emit("select"))}function u(h,m){const v=s.byDistance(h,m);l(v)}function d(h,m){const v=e.clone().set(h),g=s.byIndex(v.get(),m);l(g)}return{distance:u,index:d}}function q4(n,e,t,r,s,i,o,l){const u={passive:!0,capture:!0};let d=0;function f(v){if(!l)return;function g(x){if(new Date().getTime()-d>10)return;o.emit("slideFocusStart"),n.scrollLeft=0;const I=t.findIndex(A=>A.includes(x));D0(I)&&(s.useDuration(0),r.index(I,0),o.emit("slideFocus"))}i.add(document,"keydown",h,!1),e.forEach((x,E)=>{i.add(x,"focus",b=>{(ff(l)||l(v,b))&&g(E)},u)})}function h(v){v.code==="Tab"&&(d=new Date().getTime())}return{init:f}}function Za(n){let e=n;function t(){return e}function r(u){e=o(u)}function s(u){e+=o(u)}function i(u){e-=o(u)}function o(u){return D0(u)?u:u.get()}return{get:t,set:r,add:s,subtract:i}}function HA(n,e){const t=n.scroll==="x"?o:l,r=e.style;let s=null,i=!1;function o(m){return`translate3d(${m}px,0px,0px)`}function l(m){return`translate3d(0px,${m}px,0px)`}function u(m){if(i)return;const v=C4(n.direction(m));v!==s&&(r.transform=t(v),s=v)}function d(m){i=!m}function f(){i||(r.transform="",e.getAttribute("style")||e.removeAttribute("style"))}return{clear:f,to:u,toggleActive:d}}function X4(n,e,t,r,s,i,o,l,u){const f=xl(s),h=xl(s).reverse(),m=b().concat(I());function v(k,N){return k.reduce((M,O)=>M-s[O],N)}function g(k,N){return k.reduce((M,O)=>v(M,N)>0?M.concat([O]):M,[])}function x(k){return i.map((N,M)=>({start:N-r[M]+.5+k,end:N+e-.5+k}))}function E(k,N,M){const O=x(N);return k.map(H=>{const Z=M?0:-t,se=M?t:0,U=M?"end":"start",ne=O[H][U];return{index:H,loopPoint:ne,slideLocation:Za(-1),translate:HA(n,u[H]),target:()=>l.get()>ne?Z:se}})}function b(){const k=o[0],N=g(h,k);return E(N,t,!1)}function I(){const k=e-o[0]-1,N=g(f,k);return E(N,-t,!0)}function A(){return m.every(({index:k})=>{const N=f.filter(M=>M!==k);return v(N,e)<=.1})}function R(){m.forEach(k=>{const{target:N,translate:M,slideLocation:O}=k,H=N();H!==O.get()&&(M.to(H),O.set(H))})}function C(){m.forEach(k=>k.translate.clear())}return{canLoop:A,clear:C,loop:R,loopPoints:m}}function Q4(n,e,t){let r,s=!1;function i(u){if(!t)return;function d(f){for(const h of f)if(h.type==="childList"){u.reInit(),e.emit("slidesChanged");break}}r=new MutationObserver(f=>{s||(ff(t)||t(u,f))&&d(f)}),r.observe(n,{childList:!0})}function o(){r&&r.disconnect(),s=!0}return{init:i,destroy:o}}function J4(n,e,t,r){const s={};let i=null,o=null,l,u=!1;function d(){l=new IntersectionObserver(g=>{u||(g.forEach(x=>{const E=e.indexOf(x.target);s[E]=x}),i=null,o=null,t.emit("slidesInView"))},{root:n.parentElement,threshold:r}),e.forEach(g=>l.observe(g))}function f(){l&&l.disconnect(),u=!0}function h(g){return El(s).reduce((x,E)=>{const b=parseInt(E),{isIntersecting:I}=s[b];return(g&&I||!g&&!I)&&x.push(b),x},[])}function m(g=!0){if(g&&i)return i;if(!g&&o)return o;const x=h(g);return g&&(i=x),g||(o=x),x}return{init:d,destroy:f,get:m}}function Z4(n,e,t,r,s,i){const{measureSize:o,startEdge:l,endEdge:u}=n,d=t[0]&&s,f=g(),h=x(),m=t.map(o),v=E();function g(){if(!d)return 0;const I=t[0];return vt(e[l]-I[l])}function x(){if(!d)return 0;const I=i.getComputedStyle(ur(r));return parseFloat(I.getPropertyValue(`margin-${u}`))}function E(){return t.map((I,A,R)=>{const C=!A,F=O0(R,A);return C?m[A]+f:F?m[A]+h:R[A+1][l]-I[l]}).map(vt)}return{slideSizes:m,slideSizesWithGaps:v,startGap:f,endGap:h}}function e5(n,e,t,r,s,i,o,l,u){const{startEdge:d,endEdge:f,direction:h}=n,m=D0(t);function v(b,I){return xl(b).filter(A=>A%I===0).map(A=>b.slice(A,A+I))}function g(b){return b.length?xl(b).reduce((I,A,R)=>{const C=ur(I)||0,F=C===0,k=A===Xl(b),N=s[d]-i[C][d],M=s[d]-i[A][f],O=!r&&F?h(o):0,H=!r&&k?h(l):0,Z=vt(M-H-(N+O));return R&&Z>e+u&&I.push(A),k&&I.push(b.length),I},[]).map((I,A,R)=>{const C=Math.max(R[A-1]||0);return b.slice(C,I)}):[]}function x(b){return m?v(b,t):g(b)}return{groupSlides:x}}function t5(n,e,t,r,s,i,o){const{align:l,axis:u,direction:d,startIndex:f,loop:h,duration:m,dragFree:v,dragThreshold:g,inViewThreshold:x,slidesToScroll:E,skipSnaps:b,containScroll:I,watchResize:A,watchSlides:R,watchDrag:C,watchFocus:F}=i,k=2,N=M4(),M=N.measure(e),O=t.map(N.measure),H=D4(u,d),Z=H.measureSize(M),se=F4(Z),U=k4(l,Z),ne=!h&&!!I,q=h||!!I,{slideSizes:te,slideSizesWithGaps:G,startGap:Q,endGap:ee}=Z4(H,M,O,t,q,s),D=e5(H,Z,E,h,M,O,Q,ee,k),{snaps:$,snapsAligned:ie}=K4(H,U,M,O,D),ce=-ur($)+ur(G),{snapsContained:ue,scrollContainLimit:fe}=j4(Z,ce,ie,I,k),Se=ne?ue:ie,{limit:ye}=V4(ce,Se,h),Ae=GA(Xl(Se),f,h),Pe=Ae.clone(),De=xl(t),Te=({dragHandler:Jt,scrollBody:Zt,scrollBounds:Zo,options:{loop:si}})=>{si||Zo.constrain(Jt.pointerDown()),Zt.seek()},xe=({scrollBody:Jt,translate:Zt,location:Zo,offsetLocation:si,previousLocation:Zl,scrollLooper:Sf,slideLooper:ea,dragHandler:ta,animation:na,eventHandler:zi,scrollBounds:ra,options:{loop:Br}},Ur)=>{const sa=Jt.settled(),ec=!ra.shouldConstrain(),ia=Br?sa:sa&&ec,oa=ia&&!ta.pointerDown();oa&&na.stop();const tc=Zo.get()*Ur+Zl.get()*(1-Ur);si.set(tc),Br&&(Sf.loop(Jt.direction()),ea.loop()),Zt.to(si.get()),oa&&zi.emit("settle"),ia||zi.emit("scroll")},_e=P4(r,s,()=>Te(Sn),Jt=>xe(Sn,Jt)),je=.68,pe=Se[Ae.get()],Fe=Za(pe),Xe=Za(pe),Ve=Za(pe),Ue=Za(pe),Je=U4(Fe,Ve,Xe,Ue,m,je),Dt=z4(h,Se,ce,ye,Ue),Bn=Y4(_e,Ae,Pe,Je,Dt,Ue,o),xn=H4(ye),St=Sl(),At=J4(e,t,o,x),{slideRegistry:En}=W4(ne,I,Se,fe,D,De),mr=q4(n,t,En,Bn,Je,St,o,F),Sn={ownerDocument:r,ownerWindow:s,eventHandler:o,containerRect:M,slideRects:O,animation:_e,axis:H,dragHandler:N4(H,n,r,s,Ue,O4(H,s),Fe,_e,Bn,Je,Dt,Ae,o,se,v,g,b,je,C),eventStore:St,percentOfView:se,index:Ae,indexPrevious:Pe,limit:ye,location:Fe,offsetLocation:Ve,previousLocation:Xe,options:i,resizeHandler:B4(e,o,s,t,H,A,N),scrollBody:Je,scrollBounds:$4(ye,Ve,Ue,Je,se),scrollLooper:G4(ce,ye,Ve,[Fe,Ve,Xe,Ue]),scrollProgress:xn,scrollSnapList:Se.map(xn.get),scrollSnaps:Se,scrollTarget:Dt,scrollTo:Bn,slideLooper:X4(H,Z,ce,te,G,$,Se,Ve,t),slideFocus:mr,slidesHandler:Q4(e,o,R),slidesInView:At,slideIndexes:De,slideRegistry:En,slidesToScroll:D,target:Ue,translate:HA(H,e)};return Sn}function n5(){let n={},e;function t(d){e=d}function r(d){return n[d]||[]}function s(d){return r(d).forEach(f=>f(e,d)),u}function i(d,f){return n[d]=r(d).concat([f]),u}function o(d,f){return n[d]=r(d).filter(h=>h!==f),u}function l(){n={}}const u={init:t,emit:s,off:o,on:i,clear:l};return u}const r5={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function s5(n){function e(i,o){return VA(i,o||{})}function t(i){const o=i.breakpoints||{},l=El(o).filter(u=>n.matchMedia(u).matches).map(u=>o[u]).reduce((u,d)=>e(u,d),{});return e(i,l)}function r(i){return i.map(o=>El(o.breakpoints||{})).reduce((o,l)=>o.concat(l),[]).map(n.matchMedia)}return{mergeOptions:e,optionsAtMedia:t,optionsMediaQueries:r}}function i5(n){let e=[];function t(i,o){return e=o.filter(({options:l})=>n.optionsAtMedia(l).active!==!1),e.forEach(l=>l.init(i,n)),o.reduce((l,u)=>Object.assign(l,{[u.name]:u}),{})}function r(){e=e.filter(i=>i.destroy())}return{init:t,destroy:r}}function Ad(n,e,t){const r=n.ownerDocument,s=r.defaultView,i=s5(s),o=i5(i),l=Sl(),u=n5(),{mergeOptions:d,optionsAtMedia:f,optionsMediaQueries:h}=i,{on:m,off:v,emit:g}=u,x=H;let E=!1,b,I=d(r5,Ad.globalOptions),A=d(I),R=[],C,F,k;function N(){const{container:De,slides:Te}=A;F=(Jm(De)?n.querySelector(De):De)||n.children[0];const _e=Jm(Te)?F.querySelectorAll(Te):Te;k=[].slice.call(_e||F.children)}function M(De){const Te=t5(n,F,k,r,s,De,u);if(De.loop&&!Te.slideLooper.canLoop()){const xe=Object.assign({},De,{loop:!1});return M(xe)}return Te}function O(De,Te){E||(I=d(I,De),A=f(I),R=Te||R,N(),b=M(A),h([I,...R.map(({options:xe})=>xe)]).forEach(xe=>l.add(xe,"change",H)),A.active&&(b.translate.to(b.location.get()),b.animation.init(),b.slidesInView.init(),b.slideFocus.init(Pe),b.eventHandler.init(Pe),b.resizeHandler.init(Pe),b.slidesHandler.init(Pe),b.options.loop&&b.slideLooper.loop(),F.offsetParent&&k.length&&b.dragHandler.init(Pe),C=o.init(Pe,R)))}function H(De,Te){const xe=D();Z(),O(d({startIndex:xe},De),Te),u.emit("reInit")}function Z(){b.dragHandler.destroy(),b.eventStore.clear(),b.translate.clear(),b.slideLooper.clear(),b.resizeHandler.destroy(),b.slidesHandler.destroy(),b.slidesInView.destroy(),b.animation.destroy(),o.destroy(),l.clear()}function se(){E||(E=!0,l.clear(),Z(),u.emit("destroy"),u.clear())}function U(De,Te,xe){!A.active||E||(b.scrollBody.useBaseFriction().useDuration(Te===!0?0:A.duration),b.scrollTo.index(De,xe||0))}function ne(De){const Te=b.index.add(1).get();U(Te,De,-1)}function q(De){const Te=b.index.add(-1).get();U(Te,De,1)}function te(){return b.index.add(1).get()!==D()}function G(){return b.index.add(-1).get()!==D()}function Q(){return b.scrollSnapList}function ee(){return b.scrollProgress.get(b.offsetLocation.get())}function D(){return b.index.get()}function $(){return b.indexPrevious.get()}function ie(){return b.slidesInView.get()}function ce(){return b.slidesInView.get(!1)}function ue(){return C}function fe(){return b}function Se(){return n}function ye(){return F}function Ae(){return k}const Pe={canScrollNext:te,canScrollPrev:G,containerNode:ye,internalEngine:fe,destroy:se,off:v,on:m,emit:g,plugins:ue,previousScrollSnap:$,reInit:x,rootNode:Se,scrollNext:ne,scrollPrev:q,scrollProgress:ee,scrollSnapList:Q,scrollTo:U,selectedScrollSnap:D,slideNodes:Ae,slidesInView:ie,slidesNotInView:ce};return O(e,t),setTimeout(()=>u.emit("init"),0),Pe}Ad.globalOptions=void 0;function hf(n={},e=[]){const t=P.useRef(n),r=P.useRef(e),[s,i]=P.useState(),[o,l]=P.useState(),u=P.useCallback(()=>{s&&s.reInit(t.current,r.current)},[s]);return P.useEffect(()=>{P0(t.current,n)||(t.current=n,u())},[n,u]),P.useEffect(()=>{R4(r.current,e)||(r.current=e,u())},[e,u]),P.useEffect(()=>{if(_4()&&o){Ad.globalOptions=hf.globalOptions;const d=Ad(o,t.current,r.current);return i(d),()=>d.destroy()}else i(void 0)},[o,i]),[l,s]}hf.globalOptions=void 0;const o5={active:!0,breakpoints:{},delay:4e3,jump:!1,playOnInit:!0,stopOnFocusIn:!0,stopOnInteraction:!0,stopOnMouseEnter:!1,stopOnLastSnap:!1,rootNode:null};function a5(n,e){const t=n.scrollSnapList();return typeof e=="number"?t.map(()=>e):e(t,n)}function l5(n,e){const t=n.rootNode();return e&&e(t)||t}function pf(n={}){let e,t,r,s,i=null,o=0,l=!1,u=!1,d=!1,f=!1;function h(U,ne){t=U;const{mergeOptions:q,optionsAtMedia:te}=ne,G=q(o5,pf.globalOptions),Q=q(G,n);if(e=te(Q),t.scrollSnapList().length<=1)return;f=e.jump,r=!1,s=a5(t,e.delay);const{eventStore:ee,ownerDocument:D}=t.internalEngine(),$=!!t.internalEngine().options.watchDrag,ie=l5(t,e.rootNode);ee.add(D,"visibilitychange",b),$&&t.on("pointerDown",A),$&&!e.stopOnInteraction&&t.on("pointerUp",R),e.stopOnMouseEnter&&ee.add(ie,"mouseenter",C),e.stopOnMouseEnter&&!e.stopOnInteraction&&ee.add(ie,"mouseleave",F),e.stopOnFocusIn&&t.on("slideFocusStart",E),e.stopOnFocusIn&&!e.stopOnInteraction&&ee.add(t.containerNode(),"focusout",x),e.playOnInit&&x()}function m(){t.off("pointerDown",A).off("pointerUp",R).off("slideFocusStart",E),E(),r=!0,l=!1}function v(){const{ownerWindow:U}=t.internalEngine();U.clearTimeout(o),o=U.setTimeout(H,s[t.selectedScrollSnap()]),i=new Date().getTime(),t.emit("autoplay:timerset")}function g(){const{ownerWindow:U}=t.internalEngine();U.clearTimeout(o),o=0,i=null,t.emit("autoplay:timerstopped")}function x(){if(!r){if(I()){d=!0;return}l||t.emit("autoplay:play"),v(),l=!0}}function E(){r||(l&&t.emit("autoplay:stop"),g(),l=!1)}function b(){if(I())return d=l,E();d&&x()}function I(){const{ownerDocument:U}=t.internalEngine();return U.visibilityState==="hidden"}function A(){u||E()}function R(){u||x()}function C(){u=!0,E()}function F(){u=!1,x()}function k(U){typeof U<"u"&&(f=U),x()}function N(){l&&E()}function M(){l&&x()}function O(){return l}function H(){const{index:U}=t.internalEngine(),ne=U.clone().add(1).get(),q=t.scrollSnapList().length-1,te=e.stopOnLastSnap&&ne===q;if(t.canScrollNext()?t.scrollNext(f):t.scrollTo(0,f),t.emit("autoplay:select"),te)return E();x()}function Z(){if(!i)return null;const U=s[t.selectedScrollSnap()],ne=new Date().getTime()-i;return U-ne}return{name:"autoplay",options:n,init:h,destroy:m,play:k,stop:N,reset:M,isPlaying:O,timeUntilNext:Z}}pf.globalOptions=void 0;var jp={exports:{}},Vp={};var vT;function c5(){if(vT)return Vp;vT=1;var n=Pl();function e(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,i=n.useLayoutEffect,o=n.useDebugValue;function l(h,m){var v=m(),g=r({inst:{value:v,getSnapshot:m}}),x=g[0].inst,E=g[1];return i(function(){x.value=v,x.getSnapshot=m,u(x)&&E({inst:x})},[h,v,m]),s(function(){return u(x)&&E({inst:x}),h(function(){u(x)&&E({inst:x})})},[h]),o(v),v}function u(h){var m=h.getSnapshot;h=h.value;try{var v=m();return!t(h,v)}catch{return!0}}function d(h,m){return m()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return Vp.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,Vp}var xT;function u5(){return xT||(xT=1,jp.exports=c5()),jp.exports}var d5=u5();const KA=0,WA=1,zA=2,ET=3;var ST=Object.prototype.hasOwnProperty;function eg(n,e){var t,r;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((r=n.length)===e.length)for(;r--&&eg(n[r],e[r]););return r===-1}if(!t||typeof n=="object"){r=0;for(t in n)if(ST.call(n,t)&&++r&&!ST.call(e,t)||!(t in e)||!eg(n[t],e[t]))return!1;return Object.keys(e).length===r}}return n!==n&&e!==e}const Zr=new WeakMap,Ws=()=>{},qt=Ws(),tg=Object,Ye=n=>n===qt,_r=n=>typeof n=="function",ei=(n,e)=>({...n,...e}),YA=n=>_r(n.then),Gp={},yu={},M0="undefined",Ql=typeof window!=M0,ng=typeof document!=M0,f5=Ql&&"Deno"in window,h5=()=>Ql&&typeof window.requestAnimationFrame!=M0,qA=(n,e)=>{const t=Zr.get(n);return[()=>!Ye(e)&&n.get(e)||Gp,r=>{if(!Ye(e)){const s=n.get(e);e in yu||(yu[e]=s),t[5](e,ei(s,r),s||Gp)}},t[6],()=>!Ye(e)&&e in yu?yu[e]:!Ye(e)&&n.get(e)||Gp]};let rg=!0;const p5=()=>rg,[sg,ig]=Ql&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[Ws,Ws],m5=()=>{const n=ng&&document.visibilityState;return Ye(n)||n!=="hidden"},g5=n=>(ng&&document.addEventListener("visibilitychange",n),sg("focus",n),()=>{ng&&document.removeEventListener("visibilitychange",n),ig("focus",n)}),y5=n=>{const e=()=>{rg=!0,n()},t=()=>{rg=!1};return sg("online",e),sg("offline",t),()=>{ig("online",e),ig("offline",t)}},v5={isOnline:p5,isVisible:m5},x5={initFocus:g5,initReconnect:y5},TT=!Cn.useId,Tl=!Ql||f5,E5=n=>h5()?window.requestAnimationFrame(n):setTimeout(n,1),Hp=Tl?P.useEffect:P.useLayoutEffect,Kp=typeof navigator<"u"&&navigator.connection,bT=!Tl&&Kp&&(["slow-2g","2g"].includes(Kp.effectiveType)||Kp.saveData),vu=new WeakMap,S5=n=>tg.prototype.toString.call(n),Wp=(n,e)=>n===`[object ${e}]`;let T5=0;const og=n=>{const e=typeof n,t=S5(n),r=Wp(t,"Date"),s=Wp(t,"RegExp"),i=Wp(t,"Object");let o,l;if(tg(n)===n&&!r&&!s){if(o=vu.get(n),o)return o;if(o=++T5+"~",vu.set(n,o),Array.isArray(n)){for(o="@",l=0;l<n.length;l++)o+=og(n[l])+",";vu.set(n,o)}if(i){o="#";const u=tg.keys(n).sort();for(;!Ye(l=u.pop());)Ye(n[l])||(o+=l+":"+og(n[l])+",");vu.set(n,o)}}else o=r?n.toJSON():e=="symbol"?n.toString():e=="string"?JSON.stringify(n):""+n;return o},F0=n=>{if(_r(n))try{n=n()}catch{n=""}const e=n;return n=typeof n=="string"?n:(Array.isArray(n)?n.length:n)?og(n):"",[n,e]};let b5=0;const ag=()=>++b5;async function XA(...n){const[e,t,r,s]=n,i=ei({populateCache:!0,throwOnError:!0},typeof s=="boolean"?{revalidate:s}:s||{});let o=i.populateCache;const l=i.rollbackOnError;let u=i.optimisticData;const d=m=>typeof l=="function"?l(m):l!==!1,f=i.throwOnError;if(_r(t)){const m=t,v=[],g=e.keys();for(const x of g)!/^\$(inf|sub)\$/.test(x)&&m(e.get(x)._k)&&v.push(x);return Promise.all(v.map(h))}return h(t);async function h(m){const[v]=F0(m);if(!v)return;const[g,x]=qA(e,v),[E,b,I,A]=Zr.get(e),R=()=>{const U=E[v];return(_r(i.revalidate)?i.revalidate(g().data,m):i.revalidate!==!1)&&(delete I[v],delete A[v],U&&U[0])?U[0](zA).then(()=>g().data):g().data};if(n.length<3)return R();let C=r,F,k=!1;const N=ag();b[v]=[N,0];const M=!Ye(u),O=g(),H=O.data,Z=O._c,se=Ye(Z)?H:Z;if(M&&(u=_r(u)?u(se,H):u,x({data:u,_c:se})),_r(C))try{C=C(se)}catch(U){F=U,k=!0}if(C&&YA(C))if(C=await C.catch(U=>{F=U,k=!0}),N!==b[v][0]){if(k)throw F;return C}else k&&M&&d(F)&&(o=!0,x({data:se,_c:qt}));if(o&&!k)if(_r(o)){const U=o(C,se);x({data:U,error:qt,_c:qt})}else x({data:C,error:qt,_c:qt});if(b[v][1]=ag(),Promise.resolve(R()).then(()=>{x({_c:qt})}),k){if(f)throw F;return}return C}}const wT=(n,e)=>{for(const t in n)n[t][0]&&n[t][0](e)},w5=(n,e)=>{if(!Zr.has(n)){const t=ei(x5,e),r=Object.create(null),s=XA.bind(qt,n);let i=Ws;const o=Object.create(null),l=(f,h)=>{const m=o[f]||[];return o[f]=m,m.push(h),()=>m.splice(m.indexOf(h),1)},u=(f,h,m)=>{n.set(f,h);const v=o[f];if(v)for(const g of v)g(h,m)},d=()=>{if(!Zr.has(n)&&(Zr.set(n,[r,Object.create(null),Object.create(null),Object.create(null),s,u,l]),!Tl)){const f=t.initFocus(setTimeout.bind(qt,wT.bind(qt,r,KA))),h=t.initReconnect(setTimeout.bind(qt,wT.bind(qt,r,WA)));i=()=>{f&&f(),h&&h(),Zr.delete(n)}}};return d(),[n,s,d,i]}return[n,Zr.get(n)[4]]},I5=(n,e,t,r,s)=>{const i=t.errorRetryCount,o=s.retryCount,l=~~((Math.random()+.5)*(1<<(o<8?o:8)))*t.errorRetryInterval;!Ye(i)&&o>i||setTimeout(r,l,s)},A5=eg,[QA,_5]=w5(new Map),R5=ei({onLoadingSlow:Ws,onSuccess:Ws,onError:Ws,onErrorRetry:I5,onDiscarded:Ws,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:bT?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:bT?5e3:3e3,compare:A5,isPaused:()=>!1,cache:QA,mutate:_5,fallback:{}},v5),L5=(n,e)=>{const t=ei(n,e);if(e){const{use:r,fallback:s}=n,{use:i,fallback:o}=e;r&&i&&(t.use=r.concat(i)),s&&o&&(t.fallback=ei(s,o))}return t},C5=P.createContext({}),k5="$inf$",JA=Ql&&window.__SWR_DEVTOOLS_USE__,P5=JA?window.__SWR_DEVTOOLS_USE__:[],D5=()=>{JA&&(window.__SWR_DEVTOOLS_REACT__=Cn)},N5=n=>_r(n[1])?[n[0],n[1],n[2]||{}]:[n[0],null,(n[1]===null?n[2]:n[1])||{}],O5=()=>{const n=P.useContext(C5);return P.useMemo(()=>ei(R5,n),[n])},M5=n=>(e,t,r)=>n(e,t&&((...i)=>{const[o]=F0(e),[,,,l]=Zr.get(QA);if(o.startsWith(k5))return t(...i);const u=l[o];return Ye(u)?t(...i):(delete l[o],u)}),r),F5=P5.concat(M5),B5=n=>function(...t){const r=O5(),[s,i,o]=N5(t),l=L5(r,o);let u=n;const{use:d}=l,f=(d||[]).concat(F5);for(let h=f.length;h--;)u=f[h](u);return u(s,i||l.fetcher||null,l)},U5=(n,e,t)=>{const r=e[n]||(e[n]=[]);return r.push(t),()=>{const s=r.indexOf(t);s>=0&&(r[s]=r[r.length-1],r.pop())}};D5();const zp=Cn.use||(n=>{switch(n.status){case"pending":throw n;case"fulfilled":return n.value;case"rejected":throw n.reason;default:throw n.status="pending",n.then(e=>{n.status="fulfilled",n.value=e},e=>{n.status="rejected",n.reason=e}),n}}),Yp={dedupe:!0},IT=Promise.resolve(qt),$5=(n,e,t)=>{const{cache:r,compare:s,suspense:i,fallbackData:o,revalidateOnMount:l,revalidateIfStale:u,refreshInterval:d,refreshWhenHidden:f,refreshWhenOffline:h,keepPreviousData:m}=t,[v,g,x,E]=Zr.get(r),[b,I]=F0(n),A=P.useRef(!1),R=P.useRef(!1),C=P.useRef(b),F=P.useRef(e),k=P.useRef(t),N=()=>k.current,M=()=>N().isVisible()&&N().isOnline(),[O,H,Z,se]=qA(r,b),U=P.useRef({}).current,ne=Ye(o)?Ye(t.fallback)?qt:t.fallback[b]:o,q=(xe,_e)=>{for(const je in U){const pe=je;if(pe==="data"){if(!s(xe[pe],_e[pe])&&(!Ye(xe[pe])||!s(ue,_e[pe])))return!1}else if(_e[pe]!==xe[pe])return!1}return!0},te=P.useMemo(()=>{const xe=!b||!e?!1:Ye(l)?N().isPaused()||i?!1:u!==!1:l,_e=Ue=>{const Je=ei(Ue);return delete Je._k,xe?{isValidating:!0,isLoading:!0,...Je}:Je},je=O(),pe=se(),Fe=_e(je),Xe=je===pe?Fe:_e(pe);let Ve=Fe;return[()=>{const Ue=_e(O());return q(Ue,Ve)?(Ve.data=Ue.data,Ve.isLoading=Ue.isLoading,Ve.isValidating=Ue.isValidating,Ve.error=Ue.error,Ve):(Ve=Ue,Ue)},()=>Xe]},[r,b]),G=d5.useSyncExternalStore(P.useCallback(xe=>Z(b,(_e,je)=>{q(je,_e)||xe()}),[r,b]),te[0],te[1]),Q=!A.current,ee=v[b]&&v[b].length>0,D=G.data,$=Ye(D)?ne&&YA(ne)?zp(ne):ne:D,ie=G.error,ce=P.useRef($),ue=m?Ye(D)?Ye(ce.current)?$:ce.current:D:$,fe=ee&&!Ye(ie)?!1:Q&&!Ye(l)?l:N().isPaused()?!1:i?Ye($)?!1:u:Ye($)||u,Se=!!(b&&e&&Q&&fe),ye=Ye(G.isValidating)?Se:G.isValidating,Ae=Ye(G.isLoading)?Se:G.isLoading,Pe=P.useCallback(async xe=>{const _e=F.current;if(!b||!_e||R.current||N().isPaused())return!1;let je,pe,Fe=!0;const Xe=xe||{},Ve=!x[b]||!Xe.dedupe,Ue=()=>TT?!R.current&&b===C.current&&A.current:b===C.current,Je={isValidating:!1,isLoading:!1},Dt=()=>{H(Je)},Bn=()=>{const St=x[b];St&&St[1]===pe&&delete x[b]},xn={isValidating:!0};Ye(O().data)&&(xn.isLoading=!0);try{if(Ve&&(H(xn),t.loadingTimeout&&Ye(O().data)&&setTimeout(()=>{Fe&&Ue()&&N().onLoadingSlow(b,t)},t.loadingTimeout),x[b]=[_e(I),ag()]),[je,pe]=x[b],je=await je,Ve&&setTimeout(Bn,t.dedupingInterval),!x[b]||x[b][1]!==pe)return Ve&&Ue()&&N().onDiscarded(b),!1;Je.error=qt;const St=g[b];if(!Ye(St)&&(pe<=St[0]||pe<=St[1]||St[1]===0))return Dt(),Ve&&Ue()&&N().onDiscarded(b),!1;const At=O().data;Je.data=s(At,je)?At:je,Ve&&Ue()&&N().onSuccess(je,b,t)}catch(St){Bn();const At=N(),{shouldRetryOnError:En}=At;At.isPaused()||(Je.error=St,Ve&&Ue()&&(At.onError(St,b,At),(En===!0||_r(En)&&En(St))&&(!N().revalidateOnFocus||!N().revalidateOnReconnect||M())&&At.onErrorRetry(St,b,At,mr=>{const Sn=v[b];Sn&&Sn[0]&&Sn[0](ET,mr)},{retryCount:(Xe.retryCount||0)+1,dedupe:!0})))}return Fe=!1,Dt(),!0},[b,r]),De=P.useCallback((...xe)=>XA(r,C.current,...xe),[]);if(Hp(()=>{F.current=e,k.current=t,Ye(D)||(ce.current=D)}),Hp(()=>{if(!b)return;const xe=Pe.bind(qt,Yp);let _e=0;N().revalidateOnFocus&&(_e=Date.now()+N().focusThrottleInterval);const pe=U5(b,v,(Fe,Xe={})=>{if(Fe==KA){const Ve=Date.now();N().revalidateOnFocus&&Ve>_e&&M()&&(_e=Ve+N().focusThrottleInterval,xe())}else if(Fe==WA)N().revalidateOnReconnect&&M()&&xe();else{if(Fe==zA)return Pe();if(Fe==ET)return Pe(Xe)}});return R.current=!1,C.current=b,A.current=!0,H({_k:I}),fe&&(x[b]||(Ye($)||Tl?xe():E5(xe))),()=>{R.current=!0,pe()}},[b]),Hp(()=>{let xe;function _e(){const pe=_r(d)?d(O().data):d;pe&&xe!==-1&&(xe=setTimeout(je,pe))}function je(){!O().error&&(f||N().isVisible())&&(h||N().isOnline())?Pe(Yp).then(_e):_e()}return _e(),()=>{xe&&(clearTimeout(xe),xe=-1)}},[d,f,h,b]),P.useDebugValue(ue),i){const xe=b&&Ye($);if(!TT&&Tl&&xe)throw new Error("Fallback data is required when using Suspense in SSR.");xe&&(F.current=e,k.current=t,R.current=!1);const _e=E[b],je=!Ye(_e)&&xe?De(_e):IT;if(zp(je),!Ye(ie)&&xe)throw ie;const pe=xe?Pe(Yp):IT;!Ye(ue)&&xe&&(pe.status="fulfilled",pe.value=!0),zp(pe)}return{mutate:De,get data(){return U.data=!0,ue},get error(){return U.error=!0,ie},get isValidating(){return U.isValidating=!0,ye},get isLoading(){return U.isLoading=!0,Ae}}},es=B5($5),j5=n=>Qe.get(n).then(e=>e.data),ZA=P.memo(({movie:n,onReady:e})=>{const t=Qt(),[r,s]=P.useState(null),[i,o]=P.useState(!1),l=n.title||n.name||"Untitled",u=(n.release_date||n.first_air_date||"").split("-")[0],d=n.backdrop_path?`https://image.tmdb.org/t/p/original${n.backdrop_path}`:"https://via.placeholder.com/1920x1080/000000/666666?text=No+Image",f=n.poster_path?`https://image.tmdb.org/t/p/original${n.poster_path}`:d;P.useEffect(()=>{(async()=>{try{const v=n.media_type||"movie",E=(await Qe.get(`${nt.TMDB_BASE_URL}/${v}/${n.id}/videos?api_key=${nt.TMDB_API_KEY}`)).data.results.find(b=>b.type==="Trailer"&&b.site==="YouTube");E?s(E.key):e&&!i&&(o(!0),e())}catch(v){console.error("Failed to fetch trailer:",v),e&&!i&&(o(!0),e())}})()},[n.id,n.media_type,e,i]);const h=()=>{e&&!i&&(o(!0),e())};return S.jsxs("div",{className:"relative h-[75vh] sm:h-[70vh] md:h-[80vh] lg:h-[85vh] w-full overflow-hidden",children:[S.jsxs("div",{className:"absolute inset-0 scale-105",children:[S.jsx("img",{src:f,alt:l,className:"sm:hidden w-full h-full object-cover object-top",onLoad:h}),S.jsx("div",{className:"hidden sm:block w-full h-full",children:r?S.jsx("iframe",{src:`https://www.youtube.com/embed/${r}?autoplay=1&mute=1&loop=1&playlist=${r}&controls=0&showinfo=0&rel=0&modestbranding=1&playsinline=1&enablejsapi=1`,title:`${l} Trailer`,className:"w-full h-full object-cover pointer-events-none",style:{width:"100%",height:"100%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%) scale(1.5)",border:"none"},allow:"autoplay; encrypted-media",allowFullScreen:!0,onLoad:h}):S.jsx("img",{src:d,alt:l,className:"w-full h-full object-cover",onLoad:h})})]}),S.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent"}),S.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-2/3 bg-gradient-to-t from-black via-black/40 to-transparent"}),S.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/60 to-transparent md:from-black/80"}),S.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1/4 bg-gradient-to-t from-red-950/30 via-transparent to-transparent mix-blend-multiply"}),S.jsx("div",{className:"absolute inset-0 flex flex-col justify-end pb-safe",children:S.jsx("div",{className:"px-4 sm:px-6 md:px-8 lg:px-12 xl:px-16 pb-24 sm:pb-20 md:pb-24",children:S.jsxs("div",{className:"max-w-4xl space-y-3 sm:space-y-4",children:[n.vote_average>0&&S.jsxs("div",{className:"inline-flex items-center gap-2 px-3.5 py-1.5 bg-gradient-to-r from-yellow-500/20 to-yellow-600/20 backdrop-blur-xl rounded-full border border-yellow-500/40 shadow-lg",children:[S.jsx(gl,{className:"w-4 h-4 text-yellow-400 fill-yellow-400"}),S.jsx("span",{className:"text-white font-bold text-sm",children:n.vote_average.toFixed(1)}),u&&S.jsxs("span",{className:"text-white/60 text-xs font-medium",children:[" ",u]})]}),S.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-black text-white line-clamp-2 leading-[1.1] tracking-tight",style:{textShadow:"0 4px 12px rgba(0, 0, 0, 0.9), 0 2px 6px rgba(0, 0, 0, 0.8)"},children:l}),n.overview&&S.jsx("p",{className:"text-sm sm:text-base md:text-lg text-gray-100 line-clamp-2 sm:line-clamp-3 max-w-2xl leading-relaxed font-medium",style:{textShadow:"0 2px 6px rgba(0, 0, 0, 0.9)"},children:n.overview}),S.jsxs("div",{className:"flex flex-row gap-3 pt-2 sm:pt-4",children:[S.jsxs("button",{onClick:()=>t(`/${n.media_type||"movie"}/${n.id}`),className:"flex-1 sm:flex-none sm:min-w-[140px] px-5 sm:px-8 py-3.5 sm:py-3 bg-red-600 hover:bg-red-700 text-white text-base font-bold rounded-xl transition-all flex items-center justify-center gap-2.5 shadow-2xl shadow-red-600/40 active:scale-[0.98] border border-red-500/20",children:[S.jsx(kn,{className:"w-5 h-5 fill-current"}),S.jsx("span",{children:"Play"})]}),S.jsxs("button",{onClick:()=>t(`/${n.media_type||"movie"}/${n.id}`),className:"flex-1 sm:flex-none sm:min-w-[140px] px-5 sm:px-8 py-3.5 sm:py-3 bg-white/15 backdrop-blur-xl hover:bg-white/25 text-white text-base font-bold rounded-xl transition-all flex items-center justify-center gap-2.5 border border-white/30 shadow-xl active:scale-[0.98]",children:[S.jsx(rM,{className:"w-5 h-5"}),S.jsx("span",{children:"Info"})]})]})]})})})]})});ZA.displayName="MovieSlide";const V5=()=>{const{data:n,error:e,isLoading:t}=es(`${nt.TMDB_BASE_URL}/trending/all/day?api_key=${nt.TMDB_API_KEY}`,j5,{revalidateOnFocus:!1}),r=P.useMemo(()=>n?.results?.slice(0,7)||[],[n]),[s,i]=hf({loop:!0},[pf({delay:5e3,stopOnInteraction:!1})]),[o,l]=P.useState(0),[u,d]=P.useState(!1),f=P.useCallback(()=>{i&&l(i.selectedScrollSnap())},[i]);return P.useEffect(()=>{i&&(i.on("select",f),f())},[i,f]),t?S.jsx("div",{className:"h-[65vh] sm:h-[70vh] md:h-[80vh] lg:h-[85vh] bg-black"}):e||!r.length?S.jsx("div",{className:"h-[65vh] sm:h-[70vh] md:h-[80vh] lg:h-[85vh] bg-black flex items-center justify-center",children:S.jsx("p",{className:"text-white text-base sm:text-lg md:text-xl",children:"Unable to load content"})}):S.jsxs("div",{className:`relative transition-opacity duration-1000 ${u?"opacity-100":"opacity-0"}`,children:[S.jsx("div",{className:"overflow-hidden",ref:s,children:S.jsx("div",{className:"flex",children:r.map((h,m)=>S.jsx("div",{className:"flex-[0_0_100%] min-w-0",children:S.jsx(ZA,{movie:h,onReady:m===0?()=>d(!0):void 0})},h.id))})}),S.jsxs("div",{className:"absolute bottom-6 sm:bottom-8 left-0 right-0 pb-safe z-20",children:[S.jsx("div",{className:"sm:hidden flex justify-center items-center gap-1",children:r.map((h,m)=>S.jsx("button",{onClick:()=>i?.scrollTo(m),className:`transition-all duration-300 ${m===o?"w-4 h-0.5 bg-red-600 rounded-full":"w-0.5 h-0.5 bg-white/30 hover:bg-white/50 rounded-full"}`,"aria-label":`Go to slide ${m+1}`},m))}),S.jsx("div",{className:"hidden sm:flex justify-center items-center gap-2",children:r.map((h,m)=>S.jsx("button",{onClick:()=>i?.scrollTo(m),className:`transition-all duration-300 rounded-full ${m===o?"w-8 h-1.5 bg-red-600 shadow-lg shadow-red-600/50":"w-1.5 h-1.5 bg-white/40 hover:bg-white/70 active:scale-90"}`,"aria-label":`Go to slide ${m+1}`},m))})]})]})},G5=n=>Qe.get(n).then(e=>e.data),H5={28:"Action",12:"Adventure",16:"Animation",35:"Comedy",80:"Crime",99:"Documentary",18:"Drama",10751:"Family",14:"Fantasy",36:"History",27:"Horror",10402:"Music",9648:"Mystery",10749:"Romance",878:"Sci-Fi",10770:"TV Movie",53:"Thriller",10752:"War",37:"Western"},e_=P.memo(({movie:n,index:e,onPlay:t})=>{const[r,s]=P.useState(!1),[i,o]=P.useState({x:0,y:0}),l=f=>{const h=f.currentTarget.getBoundingClientRect(),m=((f.clientX-h.left)/h.width-.5)*40,v=((f.clientY-h.top)/h.height-.5)*40;o({x:m,y:v})},u=r?i.y/40*-10:0,d=r?i.x/40*10:0;return S.jsxs(Ke.div,{className:"group cursor-pointer touch-target relative",onMouseEnter:()=>s(!0),onMouseLeave:()=>{s(!1),o({x:0,y:0})},onMouseMove:l,onClick:t,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1,rotateX:u,rotateY:d},transition:{delay:e*.03,duration:.3,rotateX:{duration:.2,ease:"easeOut"},rotateY:{duration:.2,ease:"easeOut"}},whileHover:{scale:1.03},whileTap:{scale:.98},style:{transformStyle:"preserve-3d",perspective:1e3},children:[S.jsx("div",{className:"relative overflow-hidden rounded-xl bg-neutral-900/90 border border-neutral-800/60 shadow-xl transition-all duration-500",children:S.jsxs("div",{style:{aspectRatio:"27/40"},className:"relative overflow-hidden",children:[S.jsx(Ke.img,{src:n.poster_path?`https://image.tmdb.org/t/p/w500${n.poster_path}`:"https://via.placeholder.com/270x400/1a1a1a/ef4444?text=No+Image",alt:n.title||n.name,className:"w-full h-full object-cover",loading:"lazy",animate:{scale:r?1.08:1},transition:{duration:.6,ease:[.34,1.56,.64,1]}}),S.jsx(Ke.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:r?1:0,background:r?"radial-gradient(circle at center, rgba(239, 68, 68, 0.25) 0%, transparent 70%)":"transparent"},transition:{duration:.5,ease:[.22,1,.36,1]}}),S.jsx(Ke.div,{className:"absolute inset-0 bg-black",initial:{opacity:0},animate:{opacity:r?.5:0},transition:{duration:.5,ease:[.22,1,.36,1]}}),S.jsx(Ke.div,{className:"absolute inset-0 flex items-center justify-center",initial:{opacity:0,scale:0},animate:{opacity:r?1:0,scale:r?1:0,x:i.x*.6,y:i.y*.6},transition:{opacity:{duration:.5,ease:[.34,1.56,.64,1]},scale:{duration:.5,ease:[.34,1.56,.64,1]},x:{duration:.2,ease:[.22,1,.36,1]},y:{duration:.2,ease:[.22,1,.36,1]}},children:S.jsxs(Ke.button,{className:"relative w-16 h-16 rounded-full flex items-center justify-center overflow-hidden",onClick:f=>{f.stopPropagation(),t()},whileHover:{scale:1.12},whileTap:{scale:.92},transition:{type:"spring",stiffness:400,damping:25},style:{background:"linear-gradient(135deg, rgba(239, 68, 68, 0.95), rgba(220, 38, 38, 0.9))",backdropFilter:"blur(20px) saturate(180%)",WebkitBackdropFilter:"blur(20px) saturate(180%)",border:"2px solid rgba(255, 255, 255, 0.5)",boxShadow:"0 8px 32px rgba(239, 68, 68, 0.5), 0 0 40px rgba(239, 68, 68, 0.3), inset 0 2px 8px rgba(255, 255, 255, 0.4)"},children:[S.jsx(Ke.div,{className:"absolute inset-0",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.3) 0%, transparent 100%)"},animate:{background:["linear-gradient(135deg, rgba(255, 255, 255, 0.3) 0%, transparent 100%)","linear-gradient(225deg, rgba(255, 255, 255, 0.3) 0%, transparent 100%)","linear-gradient(135deg, rgba(255, 255, 255, 0.3) 0%, transparent 100%)"]},transition:{duration:4,repeat:1/0,ease:[.22,1,.36,1]}}),S.jsx(kn,{size:26,className:"text-white relative z-10 ml-1",strokeWidth:0,fill:"white"})]})}),S.jsxs(Ke.div,{className:"absolute top-2 right-2 px-2.5 py-1 rounded-lg flex items-center gap-1",style:{background:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(15px) saturate(150%)",WebkitBackdropFilter:"blur(15px) saturate(150%)",border:"1px solid rgba(255, 255, 255, 0.15)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"},whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:25},children:[S.jsx(gl,{size:11,className:"text-yellow-400",fill:"#facc15"}),S.jsx("span",{className:"text-white text-xs font-semibold",children:n.vote_average.toFixed(1)})]}),n.genre_ids&&n.genre_ids.length>0&&S.jsx(Ke.div,{className:"absolute bottom-2 left-2 px-2.5 py-1 rounded-md",style:{background:"rgba(0, 0, 0, 0.75)",backdropFilter:"blur(15px) saturate(150%)",WebkitBackdropFilter:"blur(15px) saturate(150%)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"},initial:{opacity:0,y:8,scale:.95},animate:{opacity:r?1:0,y:r?0:8,scale:r?1:.95},transition:{duration:.4,ease:[.34,1.56,.64,1]},children:S.jsx("span",{className:"text-white text-[10px] font-medium tracking-wide",children:n.genre_ids.slice(0,2).map(f=>H5[f]).filter(Boolean).join("  ")})}),S.jsx(Ke.button,{className:"absolute top-2 left-2 w-7 h-7 rounded-lg flex items-center justify-center",style:{background:"rgba(255, 255, 255, 0.12)",backdropFilter:"blur(15px) saturate(150%)",WebkitBackdropFilter:"blur(15px) saturate(150%)",border:"1px solid rgba(255, 255, 255, 0.25)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"},initial:{opacity:0,scale:.85},animate:{opacity:r?1:0,scale:r?1:.85},transition:{duration:.4,ease:[.34,1.56,.64,1]},onClick:f=>{f.stopPropagation()},whileHover:{scale:1.15},whileTap:{scale:.9},children:S.jsx(z1,{size:14,className:"text-white",strokeWidth:2.5})})]})}),S.jsxs("div",{className:"mt-3 px-1",children:[S.jsx(Ke.h3,{className:"font-semibold text-white text-sm sm:text-sm mb-1 truncate",animate:{color:r?"#ef4444":"#ffffff"},transition:{duration:.4,ease:[.22,1,.36,1]},children:n.title||n.name}),S.jsx("p",{className:"text-gray-500 text-xs sm:text-xs",children:(n.release_date||n.first_air_date||"").slice(0,4)})]})]})});e_.displayName="MovieCard";const K5=({title:n,endpoint:e})=>{const t=Qt(),{data:r,error:s,isLoading:i}=es(e?`${nt.TMDB_BASE_URL}${e}?api_key=${nt.TMDB_API_KEY}`:null,G5,{revalidateOnFocus:!1,revalidateOnReconnect:!1,dedupingInterval:6e4});if(s)return null;if(i)return S.jsx("section",{className:"mb-8 sm:mb-12 md:mb-16",children:S.jsxs("div",{className:"container mx-auto mobile-padding sm:px-6",children:[S.jsx("div",{className:"h-6 sm:h-8 bg-gradient-to-r from-red-800/30 to-red-900/30 rounded-lg w-48 sm:w-64 mb-4 sm:mb-6 animate-pulse"}),S.jsx("div",{className:"mobile-card-grid tablet-grid-3 desktop-grid-6 gap-3 sm:gap-4 md:gap-6",children:Array.from({length:6}).map((d,f)=>S.jsx("div",{className:"aspect-[27/40] bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg sm:rounded-xl animate-pulse"},f))})]})});const l=(r?.results||[]).filter(d=>{const f=d.media_type==="tv"||!d.media_type&&!d.title?"tv":"movie",h=!!(d.poster_path||d.backdrop_path);return(f==="movie"||f==="tv")&&h}),u=d=>{const f=d.media_type==="tv"||!d.media_type&&!d.title?"tv":"movie";t(`/${f}/${d.id}`)};return S.jsx("section",{className:"mb-16",children:S.jsxs("div",{className:"container mx-auto mobile-padding sm:px-6",children:[S.jsx("div",{className:"mb-8",children:S.jsxs("h2",{className:"text-3xl font-black text-white mb-3 relative",children:[n,S.jsx("div",{className:"absolute -bottom-1 left-0 h-1 bg-gradient-to-r from-red-500 to-red-600 w-24 rounded-full"})]})}),S.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6",children:l.slice(0,18).map((d,f)=>S.jsx(e_,{movie:d,index:f,onPlay:()=>u(d)},`${d.id}-${f}`))})]})})},W5=P.memo(K5),z5={home:[{key:"trending-all",title:"Trending Now",endpoint:"/trending/all/week"},{key:"in-theaters",title:"In Theaters",endpoint:"/movie/now_playing"},{key:"popular-movies",title:"Popular Movies",endpoint:"/movie/popular"},{key:"popular-tv",title:"Popular TV Shows",endpoint:"/tv/popular"},{key:"top-rated-movies",title:"Top Rated Movies",endpoint:"/movie/top_rated"},{key:"family-night",title:"Family Picks",endpoint:"/discover/movie?with_genres=10751"},{key:"sci-fi",title:"Science Fiction",endpoint:"/discover/movie?with_genres=878"}],movies:[{key:"trending-movies",title:"Trending Movies",endpoint:"/trending/movie/week"},{key:"movies-now-playing",title:"Now Playing",endpoint:"/movie/now_playing"},{key:"movies-popular",title:"Popular Movies",endpoint:"/movie/popular"},{key:"movies-top-rated",title:"Top Rated Movies",endpoint:"/movie/top_rated"},{key:"movies-upcoming",title:"Upcoming Releases",endpoint:"/movie/upcoming"},{key:"movies-action",title:"Action and Adventure",endpoint:"/discover/movie?with_genres=28,12"},{key:"movies-comedy",title:"Comedy Hits",endpoint:"/discover/movie?with_genres=35"},{key:"movies-horror",title:"Horror Highlights",endpoint:"/discover/movie?with_genres=27"},{key:"movies-animation",title:"Animated Favorites",endpoint:"/discover/movie?with_genres=16"}],series:[{key:"trending-tv",title:"Trending TV",endpoint:"/trending/tv/week"},{key:"tv-popular",title:"Popular TV Shows",endpoint:"/tv/popular"},{key:"tv-top-rated",title:"Top Rated TV",endpoint:"/tv/top_rated"},{key:"tv-on-air",title:"Currently Airing",endpoint:"/tv/on_the_air"},{key:"tv-airing-today",title:"Airing Today",endpoint:"/tv/airing_today"},{key:"tv-drama",title:"Drama and Suspense",endpoint:"/discover/tv?with_genres=18,9648,80"},{key:"tv-documentary",title:"Documentary Series",endpoint:"/discover/tv?with_genres=99"},{key:"tv-animation",title:"Animated Series",endpoint:"/discover/tv?with_genres=16"}],new:[{key:"trending-today",title:"Trending Today",endpoint:"/trending/all/day"},{key:"trending-week",title:"Trending This Week",endpoint:"/trending/all/week"},{key:"upcoming-movies",title:"Coming Soon",endpoint:"/movie/upcoming"},{key:"now-playing-new",title:"Now Playing In Theaters",endpoint:"/movie/now_playing"},{key:"tv-on-the-air",title:"New Episodes",endpoint:"/tv/on_the_air"},{key:"tv-airing-today-new",title:"Fresh On TV Today",endpoint:"/tv/airing_today"}]},Y5={home:"all",movies:"movie",series:"tv",new:"all"},q5=n=>{const e=new URLSearchParams(n).get("section");return e==="movies"||e==="series"||e==="new"?e:"home"};function X5(){const n=Mn(),e=P.useMemo(()=>q5(n.search),[n.search]),t=P.useMemo(()=>z5[e],[e]),r=Y5[e];return P.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[e]),S.jsx("div",{className:"relative min-h-screen bg-black text-white",children:S.jsxs("main",{className:"relative z-10",children:[S.jsx(V5,{variant:r}),S.jsx("div",{className:"py-12 space-y-16",children:t.map(s=>S.jsx(W5,{title:s.title,endpoint:s.endpoint},s.key))})]})})}const Q5=({videoUrl:n,title:e,onClose:t,poster:r,autoPlay:s=!0,movieId:i,isTV:o,season:l,episode:u,movieData:d})=>{const[f,h]=P.useState(""),[m,v]=P.useState(!0),g=P.useRef(null),x=P.useRef(null);P.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]),P.useEffect(()=>{i?h(o&&l&&u?`https://player.videasy.net/tv/${i}/${l}/${u}`:`https://player.videasy.net/movie/${i}`):n&&h(n)},[n,i,o,l,u]);const E=()=>{v(!0),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{v(!1)},3e3)},b=()=>{v(!1)},I=A=>{A.target===A.currentTarget&&t?.()};return S.jsxs(Ke.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black z-[200] flex flex-col",onClick:I,children:[S.jsx("div",{className:"sm:hidden absolute top-0 left-0 right-0 z-[210] safe-area-inset",children:S.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-b from-black/95 to-transparent",children:[S.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 bg-white/10 backdrop-blur-xl hover:bg-white/20 active:bg-white/15 rounded-full transition-all active:scale-95 border border-white/20",children:[S.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 19l-7-7 7-7"})}),S.jsx("span",{className:"text-white font-semibold text-sm",children:"Back"})]}),S.jsx("h2",{className:"text-white text-sm font-bold line-clamp-1 max-w-[60%]",children:e})]})}),S.jsxs(Ke.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},transition:{duration:.3,ease:"easeOut"},className:"w-full h-full sm:max-w-7xl sm:mx-auto sm:my-4 sm:max-h-[95vh] overflow-y-auto custom-scrollbar flex flex-col",children:[S.jsx("div",{ref:x,className:"relative bg-black flex-shrink-0 group w-full",style:{height:window.innerWidth<640?"45vh":"clamp(350px, 65vh, 75vh)",borderRadius:window.innerWidth<640?"0":"12px",padding:window.innerWidth<640?"0":"3px",background:window.innerWidth<640?"#000":"linear-gradient(135deg, #dc2626, #000000, #dc2626)",overflow:"hidden",marginTop:window.innerWidth<640?"56px":"0"},onMouseMove:E,onMouseLeave:b,onTouchStart:E,children:S.jsxs("div",{className:"w-full h-full bg-black rounded-[6px] sm:rounded-[9px] overflow-hidden relative",children:[S.jsx("div",{className:`hidden sm:block absolute top-0 left-0 right-0 z-50 transition-all duration-300 ${m?"opacity-100 translate-y-0":"opacity-0 -translate-y-full pointer-events-none"}`,children:S.jsx("div",{className:"bg-gradient-to-b from-black/90 via-black/60 to-transparent p-4 md:p-6",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("h2",{className:"text-white text-base md:text-lg lg:text-xl font-bold drop-shadow-lg line-clamp-1 flex-1",children:e}),S.jsx("button",{onClick:t,className:"ml-4 p-2 bg-white/10 hover:bg-white/20 rounded-full transition-all",children:S.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}),f&&S.jsx("iframe",{src:f,className:"w-full h-full border-0",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen",title:e})]})}),d&&S.jsx("div",{className:"flex-1 overflow-y-auto px-4 sm:px-0 pb-safe",children:S.jsxs("div",{className:"mt-4 sm:mt-4 grid grid-cols-1 lg:grid-cols-2 gap-4",children:[S.jsxs("div",{className:"bg-neutral-900/80 backdrop-blur-sm rounded-xl p-4 sm:p-5 border border-white/5",children:[S.jsx("h3",{className:"text-base sm:text-lg font-bold text-white mb-3 line-clamp-2",children:e}),S.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3 text-xs sm:text-sm",children:[d.vote_average&&S.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-green-500/20 text-green-400 font-semibold rounded-full",children:[S.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:S.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),Math.round(d.vote_average*10),"%"]}),(d.release_date||d.first_air_date)&&S.jsx("span",{className:"px-2.5 py-1 bg-white/10 text-white font-medium rounded-full",children:(d.release_date||d.first_air_date)?.slice(0,4)}),d.runtime&&S.jsxs("span",{className:"px-2.5 py-1 bg-white/10 text-gray-300 font-medium rounded-full",children:[Math.floor(d.runtime/60),"h ",d.runtime%60,"m"]}),S.jsx("span",{className:"px-2.5 py-1 bg-red-500/20 text-red-400 font-semibold rounded-full",children:"HD"})]}),d.tagline&&S.jsxs("p",{className:"text-gray-400 italic text-sm mb-3 line-clamp-2",children:['"',d.tagline,'"']}),d.overview&&S.jsx("p",{className:"text-gray-300 text-sm leading-relaxed line-clamp-4 sm:line-clamp-5",children:d.overview})]}),S.jsxs("div",{className:"bg-neutral-900/80 backdrop-blur-sm rounded-xl p-4 sm:p-5 border border-white/5",children:[S.jsx("h4",{className:"text-base font-bold text-white mb-3",children:"Details"}),S.jsxs("div",{className:"grid grid-cols-1 gap-2.5 text-sm",children:[d.genres&&d.genres.length>0&&S.jsxs("div",{children:[S.jsx("span",{className:"text-gray-400 text-xs font-medium mb-1.5 block",children:"Genres"}),S.jsx("div",{className:"flex flex-wrap gap-2",children:d.genres.map(A=>S.jsx("span",{className:"px-3 py-1 bg-white/10 text-white rounded-full text-xs font-medium",children:A.name},A.id))})]}),d.vote_average&&S.jsxs("div",{className:"flex items-center gap-2 py-1",children:[S.jsx("span",{className:"text-gray-400 text-xs font-medium min-w-[70px]",children:"Rating"}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsxs("span",{className:"text-yellow-400 font-bold text-base",children:[" ",d.vote_average.toFixed(1)]}),d.vote_count&&S.jsxs("span",{className:"text-gray-400 text-xs",children:["(",(d.vote_count/1e3).toFixed(1),"K votes)"]})]})]}),d.status&&S.jsxs("div",{className:"flex items-center gap-2 py-1",children:[S.jsx("span",{className:"text-gray-400 text-xs font-medium min-w-[70px]",children:"Status"}),S.jsx("span",{className:"text-white text-sm font-medium",children:d.status})]}),d.spoken_languages&&d.spoken_languages.length>0&&S.jsxs("div",{className:"flex items-center gap-2 py-1",children:[S.jsx("span",{className:"text-gray-400 text-xs font-medium min-w-[70px]",children:"Languages"}),S.jsx("span",{className:"text-white text-sm",children:d.spoken_languages.slice(0,3).map(A=>A.name).join(", ")})]}),d.production_companies&&d.production_companies.length>0&&S.jsxs("div",{className:"flex items-center gap-2 py-1",children:[S.jsx("span",{className:"text-gray-400 text-xs font-medium min-w-[70px]",children:"Studio"}),S.jsx("span",{className:"text-white text-sm line-clamp-1",children:d.production_companies[0].name})]}),d.budget&&d.budget>0||d.revenue&&d.revenue>0?S.jsxs("div",{className:"flex items-center gap-4 py-1",children:[d.budget&&d.budget>0&&S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"text-gray-400 text-xs font-medium",children:"Budget"}),S.jsxs("span",{className:"text-white text-sm font-medium",children:["$",(d.budget/1e6).toFixed(0),"M"]})]}),d.revenue&&d.revenue>0&&S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"text-gray-400 text-xs font-medium",children:"Revenue"}),S.jsxs("span",{className:"text-green-400 text-sm font-medium",children:["$",(d.revenue/1e6).toFixed(0),"M"]})]})]}):null]})]})]})})]})]})},AT=()=>{const{id:n}=Bk(),e=Qt(),[t,r]=P.useState(null),[s,i]=P.useState(!0),[o,l]=P.useState([{id:"1",user:"Alex Johnson",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",text:"Amazing movie! The cinematography and storyline were absolutely incredible. Highly recommend watching this masterpiece.",rating:5,timestamp:"2 hours ago",likes:24,dislikes:1},{id:"2",user:"Sarah Kim",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b1c8?w=40&h=40&fit=crop&crop=face",text:"Great acting and visual effects. The plot kept me engaged throughout. Worth every minute of the runtime.",rating:4,timestamp:"5 hours ago",likes:18,dislikes:2},{id:"3",user:"Mike Chen",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face",text:"Solid film with excellent character development. The soundtrack complements the scenes perfectly.",rating:4,timestamp:"1 day ago",likes:12,dislikes:0}]),[u,d]=P.useState(""),[f,h]=P.useState(0),[m,v]=P.useState(!1),[g,x]=P.useState(null),[E,b]=P.useState(1),[I,A]=P.useState(1),[R,C]=P.useState(1),[F,k]=P.useState([]),[N,M]=P.useState([]),O=location.pathname.includes("/tv/"),[H,Z]=hf({loop:!0,align:"start"},[pf({delay:3e3,stopOnInteraction:!1})]);P.useEffect(()=>{let U=document.getElementById("player-root");return U||(U=document.createElement("div"),U.id="player-root",document.body.appendChild(U)),x(U),()=>{}},[]),P.useEffect(()=>{const U=async()=>{try{const te=O?"tv":"movie",G=`${nt.TMDB_BASE_URL}/${te}/${n}?api_key=${nt.TMDB_API_KEY}`;console.log(" Fetching movie details from TMDB:",G);const Q=await Qe.get(G);if(console.log(" TMDB Response:",Q.data),console.log(" Movie title from TMDB:",Q.data.title||Q.data.name),r(Q.data),O&&Q.data.seasons){const $=Q.data.seasons.filter(ie=>ie.season_number>0);if(C($.length),$.length>0){const ie=$.map(ce=>ce.episode_count);k(ie),b(1),A(1)}}const ee=`${nt.TMDB_BASE_URL}/${te}/${n}/similar?api_key=${nt.TMDB_API_KEY}`,D=await Qe.get(ee);M(D.data.results.slice(0,12))}catch(te){console.error(" Error fetching movie from TMDB:",te),console.error(" Error details:",{status:te.response?.status,message:te.response?.data,url:te.config?.url})}finally{i(!1)}};n&&(console.log(" MovieDetails: Loading movie ID:",n),U());const ne=window.open;window.open=function(...te){return console.log("Redirect attempt blocked via window.open:",te),null};const q=te=>{const G=te.target;G.tagName==="A"&&G.getAttribute("target")==="_blank"&&(te.preventDefault(),te.stopPropagation(),console.log("External link click blocked"))};return document.addEventListener("click",q,!0),()=>{window.open=ne,document.removeEventListener("click",q,!0)}},[n,O]);const se=()=>{if(!u.trim()||f===0)return;const U={id:Date.now().toString(),user:"You",avatar:"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=40&h=40&fit=crop&crop=face",text:u,rating:f,timestamp:"Just now",likes:0,dislikes:0};l([U,...o]),d(""),h(0)};return s?S.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:S.jsx(Ke.span,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:S.jsx("span",{className:"w-12 h-12 border-4 border-red-500 border-t-transparent rounded-full inline-block"})})}):t?S.jsxs("div",{className:"min-h-screen bg-black",children:[m&&t&&g&&PP.createPortal(S.jsx(Q5,{videoUrl:"",title:t.title||t.name||"Video",poster:t.poster_path?`https://image.tmdb.org/t/p/w500${t.poster_path}`:void 0,movieId:n,isTV:O,season:E,episode:I,movieData:{overview:t.overview,vote_average:t.vote_average,vote_count:t.vote_count,release_date:t.release_date,first_air_date:t.first_air_date,runtime:t.runtime,genres:t.genres,spoken_languages:t.spoken_languages,production_companies:t.production_companies,tagline:t.tagline,status:t.status,budget:t.budget,revenue:t.revenue},onClose:()=>{console.log("VideoPlayer onClose called"),v(!1)}}),g),S.jsx("div",{className:"relative",children:S.jsxs("div",{className:"h-[70vh] sm:h-[80vh] md:h-[90vh] lg:h-screen bg-cover bg-center bg-no-repeat relative",style:{backgroundImage:`url(https://image.tmdb.org/t/p/original${t.backdrop_path})`},children:[S.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/70 to-transparent"}),S.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black via-transparent to-black/50"}),S.jsx("div",{className:"absolute inset-0 flex items-center",children:S.jsxs("div",{className:"container mx-auto px-4 sm:px-6 flex items-center gap-6 sm:gap-8 md:gap-12",children:[S.jsx("div",{className:"hidden lg:block flex-shrink-0",children:S.jsx("img",{src:`https://image.tmdb.org/t/p/w500${t.poster_path}`,alt:t.title||t.name,className:"w-60 lg:w-72 xl:w-80 h-auto rounded-xl lg:rounded-2xl shadow-2xl"})}),S.jsxs("div",{className:"flex-1 text-white",children:[S.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-black mb-4 sm:mb-6 bg-gradient-to-r from-white to-red-400 bg-clip-text text-transparent line-clamp-2",children:t.title||t.name}),S.jsxs("div",{className:"flex flex-wrap items-center gap-3 sm:gap-4 md:gap-6 mb-4 sm:mb-6 text-sm sm:text-base",children:[S.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[S.jsx("div",{className:"text-yellow-400",children:S.jsx(gl,{size:16,className:"sm:w-5 sm:h-5"})}),S.jsx("span",{className:"font-bold",children:t.vote_average.toFixed(1)}),S.jsxs("span",{className:"text-gray-400 text-xs sm:text-sm",children:["(",t.vote_count,")"]})]}),S.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[S.jsx("div",{className:"text-red-400",children:S.jsx(Z2,{size:16,className:"sm:w-5 sm:h-5"})}),S.jsx("span",{children:(t.release_date||t.first_air_date)?.slice(0,4)})]}),t.runtime&&S.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[S.jsx("div",{className:"text-red-400",children:S.jsx(l0,{size:16,className:"sm:w-5 sm:h-5"})}),S.jsxs("span",{children:[t.runtime," min"]})]})]}),S.jsx("div",{className:"flex flex-wrap gap-2 mb-4 sm:mb-6",children:t.genres.map(U=>S.jsx("span",{className:"px-3 sm:px-4 py-1.5 sm:py-2 bg-white/10 backdrop-blur-md rounded-full text-xs sm:text-sm font-medium border border-white/20",children:U.name},U.id))}),S.jsx("p",{className:"text-sm sm:text-base md:text-lg text-gray-300 mb-6 sm:mb-8 max-w-2xl leading-relaxed line-clamp-3 sm:line-clamp-4",children:t.overview}),O&&R>0&&S.jsxs("div",{className:"mb-4 sm:mb-6 space-y-3 sm:space-y-4",children:[S.jsxs("div",{className:"flex flex-wrap gap-3 sm:gap-4",children:[S.jsxs("div",{className:"flex flex-col",children:[S.jsx("label",{className:"text-xs sm:text-sm text-gray-400 mb-1.5 sm:mb-2 font-medium",children:"Season"}),S.jsx("select",{value:E,onChange:U=>{const ne=Number(U.target.value);b(ne),A(1)},className:"px-3 sm:px-4 py-2 sm:py-3 bg-white/10 backdrop-blur-md border border-white/20 rounded-lg sm:rounded-xl text-white text-sm sm:text-base font-medium cursor-pointer hover:bg-white/20 transition-all focus:outline-none focus:ring-2 focus:ring-red-500",children:Array.from({length:R},(U,ne)=>ne+1).map(U=>S.jsxs("option",{value:U,className:"bg-black",children:["Season ",U]},U))})]}),S.jsxs("div",{className:"flex flex-col",children:[S.jsx("label",{className:"text-xs sm:text-sm text-gray-400 mb-1.5 sm:mb-2 font-medium",children:"Episode"}),S.jsx("select",{value:I,onChange:U=>A(Number(U.target.value)),className:"px-3 sm:px-4 py-2 sm:py-3 bg-white/10 backdrop-blur-md border border-white/20 rounded-lg sm:rounded-xl text-white text-sm sm:text-base font-medium cursor-pointer hover:bg-white/20 transition-all focus:outline-none focus:ring-2 focus:ring-red-500",children:Array.from({length:F[E-1]||10},(U,ne)=>ne+1).map(U=>S.jsxs("option",{value:U,className:"bg-black",children:["Episode ",U]},U))})]})]}),S.jsxs("div",{className:"text-sm text-gray-400",children:["Now playing: ",S.jsxs("span",{className:"text-white font-medium",children:["Season ",E,", Episode ",I]})]})]}),S.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-3 md:gap-4",children:[S.jsxs("button",{onClick:()=>{v(!0)},className:"flex items-center gap-2 px-4 sm:px-6 md:px-8 py-2.5 sm:py-3 md:py-4 bg-red-600 hover:bg-red-700 rounded-lg sm:rounded-xl font-bold text-sm sm:text-base md:text-lg transition-all shadow-2xl hover:scale-105 active:scale-95",children:[S.jsx("div",{className:"text-white",children:S.jsx(kn,{size:16,className:"sm:w-5 sm:h-5"})}),O?`Watch S${E}E${I}`:"Watch Now"]}),S.jsxs("button",{type:"button",className:"group relative inline-flex items-center gap-2 sm:gap-3 overflow-hidden rounded-lg sm:rounded-full px-4 sm:px-6 md:px-8 py-2.5 sm:py-3 md:py-3.5 text-xs sm:text-sm font-semibold uppercase tracking-wide text-white transition-all duration-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/40",children:[S.jsx("span",{className:"absolute inset-0 rounded-lg sm:rounded-full bg-white/10 backdrop-blur-lg transition-all duration-500 group-hover:bg-white/15 group-active:bg-white/10","aria-hidden":"true"}),S.jsx("span",{className:"absolute inset-0 rounded-lg sm:rounded-full border border-white/25 transition-colors duration-500 group-hover:border-red-400/60","aria-hidden":"true"}),S.jsxs("span",{className:"relative flex items-center gap-2 sm:gap-3",children:[S.jsx(z1,{size:16,className:"sm:w-[18px] sm:h-[18px] text-white/80 group-hover:text-white"}),S.jsx("span",{className:"hidden sm:inline",children:"My List"}),S.jsx("span",{className:"sm:hidden",children:"List"})]})]}),S.jsxs("button",{className:"flex items-center gap-2 sm:gap-3 px-4 sm:px-6 md:px-8 py-2.5 sm:py-3 md:py-4 bg-white/10 backdrop-blur-md border border-white/20 hover:bg-white/20 rounded-lg sm:rounded-xl font-bold text-sm sm:text-base md:text-lg transition-all hover:scale-105 active:scale-95",children:[S.jsx("div",{className:"text-white",children:S.jsx(cM,{size:16,className:"sm:w-5 sm:h-5"})}),S.jsx("span",{className:"hidden sm:inline",children:"Share"})]})]})]})]})})]})}),N.length>0&&S.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-8 sm:py-10 md:py-12 bg-black",children:[S.jsx("h2",{className:"text-2xl sm:text-3xl font-black text-white mb-6 sm:mb-8",children:"More Like This"}),S.jsxs("div",{className:"relative",children:[S.jsx("div",{className:"overflow-hidden",ref:H,children:S.jsx("div",{className:"flex gap-3 sm:gap-4",children:N.map(U=>S.jsxs("div",{onClick:()=>{e(`/${O?"tv":"movie"}/${U.id}`),window.scrollTo({top:0,behavior:"smooth"})},className:"flex-[0_0_140px] sm:flex-[0_0_160px] md:flex-[0_0_180px] lg:flex-[0_0_200px] min-w-0 cursor-pointer group",children:[S.jsxs("div",{className:"relative aspect-[2/3] rounded-lg overflow-hidden bg-neutral-800",children:[U.poster_path?S.jsx("img",{src:`https://image.tmdb.org/t/p/w500${U.poster_path}`,alt:U.title||U.name,className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500",loading:"lazy"}):S.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:"No Image"}),S.jsxs("div",{className:"absolute inset-0 bg-black/80 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col items-center justify-center gap-2 sm:gap-3 p-3 sm:p-4",children:[S.jsx("button",{className:"p-2 sm:p-3 bg-red-600 text-white rounded-full hover:scale-110 transition",children:S.jsx(kn,{size:16,className:"sm:w-5 sm:h-5"})}),S.jsxs("div",{className:"text-center",children:[S.jsx("p",{className:"text-white font-semibold text-xs sm:text-sm line-clamp-2",children:U.title||U.name}),U.vote_average>0&&S.jsxs("p",{className:"text-yellow-400 text-xs mt-1",children:[" ",U.vote_average.toFixed(1)]})]})]})]}),S.jsxs("div",{className:"mt-2",children:[S.jsx("h3",{className:"text-white font-medium text-sm line-clamp-1",children:U.title||U.name}),(U.release_date||U.first_air_date)&&S.jsx("p",{className:"text-gray-400 text-xs mt-1",children:(U.release_date||U.first_air_date).split("-")[0]})]})]},U.id))})}),S.jsx("button",{onClick:()=>Z?.scrollPrev(),className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-2 sm:-translate-x-4 p-2 sm:p-3 bg-black/80 hover:bg-black text-white rounded-full transition-all hover:scale-110 z-10",children:S.jsx(eM,{size:20,className:"sm:w-6 sm:h-6"})}),S.jsx("button",{onClick:()=>Z?.scrollNext(),className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-2 sm:translate-x-4 p-2 sm:p-3 bg-black/80 hover:bg-black text-white rounded-full transition-all hover:scale-110 z-10",children:S.jsx(V1,{size:20,className:"sm:w-6 sm:h-6"})})]})]}),S.jsx("div",{className:"container mx-auto px-4 sm:px-6 py-8 sm:py-10 md:py-12",children:S.jsxs("div",{className:"max-w-4xl mx-auto",children:[S.jsx("h2",{className:"text-2xl sm:text-3xl font-black text-white mb-6 sm:mb-8",children:"User Reviews"}),S.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-xl sm:rounded-2xl p-4 sm:p-6 border border-white/10 mb-6 sm:mb-8",children:[S.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white mb-3 sm:mb-4",children:"Share Your Review"}),S.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[S.jsx("span",{className:"text-white",children:"Rating:"}),[1,2,3,4,5].map(U=>S.jsx("button",{onClick:()=>h(U),className:`text-2xl ${U<=f?"text-yellow-400":"text-gray-600"} hover:text-yellow-400 transition-colors`,children:""},U))]}),S.jsx("textarea",{value:u,onChange:U=>d(U.target.value),placeholder:"Write your review...",className:"w-full p-3 sm:p-4 bg-black/50 border border-white/20 rounded-lg sm:rounded-xl text-white text-sm sm:text-base placeholder-gray-400 resize-none h-20 sm:h-24 mb-3 sm:mb-4 focus:outline-none focus:border-red-500"}),S.jsxs("button",{onClick:se,disabled:!u.trim()||f===0,className:"flex items-center gap-2 px-4 sm:px-6 py-2 sm:py-3 bg-red-600 hover:bg-red-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg sm:rounded-xl text-sm sm:text-base font-bold transition-all hover:scale-102 active:scale-98",children:[S.jsx("div",{className:"text-white",children:S.jsx(lM,{size:14,className:"sm:w-4 sm:h-4"})}),"Post Review"]})]}),S.jsx("div",{className:"space-y-4 sm:space-y-6",children:o.map((U,ne)=>S.jsx("div",{className:"bg-white/5 backdrop-blur-md rounded-xl sm:rounded-2xl p-4 sm:p-6 border border-white/10",children:S.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[S.jsx("img",{src:U.avatar,alt:U.user,className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full object-cover flex-shrink-0"}),S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsxs("div",{className:"flex items-center justify-between mb-2 gap-2",children:[S.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[S.jsx("h4",{className:"font-bold text-white text-sm sm:text-base truncate",children:U.user}),S.jsx("div",{className:"flex items-center flex-shrink-0",children:[...Array(5)].map((q,te)=>S.jsx("span",{className:`text-xs sm:text-sm ${te<U.rating?"text-yellow-400":"text-gray-600"}`,children:""},te))})]}),S.jsx("span",{className:"text-gray-400 text-xs sm:text-sm whitespace-nowrap",children:U.timestamp})]}),S.jsx("p",{className:"text-gray-300 text-sm sm:text-base mb-3 sm:mb-4 leading-relaxed",children:U.text}),S.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[S.jsxs("button",{className:"flex items-center gap-1.5 sm:gap-2 text-gray-400 hover:text-green-400 transition-colors text-sm",children:[S.jsx("div",{children:S.jsx(dM,{size:14,className:"sm:w-4 sm:h-4"})}),S.jsx("span",{children:U.likes})]}),S.jsxs("button",{className:"flex items-center gap-1.5 sm:gap-2 text-gray-400 hover:text-red-400 transition-colors text-sm",children:[S.jsx("div",{children:S.jsx(uM,{size:14,className:"sm:w-4 sm:h-4"})}),S.jsx("span",{children:U.dislikes})]})]})]})]})},U.id))})]})})]}):S.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:S.jsx("p",{className:"text-white text-xl",children:"Movie not found"})})},J5=n=>Qe.get(n).then(e=>e.data),Z5=[{id:28,name:"Action"},{id:12,name:"Adventure"},{id:16,name:"Animation"},{id:35,name:"Comedy"},{id:80,name:"Crime"},{id:99,name:"Documentary"},{id:18,name:"Drama"},{id:10751,name:"Family"},{id:14,name:"Fantasy"},{id:36,name:"History"},{id:27,name:"Horror"},{id:10402,name:"Music"},{id:9648,name:"Mystery"},{id:10749,name:"Romance"},{id:878,name:"Sci-Fi"},{id:10770,name:"TV Movie"},{id:53,name:"Thriller"},{id:10752,name:"War"},{id:37,name:"Western"}],e6=Array.from({length:55},(n,e)=>2025-e),t6=()=>{const n=Qt(),[e,t]=P.useState(null),[r,s]=P.useState(null),[i,o]=P.useState(1),l=()=>{let g=`${nt.TMDB_BASE_URL}/discover/movie?api_key=${nt.TMDB_API_KEY}&page=${i}&sort_by=popularity.desc`;return e&&(g+=`&with_genres=${e}`),r&&(g+=`&primary_release_year=${r}`),g},{data:u,error:d,isLoading:f}=es(l(),J5);P.useEffect(()=>{o(1)},[e,r]);const h=u?.results||[],m=g=>{n(`/movie/${g}`)},v=()=>{o(g=>g+1)};return S.jsx("div",{className:"min-h-screen bg-black pt-20 pb-16",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6",children:[S.jsxs("div",{className:"mb-8",children:[S.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-4",children:"Movies"}),S.jsx("p",{className:"text-gray-400 text-lg",children:"Explore thousands of movies"})]}),S.jsxs("div",{className:"flex flex-wrap gap-4 mb-8",children:[S.jsxs("div",{className:"relative",children:[S.jsxs("select",{value:e||"",onChange:g=>t(g.target.value?Number(g.target.value):null),className:"appearance-none bg-neutral-800 text-white px-4 py-2.5 pr-10 rounded-lg border border-neutral-700 focus:outline-none focus:border-red-600 cursor-pointer",children:[S.jsx("option",{value:"",children:"All Genres"}),Z5.map(g=>S.jsx("option",{value:g.id,children:g.name},g.id))]}),S.jsx(dd,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),S.jsxs("div",{className:"relative",children:[S.jsxs("select",{value:r||"",onChange:g=>s(g.target.value?Number(g.target.value):null),className:"appearance-none bg-neutral-800 text-white px-4 py-2.5 pr-10 rounded-lg border border-neutral-700 focus:outline-none focus:border-red-600 cursor-pointer",children:[S.jsx("option",{value:"",children:"All Years"}),e6.map(g=>S.jsx("option",{value:g,children:g},g))]}),S.jsx(dd,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),(e||r)&&S.jsx("button",{onClick:()=>{t(null),s(null)},className:"px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-lg transition",children:"Clear Filters"})]}),f&&S.jsx("div",{className:"flex justify-center items-center py-20",children:S.jsx("div",{className:"w-12 h-12 border-4 border-red-600 border-t-transparent rounded-full animate-spin"})}),d&&S.jsx("div",{className:"text-center py-20",children:S.jsx("p",{className:"text-red-500 text-xl",children:"Failed to load movies"})}),!f&&!d&&h.length>0&&S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-6",children:h.map(g=>S.jsxs("div",{onClick:()=>m(g.id),className:"group cursor-pointer",children:[S.jsxs("div",{className:"relative aspect-[2/3] rounded-lg overflow-hidden bg-neutral-800",children:[g.poster_path?S.jsx("img",{src:`https://image.tmdb.org/t/p/w500${g.poster_path}`,alt:g.title,className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500",loading:"lazy"}):S.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:"No Image"}),S.jsxs("div",{className:"absolute inset-0 bg-black/80 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col items-center justify-center gap-3 p-4",children:[S.jsx("button",{className:"p-3 bg-white text-black rounded-full hover:scale-110 transition",children:S.jsx(kn,{size:20})}),S.jsxs("div",{className:"text-center",children:[S.jsx("p",{className:"text-white font-semibold text-sm line-clamp-2",children:g.title}),g.vote_average>0&&S.jsxs("p",{className:"text-yellow-400 text-xs mt-1",children:[" ",g.vote_average.toFixed(1)]})]})]})]}),S.jsxs("div",{className:"mt-2",children:[S.jsx("h3",{className:"text-white font-medium text-sm line-clamp-1",children:g.title}),g.release_date&&S.jsx("p",{className:"text-gray-400 text-xs mt-1",children:g.release_date.split("-")[0]})]})]},g.id))}),h.length>=20&&S.jsx("div",{className:"text-center mt-12",children:S.jsx("button",{onClick:v,className:"px-8 py-3 bg-neutral-800 hover:bg-neutral-700 text-white rounded-lg transition",children:"Load More"})})]}),!f&&!d&&h.length===0&&S.jsx("div",{className:"text-center py-20",children:S.jsx("p",{className:"text-gray-400 text-xl",children:"No movies found"})})]})})},n6=n=>Qe.get(n).then(e=>e.data),r6=[{id:10759,name:"Action & Adventure"},{id:16,name:"Animation"},{id:35,name:"Comedy"},{id:80,name:"Crime"},{id:99,name:"Documentary"},{id:18,name:"Drama"},{id:10751,name:"Family"},{id:10762,name:"Kids"},{id:9648,name:"Mystery"},{id:10763,name:"News"},{id:10764,name:"Reality"},{id:10765,name:"Sci-Fi & Fantasy"},{id:10766,name:"Soap"},{id:10767,name:"Talk"},{id:10768,name:"War & Politics"},{id:37,name:"Western"}],s6=Array.from({length:55},(n,e)=>2025-e),i6=()=>{const n=Qt(),[e,t]=P.useState(null),[r,s]=P.useState(null),[i,o]=P.useState(1),l=()=>{let g=`${nt.TMDB_BASE_URL}/discover/tv?api_key=${nt.TMDB_API_KEY}&page=${i}&sort_by=popularity.desc`;return e&&(g+=`&with_genres=${e}`),r&&(g+=`&first_air_date_year=${r}`),g},{data:u,error:d,isLoading:f}=es(l(),n6);P.useEffect(()=>{o(1)},[e,r]);const h=u?.results||[],m=g=>{n(`/tv/${g}`)},v=()=>{o(g=>g+1)};return S.jsx("div",{className:"min-h-screen bg-black pt-20 pb-16",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6",children:[S.jsxs("div",{className:"mb-8",children:[S.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-4",children:"TV Series"}),S.jsx("p",{className:"text-gray-400 text-lg",children:"Discover your next binge-worthy series"})]}),S.jsxs("div",{className:"flex flex-wrap gap-4 mb-8",children:[S.jsxs("div",{className:"relative",children:[S.jsxs("select",{value:e||"",onChange:g=>t(g.target.value?Number(g.target.value):null),className:"appearance-none bg-neutral-800 text-white px-4 py-2.5 pr-10 rounded-lg border border-neutral-700 focus:outline-none focus:border-red-600 cursor-pointer",children:[S.jsx("option",{value:"",children:"All Genres"}),r6.map(g=>S.jsx("option",{value:g.id,children:g.name},g.id))]}),S.jsx(dd,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),S.jsxs("div",{className:"relative",children:[S.jsxs("select",{value:r||"",onChange:g=>s(g.target.value?Number(g.target.value):null),className:"appearance-none bg-neutral-800 text-white px-4 py-2.5 pr-10 rounded-lg border border-neutral-700 focus:outline-none focus:border-red-600 cursor-pointer",children:[S.jsx("option",{value:"",children:"All Years"}),s6.map(g=>S.jsx("option",{value:g,children:g},g))]}),S.jsx(dd,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),(e||r)&&S.jsx("button",{onClick:()=>{t(null),s(null)},className:"px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-lg transition",children:"Clear Filters"})]}),f&&S.jsx("div",{className:"flex justify-center items-center py-20",children:S.jsx("div",{className:"w-12 h-12 border-4 border-red-600 border-t-transparent rounded-full animate-spin"})}),d&&S.jsx("div",{className:"text-center py-20",children:S.jsx("p",{className:"text-red-500 text-xl",children:"Failed to load TV series"})}),!f&&!d&&h.length>0&&S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-6",children:h.map(g=>S.jsxs("div",{onClick:()=>m(g.id),className:"group cursor-pointer",children:[S.jsxs("div",{className:"relative aspect-[2/3] rounded-lg overflow-hidden bg-neutral-800",children:[g.poster_path?S.jsx("img",{src:`https://image.tmdb.org/t/p/w500${g.poster_path}`,alt:g.name,className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500",loading:"lazy"}):S.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:"No Image"}),S.jsxs("div",{className:"absolute inset-0 bg-black/80 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col items-center justify-center gap-3 p-4",children:[S.jsx("button",{className:"p-3 bg-white text-black rounded-full hover:scale-110 transition",children:S.jsx(kn,{size:20})}),S.jsxs("div",{className:"text-center",children:[S.jsx("p",{className:"text-white font-semibold text-sm line-clamp-2",children:g.name}),g.vote_average>0&&S.jsxs("p",{className:"text-yellow-400 text-xs mt-1",children:[" ",g.vote_average.toFixed(1)]})]})]})]}),S.jsxs("div",{className:"mt-2",children:[S.jsx("h3",{className:"text-white font-medium text-sm line-clamp-1",children:g.name}),g.first_air_date&&S.jsx("p",{className:"text-gray-400 text-xs mt-1",children:g.first_air_date.split("-")[0]})]})]},g.id))}),h.length>=20&&S.jsx("div",{className:"text-center mt-12",children:S.jsx("button",{onClick:v,className:"px-8 py-3 bg-neutral-800 hover:bg-neutral-700 text-white rounded-lg transition",children:"Load More"})})]}),!f&&!d&&h.length===0&&S.jsx("div",{className:"text-center py-20",children:S.jsx("p",{className:"text-gray-400 text-xl",children:"No TV series found"})})]})})},Ya=n=>Qe.get(n).then(e=>e.data),o6=()=>{const n=Qt(),[e,t]=P.useState("trending"),r=()=>`${nt.TMDB_BASE_URL}/trending/all/week?api_key=${nt.TMDB_API_KEY}`,s=()=>`${nt.TMDB_BASE_URL}/movie/now_playing?api_key=${nt.TMDB_API_KEY}&region=US`,i=()=>`${nt.TMDB_BASE_URL}/movie/top_rated?api_key=${nt.TMDB_API_KEY}`,o=()=>`${nt.TMDB_BASE_URL}/discover/movie?api_key=${nt.TMDB_API_KEY}&with_original_language=hi&sort_by=popularity.desc&page=1`,l=()=>`${nt.TMDB_BASE_URL}/discover/tv?api_key=${nt.TMDB_API_KEY}&with_genres=16&with_keywords=210024|287501&with_original_language=ja&sort_by=popularity.desc&page=1`,{data:u,error:d,isLoading:f}=es(e==="trending"?r():null,Ya),{data:h,error:m,isLoading:v}=es(e==="new"?s():null,Ya),{data:g,error:x,isLoading:E}=es(e==="topRated"?i():null,Ya),{data:b,error:I,isLoading:A}=es(e==="bollywood"?o():null,Ya),{data:R,error:C,isLoading:F}=es(e==="anime"?l():null,Ya),k=()=>{switch(e){case"trending":return u?.results||[];case"new":return h?.results?.map(U=>({...U,media_type:"movie"}))||[];case"topRated":return g?.results?.map(U=>({...U,media_type:"movie"}))||[];case"bollywood":return b?.results?.map(U=>({...U,media_type:"movie"}))||[];case"anime":return R?.results?.map(U=>({...U,media_type:"tv"}))||[];default:return[]}},N=f||v||E||A||F,M=d||m||x||I||C,O=k(),H=U=>{n(`/${U.media_type}/${U.id}`)},Z=U=>U.title||U.name||"Untitled",se=U=>{const ne=U.release_date||U.first_air_date;return ne?ne.split("-")[0]:""};return S.jsx("div",{className:"min-h-screen bg-black pt-20 pb-16",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6",children:[S.jsxs("div",{className:"mb-8",children:[S.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-4",children:"New & Popular"}),S.jsx("p",{className:"text-gray-400 text-lg",children:"What's trending and recently released"})]}),S.jsxs("div",{className:"mb-8",children:[S.jsx("div",{className:"sm:hidden overflow-x-auto scrollbar-hide -mx-4 px-4",children:S.jsxs("div",{className:"flex gap-2 pb-4 border-b border-neutral-800 min-w-max",children:[S.jsxs("button",{onClick:()=>t("trending"),className:`flex items-center gap-2 px-4 py-2.5 rounded-full font-semibold text-sm transition-all whitespace-nowrap ${e==="trending"?"bg-red-600 text-white shadow-lg shadow-red-600/30":"bg-white/5 text-gray-400 hover:bg-white/10 hover:text-white active:scale-95"}`,children:[S.jsx(pd,{size:16}),"Trending"]}),S.jsxs("button",{onClick:()=>t("new"),className:`flex items-center gap-2 px-4 py-2.5 rounded-full font-semibold text-sm transition-all whitespace-nowrap ${e==="new"?"bg-red-600 text-white shadow-lg shadow-red-600/30":"bg-white/5 text-gray-400 hover:bg-white/10 hover:text-white active:scale-95"}`,children:[S.jsx(kn,{size:16}),"New Releases"]}),S.jsxs("button",{onClick:()=>t("topRated"),className:`flex items-center gap-2 px-4 py-2.5 rounded-full font-semibold text-sm transition-all whitespace-nowrap ${e==="topRated"?"bg-red-600 text-white shadow-lg shadow-red-600/30":"bg-white/5 text-gray-400 hover:bg-white/10 hover:text-white active:scale-95"}`,children:[S.jsx(gl,{size:16}),"Top Rated"]}),S.jsxs("button",{onClick:()=>t("bollywood"),className:`flex items-center gap-2 px-4 py-2.5 rounded-full font-semibold text-sm transition-all whitespace-nowrap ${e==="bollywood"?"bg-red-600 text-white shadow-lg shadow-red-600/30":"bg-white/5 text-gray-400 hover:bg-white/10 hover:text-white active:scale-95"}`,children:[S.jsx($o,{size:16}),"Bollywood"]}),S.jsxs("button",{onClick:()=>t("anime"),className:`flex items-center gap-2 px-4 py-2.5 rounded-full font-semibold text-sm transition-all whitespace-nowrap ${e==="anime"?"bg-red-600 text-white shadow-lg shadow-red-600/30":"bg-white/5 text-gray-400 hover:bg-white/10 hover:text-white active:scale-95"}`,children:[S.jsx(dS,{size:16}),"Anime"]})]})}),S.jsxs("div",{className:"hidden sm:flex gap-4 border-b border-neutral-800",children:[S.jsxs("button",{onClick:()=>t("trending"),className:`pb-4 px-2 font-semibold transition relative ${e==="trending"?"text-white":"text-gray-400 hover:text-white"}`,children:[S.jsx(pd,{className:"inline mr-2"}),"Trending",e==="trending"&&S.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-red-600 rounded-t"})]}),S.jsxs("button",{onClick:()=>t("new"),className:`pb-4 px-2 font-semibold transition relative ${e==="new"?"text-white":"text-gray-400 hover:text-white"}`,children:[S.jsx(kn,{className:"inline mr-2"}),"New Releases",e==="new"&&S.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-red-600 rounded-t"})]}),S.jsxs("button",{onClick:()=>t("topRated"),className:`pb-4 px-2 font-semibold transition relative ${e==="topRated"?"text-white":"text-gray-400 hover:text-white"}`,children:[S.jsx(gl,{className:"inline mr-2"}),"Top Rated",e==="topRated"&&S.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-red-600 rounded-t"})]}),S.jsxs("button",{onClick:()=>t("bollywood"),className:`pb-4 px-2 font-semibold transition relative ${e==="bollywood"?"text-white":"text-gray-400 hover:text-white"}`,children:[S.jsx($o,{className:"inline mr-2"}),"Bollywood",e==="bollywood"&&S.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-red-600 rounded-t"})]}),S.jsxs("button",{onClick:()=>t("anime"),className:`pb-4 px-2 font-semibold transition relative ${e==="anime"?"text-white":"text-gray-400 hover:text-white"}`,children:[S.jsx(dS,{className:"inline mr-2"}),"Anime",e==="anime"&&S.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-red-600 rounded-t"})]})]})]}),N&&S.jsx("div",{className:"flex justify-center items-center py-20",children:S.jsx("div",{className:"w-12 h-12 border-4 border-red-600 border-t-transparent rounded-full animate-spin"})}),M&&S.jsx("div",{className:"text-center py-20",children:S.jsx("p",{className:"text-red-500 text-xl",children:"Failed to load content"})}),!N&&!M&&O.length>0&&S.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-6",children:O.map(U=>S.jsxs("div",{onClick:()=>H(U),className:"group cursor-pointer",children:[S.jsxs("div",{className:"relative aspect-[2/3] rounded-lg overflow-hidden bg-neutral-800",children:[U.poster_path?S.jsx("img",{src:`https://image.tmdb.org/t/p/w500${U.poster_path}`,alt:Z(U),className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500",loading:"lazy"}):S.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:"No Image"}),S.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 bg-black/80 text-white text-xs font-semibold rounded",children:U.media_type==="tv"?"Series":"Movie"}),S.jsxs("div",{className:"absolute inset-0 bg-black/80 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col items-center justify-center gap-3 p-4",children:[S.jsx("button",{className:"p-3 bg-white text-black rounded-full hover:scale-110 transition",children:S.jsx(kn,{size:20})}),S.jsxs("div",{className:"text-center",children:[S.jsx("p",{className:"text-white font-semibold text-sm line-clamp-2",children:Z(U)}),U.vote_average>0&&S.jsxs("p",{className:"text-yellow-400 text-xs mt-1",children:[" ",U.vote_average.toFixed(1)]})]})]})]}),S.jsxs("div",{className:"mt-2",children:[S.jsx("h3",{className:"text-white font-medium text-sm line-clamp-1",children:Z(U)}),S.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[se(U)&&S.jsx("p",{className:"text-gray-400 text-xs",children:se(U)}),U.media_type&&S.jsxs("span",{className:"text-gray-500 text-xs",children:[" ",U.media_type==="tv"?"Series":"Movie"]})]})]})]},U.id))}),!N&&!M&&O.length===0&&S.jsx("div",{className:"text-center py-20",children:S.jsx("p",{className:"text-gray-400 text-xl",children:"No content available"})})]})})},he=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},a6=Number.isSafeInteger||function(n){return typeof n=="number"&&Math.abs(n)<=l6},l6=Number.MAX_SAFE_INTEGER||9007199254740991;let we=(function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n})({}),W=(function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",n.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",n.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.ASSET_LIST_LOAD_ERROR="assetListLoadError",n.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",n.ASSET_LIST_PARSING_ERROR="assetListParsingError",n.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.ATTACH_MEDIA_ERROR="attachMediaError",n.UNKNOWN="unknown",n})({}),_=(function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.MEDIA_ENDED="hlsMediaEnded",n.STALL_RESOLVED="hlsStallResolved",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFERED_TO_END="hlsBufferedToEnd",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",n.ASSET_LIST_LOADING="hlsAssetListLoading",n.ASSET_LIST_LOADED="hlsAssetListLoaded",n.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",n.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",n.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",n.INTERSTITIAL_STARTED="hlsInterstitialStarted",n.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",n.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",n.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",n.INTERSTITIAL_ENDED="hlsInterstitialEnded",n.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",n.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",n.EVENT_CUE_ENTER="hlsEventCueEnter",n})({});var He={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ge={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class vo{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class c6{constructor(e,t,r,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new vo(e),this.fast_=new vo(t),this.defaultTTFB_=s,this.ttfb_=new vo(e)}update(e,t){const{slow_:r,fast_:s,ttfb_:i}=this;r.halfLife!==e&&(this.slow_=new vo(e,r.getEstimate(),r.getTotalWeight())),s.halfLife!==t&&(this.fast_=new vo(t,s.getEstimate(),s.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new vo(e,i.getEstimate(),i.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,s=e/1e3,i=r/s;this.fast_.sample(s,i),this.slow_.sample(s,i)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function u6(n,e,t){return(e=f6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rt(){return rt=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},rt.apply(null,arguments)}function _T(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function et(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?_T(Object(t),!0).forEach(function(r){u6(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):_T(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function d6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function f6(n){var e=d6(n,"string");return typeof e=="symbol"?e:e+""}class Xn{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const r=`[${e}]:`;this.trace=js,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r)}}const js=function(){},h6={trace:js,debug:js,log:js,warn:js,info:js,error:js};function lg(){return rt({},h6)}function p6(n,e){const t=self.console[n];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${n}] >`):js}function RT(n,e,t){return e[n]?e[n].bind(e):p6(n,t)}const cg=lg();function m6(n,e,t){const r=lg();if(typeof console=="object"&&n===!0||typeof n=="object"){const s=["debug","log","info","warn","error"];s.forEach(i=>{r[i]=RT(i,n,t)});try{r.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return lg()}s.forEach(i=>{cg[i]=RT(i,n)})}else rt(cg,r);return r}const tt=cg;function ti(n=!0){return typeof self>"u"?void 0:(n||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function g6(n){return typeof self<"u"&&n===self.ManagedMediaSource}function t_(n,e){const t=Object.keys(n),r=Object.keys(e),s=t.length,i=r.length;return!s||!i||s===i&&!t.some(o=>r.indexOf(o)===-1)}function Dn(n,e=!1){if(typeof TextDecoder<"u"){const d=new TextDecoder("utf-8").decode(n);if(e){const f=d.indexOf("\0");return f!==-1?d.substring(0,f):d}return d.replace(/\0/g,"")}const t=n.length;let r,s,i,o="",l=0;for(;l<t;){if(r=n[l++],r===0&&e)return o;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:s=n[l++],o+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=n[l++],i=n[l++],o+=String.fromCharCode((r&15)<<12|(s&63)<<6|(i&63)<<0);break}}return o}function Vt(n){let e="";for(let t=0;t<n.length;t++){let r=n[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}function n_(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function y6(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var qp={exports:{}},LT;function v6(){return LT||(LT=1,(function(n,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,l={buildAbsoluteURL:function(u,d,f){if(f=f||{},u=u.trim(),d=d.trim(),!d){if(!f.alwaysNormalize)return u;var h=l.parseURL(u);if(!h)throw new Error("Error trying to parse base URL.");return h.path=l.normalizePath(h.path),l.buildURLFromParts(h)}var m=l.parseURL(d);if(!m)throw new Error("Error trying to parse relative URL.");if(m.scheme)return f.alwaysNormalize?(m.path=l.normalizePath(m.path),l.buildURLFromParts(m)):d;var v=l.parseURL(u);if(!v)throw new Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var g=s.exec(v.path);v.netLoc=g[1],v.path=g[2]}v.netLoc&&!v.path&&(v.path="/");var x={scheme:v.scheme,netLoc:m.netLoc,path:null,params:m.params,query:m.query,fragment:m.fragment};if(!m.netLoc&&(x.netLoc=v.netLoc,m.path[0]!=="/"))if(!m.path)x.path=v.path,m.params||(x.params=v.params,m.query||(x.query=v.query));else{var E=v.path,b=E.substring(0,E.lastIndexOf("/")+1)+m.path;x.path=l.normalizePath(b)}return x.path===null&&(x.path=f.alwaysNormalize?l.normalizePath(m.path):m.path),l.buildURLFromParts(x)},parseURL:function(u){var d=r.exec(u);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(i,"");u.length!==(u=u.replace(o,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}};n.exports=l})()})(qp)),qp.exports}var B0=v6();class U0{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var it={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class r_{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,E6(this,"stats")}setByteRange(e,t){const r=e.split("@",2);let s;r.length===1?s=t?.byteRangeEndOffset||0:s=parseInt(r[1]),this._byteRange=[s,parseInt(r[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[it.AUDIO]:null,[it.VIDEO]:null,[it.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new U0),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=B0.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[it.AUDIO]=null,e[it.VIDEO]=null,e[it.AUDIOVIDEO]=null}}function wt(n){return n.sn!=="initSegment"}class Xp extends r_{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(he(e)&&he(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const r=Object.keys(t);if(r.length===1){const s=this._decryptdata=t[r[0]]||null;s&&(this._decryptdata=s.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=he(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const r=Object.keys(this.levelkeys),s=r.length;if(s>1||s===1&&(t=this.levelkeys[r[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!he(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return wt(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var r;const s=t[e];s&&!((r=this._decryptdata)!=null&&r.keyId)&&(this._decryptdata=s.getDecryptData(this.sn,t))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,s,i,o=!1){const{elementaryStreams:l}=this,u=l[e];if(!u){l[e]={startPTS:t,endPTS:r,startDTS:s,endDTS:i,partial:o};return}u.startPTS=Math.min(u.startPTS,t),u.endPTS=Math.max(u.endPTS,r),u.startDTS=Math.min(u.startDTS,s),u.endDTS=Math.max(u.endDTS,i)}}class x6 extends r_{constructor(e,t,r,s,i){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=s;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function s_(n,e){const t=Object.getPrototypeOf(n);if(t){const r=Object.getOwnPropertyDescriptor(t,e);return r||s_(t,e)}}function E6(n,e){const t=s_(n,e);t&&(t.enumerable=!0,Object.defineProperty(n,e,t))}const CT=Math.pow(2,32)-1,S6=[].push,i_={video:1,audio:2,id3:3,text:4};function kt(n){return String.fromCharCode.apply(null,n)}function o_(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function Oe(n,e){const t=a_(n,e);return t<0?4294967296+t:t}function kT(n,e){let t=Oe(n,e);return t*=Math.pow(2,32),t+=Oe(n,e+4),t}function a_(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function T6(n){const e=n.byteLength;for(let t=0;t<e;){const r=Oe(n,t);if(r>8&&n[t+4]===109&&n[t+5]===111&&n[t+6]===111&&n[t+7]===102)return!0;t=r>1?t+r:e}return!1}function $e(n,e){const t=[];if(!e.length)return t;const r=n.byteLength;for(let s=0;s<r;){const i=Oe(n,s),o=kt(n.subarray(s+4,s+8)),l=i>1?s+i:r;if(o===e[0])if(e.length===1)t.push(n.subarray(s+8,l));else{const u=$e(n.subarray(s+8,l),e.slice(1));u.length&&S6.apply(t,u)}s=l}return t}function b6(n){const e=[],t=n[0];let r=8;const s=Oe(n,r);r+=4;let i=0,o=0;t===0?(i=Oe(n,r),o=Oe(n,r+4),r+=8):(i=kT(n,r),o=kT(n,r+8),r+=16),r+=2;let l=n.length+o;const u=o_(n,r);r+=2;for(let d=0;d<u;d++){let f=r;const h=Oe(n,f);f+=4;const m=h&2147483647;if((h&2147483648)>>>31===1)return tt.warn("SIDX has hierarchical references (not supported)"),null;const g=Oe(n,f);f+=4,e.push({referenceSize:m,subsegmentDuration:g,info:{duration:g/s,start:l,end:l+m-1}}),l+=m,f+=4,r=f}return{earliestPresentationTime:i,timescale:s,version:t,referencesCount:u,references:e}}function l_(n){const e=[],t=$e(n,["moov","trak"]);for(let s=0;s<t.length;s++){const i=t[s],o=$e(i,["tkhd"])[0];if(o){let l=o[0];const u=Oe(o,l===0?12:20),d=$e(i,["mdia","mdhd"])[0];if(d){l=d[0];const f=Oe(d,l===0?12:20),h=$e(i,["mdia","hdlr"])[0];if(h){const m=kt(h.subarray(8,12)),v={soun:it.AUDIO,vide:it.VIDEO}[m],g=$e(i,["mdia","minf","stbl","stsd"])[0],x=w6(g);v?(e[u]={timescale:f,type:v,stsd:x},e[v]=et({timescale:f,id:u},x)):e[u]={timescale:f,type:m,stsd:x}}}}}return $e(n,["moov","mvex","trex"]).forEach(s=>{const i=Oe(s,4),o=e[i];o&&(o.default={duration:Oe(s,12),flags:Oe(s,20)})}),e}function w6(n){const e=n.subarray(8),t=e.subarray(86),r=kt(e.subarray(4,8));let s=r,i;const o=r==="enca"||r==="encv";if(o){const d=$e(e,[r])[0].subarray(r==="enca"?28:78);$e(d,["sinf"]).forEach(h=>{const m=$e(h,["schm"])[0];if(m){const v=kt(m.subarray(4,8));if(v==="cbcs"||v==="cenc"){const g=$e(h,["frma"])[0];g&&(s=kt(g))}}})}const l=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const u=$e(t,["avcC"])[0];u&&u.length>3&&(s+="."+Eu(u[1])+Eu(u[2])+Eu(u[3]),i=xu(l==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const u=$e(e,[r])[0],d=$e(u.subarray(28),["esds"])[0];if(d&&d.length>7){let f=4;if(d[f++]!==3)break;f=Qp(d,f),f+=2;const h=d[f++];if(h&128&&(f+=2),h&64&&(f+=d[f++]),d[f++]!==4)break;f=Qp(d,f);const m=d[f++];if(m===64)s+="."+Eu(m);else break;if(f+=12,d[f++]!==5)break;f=Qp(d,f);const v=d[f++];let g=(v&248)>>3;g===31&&(g+=1+((v&7)<<3)+((d[f]&224)>>5)),s+="."+g}break}case"hvc1":case"hev1":{const u=$e(t,["hvcC"])[0];if(u&&u.length>12){const d=u[1],f=["","A","B","C"][d>>6],h=d&31,m=Oe(u,2),v=(d&32)>>5?"H":"L",g=u[12],x=u.subarray(6,12);s+="."+f+h,s+="."+I6(m).toString(16).toUpperCase(),s+="."+v+g;let E="";for(let b=x.length;b--;){const I=x[b];(I||E)&&(E="."+I.toString(16).toUpperCase()+E)}s+=E}i=xu(l=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=xu(s,t)||s;break}case"vp09":{const u=$e(t,["vpcC"])[0];if(u&&u.length>6){const d=u[4],f=u[5],h=u[6]>>4&15;s+="."+Ir(d)+"."+Ir(f)+"."+Ir(h)}break}case"av01":{const u=$e(t,["av1C"])[0];if(u&&u.length>2){const d=u[1]>>>5,f=u[1]&31,h=u[2]>>>7?"H":"M",m=(u[2]&64)>>6,v=(u[2]&32)>>5,g=d===2&&m?v?12:10:m?10:8,x=(u[2]&16)>>4,E=(u[2]&8)>>3,b=(u[2]&4)>>2,I=u[2]&3;s+="."+d+"."+Ir(f)+h+"."+Ir(g)+"."+x+"."+E+b+I+"."+Ir(1)+"."+Ir(1)+"."+Ir(1)+"."+0,i=xu("dav1",t)}break}}return{codec:s,encrypted:o,supplemental:i}}function xu(n,e){const t=$e(e,["dvvC"]),r=t.length?t[0]:$e(e,["dvcC"])[0];if(r){const s=r[2]>>1&127,i=r[2]<<5&32|r[3]>>3&31;return n+"."+Ir(s)+"."+Ir(i)}}function I6(n){let e=0;for(let t=0;t<32;t++)e|=(n>>t&1)<<31-t;return e>>>0}function Qp(n,e){const t=e+5;for(;n[e++]&128&&e<t;);return e}function Eu(n){return("0"+n.toString(16).toUpperCase()).slice(-2)}function Ir(n){return(n<10?"0":"")+n}function A6(n,e){if(!n||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&c_(n,(r,s)=>{const i=r.subarray(8,24);i.some(o=>o!==0)||(tt.log(`[eme] Patching keyId in 'enc${s?"a":"v"}>sinf>>tenc' box: ${Vt(i)} -> ${Vt(t)}`),r.set(t,8))})}function _6(n){const e=[];return c_(n,t=>e.push(t.subarray(8,24))),e}function c_(n,e){$e(n,["moov","trak"]).forEach(r=>{const s=$e(r,["mdia","minf","stbl","stsd"])[0];if(!s)return;const i=s.subarray(8);let o=$e(i,["enca"]);const l=o.length>0;l||(o=$e(i,["encv"])),o.forEach(u=>{const d=l?u.subarray(28):u.subarray(78);$e(d,["sinf"]).forEach(h=>{const m=u_(h);m&&e(m,l)})})})}function u_(n){const e=$e(n,["schm"])[0];if(e){const t=kt(e.subarray(4,8));if(t==="cbcs"||t==="cenc"){const r=$e(n,["schi","tenc"])[0];if(r)return r}}}function R6(n,e,t){const r={},s=$e(n,["moof","traf"]);for(let i=0;i<s.length;i++){const o=s[i],l=$e(o,["tfhd"])[0],u=Oe(l,4),d=e[u];if(!d)continue;r[u]||(r[u]={start:NaN,duration:0,sampleCount:0,timescale:d.timescale,type:d.type});const f=r[u],h=$e(o,["tfdt"])[0];if(h){const A=h[0];let R=Oe(h,4);A===1&&(R===CT?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(R*=CT+1,R+=Oe(h,8))),he(R)&&(!he(f.start)||R<f.start)&&(f.start=R)}const m=d.default,v=Oe(l,0)|m?.flags;let g=m?.duration||0;v&8&&(v&2?g=Oe(l,12):g=Oe(l,8));const x=$e(o,["trun"]);let E=f.start||0,b=0,I=g;for(let A=0;A<x.length;A++){const R=x[A],C=Oe(R,4),F=f.sampleCount;f.sampleCount+=C;const k=R[3]&1,N=R[3]&4,M=R[2]&1,O=R[2]&2,H=R[2]&4,Z=R[2]&8;let se=8,U=C;for(k&&(se+=4),N&&C&&(!(R[se+1]&1)&&f.keyFrameIndex===void 0&&(f.keyFrameIndex=F),se+=4,M?(I=Oe(R,se),se+=4):I=g,O&&(se+=4),Z&&(se+=4),E+=I,b+=I,U--);U--;)M?(I=Oe(R,se),se+=4):I=g,O&&(se+=4),H&&(R[se+1]&1||f.keyFrameIndex===void 0&&(f.keyFrameIndex=f.sampleCount-(U+1),f.keyFrameStart=E),se+=4),Z&&(se+=4),E+=I,b+=I;!b&&g&&(b+=g*C)}f.duration+=b}if(!Object.keys(r).some(i=>r[i].duration)){let i=1/0,o=0;const l=$e(n,["sidx"]);for(let u=0;u<l.length;u++){const d=b6(l[u]);if(d!=null&&d.references){i=Math.min(i,d.earliestPresentationTime/d.timescale);const f=d.references.reduce((h,m)=>h+m.info.duration||0,0);o=Math.max(o,f+d.earliestPresentationTime/d.timescale)}}o&&he(o)&&Object.keys(r).forEach(u=>{r[u].duration||(r[u].duration=o*r[u].timescale-r[u].start)})}return r}function L6(n){const e={valid:null,remainder:null},t=$e(n,["moof"]);if(t.length<2)return e.remainder=n,e;const r=t[t.length-1];return e.valid=n.slice(0,r.byteOffset-8),e.remainder=n.slice(r.byteOffset-8),e}function qn(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function PT(n,e){const t=[],r=e.samples,s=e.timescale,i=e.id;let o=!1;return $e(r,["moof"]).map(u=>{const d=u.byteOffset-8;$e(u,["traf"]).map(h=>{const m=$e(h,["tfdt"]).map(v=>{const g=v[0];let x=Oe(v,4);return g===1&&(x*=Math.pow(2,32),x+=Oe(v,8)),x/s})[0];return m!==void 0&&(n=m),$e(h,["tfhd"]).map(v=>{const g=Oe(v,4),x=Oe(v,0)&16777215,E=(x&1)!==0,b=(x&2)!==0,I=(x&8)!==0;let A=0;const R=(x&16)!==0;let C=0;const F=(x&32)!==0;let k=8;g===i&&(E&&(k+=8),b&&(k+=4),I&&(A=Oe(v,k),k+=4),R&&(C=Oe(v,k),k+=4),F&&(k+=4),e.type==="video"&&(o=mf(e.codec)),$e(h,["trun"]).map(N=>{const M=N[0],O=Oe(N,0)&16777215,H=(O&1)!==0;let Z=0;const se=(O&4)!==0,U=(O&256)!==0;let ne=0;const q=(O&512)!==0;let te=0;const G=(O&1024)!==0,Q=(O&2048)!==0;let ee=0;const D=Oe(N,4);let $=8;H&&(Z=Oe(N,$),$+=4),se&&($+=4);let ie=Z+d;for(let ce=0;ce<D;ce++){if(U?(ne=Oe(N,$),$+=4):ne=A,q?(te=Oe(N,$),$+=4):te=C,G&&($+=4),Q&&(M===0?ee=Oe(N,$):ee=a_(N,$),$+=4),e.type===it.VIDEO){let ue=0;for(;ue<te;){const fe=Oe(r,ie);if(ie+=4,C6(o,r[ie])){const Se=r.subarray(ie,ie+fe);$0(Se,o?2:1,n+ee/s,t)}ie+=fe,ue+=fe+4}}n+=ne/s}}))})})}),t}function mf(n){if(!n)return!1;const e=n.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function C6(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function $0(n,e,t,r){const s=d_(n);let i=0;i+=e;let o=0,l=0,u=0;for(;i<s.length;){o=0;do{if(i>=s.length)break;u=s[i++],o+=u}while(u===255);l=0;do{if(i>=s.length)break;u=s[i++],l+=u}while(u===255);const d=s.length-i;let f=i;if(l<d)i+=l;else if(l>d){tt.error(`Malformed SEI payload. ${l} is too small, only ${d} bytes left to parse.`);break}if(o===4){if(s[f++]===181){const m=o_(s,f);if(f+=2,m===49){const v=Oe(s,f);if(f+=4,v===1195456820){const g=s[f++];if(g===3){const x=s[f++],E=31&x,b=64&x,I=b?2+E*3:0,A=new Uint8Array(I);if(b){A[0]=x;for(let R=1;R<I;R++)A[R]=s[f++]}r.push({type:g,payloadType:o,pts:t,bytes:A})}}}}}else if(o===5&&l>16){const h=[];for(let g=0;g<16;g++){const x=s[f++].toString(16);h.push(x.length==1?"0"+x:x),(g===3||g===5||g===7||g===9)&&h.push("-")}const m=l-16,v=new Uint8Array(m);for(let g=0;g<m;g++)v[g]=s[f++];r.push({payloadType:o,pts:t,uuid:h.join(""),userData:Dn(v),userDataBytes:v})}}}function d_(n){const e=n.byteLength,t=[];let r=1;for(;r<e-2;)n[r]===0&&n[r+1]===0&&n[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return n;const s=e-t.length,i=new Uint8Array(s);let o=0;for(r=0;r<s;o++,r++)o===t[0]&&(o++,t.shift()),i[r]=n[o];return i}function k6(n){const e=n[0];let t="",r="",s=0,i=0,o=0,l=0,u=0,d=0;if(e===0){for(;kt(n.subarray(d,d+1))!=="\0";)t+=kt(n.subarray(d,d+1)),d+=1;for(t+=kt(n.subarray(d,d+1)),d+=1;kt(n.subarray(d,d+1))!=="\0";)r+=kt(n.subarray(d,d+1)),d+=1;r+=kt(n.subarray(d,d+1)),d+=1,s=Oe(n,12),i=Oe(n,16),l=Oe(n,20),u=Oe(n,24),d=28}else if(e===1){d+=4,s=Oe(n,d),d+=4;const h=Oe(n,d);d+=4;const m=Oe(n,d);for(d+=4,o=2**32*h+m,a6(o)||(o=Number.MAX_SAFE_INTEGER,tt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),l=Oe(n,d),d+=4,u=Oe(n,d),d+=4;kt(n.subarray(d,d+1))!=="\0";)t+=kt(n.subarray(d,d+1)),d+=1;for(t+=kt(n.subarray(d,d+1)),d+=1;kt(n.subarray(d,d+1))!=="\0";)r+=kt(n.subarray(d,d+1)),d+=1;r+=kt(n.subarray(d,d+1)),d+=1}const f=n.subarray(d,n.byteLength);return{schemeIdUri:t,value:r,timeScale:s,presentationTime:o,presentationTimeDelta:i,eventDuration:l,id:u,payload:f}}function P6(n,...e){const t=e.length;let r=8,s=t;for(;s--;)r+=e[s].byteLength;const i=new Uint8Array(r);for(i[0]=r>>24&255,i[1]=r>>16&255,i[2]=r>>8&255,i[3]=r&255,i.set(n,4),s=0,r=8;s<t;s++)i.set(e[s],r),r+=e[s].byteLength;return i}function D6(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let r,s;r=0,s=new Uint8Array;let i;r>0?(i=new Uint8Array(4),e.length>0&&new DataView(i.buffer).setUint32(0,e.length,!1)):i=new Uint8Array;const o=new Uint8Array(4);return t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),P6([112,115,115,104],new Uint8Array([r,0,0,0]),n,i,s,o,t)}function N6(n){const e=[];if(n instanceof ArrayBuffer){const t=n.byteLength;let r=0;for(;r+32<t;){const s=new DataView(n,r),i=O6(s);e.push(i),r+=i.size}}return e}function O6(n){const e=n.getUint32(0),t=n.byteOffset,r=n.byteLength;if(r<e)return{offset:t,size:r};if(n.getUint32(4)!==1886614376)return{offset:t,size:e};const i=n.getUint32(8)>>>24;if(i!==0&&i!==1)return{offset:t,size:e};const o=n.buffer,l=Vt(new Uint8Array(o,t+12,16));let u=null,d=null,f=0;if(i===0)f=28;else{const m=n.getUint32(28);if(!m||r<32+m*16)return{offset:t,size:e};u=[];for(let v=0;v<m;v++)u.push(new Uint8Array(o,t+32+v*16,16));f=32+m*16}if(!f)return{offset:t,size:e};const h=n.getUint32(f);return e-32<h?{offset:t,size:e}:(d=new Uint8Array(o,t+f+4,h),{version:i,systemId:l,kids:u,data:d,offset:t,size:e})}const f_=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Go={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function j0(n,e){const t=Go[e];return!!t&&!!t[n.slice(0,4)]}function bl(n,e,t=!0){return!n.split(",").some(r=>!V0(r,e,t))}function V0(n,e,t=!0){var r;const s=ti(t);return(r=s?.isTypeSupported(wl(n,e)))!=null?r:!1}function wl(n,e){return`${e}/mp4;codecs=${n}`}function DT(n){if(n){const e=n.substring(0,4);return Go.video[e]}return 2}function _d(n){const e=f_();return n.split(",").reduce((t,r)=>{const i=e&&mf(r)?9:Go.video[r];return i?(i*2+t)/(t?3:2):(Go.audio[r]+t)/(t?2:1)},0)}const Jp={};function M6(n,e=!0){if(Jp[n])return Jp[n];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[n];for(let s=0;s<t.length;s++){var r;if(V0(t[s],"audio",e))return Jp[n]=t[s],t[s];if(t[s]==="mp3"&&(r=ti(e))!=null&&r.isTypeSupported("audio/mpeg"))return""}return n}const F6=/flac|opus|mp4a\.40\.34/i;function Rd(n,e=!0){return n.replace(F6,t=>M6(t.toLowerCase(),e))}function B6(n,e){const t=[];if(n){const r=n.split(",");for(let s=0;s<r.length;s++)j0(r[s],"video")||t.push(r[s])}return e&&t.push(e),t.join(",")}function Yu(n,e){if(n&&(n.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(n)!==-1)&&(NT(n,"audio")||NT(n,"video")))return n;if(e){const t=e.split(",");if(t.length>1){if(n){for(let r=t.length;r--;)if(t[r].substring(0,4)===n.substring(0,4))return t[r]}return t[0]}}return e||n}function NT(n,e){return j0(n,e)&&V0(n,e)}function U6(n){const e=n.split(",");for(let t=0;t<e.length;t++){const r=e[t].split(".");r.length>2&&r[0]==="avc1"&&(e[t]=`avc1.${parseInt(r[1]).toString(16)}${("000"+parseInt(r[2]).toString(16)).slice(-4)}`)}return e.join(",")}function $6(n){if(n.startsWith("av01.")){const e=n.split("."),t=["0","111","01","01","01","0"];for(let r=e.length;r>4&&r<10;r++)e[r]=t[r-4];return e.join(".")}return n}function OT(n){const e=ti(n)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function ug(n){return n.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const j6={supported:!0,powerEfficient:!0,smooth:!0},V6={supported:!1,smooth:!1,powerEfficient:!1},h_={supported:!0,configurations:[],decodingInfoResults:[j6]};function p_(n,e){return{supported:!1,configurations:e,decodingInfoResults:[V6],error:n}}function G6(n,e,t,r,s,i){const o=n.videoCodec,l=n.audioCodec?n.audioGroups:null,u=i?.audioCodec,d=i?.channels,f=d?parseInt(d):u?1/0:2;let h=null;if(l!=null&&l.length)try{l.length===1&&l[0]?h=e.groups[l[0]].channels:h=l.reduce((m,v)=>{if(v){const g=e.groups[v];if(!g)throw new Error(`Audio track group ${v} not found`);Object.keys(g.channels).forEach(x=>{m[x]=(m[x]||0)+g.channels[x]})}return m},{2:0})}catch{return!0}return o!==void 0&&(o.split(",").some(m=>mf(m))||n.width>1920&&n.height>1088||n.height>1920&&n.width>1088||n.frameRate>Math.max(r,30)||n.videoRange!=="SDR"&&n.videoRange!==t||n.bitrate>Math.max(s,8e6))||!!h&&he(f)&&Object.keys(h).some(m=>parseInt(m)>f)}function m_(n,e,t,r={}){const s=n.videoCodec;if(!s&&!n.audioCodec||!t)return Promise.resolve(h_);const i=[],o=H6(n),l=o.length,u=K6(n,e,l>0),d=u.length;for(let f=l||1*d||1;f--;){const h={type:"media-source"};if(l&&(h.video=o[f%l]),d){h.audio=u[f%d];const m=h.audio.bitrate;h.video&&m&&(h.video.bitrate-=m)}i.push(h)}if(s){const f=navigator.userAgent;if(s.split(",").some(h=>mf(h))&&f_())return Promise.resolve(p_(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${f})`),i))}return Promise.all(i.map(f=>{const h=z6(f);return r[h]||(r[h]=t.decodingInfo(f))})).then(f=>({supported:!f.some(h=>!h.supported),configurations:i,decodingInfoResults:f})).catch(f=>({supported:!1,configurations:i,decodingInfoResults:[],error:f}))}function H6(n){var e;const t=(e=n.videoCodec)==null?void 0:e.split(","),r=g_(n),s=n.width||640,i=n.height||480,o=n.frameRate||30,l=n.videoRange.toLowerCase();return t?t.map(u=>{const d={contentType:wl($6(u),"video"),width:s,height:i,bitrate:r,framerate:o};return l!=="sdr"&&(d.transferFunction=l),d}):[]}function K6(n,e,t){var r;const s=(r=n.audioCodec)==null?void 0:r.split(","),i=g_(n);return s&&n.audioGroups?n.audioGroups.reduce((o,l)=>{var u;const d=l?(u=e.groups[l])==null?void 0:u.tracks:null;return d?d.reduce((f,h)=>{if(h.groupId===l){const m=parseFloat(h.channels||"");s.forEach(v=>{const g={contentType:wl(v,"audio"),bitrate:t?W6(v,i):i};m&&(g.channels=""+m),f.push(g)})}return f},o):o},[]):[]}function W6(n,e){if(e<=1)return 1;let t=128e3;return n==="ec-3"?t=768e3:n==="ac-3"&&(t=64e4),Math.min(e/2,t)}function g_(n){return Math.ceil(Math.max(n.bitrate*.9,n.averageBitrate)/1e3)*1e3||1}function z6(n){let e="";const{audio:t,video:r}=n;if(r){const s=ug(r.contentType);e+=`${s}_r${r.height}x${r.width}f${Math.ceil(r.framerate)}${r.transferFunction||"sd"}_${Math.ceil(r.bitrate/1e5)}`}if(t){const s=ug(t.contentType);e+=`${r?"_":""}${s}_c${t.channels}`}return e}const dg=["NONE","TYPE-0","TYPE-1",null];function Y6(n){return dg.indexOf(n)>-1}const Ld=["SDR","PQ","HLG"];function q6(n){return!!n&&Ld.indexOf(n)>-1}var qu={No:"",Yes:"YES",v2:"v2"};function MT(n){const{canSkipUntil:e,canSkipDateRanges:t,age:r}=n,s=r<e/2;return e&&s?t?qu.v2:qu.Yes:qu.No}class FT{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Il{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const r=(t=e.supplemental)==null?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return BT(this._audioGroups,e)}hasSubtitleGroup(e){return BT(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function BT(n,e){return!e||!n?!1:n.indexOf(e)!==-1}function X6(){if(typeof matchMedia=="function"){const n=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(n.media!==e.media)return n.matches===!0}return!1}function Q6(n,e){let t=!1,r=[];if(n&&(t=n!=="SDR",r=[n]),e){r=e.allowedVideoRanges||Ld.slice(0);const s=r.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:s&&X6(),t||(r=["SDR"])}return{preferHDR:t,allowedVideoRanges:r}}const J6=n=>{const e=new WeakSet;return(t,r)=>{if(n&&(r=n(t,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},ot=(n,e)=>JSON.stringify(n,J6(e));function Z6(n,e,t,r,s){const i=Object.keys(n),o=r?.channels,l=r?.audioCodec,u=s?.videoCodec,d=o&&parseInt(o)===2;let f=!1,h=!1,m=1/0,v=1/0,g=1/0,x=1/0,E=0,b=[];const{preferHDR:I,allowedVideoRanges:A}=Q6(e,s);for(let N=i.length;N--;){const M=n[i[N]];f||(f=M.channels[2]>0),m=Math.min(m,M.minHeight),v=Math.min(v,M.minFramerate),g=Math.min(g,M.minBitrate),A.filter(H=>M.videoRanges[H]>0).length>0&&(h=!0)}m=he(m)?m:0,v=he(v)?v:0;const R=Math.max(1080,m),C=Math.max(30,v);g=he(g)?g:t,t=Math.max(g,t),h||(e=void 0);const F=i.length>1;return{codecSet:i.reduce((N,M)=>{const O=n[M];if(M===N)return N;if(b=h?A.filter(H=>O.videoRanges[H]>0):[],F){if(O.minBitrate>t)return Tr(M,`min bitrate of ${O.minBitrate} > current estimate of ${t}`),N;if(!O.hasDefaultAudio)return Tr(M,"no renditions with default or auto-select sound found"),N;if(l&&M.indexOf(l.substring(0,4))%5!==0)return Tr(M,`audio codec preference "${l}" not found`),N;if(o&&!d){if(!O.channels[o])return Tr(M,`no renditions with ${o} channel sound found (channels options: ${Object.keys(O.channels)})`),N}else if((!l||d)&&f&&O.channels[2]===0)return Tr(M,"no renditions with stereo sound found"),N;if(O.minHeight>R)return Tr(M,`min resolution of ${O.minHeight} > maximum of ${R}`),N;if(O.minFramerate>C)return Tr(M,`min framerate of ${O.minFramerate} > maximum of ${C}`),N;if(!b.some(H=>O.videoRanges[H]>0))return Tr(M,`no variants with VIDEO-RANGE of ${ot(b)} found`),N;if(u&&M.indexOf(u.substring(0,4))%5!==0)return Tr(M,`video codec preference "${u}" not found`),N;if(O.maxScore<E)return Tr(M,`max score of ${O.maxScore} < selected max of ${E}`),N}return N&&(_d(M)>=_d(N)||O.fragmentError>n[N].fragmentError)?N:(x=O.minIndex,E=O.maxScore,M)},void 0),videoRanges:b,preferHDR:I,minFramerate:v,minBitrate:g,minIndex:x}}function Tr(n,e){tt.log(`[abr] start candidates with "${n}" ignored because ${e}`)}function y_(n){return n.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);const s=t.channels||"2";return r.channels[s]=(r.channels[s]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function e8(n,e,t,r){return n.slice(t,r+1).reduce((s,i,o)=>{if(!i.codecSet)return s;const l=i.audioGroups;let u=s[i.codecSet];u||(s[i.codecSet]=u={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:o,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!l,fragmentError:0}),u.minBitrate=Math.min(u.minBitrate,i.bitrate);const d=Math.min(i.height,i.width);return u.minHeight=Math.min(u.minHeight,d),u.minFramerate=Math.min(u.minFramerate,i.frameRate),u.minIndex=Math.min(u.minIndex,o),u.maxScore=Math.max(u.maxScore,i.score),u.fragmentError+=i.fragmentError,u.videoRanges[i.videoRange]=(u.videoRanges[i.videoRange]||0)+1,l&&l.forEach(f=>{if(!f)return;const h=e.groups[f];h&&(u.hasDefaultAudio=u.hasDefaultAudio||e.hasDefaultAudio?h.hasDefault:h.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(h.channels).forEach(m=>{u.channels[m]=(u.channels[m]||0)+h.channels[m]}))}),s},{})}function UT(n){if(!n)return n;const{lang:e,assocLang:t,characteristics:r,channels:s,audioCodec:i}=n;return{lang:e,assocLang:t,characteristics:r,channels:s,audioCodec:i}}function Rr(n,e,t){if("attrs"in n){const r=e.indexOf(n);if(r!==-1)return r}for(let r=0;r<e.length;r++){const s=e[r];if(Di(n,s,t))return r}return-1}function Di(n,e,t){const{groupId:r,name:s,lang:i,assocLang:o,default:l}=n,u=n.forced;return(r===void 0||e.groupId===r)&&(s===void 0||e.name===s)&&(i===void 0||t8(i,e.lang))&&(i===void 0||e.assocLang===o)&&(l===void 0||e.default===l)&&(u===void 0||e.forced===u)&&(!("characteristics"in n)||n8(n.characteristics||"",e.characteristics))&&(t===void 0||t(n,e))}function t8(n,e="--"){return n.length===e.length?n===e:n.startsWith(e)||e.startsWith(n)}function n8(n,e=""){const t=n.split(","),r=e.split(",");return t.length===r.length&&!t.some(s=>r.indexOf(s)===-1)}function Ii(n,e){const{audioCodec:t,channels:r}=n;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function r8(n,e,t,r,s){const i=e[r],l=e.reduce((m,v,g)=>{const x=v.uri;return(m[x]||(m[x]=[])).push(g),m},{})[i.uri];l.length>1&&(r=Math.max.apply(Math,l));const u=i.videoRange,d=i.frameRate,f=i.codecSet.substring(0,4),h=$T(e,r,m=>{if(m.videoRange!==u||m.frameRate!==d||m.codecSet.substring(0,4)!==f)return!1;const v=m.audioGroups,g=t.filter(x=>!v||v.indexOf(x.groupId)!==-1);return Rr(n,g,s)>-1});return h>-1?h:$T(e,r,m=>{const v=m.audioGroups,g=t.filter(x=>!v||v.indexOf(x.groupId)!==-1);return Rr(n,g,s)>-1})}function $T(n,e,t){for(let r=e;r>-1;r--)if(t(n[r]))return r;for(let r=e+1;r<n.length;r++)if(t(n[r]))return r;return-1}function Cd(n,e){var t;return!!n&&n!==((t=e.loadLevelObj)==null?void 0:t.uri)}class s8 extends Xn{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var r;const{fragCurrent:s,partCurrent:i,hls:o}=this,{autoLevelEnabled:l,media:u}=o;if(!s||!u)return;const d=performance.now(),f=i?i.stats:s.stats,h=i?i.duration:s.duration,m=d-f.loading.start,v=o.minAutoLevel,g=s.level,x=this._nextAutoLevel;if(f.aborted||f.loaded&&f.loaded===f.total||g<=v){this.clearTimer(),this._nextAutoLevel=-1;return}if(!l)return;const E=x>-1&&x!==g,b=!!t||E;if(!b&&(u.paused||!u.playbackRate||!u.readyState))return;const I=o.mainForwardBufferInfo;if(!b&&I===null)return;const A=this.bwEstimator.getEstimateTTFB(),R=Math.abs(u.playbackRate);if(m<=Math.max(A,1e3*(h/(R*2))))return;const C=I?I.len/R:0,F=f.loading.first?f.loading.first-f.loading.start:-1,k=f.loaded&&F>-1,N=this.getBwEstimate(),M=o.levels,O=M[g],H=Math.max(f.loaded,Math.round(h*(s.bitrate||O.averageBitrate)/8));let Z=k?m-F:m;Z<1&&k&&(Z=Math.min(m,f.loaded*8/N));const se=k?f.loaded*1e3/Z:0,U=A/1e3,ne=se?(H-f.loaded)/se:H*8/N+U;if(ne<=C)return;const q=se?se*8:N,te=((r=t?.details||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,G=this.hls.config.abrBandWidthUpFactor;let Q=Number.POSITIVE_INFINITY,ee;for(ee=g-1;ee>v;ee--){const ce=M[ee].maxBitrate,ue=!M[ee].details||te;if(Q=this.getTimeToLoadFrag(U,q,h*ce,ue),Q<Math.min(C,h+U))break}if(Q>=ne||Q>h*10)return;k?this.bwEstimator.sample(m-Math.min(A,F),f.loaded):this.bwEstimator.sampleTTFB(m);const D=M[ee].maxBitrate;this.getBwEstimate()*G>D&&this.resetEstimator(D);const $=this.findBestLevel(D,v,ee,0,C,1,1);$>-1&&(ee=$),this.warn(`Fragment ${s.sn}${i?" part "+i.index:""} of level ${g} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${C.toFixed(3)} s
      Estimated load time for current fragment: ${ne.toFixed(3)} s
      Estimated load time for down switch fragment: ${Q.toFixed(3)} s
      TTFB estimate: ${F|0} ms
      Current BW estimate: ${he(N)?N|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${ee} @ ${D|0} bps`),o.nextLoadLevel=o.nextAutoLevel=ee,this.clearTimer();const ie=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===ee&&ee>0){const ce=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${ee>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${ce.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,ee>v){let ue=this.findBestLevel(this.hls.levels[v].bitrate,v,ee,0,ce,1,1);ue===-1&&(ue=v),this.hls.nextLoadLevel=this.hls.nextAutoLevel=ue,this.resetEstimator(this.hls.levels[ue].bitrate)}}};E||ne>Q*2?ie():this.timer=self.setInterval(ie,Q*1e3),o.trigger(_.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:i,stats:f})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new c6(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.FRAG_LOADING,this.onFragLoading,this),e.on(_.FRAG_LOADED,this.onFragLoaded,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this),e.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(_.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.FRAG_LOADING,this.onFragLoading,this),e.off(_.FRAG_LOADED,this.onFragLoaded,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this),e.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(_.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(_.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var s;this.fragCurrent=r,this.partCurrent=(s=t.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case W.BUFFER_ADD_CODEC_ERROR:case W.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case W.FRAG_LOAD_TIMEOUT:{const r=t.frag,{fragCurrent:s,partCurrent:i}=this;if(r&&s&&r.sn===s.sn&&r.level===s.level){const o=performance.now(),l=i?i.stats:r.stats,u=o-l.loading.start,d=l.loading.first?l.loading.first-l.loading.start:-1;if(l.loaded&&d>-1){const h=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(u-Math.min(h,d),l.loaded)}else this.bwEstimator.sampleTTFB(u)}break}}}getTimeToLoadFrag(e,t,r,s){const i=e+r/t,o=s?e+this.lastLevelLoadSec:0;return i+o}onLevelLoaded(e,t){const r=this.hls.config,{loading:s}=t.stats,i=s.end-s.first;he(i)&&(this.lastLevelLoadSec=i/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:r}){const s=r?r.stats:t.stats;if(t.type===ge.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const i=r?r.duration:t.duration,o=this.hls.levels[t.level],l=(o.loaded?o.loaded.bytes:0)+s.loaded,u=(o.loaded?o.loaded.duration:0)+i;o.loaded={bytes:l,duration:u},o.realBitrate=Math.round(8*l/u)}if(t.bitrateTest){const i={stats:s,frag:t,part:r,id:t.type};this.onFragBuffered(_.FRAG_BUFFERED,i),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:r,part:s}=t,i=s!=null&&s.stats.loaded?s.stats:r.stats;if(i.aborted||this.ignoreFragment(r))return;const o=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,i.loaded),i.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ge.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,i=this.findBestLevel(r,t,e,0,s,1,1);if(i>-1)return i;const o=this.hls.firstLevel,l=Math.min(Math.max(o,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${l}`),l}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,r=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(e!==-1&&(!r||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const i=r&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,i)&&o[e].loadError<=o[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:s,config:i,minAutoLevel:o}=r,l=t?t.duration:e?e.duration:0,u=this.getBwEstimate(),d=this.getStarvationDelay();let f=i.abrBandWidthFactor,h=i.abrBandWidthUpFactor;if(d){const E=this.findBestLevel(u,o,s,d,0,f,h);if(E>=0)return this.rebufferNotice=-1,E}let m=l?Math.min(l,i.maxStarvationDelay):i.maxStarvationDelay;if(!d){const E=this.bitrateTestDelay;E&&(m=(l?Math.min(l,i.maxLoadingDelay):i.maxLoadingDelay)-E,this.info(`bitrate test took ${Math.round(1e3*E)}ms, set first fragment max fetchDuration to ${Math.round(1e3*m)} ms`),f=h=1)}const v=this.findBestLevel(u,o,s,d,m,f,h);if(this.rebufferNotice!==v&&(this.rebufferNotice=v,this.info(`${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${v}`)),v>-1)return v;const g=r.levels[o],x=r.loadLevelObj;return x&&g?.bitrate<x.bitrate?o:r.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,s=e.mainForwardBufferInfo;return(s?s.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,s,i,o,l){var u;const d=s+i,f=this.lastLoadedFragLevel,h=f===-1?this.hls.firstLevel:f,{fragCurrent:m,partCurrent:v}=this,{levels:g,allAudioTracks:x,loadLevel:E,config:b}=this.hls;if(g.length===1)return 0;const I=g[h],A=!!((u=this.hls.latestLevelDetails)!=null&&u.live),R=E===-1||f===-1;let C,F="SDR",k=I?.frameRate||0;const{audioPreference:N,videoPreference:M}=b,O=this.audioTracksByGroup||(this.audioTracksByGroup=y_(x));let H=-1;if(R){if(this.firstSelection!==-1)return this.firstSelection;const q=this.codecTiers||(this.codecTiers=e8(g,O,t,r)),te=Z6(q,F,e,N,M),{codecSet:G,videoRanges:Q,minFramerate:ee,minBitrate:D,minIndex:$,preferHDR:ie}=te;H=$,C=G,F=ie?Q[Q.length-1]:Q[0],k=ee,e=Math.max(e,D),this.log(`picked start tier ${ot(te)}`)}else C=I?.codecSet,F=I?.videoRange;const Z=v?v.duration:m?m.duration:0,se=this.bwEstimator.getEstimateTTFB()/1e3,U=[];for(let q=r;q>=t;q--){var ne;const te=g[q],G=q>h;if(!te)continue;if(b.useMediaCapabilities&&!te.supportedResult&&!te.supportedPromise){const ue=navigator.mediaCapabilities;typeof ue?.decodingInfo=="function"&&G6(te,O,F,k,e,N)?(te.supportedPromise=m_(te,O,ue,this.supportedCache),te.supportedPromise.then(fe=>{if(!this.hls)return;te.supportedResult=fe;const Se=this.hls.levels,ye=Se.indexOf(te);fe.error?this.warn(`MediaCapabilities decodingInfo error: "${fe.error}" for level ${ye} ${ot(fe)}`):fe.supported?fe.decodingInfoResults.some(Ae=>Ae.smooth===!1||Ae.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${ye} not smooth or powerEfficient: ${ot(fe)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${ye} ${ot(fe)}`),ye>-1&&Se.length>1&&(this.log(`Removing unsupported level ${ye}`),this.hls.removeLevel(ye),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(fe=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${fe}`)})):te.supportedResult=h_}if((C&&te.codecSet!==C||F&&te.videoRange!==F||G&&k>te.frameRate||!G&&k>0&&k<te.frameRate||(ne=te.supportedResult)!=null&&(ne=ne.decodingInfoResults)!=null&&ne.some(ue=>ue.smooth===!1))&&(!R||q!==H)){U.push(q);continue}const Q=te.details,ee=(v?Q?.partTarget:Q?.averagetargetduration)||Z;let D;G?D=l*e:D=o*e;const $=Z&&s>=Z*2&&i===0?te.averageBitrate:te.maxBitrate,ie=this.getTimeToLoadFrag(se,D,$*ee,Q===void 0);if(D>=$&&(q===f||te.loadError===0&&te.fragmentError===0)&&(ie<=se||!he(ie)||A&&!this.bitrateTestDelay||ie<d)){const ue=this.forcedAutoLevel;return q!==E&&(ue===-1||ue!==E)&&(U.length&&this.trace(`Skipped level(s) ${U.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${g[U[0]].codecs}" ${g[U[0]].videoRange}; not compatible with "${C}" ${F}`),this.info(`switch candidate:${h}->${q} adjustedbw(${Math.round(D)})-bitrate=${Math.round(D-$)} ttfb:${se.toFixed(1)} avgDuration:${ee.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${ie.toFixed(1)} firstSelection:${R} codecSet:${te.codecSet} videoRange:${te.videoRange} hls.loadLevel:${E}`)),R&&(this.firstSelection=q),q}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),t)}}const v_={search:function(n,e){let t=0,r=n.length-1,s=null,i=null;for(;t<=r;){s=(t+r)/2|0,i=n[s];const o=e(i);if(o>0)t=s+1;else if(o<0)r=s-1;else return i}return null}};function i8(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!he(e))return null;const r=n[0].programDateTime;if(e<(r||0))return null;const s=n[n.length-1].endProgramDateTime;if(e>=(s||0))return null;for(let i=0;i<n.length;++i){const o=n[i];if(a8(e,t,o))return o}return null}function ji(n,e,t=0,r=0,s=.005){let i=null;if(n){i=e[1+n.sn-e[0].sn]||null;const l=n.endDTS-t;l>0&&l<15e-7&&(t+=15e-7),i&&n.level!==i.level&&i.end<=n.end&&(i=e[2+n.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(i=e[0]);if(i&&((!n||n.level===i.level)&&jT(t,r,i)===0||o8(i,n,Math.min(s,r))))return i;const o=v_.search(e,jT.bind(null,t,r));return o&&(o!==n||!i)?o:i}function o8(n,e,t){if(e&&e.start===0&&e.level<n.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((s,i)=>(i[0]==="INF"&&(s+=parseFloat(i[1])),s),t);return n.start<=r}return!1}function jT(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=n?1:t.start-r>n&&t.start?-1:0}function a8(n,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>n}function x_(n,e,t){if(n&&n.startCC<=e&&n.endCC>=e){let r=n.fragments;const{fragmentHint:s}=n;s&&(r=r.concat(s));let i;return v_.search(r,o=>o.cc<e?1:o.cc>e?-1:(i=o,o.end<=t?1:o.start>t?-1:0)),i||null}return null}function kd(n){switch(n.details){case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_TIMEOUT:case W.LEVEL_LOAD_TIMEOUT:case W.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function E_(n){return n.details.startsWith("key")}function S_(n){return E_(n)&&!!n.frag&&!n.frag.decryptdata}function VT(n,e){const t=kd(e);return n.default[`${t?"timeout":"error"}Retry`]}function G0(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function GT(n){return et(et({},n),{errorRetry:null,timeoutRetry:null})}function Pd(n,e,t,r){if(!n)return!1;const s=r?.code,i=e<n.maxNumRetry&&(l8(s)||!!t);return n.shouldRetry?n.shouldRetry(n,e,t,r,i):i}function l8(n){return fg(n)||!!n&&(n<400||n>499)}function fg(n){return n===0&&navigator.onLine===!1}var jt={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},_n={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class c8 extends Xn{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(_.ERROR,this.onError,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(_.ERROR,this.onError,this),e.off(_.ERROR,this.onErrorOut,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===ge.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,r=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||r===-1?t.loadLevel:r}variantHasKey(e,t){if(e){var r;if((r=e.details)!=null&&r.hasKey(t))return!0;const s=e.audioGroups;if(s)return this.hls.allAudioTracks.filter(o=>s.indexOf(o.groupId)>=0).some(o=>{var l;return(l=o.details)==null?void 0:l.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var r;if(t.fatal)return;const s=this.hls,i=t.context;switch(t.details){case W.FRAG_LOAD_ERROR:case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_ERROR:case W.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case W.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction=Do();return}case W.FRAG_GAP:case W.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=jt.SendAlternateToPenaltyBox;return}case W.LEVEL_EMPTY_ERROR:case W.LEVEL_PARSING_ERROR:{var o;const u=t.parent===ge.MAIN?t.level:s.loadLevel;t.details===W.LEVEL_EMPTY_ERROR&&((o=t.context)!=null&&(o=o.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case W.LEVEL_LOAD_ERROR:case W.LEVEL_LOAD_TIMEOUT:typeof i?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.level));return;case W.AUDIO_TRACK_LOAD_ERROR:case W.AUDIO_TRACK_LOAD_TIMEOUT:case W.SUBTITLE_LOAD_ERROR:case W.SUBTITLE_TRACK_LOAD_TIMEOUT:if(i){const u=s.loadLevelObj;if(u&&(i.type===He.AUDIO_TRACK&&u.hasAudioGroup(i.groupId)||i.type===He.SUBTITLE_TRACK&&u.hasSubtitleGroup(i.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=jt.SendAlternateToPenaltyBox,t.errorAction.flags=_n.MoveAllAlternatesMatchingHost;return}}return;case W.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:jt.SendAlternateToPenaltyBox,flags:_n.MoveAllAlternatesMatchingHDCP};return;case W.KEY_SYSTEM_SESSION_UPDATE_FAILED:case W.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case W.KEY_SYSTEM_NO_SESSION:t.errorAction={action:jt.SendAlternateToPenaltyBox,flags:_n.MoveAllAlternatesMatchingKey};return;case W.BUFFER_ADD_CODEC_ERROR:case W.REMUX_ALLOC_ERROR:case W.BUFFER_APPEND_ERROR:if(!t.errorAction){var l;t.errorAction=this.getLevelSwitchAction(t,(l=t.level)!=null?l:s.loadLevel)}return;case W.INTERNAL_EXCEPTION:case W.BUFFER_APPENDING_ERROR:case W.BUFFER_FULL_ERROR:case W.LEVEL_SWITCH_ERROR:case W.BUFFER_STALLED_ERROR:case W.BUFFER_SEEK_OVER_HOLE:case W.BUFFER_NUDGE_ON_STALL:t.errorAction=Do();return}t.type===we.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=Do())}getPlaylistRetryOrSwitchAction(e,t){const r=this.hls,s=VT(r.config.playlistLoadPolicy,e),i=this.playlistError++;if(Pd(s,i,kd(e),e.response))return{action:jt.RetryRequest,flags:_n.None,retryConfig:s,retryCount:i};const l=this.getLevelSwitchAction(e,t);return s&&(l.retryConfig=s,l.retryCount=i),l}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),s=t.levels[r],{fragLoadPolicy:i,keyLoadPolicy:o}=t.config,l=VT(E_(e)?o:i,e),u=t.levels.reduce((f,h)=>f+h.fragmentError,0);if(s&&(e.details!==W.FRAG_GAP&&s.fragmentError++,!S_(e)&&Pd(l,u,kd(e),e.response)))return{action:jt.RetryRequest,flags:_n.None,retryConfig:l,retryCount:u};const d=this.getLevelSwitchAction(e,r);return l&&(d.retryConfig=l,d.retryCount=u),d}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const s=this.hls.levels[t];if(s){var i,o;const d=e.details;s.loadError++,d===W.BUFFER_APPEND_ERROR&&s.fragmentError++;let f=-1;const{levels:h,loadLevel:m,minAutoLevel:v,maxAutoLevel:g}=r;!r.autoLevelEnabled&&!r.config.preserveManualLevelOnError&&(r.loadLevel=-1);const x=(i=e.frag)==null?void 0:i.type,b=(x===ge.AUDIO&&d===W.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(d===W.BUFFER_ADD_CODEC_ERROR||d===W.BUFFER_APPEND_ERROR))&&h.some(({audioCodec:F})=>s.audioCodec!==F),A=e.sourceBufferName==="video"&&(d===W.BUFFER_ADD_CODEC_ERROR||d===W.BUFFER_APPEND_ERROR)&&h.some(({codecSet:F,audioCodec:k})=>s.codecSet!==F&&s.audioCodec===k),{type:R,groupId:C}=(o=e.context)!=null?o:{};for(let F=h.length;F--;){const k=(F+m)%h.length;if(k!==m&&k>=v&&k<=g&&h[k].loadError===0){var l,u;const N=h[k];if(d===W.FRAG_GAP&&x===ge.MAIN&&e.frag){const M=h[k].details;if(M){const O=ji(e.frag,M.fragments,e.frag.start);if(O!=null&&O.gap)continue}}else{if(R===He.AUDIO_TRACK&&N.hasAudioGroup(C)||R===He.SUBTITLE_TRACK&&N.hasSubtitleGroup(C))continue;if(x===ge.AUDIO&&(l=s.audioGroups)!=null&&l.some(M=>N.hasAudioGroup(M))||x===ge.SUBTITLE&&(u=s.subtitleGroups)!=null&&u.some(M=>N.hasSubtitleGroup(M))||b&&s.audioCodec===N.audioCodec||A&&s.codecSet===N.codecSet||!b&&s.codecSet!==N.codecSet)continue}f=k;break}}if(f>-1&&r.loadLevel!==f)return e.levelRetry=!0,this.playlistError=0,{action:jt.SendAlternateToPenaltyBox,flags:_n.None,nextAutoLevel:f}}return{action:jt.SendAlternateToPenaltyBox,flags:_n.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case jt.DoNothing:break;case jt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==W.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:s}=r,i=r.nextAutoLevel;switch(s){case _n.None:this.switchLevel(e,i);break;case _n.MoveAllAlternatesMatchingHDCP:{const u=this.getVariantLevelIndex(e.frag),d=t.levels[u],f=d?.attrs["HDCP-LEVEL"];if(r.hdcpLevel=f,f==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(f){t.maxHdcpLevel=dg[dg.indexOf(f)-1],r.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case _n.MoveAllAlternatesMatchingKey:{const u=e.decryptdata;if(u){const d=this.hls.levels,f=d.length;for(let m=f;m--;)if(this.variantHasKey(d[m],u)){var o,l;this.log(`Banned key found in level ${m} (${d[m].bitrate}bps) or audio group "${(o=d[m].audioGroups)==null?void 0:o.join(",")}" (${(l=e.frag)==null?void 0:l.type} fragment) ${Vt(u.keyId||[])}`),d[m].fragmentError++,d[m].loadError++,this.log(`Removing level ${m} with key error (${e.error})`),this.hls.removeLevel(m)}const h=e.frag;if(this.hls.levels.length<f)r.resolved=!0;else if(h&&h.type!==ge.MAIN){const m=h.decryptdata;m&&!u.matches(m)&&(r.resolved=!0)}}break}}r.resolved||this.switchLevel(e,i)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===W.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const r=ug(e.mimeType),s=this.hls.levels;for(let i=s.length;i--;)s[i][`${e.sourceBufferName}Codec`]===r&&(this.log(`Removing level ${i} for ${e.details} ("${r}" not supported)`),this.hls.removeLevel(i))}}}function Do(n){const e={action:jt.DoNothing,flags:_n.None};return n&&(e.resolved=!0),e}var Pt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class u8{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.BUFFER_APPENDED,this.onBufferAppended,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this),e.on(_.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.BUFFER_APPENDED,this.onBufferAppended,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this),e.off(_.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let s=r.length;s--;){const i=r[s];if(!i)break;if(i.start<=e&&e<=i.end&&i.loaded)return i}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,r){const{fragments:s}=this,i=Object.keys(s);for(let o=i.length;o--;){const l=s[i[o]];if(l?.body.type===t&&(!r||l.buffered)){const u=l.body;if(u.start<=e&&e<=u.end)return u}}return null}detectEvictedFragments(e,t,r,s,i){this.timeRanges&&(this.timeRanges[e]=t);const o=s?.fragment.sn||-1;Object.keys(this.fragments).forEach(l=>{const u=this.fragments[l];if(!u||o>=u.body.sn)return;if(!u.buffered&&(!u.loaded||i)){u.body.type===r&&this.removeFragment(u.body);return}const d=u.range[e];if(d){if(d.time.length===0){this.removeFragment(u.body);return}d.time.some(f=>{const h=!this.isTimeBuffered(f.startPTS,f.endPTS,t);return h&&this.removeFragment(u.body),h})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const r=e.frag,s=xo(r),i=this.fragments[s];if(!i||i.buffered&&r.gap)return;const o=!r.relurl;Object.keys(t).forEach(l=>{const u=r.elementaryStreams[l];if(!u)return;const d=t[l],f=o||u.partial===!0;i.range[l]=this.getBufferedTimes(r,e.part,f,d)}),i.loaded=null,Object.keys(i.range).length?(this.bufferedEnd(i,r),Su(i)||this.removeParts(r.sn-1,r.type)):this.removeFragment(i.body)}bufferedEnd(e,t){e.buffered=!0,(e.body.endList=t.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=HT(r,s=>s.fragment.sn>=e))}fragBuffered(e,t){const r=xo(e);let s=this.fragments[r];!s&&t&&(s=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,this.bufferedEnd(s,e))}getBufferedTimes(e,t,r,s){const i={time:[],partial:r},o=e.start,l=e.end,u=e.minEndPTS||l,d=e.maxStartPTS||o;for(let f=0;f<s.length;f++){const h=s.start(f)-this.bufferPadding,m=s.end(f)+this.bufferPadding;if(d>=h&&u<=m){i.time.push({startPTS:Math.max(o,s.start(f)),endPTS:Math.min(l,s.end(f))});break}else if(o<m&&l>h){const v=Math.max(o,s.start(f)),g=Math.min(l,s.end(f));g>v&&(i.partial=!0,i.time.push({startPTS:v,endPTS:g}))}else if(l<=h)break}return i}getPartialFragment(e){let t=null,r,s,i,o=0;const{bufferPadding:l,fragments:u}=this;return Object.keys(u).forEach(d=>{const f=u[d];f&&Su(f)&&(s=f.body.start-l,i=f.body.end+l,e>=s&&e<=i&&(r=Math.min(e-s,i-e),o<=r&&(t=f.body,o=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Su(t))}getState(e){const t=xo(e),r=this.fragments[t];return r?r.buffered?Su(r)?Pt.PARTIAL:Pt.OK:Pt.APPENDING:Pt.NOT_LOADED}isTimeBuffered(e,t,r){let s,i;for(let o=0;o<r.length;o++){if(s=r.start(o)-this.bufferPadding,i=r.end(o)+this.bufferPadding,e>=s&&t<=i)return!0;if(t<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const r=t.frag,s=t.part?null:t,i=xo(r);this.fragments[i]={body:r,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:s,timeRanges:i,type:o}=t;if(r.sn==="initSegment")return;const l=r.type;if(s){let d=this.activePartLists[l];d||(this.activePartLists[l]=d=[]),d.push(s)}this.timeRanges=i;const u=i[o];this.detectEvictedFragments(o,u,l,s)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=xo(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,r=Object.keys(t);if(!e)return r.length>0;for(let s=r.length;s--;){const i=t[r[s]];if(i?.body.type===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,s,i){s&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const l=this.fragments[o];if(!l)return;const u=l.body;u.type!==r||s&&!u.gap||u.start<t&&u.end>e&&(l.buffered||i)&&this.removeFragment(u)})}removeFragment(e){const t=xo(e);e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const s=e.sn;this.activePartLists[e.type]=HT(r,i=>i.fragment.sn!==s)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(r=>r.clearElementaryStreamInfo())}}function Su(n){var e,t,r;return n.buffered&&!!(n.body.gap||(e=n.range.video)!=null&&e.partial||(t=n.range.audio)!=null&&t.partial||(r=n.range.audiovideo)!=null&&r.partial)}function xo(n){return`${n.type}_${n.level}_${n.sn}`}function HT(n,e){return n.filter(t=>{const r=e(t);return r||t.clearElementaryStreamInfo(),r})}var ni={cbc:0,ctr:1};class d8{constructor(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}decrypt(e,t){switch(this.aesMode){case ni.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case ni.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function f8(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?n.slice(0,e-t):n}class h8{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let s=0;s<4;s++)r[s]=t.getUint32(s*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,s=r[0],i=r[1],o=r[2],l=r[3],u=this.invSubMix,d=u[0],f=u[1],h=u[2],m=u[3],v=new Uint32Array(256);let g=0,x=0,E=0;for(E=0;E<256;E++)E<128?v[E]=E<<1:v[E]=E<<1^283;for(E=0;E<256;E++){let b=x^x<<1^x<<2^x<<3^x<<4;b=b>>>8^b&255^99,e[g]=b,t[b]=g;const I=v[g],A=v[I],R=v[A];let C=v[b]*257^b*16843008;s[g]=C<<24|C>>>8,i[g]=C<<16|C>>>16,o[g]=C<<8|C>>>24,l[g]=C,C=R*16843009^A*65537^I*257^g*16843008,d[b]=C<<24|C>>>8,f[b]=C<<16|C>>>16,h[b]=C<<8|C>>>24,m[b]=C,g?(g=I^v[v[v[R^I]]],x^=v[v[x]]):g=x=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,s=0;for(;s<t.length&&r;)r=t[s]===this.key[s],s++;if(r)return;this.key=t;const i=this.keySize=t.length;if(i!==4&&i!==6&&i!==8)throw new Error("Invalid aes key size="+i);const o=this.ksRows=(i+6+1)*4;let l,u;const d=this.keySchedule=new Uint32Array(o),f=this.invKeySchedule=new Uint32Array(o),h=this.sBox,m=this.rcon,v=this.invSubMix,g=v[0],x=v[1],E=v[2],b=v[3];let I,A;for(l=0;l<o;l++){if(l<i){I=d[l]=t[l];continue}A=I,l%i===0?(A=A<<8|A>>>24,A=h[A>>>24]<<24|h[A>>>16&255]<<16|h[A>>>8&255]<<8|h[A&255],A^=m[l/i|0]<<24):i>6&&l%i===4&&(A=h[A>>>24]<<24|h[A>>>16&255]<<16|h[A>>>8&255]<<8|h[A&255]),d[l]=I=(d[l-i]^A)>>>0}for(u=0;u<o;u++)l=o-u,u&3?A=d[l]:A=d[l-4],u<4||l<=4?f[u]=A:f[u]=g[h[A>>>24]]^x[h[A>>>16&255]]^E[h[A>>>8&255]]^b[h[A&255]],f[u]=f[u]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const s=this.keySize+6,i=this.invKeySchedule,o=this.invSBox,l=this.invSubMix,u=l[0],d=l[1],f=l[2],h=l[3],m=this.uint8ArrayToUint32Array_(r);let v=m[0],g=m[1],x=m[2],E=m[3];const b=new Int32Array(e),I=new Int32Array(b.length);let A,R,C,F,k,N,M,O,H,Z,se,U,ne,q;const te=this.networkToHostOrderSwap;for(;t<b.length;){for(H=te(b[t]),Z=te(b[t+1]),se=te(b[t+2]),U=te(b[t+3]),k=H^i[0],N=U^i[1],M=se^i[2],O=Z^i[3],ne=4,q=1;q<s;q++)A=u[k>>>24]^d[N>>16&255]^f[M>>8&255]^h[O&255]^i[ne],R=u[N>>>24]^d[M>>16&255]^f[O>>8&255]^h[k&255]^i[ne+1],C=u[M>>>24]^d[O>>16&255]^f[k>>8&255]^h[N&255]^i[ne+2],F=u[O>>>24]^d[k>>16&255]^f[N>>8&255]^h[M&255]^i[ne+3],k=A,N=R,M=C,O=F,ne=ne+4;A=o[k>>>24]<<24^o[N>>16&255]<<16^o[M>>8&255]<<8^o[O&255]^i[ne],R=o[N>>>24]<<24^o[M>>16&255]<<16^o[O>>8&255]<<8^o[k&255]^i[ne+1],C=o[M>>>24]<<24^o[O>>16&255]<<16^o[k>>8&255]<<8^o[N&255]^i[ne+2],F=o[O>>>24]<<24^o[k>>16&255]<<16^o[N>>8&255]<<8^o[M&255]^i[ne+3],I[t]=te(A^v),I[t+1]=te(F^g),I[t+2]=te(C^x),I[t+3]=te(R^E),v=H,g=Z,x=se,E=U,t=t+4}return I.buffer}}class p8{constructor(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}expandKey(){const e=m8(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function m8(n){switch(n){case ni.cbc:return"AES-CBC";case ni.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${n}`)}}const g8=16;class H0{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?f8(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r,s){return this.useSoftware?new Promise((i,o)=>{const l=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(l,t,r,s);const u=this.flush();u?i(u.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r,s)}softwareDecrypt(e,t,r,s){const{currentIV:i,currentResult:o,remainderData:l}=this;if(s!==ni.cbc||t.byteLength!==16)return tt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),l&&(e=qn(l,e),this.remainderData=null);const u=this.getValidChunk(e);if(!u.length)return null;i&&(r=i);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new h8),d.expandKey(t);const f=o;return this.currentResult=d.decrypt(u.buffer,0,r),this.currentIV=u.slice(-16).buffer,f||null}webCryptoDecrypt(e,t,r,s){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,s));this.key=t,this.fastAesKey=new p8(this.subtle,t,s)}return this.fastAesKey.expandKey().then(i=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new d8(this.subtle,new Uint8Array(r),s).decrypt(e.buffer,i)):Promise.reject(new Error("web crypto not initialized"))).catch(i=>(tt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,r,s)))}onWebCryptoError(e,t,r,s){const i=this.enableSoftwareAES;if(i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,s);const o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(i?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%g8;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}logOnce(e){this.logEnabled&&(tt.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const KT=Math.pow(2,17);class y8{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new Xr({type:we.NETWORK_ERROR,details:W.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,i=s.fLoader,o=s.loader;return new Promise((l,u)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(g=>g[0]==="GAP")){u(zT(e));return}else e.gap=!1;const d=this.loader=i?new i(s):new o(s),f=WT(e);e.loader=d;const h=GT(s.fragLoadPolicy.default),m={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:KT};e.stats=d.stats;const v={onSuccess:(g,x,E,b)=>{this.resetLoader(e,d);let I=g.data;E.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(I.slice(0,16)),I=I.slice(16)),l({frag:e,part:null,payload:I,networkDetails:b})},onError:(g,x,E,b)=>{this.resetLoader(e,d),u(new Xr({type:we.NETWORK_ERROR,details:W.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:et({url:r,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:E,stats:b}))},onAbort:(g,x,E)=>{this.resetLoader(e,d),u(new Xr({type:we.NETWORK_ERROR,details:W.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:E,stats:g}))},onTimeout:(g,x,E)=>{this.resetLoader(e,d),u(new Xr({type:we.NETWORK_ERROR,details:W.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${m.timeout}ms`),networkDetails:E,stats:g}))}};t&&(v.onProgress=(g,x,E,b)=>t({frag:e,part:null,payload:E,networkDetails:b})),d.load(f,m,v)})}loadPart(e,t,r){this.abort();const s=this.config,i=s.fLoader,o=s.loader;return new Promise((l,u)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){u(zT(e,t));return}const d=this.loader=i?new i(s):new o(s),f=WT(e,t);e.loader=d;const h=GT(s.fragLoadPolicy.default),m={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:KT};t.stats=d.stats,d.load(f,m,{onSuccess:(v,g,x,E)=>{this.resetLoader(e,d),this.updateStatsFromPart(e,t);const b={frag:e,part:t,payload:v.data,networkDetails:E};r(b),l(b)},onError:(v,g,x,E)=>{this.resetLoader(e,d),u(new Xr({type:we.NETWORK_ERROR,details:W.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:et({url:f.url,data:void 0},v),error:new Error(`HTTP Error ${v.code} ${v.text}`),networkDetails:x,stats:E}))},onAbort:(v,g,x)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,d),u(new Xr({type:we.NETWORK_ERROR,details:W.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:x,stats:v}))},onTimeout:(v,g,x)=>{this.resetLoader(e,d),u(new Xr({type:we.NETWORK_ERROR,details:W.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${m.timeout}ms`),networkDetails:x,stats:v}))}})})}updateStatsFromPart(e,t){const r=e.stats,s=t.stats,i=s.total;if(r.loaded+=s.loaded,i){const u=Math.round(e.duration/t.duration),d=Math.min(Math.round(r.loaded/i),u),h=(u-d)*Math.round(r.loaded/d);r.total=r.loaded+h}else r.total=Math.max(r.loaded,r.total);const o=r.loading,l=s.loading;o.start?o.first+=l.first-l.start:(o.start=l.start,o.first=l.first),o.end=l.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function WT(n,e=null){const t=e||n,r={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},s=t.byteRangeStartOffset,i=t.byteRangeEndOffset;if(he(s)&&he(i)){var o;let l=s,u=i;if(n.sn==="initSegment"&&v8((o=n.decryptdata)==null?void 0:o.method)){const d=i-s;d%16&&(u=i+(16-d%16)),s!==0&&(r.resetIV=!0,l=s-16)}r.rangeStart=l,r.rangeEnd=u}return r}function zT(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),r={type:we.MEDIA_ERROR,details:W.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(r.part=e),(e||n).stats.aborted=!0,new Xr(r)}function v8(n){return n==="AES-128"||n==="AES-256"}class Xr extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class T_ extends Xn{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class K0{constructor(e,t,r,s=0,i=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Tu(),this.buffering={audio:Tu(),video:Tu(),audiovideo:Tu()},this.level=e,this.sn=t,this.id=r,this.size=s,this.part=i,this.partial=o}}function Tu(){return{start:0,executeStart:0,executeEnd:0,end:0}}const YT={length:0,start:()=>0,end:()=>0};class Me{static isBuffered(e,t){if(e){const r=Me.getBuffered(e);for(let s=r.length;s--;)if(t>=r.start(s)&&t<=r.end(s))return!0}return!1}static bufferedRanges(e){if(e){const t=Me.getBuffered(e);return Me.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}static bufferInfo(e,t,r){if(e){const s=Me.bufferedRanges(e);if(s.length)return Me.bufferedInfo(s,t,r)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((f,h)=>f.start-h.start||h.end-f.end);let s=-1,i=[];if(r)for(let f=0;f<e.length;f++){t>=e[f].start&&t<=e[f].end&&(s=f);const h=i.length;if(h){const m=i[h-1].end;e[f].start-m<r?e[f].end>m&&(i[h-1].end=e[f].end):i.push(e[f])}else i.push(e[f])}else i=e;let o=0,l,u=t,d=t;for(let f=0;f<i.length;f++){const h=i[f].start,m=i[f].end;if(s===-1&&t>=h&&t<=m&&(s=f),t+r>=h&&t<m)u=h,d=m,o=d-t;else if(t+r<h){l=h;break}}return{len:o,start:u||0,end:d||0,nextStart:l,buffered:e,bufferedIndex:s}}static getBuffered(e){try{return e.buffered||YT}catch(t){return tt.log("failed to get media.buffered",t),YT}}}const b_=/\{\$([a-zA-Z0-9-_]+)\}/g;function qT(n){return b_.test(n)}function hg(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(b_,r=>{const s=r.substring(2,r.length-1),i=t?.[s];return i===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),r):i})}return e}function XT(n,e,t){let r=n.variableList;r||(n.variableList=r={});let s,i;if("QUERYPARAM"in e){s=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(s))i=o.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${t}"`)}catch(o){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else s=e.NAME,i=e.VALUE;s in r?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):r[s]=i||""}function x8(n,e,t){const r=e.IMPORT;if(t&&r in t){let s=n.variableList;s||(n.variableList=s={}),s[r]=t[r]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}const E8=/^(\d+)x(\d+)$/,QT=/(.+?)=(".*?"|.*?)(?:,|$)/g;class mt{constructor(e,t){typeof e=="string"&&(e=mt.parseAttrList(e,t)),rt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let s=0;s<t.length/2;s++)r[s]=parseInt(t.slice(s*2,s*2+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((s,i)=>(s[i.toLowerCase()]=!0,s),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=E8.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let r;const s={};for(QT.lastIndex=0;(r=QT.exec(e))!==null;){const o=r[1].trim();let l=r[2];const u=l.indexOf('"')===0&&l.lastIndexOf('"')===l.length-1;let d=!1;if(u)l=l.slice(1,-1);else switch(o){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":d=!0}if(t&&(u||d))l=hg(t,l);else if(!d&&!u)switch(o){case"CLOSED-CAPTIONS":if(l==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":tt.warn(`${e}: attribute ${o} is missing quotes`)}s[o]=l}return s}}const S8="com.apple.hls.interstitial";function T8(n){return n!=="ID"&&n!=="CLASS"&&n!=="CUE"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function b8(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"||n==="SCTE35-CMD"}class w_{constructor(e,t,r=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=t?.tagAnchor||null,this.tagOrder=(s=t?.tagOrder)!=null?s:r,t){const i=t.attr;for(const o in i)if(Object.prototype.hasOwnProperty.call(e,o)&&e[o]!==i[o]){tt.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=o;break}e=rt(new mt({}),i,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const i=t?.endDate||new Date(this.attr["END-DATE"]);he(i.getTime())&&(this._endDate=i)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(tt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(he(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===S8}get isValid(){return!!this.id&&!this._badValueForSameId&&he(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const w8=10;class I8{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let r=t.decryptdata;return r||(t.setKeyFormat(e.keyFormat),r=t.decryptdata),!!r&&e.matches(r)})}get hasProgramDateTime(){return this.fragments.length?he(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||w8}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Dd(n,e){return n.length===e.length?!n.some((t,r)=>t!==e[r]):!1}function JT(n,e){return!n&&!e?!0:!n||!e?!1:Dd(n,e)}function No(n){return n==="AES-128"||n==="AES-256"||n==="AES-256-CTR"}function W0(n){switch(n){case"AES-128":case"AES-256":return ni.cbc;case"AES-256-CTR":return ni.ctr;default:throw new Error(`invalid full segment method ${n}`)}}function z0(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function pg(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}function A8(n){const e=pg(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function I_(n){const e=function(r,s,i){const o=r[s];r[s]=r[i],r[i]=o};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function A_(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),s=r[r.length-1].split(",");if(s.length===2){const i=s[0]==="base64",o=s[1];i?(r.splice(-1,1),t=z0(o)):t=A8(o)}}return t}const Nd=typeof self<"u"?self:void 0;var gt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Gt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Xu(n){switch(n){case Gt.FAIRPLAY:return gt.FAIRPLAY;case Gt.PLAYREADY:return gt.PLAYREADY;case Gt.WIDEVINE:return gt.WIDEVINE;case Gt.CLEARKEY:return gt.CLEARKEY}}function Zp(n){switch(n){case gt.FAIRPLAY:return Gt.FAIRPLAY;case gt.PLAYREADY:return Gt.PLAYREADY;case gt.WIDEVINE:return Gt.WIDEVINE;case gt.CLEARKEY:return Gt.CLEARKEY}}function el(n){const{drmSystems:e,widevineLicenseUrl:t}=n,r=e?[gt.FAIRPLAY,gt.WIDEVINE,gt.PLAYREADY,gt.CLEARKEY].filter(s=>!!e[s]):[];return!r[gt.WIDEVINE]&&t&&r.push(gt.WIDEVINE),r}const __=(function(n){return Nd!=null&&(n=Nd.navigator)!=null&&n.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function _8(n,e,t,r){let s;switch(n){case gt.FAIRPLAY:s=["cenc","sinf"];break;case gt.WIDEVINE:case gt.PLAYREADY:s=["cenc"];break;case gt.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return R8(s,e,t,r)}function R8(n,e,t,r){return[{initDataTypes:n,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(i=>({contentType:`audio/mp4; codecs=${i}`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(i=>({contentType:`video/mp4; codecs=${i}`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function L8(n){var e;return!!n&&(n.sessionType==="persistent-license"||!!((e=n.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function R_(n){const e=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),r=t.substring(t.indexOf("<"),t.length),o=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(o){const l=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(l){const u=z0(l).subarray(0,16);return I_(u),u}}return null}let Eo={};class Qs{static clearKeyUriToKeyIdMap(){Eo={}}static setKeyIdForUri(e,t){Eo[e]=t}static addKeyIdForUri(e){const t=Object.keys(Eo).length%Number.MAX_SAFE_INTEGER,r=new Uint8Array(16);return new DataView(r.buffer,12,4).setUint32(0,t),Eo[e]=r,r}constructor(e,t,r,s=[1],i=null,o){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=s,this.iv=i,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!No(e),o!=null&&o.startsWith("0x")&&(this.keyId=new Uint8Array(n_(o)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Dd(e.keyFormatVersions,this.keyFormatVersions)&&JT(e.iv,this.iv)&&JT(e.keyId,this.keyId)}isSupported(){if(this.method){if(No(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Gt.FAIRPLAY:case Gt.WIDEVINE:case Gt.PLAYREADY:case Gt.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(No(this.method)){let i=this.iv;return i||(typeof e!="number"&&(tt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),i=k8(e)),new Qs(this.method,this.uri,"identity",this.keyFormatVersions,i)}if(this.keyId){const i=Eo[this.uri];if(i&&!Dd(this.keyId,i)&&Qs.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const r=A_(this.uri);if(r)switch(this.keyFormat){case Gt.WIDEVINE:if(this.pssh=r,!this.keyId){const i=N6(r.buffer);if(i.length){var s;const o=i[0];this.keyId=(s=o.kids)!=null&&s.length?o.kids[0]:null}}this.keyId||(this.keyId=ZT(t));break;case Gt.PLAYREADY:{const i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=D6(i,null,r),this.keyId=R_(r);break}default:{let i=r.subarray(0,16);if(i.length!==16){const o=new Uint8Array(16);o.set(i,16-i.length),i=o}this.keyId=i;break}}if(!this.keyId||this.keyId.byteLength!==16){let i;i=C8(t),i||(i=ZT(t),i||(i=Eo[this.uri])),i&&(this.keyId=i,Qs.setKeyIdForUri(this.uri,i))}return this}}function C8(n){const e=n?.[Gt.WIDEVINE];return e?e.keyId:null}function ZT(n){const e=n?.[Gt.PLAYREADY];if(e){const t=A_(e.uri);if(t)return R_(t)}return null}function k8(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const eb=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,tb=/#EXT-X-MEDIA:(.*)/g,P8=/^#EXT(?:INF|-X-TARGETDURATION):/m,em=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),D8=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Lr{static findGroup(e,t){for(let r=0;r<e.length;r++){const s=e[r];if(s.id===t)return s}}static resolve(e,t){return B0.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return P8.test(e)}static parseMasterPlaylist(e,t){const r=qT(e),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},i=[];if(eb.lastIndex=0,!e.startsWith("#EXTM3U"))return s.playlistParsingError=new Error("no EXTM3U delimiter"),s;let o;for(;(o=eb.exec(e))!=null;)if(o[1]){var l;const d=new mt(o[1],s),f=hg(s,o[2]),h={attrs:d,bitrate:d.decimalInteger("BANDWIDTH")||d.decimalInteger("AVERAGE-BANDWIDTH"),name:d.NAME,url:Lr.resolve(f,t)},m=d.decimalResolution("RESOLUTION");m&&(h.width=m.width,h.height=m.height),sb(d.CODECS,h);const v=d["SUPPLEMENTAL-CODECS"];v&&(h.supplemental={},sb(v,h.supplemental)),(l=h.unknownCodecs)!=null&&l.length||i.push(h),s.levels.push(h)}else if(o[3]){const d=o[3],f=o[4];switch(d){case"SESSION-DATA":{const h=new mt(f,s),m=h["DATA-ID"];m&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[m]=h);break}case"SESSION-KEY":{const h=nb(f,t,s);h.encrypted&&h.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(h)):tt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${f}"`);break}case"DEFINE":{{const h=new mt(f,s);XT(s,h,t)}break}case"CONTENT-STEERING":{const h=new mt(f,s);s.contentSteering={uri:Lr.resolve(h["SERVER-URI"],t),pathwayId:h["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=rb(f);break}}}const u=i.length>0&&i.length<s.levels.length;return s.levels=u?i:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(e,t,r){let s;const i={},o=r.levels,l={AUDIO:o.map(d=>({id:d.attrs.AUDIO,audioCodec:d.audioCodec})),SUBTITLES:o.map(d=>({id:d.attrs.SUBTITLES,textCodec:d.textCodec})),"CLOSED-CAPTIONS":[]};let u=0;for(tb.lastIndex=0;(s=tb.exec(e))!==null;){const d=new mt(s[1],r),f=d.TYPE;if(f){const h=l[f],m=i[f]||[];i[f]=m;const v=d.LANGUAGE,g=d["ASSOC-LANGUAGE"],x=d.CHANNELS,E=d.CHARACTERISTICS,b=d["INSTREAM-ID"],I={attrs:d,bitrate:0,id:u++,groupId:d["GROUP-ID"]||"",name:d.NAME||v||"",type:f,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:v,url:d.URI?Lr.resolve(d.URI,t):""};if(g&&(I.assocLang=g),x&&(I.channels=x),E&&(I.characteristics=E),b&&(I.instreamId=b),h!=null&&h.length){const A=Lr.findGroup(h,I.groupId)||h[0];ib(I,A,"audioCodec"),ib(I,A,"textCodec")}m.push(I)}}return i}static parseLevelPlaylist(e,t,r,s,i,o){var l;const u={url:t},d=new I8(t),f=d.fragments,h=[];let m=null,v=0,g=0,x=0,E=0,b=0,I=null,A=new Xp(s,u),R,C,F,k=-1,N=!1,M=null,O;if(em.lastIndex=0,d.m3u8=e,d.hasVariableRefs=qT(e),((l=em.exec(e))==null?void 0:l[0])!=="#EXTM3U")return d.playlistParsingError=new Error("Missing format identifier #EXTM3U"),d;for(;(R=em.exec(e))!==null;){N&&(N=!1,A=new Xp(s,u),A.playlistOffset=x,A.setStart(x),A.sn=v,A.cc=E,b&&(A.bitrate=b),A.level=r,m&&(A.initSegment=m,m.rawProgramDateTime&&(A.rawProgramDateTime=m.rawProgramDateTime,m.rawProgramDateTime=null),M&&(A.setByteRange(M),M=null)));const U=R[1];if(U){A.duration=parseFloat(U);const ne=(" "+R[2]).slice(1);A.title=ne||null,A.tagList.push(ne?["INF",U,ne]:["INF",U])}else if(R[3]){if(he(A.duration)){A.playlistOffset=x,A.setStart(x),F&&ab(A,F,d),A.sn=v,A.level=r,A.cc=E,f.push(A);const ne=(" "+R[3]).slice(1);A.relurl=hg(d,ne),mg(A,I,h),I=A,x+=A.duration,v++,g=0,N=!0}}else{if(R=R[0].match(D8),!R){tt.warn("No matches on slow regex match for level playlist!");continue}for(C=1;C<R.length&&R[C]===void 0;C++);const ne=(" "+R[C]).slice(1),q=(" "+R[C+1]).slice(1),te=R[C+2]?(" "+R[C+2]).slice(1):null;switch(ne){case"BYTERANGE":I?A.setByteRange(q,I):A.setByteRange(q);break;case"PROGRAM-DATE-TIME":A.rawProgramDateTime=q,A.tagList.push(["PROGRAM-DATE-TIME",q]),k===-1&&(k=f.length);break;case"PLAYLIST-TYPE":d.type&&Yr(d,ne,R),d.type=q.toUpperCase();break;case"MEDIA-SEQUENCE":d.startSN!==0?Yr(d,ne,R):f.length>0&&lb(d,ne,R),v=d.startSN=parseInt(q);break;case"SKIP":{d.skippedSegments&&Yr(d,ne,R);const G=new mt(q,d),Q=G.decimalInteger("SKIPPED-SEGMENTS");if(he(Q)){d.skippedSegments+=Q;for(let D=Q;D--;)f.push(null);v+=Q}const ee=G.enumeratedString("RECENTLY-REMOVED-DATERANGES");ee&&(d.recentlyRemovedDateranges=(d.recentlyRemovedDateranges||[]).concat(ee.split("	")));break}case"TARGETDURATION":d.targetduration!==0&&Yr(d,ne,R),d.targetduration=Math.max(parseInt(q),1);break;case"VERSION":d.version!==null&&Yr(d,ne,R),d.version=parseInt(q);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":d.live||Yr(d,ne,R),d.live=!1;break;case"#":(q||te)&&A.tagList.push(te?[q,te]:[q]);break;case"DISCONTINUITY":E++,A.tagList.push(["DIS"]);break;case"GAP":A.gap=!0,A.tagList.push([ne]);break;case"BITRATE":A.tagList.push([ne,q]),b=parseInt(q)*1e3,he(b)?A.bitrate=b:b=0;break;case"DATERANGE":{const G=new mt(q,d),Q=new w_(G,d.dateRanges[G.ID],d.dateRangeTagCount);d.dateRangeTagCount++,Q.isValid||d.skippedSegments?d.dateRanges[Q.id]=Q:tt.warn(`Ignoring invalid DATERANGE tag: "${q}"`),A.tagList.push(["EXT-X-DATERANGE",q]);break}case"DEFINE":{{const G=new mt(q,d);"IMPORT"in G?x8(d,G,o):XT(d,G,t)}break}case"DISCONTINUITY-SEQUENCE":d.startCC!==0?Yr(d,ne,R):f.length>0&&lb(d,ne,R),d.startCC=E=parseInt(q);break;case"KEY":{const G=nb(q,t,d);if(G.isSupported()){if(G.method==="NONE"){F=void 0;break}F||(F={});const Q=F[G.keyFormat];Q!=null&&Q.matches(G)||(Q&&(F=rt({},F)),F[G.keyFormat]=G)}else tt.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${q}"`);break}case"START":d.startTimeOffset=rb(q);break;case"MAP":{const G=new mt(q,d);if(A.duration){const Q=new Xp(s,u);ob(Q,G,r,F),m=Q,A.initSegment=m,m.rawProgramDateTime&&!A.rawProgramDateTime&&(A.rawProgramDateTime=m.rawProgramDateTime)}else{const Q=A.byteRangeEndOffset;if(Q){const ee=A.byteRangeStartOffset;M=`${Q-ee}@${ee}`}else M=null;ob(A,G,r,F),m=A,N=!0}m.cc=E;break}case"SERVER-CONTROL":{O&&Yr(d,ne,R),O=new mt(q),d.canBlockReload=O.bool("CAN-BLOCK-RELOAD"),d.canSkipUntil=O.optionalFloat("CAN-SKIP-UNTIL",0),d.canSkipDateRanges=d.canSkipUntil>0&&O.bool("CAN-SKIP-DATERANGES"),d.partHoldBack=O.optionalFloat("PART-HOLD-BACK",0),d.holdBack=O.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{d.partTarget&&Yr(d,ne,R);const G=new mt(q);d.partTarget=G.decimalFloatingPoint("PART-TARGET");break}case"PART":{let G=d.partList;G||(G=d.partList=[]);const Q=g>0?G[G.length-1]:void 0,ee=g++,D=new mt(q,d),$=new x6(D,A,u,ee,Q);G.push($),A.duration+=$.duration;break}case"PRELOAD-HINT":{const G=new mt(q,d);d.preloadHint=G;break}case"RENDITION-REPORT":{const G=new mt(q,d);d.renditionReports=d.renditionReports||[],d.renditionReports.push(G);break}default:tt.warn(`line parsed but not handled: ${R}`);break}}}I&&!I.relurl?(f.pop(),x-=I.duration,d.partList&&(d.fragmentHint=I)):d.partList&&(mg(A,I,h),A.cc=E,d.fragmentHint=A,F&&ab(A,F,d)),d.targetduration||(d.playlistParsingError=new Error("Missing Target Duration"));const H=f.length,Z=f[0],se=f[H-1];if(x+=d.skippedSegments*d.targetduration,x>0&&H&&se){d.averagetargetduration=x/H;const U=se.sn;d.endSN=U!=="initSegment"?U:0,d.live||(se.endList=!0),k>0&&(O8(f,k),Z&&h.unshift(Z))}return d.fragmentHint&&(x+=d.fragmentHint.duration),d.totalduration=x,h.length&&d.dateRangeTagCount&&Z&&L_(h,d),d.endCC=E,d}}function L_(n,e){let t=n.length;if(!t)if(e.hasProgramDateTime){const l=e.fragments[e.fragments.length-1];n.push(l),t++}else return;const r=n[t-1],s=e.live?1/0:e.totalduration,i=Object.keys(e.dateRanges);for(let l=i.length;l--;){const u=e.dateRanges[i[l]],d=u.startDate.getTime();u.tagAnchor=r.ref;for(let f=t;f--;){var o;if(((o=n[f])==null?void 0:o.sn)<e.startSN)break;const h=N8(e,d,n,f,s);if(h!==-1){u.tagAnchor=e.fragments[h].ref;break}}}}function N8(n,e,t,r,s){const i=t[r];if(i){const l=i.programDateTime;if(e>=l||r===0){var o;const u=(((o=t[r+1])==null?void 0:o.start)||s)-i.start;if(e<=l+u*1e3){const d=t[r].sn-n.startSN;if(d<0)return-1;const f=n.fragments;if(f.length>t.length){const m=(t[r+1]||f[f.length-1]).sn-n.startSN;for(let v=m;v>d;v--){const g=f[v].programDateTime;if(e>=g&&e<g+f[v].duration*1e3)return v}}return d}}}return-1}function nb(n,e,t){var r,s;const i=new mt(n,t),o=(r=i.METHOD)!=null?r:"",l=i.URI,u=i.hexadecimalInteger("IV"),d=i.KEYFORMATVERSIONS,f=(s=i.KEYFORMAT)!=null?s:"identity";l&&i.IV&&!u&&tt.error(`Invalid IV: ${i.IV}`);const h=l?Lr.resolve(l,e):"",m=(d||"1").split("/").map(Number).filter(Number.isFinite);return new Qs(o,h,f,m,u,i.KEYID)}function rb(n){const t=new mt(n).decimalFloatingPoint("TIME-OFFSET");return he(t)?t:null}function sb(n,e){let t=(n||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{const s=t.filter(i=>j0(i,r));s.length&&(e[`${r}Codec`]=s.map(i=>i.split("/")[0]).join(","),t=t.filter(i=>s.indexOf(i)===-1))}),e.unknownCodecs=t}function ib(n,e,t){const r=e[t];r&&(n[t]=r)}function O8(n,e){let t=n[e];for(let r=e;r--;){const s=n[r];if(!s)return;s.programDateTime=t.programDateTime-s.duration*1e3,t=s}}function mg(n,e,t){n.rawProgramDateTime?t.push(n):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime)}function ob(n,e,t,r){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",r&&(n.levelkeys=r),n.initSegment=null}function ab(n,e,t){n.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(s=>e[s].isCommonEncryption)&&r.push(n)}function Yr(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function lb(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function tm(n,e){const t=e.startPTS;if(he(t)){let r=0,s;e.sn>n.sn?(r=t-n.start,s=n):(r=n.start-t,s=e),s.duration!==r&&s.setDuration(r)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.setStart(n.start+(n.minEndPTS-n.start)):e.setStart(n.start+n.duration):e.setStart(Math.max(n.start-e.duration,0))}function C_(n,e,t,r,s,i,o){r-t<=0&&(o.warn("Fragment should have a positive duration",e),r=t+e.duration,i=s+e.duration);let u=t,d=r;const f=e.startPTS,h=e.endPTS;if(he(f)){const b=Math.abs(f-t);n&&b>n.totalduration?o.warn(`media timestamps and playlist times differ by ${b}s for level ${e.level} ${n.url}`):he(e.deltaPTS)?e.deltaPTS=Math.max(b,e.deltaPTS):e.deltaPTS=b,u=Math.max(t,f),t=Math.min(t,f),s=e.startDTS!==void 0?Math.min(s,e.startDTS):s,d=Math.min(r,h),r=Math.max(r,h),i=e.endDTS!==void 0?Math.max(i,e.endDTS):i}const m=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(r-e.start),e.startPTS=t,e.maxStartPTS=u,e.startDTS=s,e.endPTS=r,e.minEndPTS=d,e.endDTS=i;const v=e.sn;if(!n||v<n.startSN||v>n.endSN)return 0;let g;const x=v-n.startSN,E=n.fragments;for(E[x]=e,g=x;g>0;g--)tm(E[g],E[g-1]);for(g=x;g<E.length-1;g++)tm(E[g],E[g+1]);return n.fragmentHint&&tm(E[E.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,m}function M8(n,e,t){if(n===e)return;let r=null;const s=n.fragments;for(let f=s.length-1;f>=0;f--){const h=s[f].initSegment;if(h){r=h;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let i;U8(n,e,(f,h,m,v)=>{if((!e.startCC||e.skippedSegments)&&h.cc!==f.cc){const g=f.cc-h.cc;for(let x=m;x<v.length;x++)v[x].cc+=g;e.endCC=v[v.length-1].cc}he(f.startPTS)&&he(f.endPTS)&&(h.setStart(h.startPTS=f.startPTS),h.startDTS=f.startDTS,h.maxStartPTS=f.maxStartPTS,h.endPTS=f.endPTS,h.endDTS=f.endDTS,h.minEndPTS=f.minEndPTS,h.setDuration(f.endPTS-f.startPTS),h.duration&&(i=h),e.PTSKnown=e.alignedSliding=!0),f.hasStreams&&(h.elementaryStreams=f.elementaryStreams),h.loader=f.loader,f.hasStats&&(h.stats=f.stats),f.initSegment&&(h.initSegment=f.initSegment,r=f.initSegment)});const o=e.fragments,l=e.fragmentHint?o.concat(e.fragmentHint):o;if(r&&l.forEach(f=>{var h;f&&(!f.initSegment||f.initSegment.relurl===((h=r)==null?void 0:h.relurl))&&(f.initSegment=r)}),e.skippedSegments){if(e.deltaUpdateFailed=o.some(f=>!f),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let f=e.skippedSegments;f--;)o.shift();e.startSN=o[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=F8(n.dateRanges,e,t));const f=n.fragments.filter(h=>h.rawProgramDateTime);if(n.hasProgramDateTime&&!e.hasProgramDateTime)for(let h=1;h<l.length;h++)l[h].programDateTime===null&&mg(l[h],l[h-1],f);L_(f,e)}e.endCC=o[o.length-1].cc}if(!e.startCC){var u;const f=D_(n,e.startSN-1);e.startCC=(u=f?.cc)!=null?u:o[0].cc}B8(n.partList,e.partList,(f,h)=>{h.elementaryStreams=f.elementaryStreams,h.stats=f.stats}),i?C_(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS,t):k_(n,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const d=e.advancedDateTime;if(e.advanced&&d){const f=e.edge;e.driftStart||(e.driftStartTime=d,e.driftStart=f),e.driftEndTime=d,e.driftEnd=f}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=n.requestScheduled)}function F8(n,e,t){const{dateRanges:r,recentlyRemovedDateranges:s}=e,i=rt({},n);s&&s.forEach(u=>{delete i[u]});const l=Object.keys(i).length;return l?(Object.keys(r).forEach(u=>{const d=i[u],f=new w_(r[u].attr,d);f.isValid?(i[u]=f,d||(f.tagOrder+=l)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${ot(r[u].attr)}"`)}),i):r}function B8(n,e,t){if(n&&e){let r=0;for(let s=0,i=n.length;s<=i;s++){const o=n[s],l=e[s+r];o&&l&&o.index===l.index&&o.fragment.sn===l.fragment.sn?t(o,l):r--}}}function U8(n,e,t){const r=e.skippedSegments,s=Math.max(n.startSN,e.startSN)-e.startSN,i=(n.fragmentHint?1:0)+(r?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,o=e.startSN-n.startSN,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let d=s;d<=i;d++){const f=u[o+d];let h=l[d];if(r&&!h&&f&&(h=e.fragments[d]=f),f&&h){t(f,h,d,l);const m=f.relurl,v=h.relurl;if(m&&$8(m,v)){e.playlistParsingError=cb(`media sequence mismatch ${h.sn}:`,n,e,f,h);return}else if(f.cc!==h.cc){e.playlistParsingError=cb(`discontinuity sequence mismatch (${f.cc}!=${h.cc})`,n,e,f,h);return}}}}function cb(n,e,t,r,s){return new Error(`${n} ${s.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function k_(n,e,t=!0){const r=e.startSN+e.skippedSegments-n.startSN,s=n.fragments,i=r>=0;let o=0;if(i&&r<s.length)o=s[r].start;else if(i&&e.startSN===n.endSN+1)o=n.fragmentEnd;else if(i&&t)o=n.fragmentStart+r*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)o=n.fragmentStart;else return;gg(e,o)}function gg(n,e){if(e){const t=n.fragments;for(let r=n.skippedSegments;r<t.length;r++)t[r].addStart(e);n.fragmentHint&&n.fragmentHint.addStart(e)}}function P_(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const r=n.fragments;if(r.length&&t*4>e){const i=r[r.length-1].duration*1e3;i<t&&(t=i)}}else t/=2;return Math.round(t)}function D_(n,e,t){if(!n)return null;let r=n.fragments[e-n.startSN];return r||(r=n.fragmentHint,r&&r.sn===e)?r:e<n.startSN&&t&&t.sn===e?t:null}function ub(n,e,t){return n?N_(n.partList,e,t):null}function N_(n,e,t){if(n)for(let r=n.length;r--;){const s=n[r];if(s.index===t&&s.fragment.sn===e)return s}return null}function O_(n){n.forEach((e,t)=>{var r;(r=e.details)==null||r.fragments.forEach(s=>{s.level=t,s.initSegment&&(s.initSegment.level=t)})})}function $8(n,e){return n!==e&&e?db(n)!==db(e):!1}function db(n){return n.replace(/\?[^?]*$/,"")}function cl(n,e){for(let r=0,s=n.length;r<s;r++){var t;if(((t=n[r])==null?void 0:t.cc)===e)return n[r]}return null}function j8(n,e){return!!(n&&e.startCC<n.endCC&&e.endCC>n.startCC)}function fb(n,e){const t=n.start+e;n.startPTS=t,n.setStart(t),n.endPTS=t+n.duration}function M_(n,e){const t=e.fragments;for(let r=0,s=t.length;r<s;r++)fb(t[r],n);e.fragmentHint&&fb(e.fragmentHint,n),e.alignedSliding=!0}function V8(n,e){n&&(F_(e,n),e.alignedSliding||Od(e,n),!e.alignedSliding&&!e.skippedSegments&&k_(n,e,!1))}function F_(n,e){if(!j8(e,n))return;const t=Math.min(e.endCC,n.endCC),r=cl(e.fragments,t),s=cl(n.fragments,t);if(!r||!s)return;tt.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const i=r.start-s.start;M_(i,n)}function Od(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,r=e.fragments;if(!t.length||!r.length)return;let s,i;const o=Math.min(e.endCC,n.endCC);e.startCC<o&&n.startCC<o&&(s=cl(r,o),i=cl(t,o)),(!s||!i)&&(s=r[Math.floor(r.length/2)],i=cl(t,s.cc)||t[Math.floor(t.length/2)]);const l=s.programDateTime,u=i.programDateTime;if(!l||!u)return;const d=(u-l)/1e3-(i.start-s.start);M_(d,n)}function rn(n,e,t){mn(n,e,t),n.addEventListener(e,t)}function mn(n,e,t){n.removeEventListener(e,t)}const G8={toString:function(n){let e="";const t=n.length;for(let r=0;r<t;r++)e+=`[${n.start(r).toFixed(3)}-${n.end(r).toFixed(3)}]`;return e}},re={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Y0 extends T_{constructor(e,t,r,s,i){super(s,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=re.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:o,fragCurrent:l,media:u,mediaBuffer:d,state:f}=this,h=u?u.currentTime:0,m=Me.bufferInfo(d||u,h,o.maxBufferHole),v=!m.len;if(this.log(`Media seeking to ${he(h)?h.toFixed(3):h}, state: ${f}, ${v?"out of":"in"} buffer`),this.state===re.ENDED)this.resetLoadingState();else if(l){const g=o.maxFragLookUpTolerance,x=l.start-g,E=l.start+l.duration+g;if(v||E<m.start||x>m.end){const b=h>E;(h<x||b)&&(b&&l.loader&&(this.log(`Cancelling fragment load for seek (sn: ${l.sn})`),l.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(u){this.fragmentTracker.removeFragmentsInRange(h,1/0,this.playlistType,!0);const g=this.lastCurrentTime;if(h>g&&(this.lastCurrentTime=h),!this.loadingParts){const x=Math.max(m.end,h),E=this.shouldLoadParts(this.getLevelDetails(),x);E&&(this.log(`LL-Part loading ON after seeking to ${h.toFixed(2)} with buffer @${x.toFixed(2)}`),this.loadingParts=E)}}this.hls.hasEnoughToStart||(this.log(`Setting ${v?"startPosition":"nextLoadPosition"} to ${h} for seek without enough to start`),this.nextLoadPosition=h,v&&(this.startPosition=h)),v&&this.state===re.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=i,this.hls=e,this.fragmentLoader=new y8(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new H0(e.config)}registerListeners(){const{hls:e}=this;e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(_.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===re.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=re.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const r=e.end||0,s=this.config.timelineOffset||0;if(r<=s)return!1;const i=e.buffered;this.config.maxBufferHole&&i&&i.length>1&&(e=Me.bufferedInfo(i,e.start,0));const o=e.nextStart;if(o&&o>s&&o<t.edge||this.media.currentTime<e.start)return!1;const u=t.partList;if(u!=null&&u.length){const f=u[u.length-1];return Me.isBuffered(this.media,f.start+f.duration/2)}const d=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(d)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;rn(r,"seeking",this.onMediaSeeking),rn(r,"ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===re.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(e,t){const r=!!t.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),mn(s,"seeking",this.onMediaSeeking),mn(s,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=re.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const s=i=>{const o=i.frag;if(this.fragContextChanged(o)){this.warn(`${o.type} sn: ${o.sn}${i.part?" part: "+i.part.index:""} of ${this.fragInfo(o,!1,i.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(o);return}o.stats.chunkCount++,this._handleFragmentLoadProgress(i)};this._doFragLoad(e,t,r,s).then(i=>{if(!i)return;const o=this.state,l=i.frag;if(this.fragContextChanged(l)){(o===re.FRAG_LOADING||!this.fragCurrent&&o===re.PARSING)&&(this.fragmentTracker.removeFragment(l),this.state=re.IDLE);return}"payload"in i&&(this.log(`Loaded ${l.type} sn: ${l.sn} of ${this.playlistLabel()} ${l.level}`),this.hls.trigger(_.FRAG_LOADED,i)),this._handleFragmentLoadComplete(i)}).catch(i=>{this.state===re.STOPPED||this.state===re.ERROR||(this.warn(`Frag error: ${i?.message||i}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===Pt.APPENDING){const i=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,i),l=Math.max(e.duration,o?o.len:this.config.maxBufferLength),u=this.backtrackFragment;((u?e.sn-u.sn:0)===1||this.reduceMaxBufferLength(l,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Pt.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return t?.live&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const s={startOffset:e,endOffset:t,type:r};this.hls.trigger(_.BUFFER_FLUSHING,s)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{const s=r?.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:s}=this,{frag:i,payload:o}=r,l=i.decryptdata;if(o&&o.byteLength>0&&l!=null&&l.key&&l.iv&&No(l.method)){const u=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),l.key.buffer,l.iv.buffer,W0(l.method)).catch(d=>{throw s.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:i}),d}).then(d=>{const f=self.performance.now();return s.trigger(_.FRAG_DECRYPTED,{frag:i,payload:d,stats:{tstart:u,tdecrypt:f}}),r.payload=d,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===re.STOPPED||this.state===re.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state!==re.STOPPED&&(this.state=re.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var r,s;const i=e.tracks;if(i&&!t.encrypted&&((r=i.audio)!=null&&r.encrypted||(s=i.video)!=null&&s.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const o=this.media,l=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${o?"attached mediaKeys: "+o.mediaKeys:"detached"})`);return this.warn(l.message),!o||o.mediaKeys?!1:(this.hls.trigger(_.ERROR,{type:we.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_KEYS,fatal:!1,error:l,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${r?G8.toString(Me.getBuffered(r)):"(detached)"})`),wt(e)){var s;if(e.type!==ge.SUBTITLE){const o=e.elementaryStreams;if(!Object.keys(o).some(l=>!!o[l])){this.state=re.IDLE;return}}const i=(s=this.levels)==null?void 0:s[e.level];i!=null&&i.fragmentError&&(this.log(`Resetting level fragment error count of ${i.fragmentError} on frag buffered`),i.fragmentError=0)}this.state=re.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:s,partsLoaded:i}=e,o=!i||i.length===0||i.some(u=>!u),l=new K0(r.level,r.sn,r.stats.chunkCount+1,0,s?s.index:-1,!o);t.flush(l)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,s){var i;this.fragCurrent=e;const o=t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let l=null;if(e.encrypted&&!((i=e.decryptdata)!=null&&i.key)){if(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=re.KEY_LOADING,this.fragCurrent=e,l=this.keyLoader.load(e).then(m=>{if(!this.fragContextChanged(m.frag))return this.hls.trigger(_.KEY_LOADED,m),this.state===re.KEY_LOADING&&(this.state=re.IDLE),m}),this.hls.trigger(_.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(l=this.keyLoader.loadClear(e,o.encryptedFragments,this.startFragRequested),l&&this.log("[eme] blocking frag load until media-keys acquired"));const u=this.fragPrevious;if(wt(e)&&(!u||e.sn!==u.sn)){const m=this.shouldLoadParts(t.details,e.end);m!==this.loadingParts&&(this.log(`LL-Part loading ${m?"ON":"OFF"} loading sn ${u?.sn}->${e.sn}`),this.loadingParts=m)}if(r=Math.max(e.start,r||0),this.loadingParts&&wt(e)){const m=o.partList;if(m&&s){r>o.fragmentEnd&&o.fragmentHint&&(e=o.fragmentHint);const v=this.getNextPart(m,e,r);if(v>-1){const g=m[v];e=this.fragCurrent=g.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${g.index} (${v}/${m.length-1}) of ${this.fragInfo(e,!1,g)}) cc: ${e.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=g.start+g.duration,this.state=re.FRAG_LOADING;let x;return l?x=l.then(E=>!E||this.fragContextChanged(E.frag)?null:this.doFragPartsLoad(e,g,t,s)).catch(E=>this.handleFragLoadError(E)):x=this.doFragPartsLoad(e,g,t,s).catch(E=>this.handleFragLoadError(E)),this.hls.trigger(_.FRAG_LOADING,{frag:e,part:g,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):x}else if(!e.url||this.loadedEndOfParts(m,r))return Promise.resolve(null)}}if(wt(e)&&this.loadingParts){var d;this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(d=o.partList)==null?void 0:d.filter(m=>m.loaded).map(m=>`[${m.start}-${m.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+o.startSN+"-"+o.endSN+"]"}, target: ${parseFloat(r.toFixed(3))}`),he(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=re.FRAG_LOADING;const f=this.config.progressive&&e.type!==ge.SUBTITLE;let h;return f&&l?h=l.then(m=>!m||this.fragContextChanged(m.frag)?null:this.fragmentLoader.load(e,s)).catch(m=>this.handleFragLoadError(m)):h=Promise.all([this.fragmentLoader.load(e,f?s:void 0),l]).then(([m])=>(!f&&s&&s(m),m)).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(_.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):h}doFragPartsLoad(e,t,r,s){return new Promise((i,o)=>{var l;const u=[],d=(l=r.details)==null?void 0:l.partList,f=h=>{this.fragmentLoader.loadPart(e,h,s).then(m=>{u[h.index]=m;const v=m.part;this.hls.trigger(_.FRAG_LOADED,m);const g=ub(r.details,e.sn,h.index+1)||N_(d,e.sn,h.index+1);if(g)f(g);else return i({frag:e,part:v,partsLoaded:u})}).catch(o)};f(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===W.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===we.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(_.ERROR,t)}else this.hls.trigger(_.ERROR,{type:we.OTHER_ERROR,details:W.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==re.PARSING){!this.fragCurrent&&this.state!==re.STOPPED&&this.state!==re.ERROR&&(this.state=re.IDLE);return}const{frag:r,part:s,level:i}=t,o=self.performance.now();r.stats.parsing.end=o,s&&(s.stats.parsing.end=o);const l=this.getLevelDetails(),d=l&&r.sn>l.endSN||this.shouldLoadParts(l,r.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=d),this.updateLevelTiming(r,s,i,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var r;const i=e.partList[0];if(i.fragment.type===ge.SUBTITLE)return!1;const o=i.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0);if(t>=o){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>i.start-i.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:s,sn:i,part:o}=e;if(!(t!=null&&t[s]))return this.warn(`Levels object was unset while buffering fragment ${i} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const l=t[s],u=l.details,d=o>-1?ub(u,i,o):null,f=d?d.fragment:D_(u,i,r);return f?(r&&r!==f&&(f.stats=r.stats),{frag:f,part:d,level:l}):null}bufferFragmentData(e,t,r,s,i){if(this.state!==re.PARSING)return;const{data1:o,data2:l}=e;let u=o;if(l&&(u=qn(o,l)),!u.length)return;const d=this.initPTS[t.cc],f=d?-d.baseTime/d.timescale:void 0,h={type:e.type,frag:t,part:r,chunkMeta:s,offset:f,parent:t.type,data:u};if(this.hls.trigger(_.BUFFER_APPENDING,h),e.dropped&&e.independent&&!r){if(i)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Me.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,s=Me.bufferInfo(t,r,0),i=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,i*.25),l=Math.max(Math.min(e.start-o,s.end-o),r+o);e.start-l>o&&this.flushMainBuffer(l,e.start)}getFwdBufferInfo(e,t){var r;const s=this.getLoadPosition();if(!he(s))return null;const o=this.lastCurrentTime>s||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,s,t,o)}getFwdBufferInfoAtPos(e,t,r,s){const i=Me.bufferInfo(e,t,s);if(i.len===0&&i.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,r);if(o&&(i.nextStart<=o.end||o.gap)){const l=Math.max(Math.min(i.nextStart,o.end)-t,s);return Me.bufferInfo(e,t,l)}}return i}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const r=this.config,s=Math.max(Math.min(e-t,r.maxBufferLength),t),i=Math.max(e-t*3,r.maxMaxBufferLength/2,s);return i>=s?(r.maxMaxBufferLength=i,this.warn(`Reduce max buffer length to ${i}s`),!0):!1}getAppendedFrag(e,t=ge.MAIN){const r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return r&&"fragment"in r?r.fragment:r}getNextFragment(e,t){const r=t.fragments,s=r.length;if(!s)return null;const{config:i}=this,o=r[0].start,l=i.lowLatencyMode&&!!t.partList;let u=null;if(t.live){const h=i.initialLiveManifestSize;if(s<h)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${h})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o){var d;l&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),u=this.getInitialLiveFragment(t);const m=this.hls.startPosition,v=this.hls.liveSyncPosition,g=u?(m!==-1&&m>=o?m:v)||u.start:e;this.log(`Setting startPosition to ${g} to match start frag at live edge. mainStart: ${m} liveSyncPosition: ${v} frag.start: ${(d=u)==null?void 0:d.start}`),this.startPosition=this.nextLoadPosition=g}}else e<=o&&(u=r[0]);if(!u){const h=this.loadingParts?t.partEnd:t.fragmentEnd;u=this.getFragmentAtPosition(e,h,t)}let f=this.filterReplacedPrimary(u,t);if(!f&&u){const h=u.sn-t.startSN;f=this.filterReplacedPrimary(r[h+1]||null,t)}return this.mapToInitFragWhenRequired(f)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===Pt.OK||r===Pt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,s,i){let o=null;if(e.gap&&(o=this.getNextFragment(this.nextLoadPosition,t),o&&!o.gap&&r.nextStart)){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,s,0);if(l!==null&&r.len+l.len>=i){const u=o.sn;return this.loopSn!==u&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${u}`),this.loopSn=u),null}}return this.loopSn=void 0,o}get primaryPrefetch(){if(hb(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(hb(this.config)&&e.type!==ge.SUBTITLE){const r=this.hls.interstitialsManager,s=r?.bufferingItem;if(s){const o=s.event;if(o){if(o.appendInPlace||Math.abs(e.start-s.start)>1||s.start===0)return null}else if(e.end<=s.start&&t?.live===!1||e.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||e.start-s.end>1))return null}const i=r?.playerQueue;if(i)for(let o=i.length;o--;){const l=i[o].interstitial;if(l.appendInPlace&&e.start>=l.startTime&&e.end<=l.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let s=-1,i=!1,o=!0;for(let l=0,u=e.length;l<u;l++){const d=e[l];if(o=o&&!d.independent,s>-1&&r<d.start)break;const f=d.loaded;f?s=-1:(i||(d.independent||o)&&d.fragment===t)&&(d.fragment!==t&&this.warn(`Need buffer at ${r} but next unloaded part starts at ${d.start}`),s=l),i=f}return s}loadedEndOfParts(e,t){let r;for(let s=e.length;s--;){if(r=e[s],!r.loaded)return!1;if(t>r.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,r=this.fragPrevious;let s=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),s=i8(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const i=r.sn+1;if(i>=e.startSN&&i<=e.endSN){const o=t[i-e.startSN];r.cc===o.cc&&(s=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=x_(e,r.cc,r.end),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const i=this.hls.liveSyncPosition;i!==null&&(s=this.getFragmentAtPosition(i,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,t,r){const{config:s}=this;let{fragPrevious:i}=this,{fragments:o,endSN:l}=r;const{fragmentHint:u}=r,{maxFragLookUpTolerance:d}=s,f=r.partList,h=!!(this.loadingParts&&f!=null&&f.length&&u);h&&!this.bitrateTest&&f[f.length-1].fragment.sn===u.sn&&(o=o.concat(u),l=u.sn);let m;if(e<t){var v;const x=e<this.lastCurrentTime||e>t-d||(v=this.media)!=null&&v.paused||!this.startFragRequested?0:d;m=ji(i,o,e,x)}else m=o[o.length-1];if(m){const g=m.sn-r.startSN,x=this.fragmentTracker.getState(m);if((x===Pt.OK||x===Pt.PARTIAL&&m.gap)&&(i=m),i&&m.sn===i.sn&&(!h||f[0].fragment.sn>m.sn||!r.live)&&m.level===i.level){const b=o[g+1];m.sn<l&&this.fragmentTracker.getState(b)!==Pt.OK?m=b:m=null}}return m}alignPlaylists(e,t,r){const s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const i=e.fragmentStart,o=!t,l=e.alignedSliding&&he(i);if(o||!l&&!i){V8(r,e);const u=e.fragmentStart;return this.log(`Live playlist sliding: ${u.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${s}`),u}return i}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;r<t&&(r=-1);const s=this.timelineOffset;if(r===-1){const i=this.startTimeOffset!==null,o=i?this.startTimeOffset:e.startTimeOffset;o!==null&&he(o)?(r=t+o,o<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${o} found in ${i?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+s}this.nextLoadPosition=r+s}getLoadPosition(){var e;const{media:t}=this;let r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&wt(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==re.FRAG_LOADING_WAITING_RETRY)&&(this.state=re.IDLE)}onFragmentOrKeyLoadError(e,t){var r;if(t.chunkMeta&&!t.frag){const b=this.getCurrentContext(t.chunkMeta);b&&(t.frag=b.frag)}const s=t.frag;if(!s||s.type!==e||!this.levels)return;if(this.fragContextChanged(s)){var i;this.warn(`Frag load error must match current frag to retry ${s.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const o=t.details===W.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(s,!0);const l=t.errorAction;if(!l){this.state=re.ERROR;return}const{action:u,flags:d,retryCount:f=0,retryConfig:h}=l,m=!!h,v=m&&u===jt.RetryRequest,g=m&&!l.resolved&&d===_n.MoveAllAlternatesMatchingHost,x=(r=this.hls.latestLevelDetails)==null?void 0:r.live;if(!v&&g&&wt(s)&&!s.endList&&x&&!S_(t))this.resetFragmentErrors(e),this.treatAsGap(s),l.resolved=!0;else if((v||g)&&f<h.maxNumRetry){var E;const b=fg((E=t.response)==null?void 0:E.code),I=G0(h,f);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+I,this.state=re.FRAG_LOADING_WAITING_RETRY,l.resolved=!0,b){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${s.sn} of ${e} ${s.level} errored with ${t.details}, retrying loading ${f+1}/${h.maxNumRetry} in ${I}ms`)}else if(h)if(this.resetFragmentErrors(e),f<h.maxNumRetry)!o&&u!==jt.RemoveAlternatePermanently&&(l.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${f})`);return}else u===jt.SendAlternateToPenaltyBox?this.state=re.WAITING_LEVEL:this.state=re.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,r=t===1/0;(!t||e>=t||r&&!fg(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=re.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===re.PARSING||this.state===re.PARSED){const t=e.frag,r=e.parent,s=this.getFwdBufferInfo(this.mediaBuffer,r),i=s&&s.len>.5;i&&this.reduceMaxBufferLength(s.len,t?.duration||10);const o=!i;return o&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===ge.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==re.STOPPED&&(this.state=re.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const s=Me.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,s,r),this.state===re.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==re.STOPPED&&(this.state=re.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,s){const i=r.details;if(!i){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((u,d)=>{const f=e.elementaryStreams[d];if(f){const h=f.endPTS-f.startPTS;if(h<=0)return this.warn(`Could not parse fragment ${e.sn} ${d} duration reliably (${h})`),u||!1;const m=s?0:C_(i,e,f.startPTS,f.endPTS,f.startDTS,f.endDTS,this);return this.hls.trigger(_.LEVEL_PTS_UPDATED,{details:i,level:r,drift:m,type:d,frag:e,start:f.startPTS,end:f.endPTS}),!0}return u},!1)){var l;const u=((l=this.transmuxer)==null?void 0:l.error)===null;if((r.fragmentError===0||u&&(r.fragmentError<2||e.endList))&&this.treatAsGap(e,r),u){const d=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=re.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(_.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===ge.MAIN?"level":"track"}fragInfo(e,t=!0,r){var s,i;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((s=t&&!r?e.startPTS:(r||e).start)!=null?s:NaN).toFixed(3)}-${((i=t&&!r?e.endPTS:(r||e).end)!=null?i:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function hb(n){return!!n.interstitialsController&&n.enableInterstitialPlayback!==!1}class B_{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=H8(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function H8(n,e){const t=new Uint8Array(e);let r=0;for(let s=0;s<n.length;s++){const i=n[s];t.set(i,r),r+=i.length}return t}var nm={exports:{}},pb;function K8(){return pb||(pb=1,(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(u,d,f){this.fn=u,this.context=d,this.once=f||!1}function i(u,d,f,h,m){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new s(f,h||u,m),g=t?t+d:d;return u._events[g]?u._events[g].fn?u._events[g]=[u._events[g],v]:u._events[g].push(v):(u._events[g]=v,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],f,h;if(this._eventsCount===0)return d;for(h in f=this._events)e.call(f,h)&&d.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},l.prototype.listeners=function(d){var f=t?t+d:d,h=this._events[f];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,v=h.length,g=new Array(v);m<v;m++)g[m]=h[m].fn;return g},l.prototype.listenerCount=function(d){var f=t?t+d:d,h=this._events[f];return h?h.fn?1:h.length:0},l.prototype.emit=function(d,f,h,m,v,g){var x=t?t+d:d;if(!this._events[x])return!1;var E=this._events[x],b=arguments.length,I,A;if(E.fn){switch(E.once&&this.removeListener(d,E.fn,void 0,!0),b){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,f),!0;case 3:return E.fn.call(E.context,f,h),!0;case 4:return E.fn.call(E.context,f,h,m),!0;case 5:return E.fn.call(E.context,f,h,m,v),!0;case 6:return E.fn.call(E.context,f,h,m,v,g),!0}for(A=1,I=new Array(b-1);A<b;A++)I[A-1]=arguments[A];E.fn.apply(E.context,I)}else{var R=E.length,C;for(A=0;A<R;A++)switch(E[A].once&&this.removeListener(d,E[A].fn,void 0,!0),b){case 1:E[A].fn.call(E[A].context);break;case 2:E[A].fn.call(E[A].context,f);break;case 3:E[A].fn.call(E[A].context,f,h);break;case 4:E[A].fn.call(E[A].context,f,h,m);break;default:if(!I)for(C=1,I=new Array(b-1);C<b;C++)I[C-1]=arguments[C];E[A].fn.apply(E[A].context,I)}}return!0},l.prototype.on=function(d,f,h){return i(this,d,f,h,!1)},l.prototype.once=function(d,f,h){return i(this,d,f,h,!0)},l.prototype.removeListener=function(d,f,h,m){var v=t?t+d:d;if(!this._events[v])return this;if(!f)return o(this,v),this;var g=this._events[v];if(g.fn)g.fn===f&&(!m||g.once)&&(!h||g.context===h)&&o(this,v);else{for(var x=0,E=[],b=g.length;x<b;x++)(g[x].fn!==f||m&&!g[x].once||h&&g[x].context!==h)&&E.push(g[x]);E.length?this._events[v]=E.length===1?E[0]:E:o(this,v)}return this},l.prototype.removeAllListeners=function(d){var f;return d?(f=t?t+d:d,this._events[f]&&o(this,f)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,n.exports=l})(nm)),nm.exports}var W8=K8(),q0=y6(W8);const Al="1.6.15",Ho={};function z8(){return typeof __HLS_WORKER_BUNDLE__=="function"}function Y8(){const n=Ho[Al];if(n)return n.clientCount++,n;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),s={worker:new self.Worker(t),objectURL:t,clientCount:1};return Ho[Al]=s,s}function q8(n){const e=Ho[n];if(e)return e.clientCount++,e;const t=new self.URL(n,self.location.href).href,s={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Ho[n]=s,s}function X8(n){const e=Ho[n||Al];if(e&&e.clientCount--===1){const{worker:r,objectURL:s}=e;delete Ho[n||Al],s&&self.URL.revokeObjectURL(s),r.terminate()}}function U_(n,e){return e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function X0(n,e){return e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function gf(n,e){let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t}function _l(n,e){const t=e;let r=0;for(;X0(n,e);){r+=10;const s=gf(n,e+6);r+=s,U_(n,e+10)&&(r+=10),e+=r}if(r>0)return n.subarray(t,t+r)}function Q8(n,e,t,r){const s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=e[t+2],o=i>>2&15;if(o>12){const v=new Error(`invalid ADTS sampling index:${o}`);n.emit(_.ERROR,_.ERROR,{type:we.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!0,error:v,reason:v.message});return}const l=(i>>6&3)+1,u=e[t+3]>>6&3|(i&1)<<2,d="mp4a.40."+l,f=s[o];let h=o;(l===5||l===29)&&(h-=3);const m=[l<<3|(h&14)>>1,(h&1)<<7|u<<3];return tt.log(`manifest codec:${r}, parsed codec:${d}, channels:${u}, rate:${f} (ADTS object type:${l} sampling index:${o})`),{config:m,samplerate:f,channelCount:u,codec:d,parsedCodec:d,manifestCodec:r}}function $_(n,e){return n[e]===255&&(n[e+1]&246)===240}function j_(n,e){return n[e+1]&1?7:9}function Q0(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function J8(n,e){return e+5<n.length}function Md(n,e){return e+1<n.length&&$_(n,e)}function Z8(n,e){return J8(n,e)&&$_(n,e)&&Q0(n,e)<=n.length-e}function eV(n,e){if(Md(n,e)){const t=j_(n,e);if(e+t>=n.length)return!1;const r=Q0(n,e);if(r<=t)return!1;const s=e+r;return s===n.length||Md(n,s)}return!1}function V_(n,e,t,r,s){if(!n.samplerate){const i=Q8(e,t,r,s);if(!i)return;rt(n,i)}}function G_(n){return 1024*9e4/n}function tV(n,e){const t=j_(n,e);if(e+t<=n.length){const r=Q0(n,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function H_(n,e,t,r,s){const i=G_(n.samplerate),o=r+s*i,l=tV(e,t);let u;if(l){const{frameLength:h,headerLength:m}=l,v=m+h,g=Math.max(0,t+v-e.length);g?(u=new Uint8Array(v-m),u.set(e.subarray(t+m,e.length),0)):u=e.subarray(t+m,t+v);const x={unit:u,pts:o};return g||n.samples.push(x),{sample:x,length:v,missing:g}}const d=e.length-t;return u=new Uint8Array(d),u.set(e.subarray(t,e.length),0),{sample:{unit:u,pts:o},length:d,missing:-1}}function nV(n,e){return X0(n,e)&&gf(n,e+6)+10<=n.length-e}function rV(n){return n instanceof ArrayBuffer?n:n.byteOffset==0&&n.byteLength==n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}function rm(n,e=0,t=1/0){return sV(n,e,t,Uint8Array)}function sV(n,e,t,r){const s=iV(n);let i=1;"BYTES_PER_ELEMENT"in r&&(i=r.BYTES_PER_ELEMENT);const o=oV(n)?n.byteOffset:0,l=(o+n.byteLength)/i,u=(o+e)/i,d=Math.floor(Math.max(0,Math.min(u,l))),f=Math.floor(Math.min(d+Math.max(t,0),l));return new r(s,d,f-d)}function iV(n){return n instanceof ArrayBuffer?n:n.buffer}function oV(n){return n&&n.buffer instanceof ArrayBuffer&&n.byteLength!==void 0&&n.byteOffset!==void 0}function aV(n){const e={key:n.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(n.size<2)return;if(n.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const r=n.data.subarray(1).indexOf(0);if(r===-1)return;const s=Dn(rm(n.data,1,r)),i=n.data[2+r],o=n.data.subarray(3+r).indexOf(0);if(o===-1)return;const l=Dn(rm(n.data,3+r,o));let u;return s==="-->"?u=Dn(rm(n.data,4+r+o)):u=rV(n.data.subarray(4+r+o)),e.mimeType=s,e.pictureType=i,e.description=l,e.data=u,e}function lV(n){if(n.size<2)return;const e=Dn(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}}function cV(n){if(n.size<2)return;if(n.type==="TXXX"){let t=1;const r=Dn(n.data.subarray(t),!0);t+=r.length+1;const s=Dn(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=Dn(n.data.subarray(1));return{key:n.type,info:"",data:e}}function uV(n){if(n.type==="WXXX"){if(n.size<2)return;let t=1;const r=Dn(n.data.subarray(t),!0);t+=r.length+1;const s=Dn(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=Dn(n.data);return{key:n.type,info:"",data:e}}function dV(n){return n.type==="PRIV"?lV(n):n.type[0]==="W"?uV(n):n.type==="APIC"?aV(n):cV(n)}function fV(n){const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=gf(n,4),r=10;return{type:e,size:t,data:n.subarray(r,r+t)}}const bu=10,hV=10;function K_(n){let e=0;const t=[];for(;X0(n,e);){const r=gf(n,e+6);n[e+5]>>6&1&&(e+=bu),e+=bu;const s=e+r;for(;e+hV<s;){const i=fV(n.subarray(e)),o=dV(i);o&&t.push(o),e+=i.size+bu}U_(n,e)&&(e+=bu)}return t}function W_(n){return n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp"}function pV(n){if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}}function J0(n){const e=K_(n);for(let t=0;t<e.length;t++){const r=e[t];if(W_(r))return pV(r)}}let Ln=(function(n){return n.audioId3="org.id3",n.dateRange="com.apple.quicktime.HLS",n.emsg="https://aomedia.org/emsg/ID3",n.misbklv="urn:misb:KLV:bin:1910.1",n})({});function Ar(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Z0{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=qn(this.cachedData,e),this.cachedData=null);let r=_l(e,0),s=r?r.length:0,i;const o=this._audioTrack,l=this._id3Track,u=r?J0(r):void 0,d=e.length;for((this.basePTS===null||this.frameIndex===0&&he(u))&&(this.basePTS=mV(u,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Ln.audioId3,duration:Number.POSITIVE_INFINITY});s<d;){if(this.canParse(e,s)){const f=this.appendFrame(o,e,s);f?(this.frameIndex++,this.lastPTS=f.sample.pts,s+=f.length,i=s):s=d}else nV(e,s)?(r=_l(e,s),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Ln.audioId3,duration:Number.POSITIVE_INFINITY}),s+=r.length,i=s):s++;if(s===d&&i!==d){const f=e.slice(i);this.cachedData?this.cachedData=qn(this.cachedData,f):this.cachedData=f}}return{audioTrack:o,videoTrack:Ar(),id3Track:l,textTrack:Ar()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Ar(),id3Track:this._id3Track,textTrack:Ar()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const mV=(n,e,t)=>{if(he(n))return n*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};let wu=null;const gV=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],yV=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],vV=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],xV=[0,1,1,4];function z_(n,e,t,r,s){if(t+24>e.length)return;const i=Y_(e,t);if(i&&t+i.frameLength<=e.length){const o=i.samplesPerFrame*9e4/i.sampleRate,l=r+s*o,u={unit:e.subarray(t,t+i.frameLength),pts:l,dts:l};return n.config=[],n.channelCount=i.channelCount,n.samplerate=i.sampleRate,n.samples.push(u),{sample:u,length:i.frameLength,missing:0}}}function Y_(n,e){const t=n[e+1]>>3&3,r=n[e+1]>>1&3,s=n[e+2]>>4&15,i=n[e+2]>>2&3;if(t!==1&&s!==0&&s!==15&&i!==3){const o=n[e+2]>>1&1,l=n[e+3]>>6,u=t===3?3-r:r===3?3:4,d=gV[u*14+s-1]*1e3,h=yV[(t===3?0:t===2?1:2)*3+i],m=l===3?1:2,v=vV[t][r],g=xV[r],x=v*8*g,E=Math.floor(v*d/h+o)*g;if(wu===null){const A=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);wu=A?parseInt(A[1]):0}return!!wu&&wu<=87&&r===2&&d>=224e3&&l===0&&(n[e+3]=n[e+3]|128),{sampleRate:h,channelCount:m,frameLength:E,samplesPerFrame:x}}}function ey(n,e){return n[e]===255&&(n[e+1]&224)===224&&(n[e+1]&6)!==0}function q_(n,e){return e+1<n.length&&ey(n,e)}function EV(n,e){return ey(n,e)&&4<=n.length-e}function X_(n,e){if(e+1<n.length&&ey(n,e)){const r=Y_(n,e);let s=4;r!=null&&r.frameLength&&(s=r.frameLength);const i=e+s;return i===n.length||q_(n,i)}return!1}class SV extends Z0{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const r=_l(e,0);let s=r?.length||0;if(X_(e,s))return!1;for(let i=e.length;s<i;s++)if(eV(e,s))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return Z8(e,t)}appendFrame(e,t,r){V_(e,this.observer,t,r,e.manifestCodec);const s=H_(e,t,r,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const Q_=(n,e)=>{let t=0,r=5;e+=r;const s=new Uint32Array(1),i=new Uint32Array(1),o=new Uint8Array(1);for(;r>0;){o[0]=n[e];const l=Math.min(r,8),u=8-l;i[0]=4278190080>>>24+u<<u,s[0]=(o[0]&i[0])>>u,t=t?t<<l|s[0]:s[0],e+=1,r-=l}return t};class TV extends Z0{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){const s=J_(e,t,r,this.basePTS,this.frameIndex);if(s!==-1)return{sample:e.samples[e.samples.length-1],length:s,missing:0}}static probe(e){if(!e)return!1;const t=_l(e,0);if(!t)return!1;const r=t.length;return e[r]===11&&e[r+1]===119&&J0(t)!==void 0&&Q_(e,r)<16}}function J_(n,e,t,r,s){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const i=e[t+4]>>6;if(i>=3)return-1;const l=[48e3,44100,32e3][i],u=e[t+4]&63,f=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][u*3+i]*2;if(t+f>e.length)return-1;const h=e[t+6]>>5;let m=0;h===2?m+=2:(h&1&&h!==1&&(m+=2),h&4&&(m+=2));const v=(e[t+6]<<8|e[t+7])>>12-m&1,x=[2,1,2,3,3,4,4,5][h]+v,E=e[t+5]>>3,b=e[t+5]&7,I=new Uint8Array([i<<6|E<<1|b>>2,(b&3)<<6|h<<3|v<<2|u>>4,u<<4&224]),A=1536/l*9e4,R=r+s*A,C=e.subarray(t,t+f);return n.config=I,n.channelCount=x,n.samplerate=l,n.samples.push({unit:C,pts:R}),f}class bV extends Z0{resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=_l(e,0);let r=t?.length||0;if(t&&e[r]===11&&e[r+1]===119&&J0(t)!==void 0&&Q_(e,r)<=16)return!1;for(let s=e.length;r<s;r++)if(X_(e,r))return tt.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return EV(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return z_(e,t,r,this.basePTS,this.frameIndex)}}const wV=/\/emsg[-/]ID3/i;class IV{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,s){const i=this.videoTrack=Ar("video",1),o=this.audioTrack=Ar("audio",1),l=this.txtTrack=Ar("text",1);if(this.id3Track=Ar("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const u=l_(e);if(u.video){const{id:d,timescale:f,codec:h,supplemental:m}=u.video;i.id=d,i.timescale=l.timescale=f,i.codec=h,i.supplemental=m}if(u.audio){const{id:d,timescale:f,codec:h}=u.audio;o.id=d,o.timescale=f,o.codec=h}l.id=i_.text,i.sampleDuration=0,i.duration=o.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return T6(e)}demux(e,t){this.timeOffset=t;let r=e;const s=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=qn(this.remainderData,e));const l=L6(r);this.remainderData=l.remainder,s.samples=l.valid||new Uint8Array}else s.samples=r;const o=this.extractID3Track(s,t);return i.samples=PT(t,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(t,this.timeOffset);return r.samples=PT(e,t),{videoTrack:t,audioTrack:Ar(),id3Track:s,textTrack:Ar()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const s=$e(e.samples,["emsg"]);s&&s.forEach(i=>{const o=k6(i);if(wV.test(o.schemeIdUri)){const l=mb(o,t);let u=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;u<=.001&&(u=Number.POSITIVE_INFINITY);const d=o.payload;r.samples.push({data:d,len:d.byteLength,dts:l,pts:l,type:Ln.emsg,duration:u})}else if(this.config.enableEmsgKLVMetadata&&o.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const l=mb(o,t);r.samples.push({data:o.payload,len:o.payload.byteLength,dts:l,pts:l,type:Ln.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function mb(n,e){return he(n.presentationTime)?n.presentationTime/n.timeScale:e+n.presentationTimeDelta/n.timeScale}class AV{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new H0(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,ni.cbc)}decryptAacSample(e,t,r){const s=e[t].unit;if(s.length<=16)return;const i=s.subarray(16,s.length-s.length%16),o=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(o).then(l=>{const u=new Uint8Array(l);s.set(u,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)}).catch(r)}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)r.set(e.subarray(i,i+16),s);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)e.set(r.subarray(s,s+16),i);return e}decryptAvcSample(e,t,r,s,i){const o=d_(i.data),l=this.getAvcEncryptedData(o);this.decryptBuffer(l.buffer).then(u=>{i.data=this.getAvcDecryptedUnit(o,u),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,s)}).catch(s)}decryptAvcSamples(e,t,r,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){s();return}const i=e[t].units;for(;!(r>=i.length);r++){const o=i[r];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,r,s,o),!this.decrypter.isSync()))return}}}}class Z_{constructor(){this.VideoSample=null}createVideoSample(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}getLastNalUnit(e){var t;let r=this.VideoSample,s;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const i=r.units;s=i[i.length-1]}return s}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const r=t.samples,s=r.length;if(s){const i=r[s-1];e.pts=i.pts,e.dts=i.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,r){const s=t.byteLength;let i=e.naluState||0;const o=i,l=[];let u=0,d,f,h,m=-1,v=0;for(i===-1&&(m=0,v=this.getNALuType(t,0),i=0,u=1);u<s;){if(d=t[u++],!i){i=d?0:1;continue}if(i===1){i=d?0:2;continue}if(!d)i=3;else if(d===1){if(f=u-i-1,m>=0){const g={data:t.subarray(m,f),type:v};l.push(g)}else{const g=this.getLastNalUnit(e.samples);g&&(o&&u<=4-o&&g.state&&(g.data=g.data.subarray(0,g.data.byteLength-o)),f>0&&(g.data=qn(g.data,t.subarray(0,f)),g.state=0))}u<s?(h=this.getNALuType(t,u),m=u,v=h,i=0):i=-1}else i=0}if(m>=0&&i>=0){const g={data:t.subarray(m,s),type:v,state:i};l.push(g)}if(l.length===0){const g=this.getLastNalUnit(e.samples);g&&(g.data=qn(g.data,t))}return e.naluState=i,l}}class ul{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,s=new Uint8Array(4),i=Math.min(4,t);if(i===0)throw new Error("no bytes available");s.set(e.subarray(r,r+i)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=i*8,this.bytesAvailable-=i}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&tt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class _V extends Z_{parsePES(e,t,r,s){const i=this.parseNALu(e,r.data,s);let o=this.VideoSample,l,u=!1;r.data=null,o&&i.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach(d=>{var f,h;switch(d.type){case 1:{let x=!1;l=!0;const E=d.data;if(u&&E.length>4){const b=this.readSliceType(E);(b===2||b===4||b===7||b===9)&&(x=!0)}if(x){var m;(m=o)!=null&&m.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.frame=!0,o.key=x;break}case 5:l=!0,(f=o)!=null&&f.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 6:{l=!0,$0(d.data,1,r.pts,t.samples);break}case 7:{var v,g;l=!0,u=!0;const x=d.data,E=this.readSPS(x);if(!e.sps||e.width!==E.width||e.height!==E.height||((v=e.pixelRatio)==null?void 0:v[0])!==E.pixelRatio[0]||((g=e.pixelRatio)==null?void 0:g[1])!==E.pixelRatio[1]){e.width=E.width,e.height=E.height,e.pixelRatio=E.pixelRatio,e.sps=[x];const b=x.subarray(1,4);let I="avc1.";for(let A=0;A<3;A++){let R=b[A].toString(16);R.length<2&&(R="0"+R),I+=R}e.codec=I}break}case 8:l=!0,e.pps=[d.data];break;case 9:l=!0,e.audFound=!0,(h=o)!=null&&h.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:l=!0;break;default:l=!1;break}o&&l&&o.units.push(d)}),s&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new ul(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let r=8,s=8,i;for(let o=0;o<e;o++)s!==0&&(i=t.readEG(),s=(r+i+256)%256),r=s===0?r:s}readSPS(e){const t=new ul(e);let r=0,s=0,i=0,o=0,l,u,d;const f=t.readUByte.bind(t),h=t.readBits.bind(t),m=t.readUEG.bind(t),v=t.readBoolean.bind(t),g=t.skipBits.bind(t),x=t.skipEG.bind(t),E=t.skipUEG.bind(t),b=this.skipScalingList.bind(this);f();const I=f();if(h(5),g(3),f(),E(),I===100||I===110||I===122||I===244||I===44||I===83||I===86||I===118||I===128){const N=m();if(N===3&&g(1),E(),E(),g(1),v())for(u=N!==3?8:12,d=0;d<u;d++)v()&&(d<6?b(16,t):b(64,t))}E();const A=m();if(A===0)m();else if(A===1)for(g(1),x(),x(),l=m(),d=0;d<l;d++)x();E(),g(1);const R=m(),C=m(),F=h(1);F===0&&g(1),g(1),v()&&(r=m(),s=m(),i=m(),o=m());let k=[1,1];if(v()&&v())switch(f()){case 1:k=[1,1];break;case 2:k=[12,11];break;case 3:k=[10,11];break;case 4:k=[16,11];break;case 5:k=[40,33];break;case 6:k=[24,11];break;case 7:k=[20,11];break;case 8:k=[32,11];break;case 9:k=[80,33];break;case 10:k=[18,11];break;case 11:k=[15,11];break;case 12:k=[64,33];break;case 13:k=[160,99];break;case 14:k=[4,3];break;case 15:k=[3,2];break;case 16:k=[2,1];break;case 255:{k=[f()<<8|f(),f()<<8|f()];break}}return{width:Math.ceil((R+1)*16-r*2-s*2),height:(2-F)*(C+1)*16-(F?2:4)*(i+o),pixelRatio:k}}}class RV extends Z_{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,r,s){const i=this.parseNALu(e,r.data,s);let o=this.VideoSample,l,u=!1;r.data=null,o&&i.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach(d=>{var f,h;switch(d.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),o.frame=!0,l=!0;break;case 16:case 17:case 18:case 21:if(l=!0,u){var m;(m=o)!=null&&m.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:l=!0,(f=o)!=null&&f.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 39:l=!0,$0(d.data,2,r.pts,t.samples);break;case 32:l=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=rt(e.params,this.readVPS(d.data)),this.initVPS=d.data),e.vps=[d.data];break;case 33:if(l=!0,u=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],d.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const v=this.readSPS(d.data);e.width=v.width,e.height=v.height,e.pixelRatio=v.pixelRatio,e.codec=v.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const g in v.params)e.params[g]=v.params[g]}this.pushParameterSet(e.sps,d.data,e.vps),o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0;break;case 34:if(l=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const v=this.readPPS(d.data);for(const g in v)e.params[g]=v[g]}this.pushParameterSet(e.pps,d.data,e.vps)}break;case 35:l=!0,e.audFound=!0,(h=o)!=null&&h.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:l=!1;break}o&&l&&o.units.push(d)}),s&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}pushParameterSet(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let r=0;for(let s=0;s<e.byteLength;s++)s>=2&&e[s]===3&&e[s-1]===0&&e[s-2]===0||(t[r]=e[s],r++);return new Uint8Array(t.buffer,0,r)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new ul(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const r=t.readBits(3),s=t.readBoolean();return{numTemporalLayers:r+1,temporalIdNested:s}}readSPS(e){const t=new ul(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const r=t.readBits(3);t.readBoolean();const s=t.readBits(2),i=t.readBoolean(),o=t.readBits(5),l=t.readUByte(),u=t.readUByte(),d=t.readUByte(),f=t.readUByte(),h=t.readUByte(),m=t.readUByte(),v=t.readUByte(),g=t.readUByte(),x=t.readUByte(),E=t.readUByte(),b=t.readUByte(),I=[],A=[];for(let pe=0;pe<r;pe++)I.push(t.readBoolean()),A.push(t.readBoolean());if(r>0)for(let pe=r;pe<8;pe++)t.readBits(2);for(let pe=0;pe<r;pe++)I[pe]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),A[pe]&&t.readUByte();t.readUEG();const R=t.readUEG();R==3&&t.skipBits(1);const C=t.readUEG(),F=t.readUEG(),k=t.readBoolean();let N=0,M=0,O=0,H=0;k&&(N+=t.readUEG(),M+=t.readUEG(),O+=t.readUEG(),H+=t.readUEG());const Z=t.readUEG(),se=t.readUEG(),U=t.readUEG(),ne=t.readBoolean();for(let pe=ne?0:r;pe<=r;pe++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Fe=0;Fe<4;Fe++)for(let Xe=0;Xe<(Fe===3?2:6);Xe++)if(!t.readBoolean())t.readUEG();else{const Ue=Math.min(64,1<<4+(Fe<<1));Fe>1&&t.readEG();for(let Je=0;Je<Ue;Je++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const G=t.readUEG();let Q=0;for(let pe=0;pe<G;pe++){let Fe=!1;if(pe!==0&&(Fe=t.readBoolean()),Fe){pe===G&&t.readUEG(),t.readBoolean(),t.readUEG();let Xe=0;for(let Ve=0;Ve<=Q;Ve++){const Ue=t.readBoolean();let Je=!1;Ue||(Je=t.readBoolean()),(Ue||Je)&&Xe++}Q=Xe}else{const Xe=t.readUEG(),Ve=t.readUEG();Q=Xe+Ve;for(let Ue=0;Ue<Xe;Ue++)t.readUEG(),t.readBoolean();for(let Ue=0;Ue<Ve;Ue++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const pe=t.readUEG();for(let Fe=0;Fe<pe;Fe++){for(let Xe=0;Xe<U+4;Xe++)t.readBits(1);t.readBits(1)}}let D=0,$=1,ie=1,ce=!0,ue=1,fe=0;t.readBoolean(),t.readBoolean();let Se=!1;if(t.readBoolean()){if(t.readBoolean()){const Dt=t.readUByte(),Bn=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],xn=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Dt>0&&Dt<16?($=Bn[Dt-1],ie=xn[Dt-1]):Dt===255&&($=t.readBits(16),ie=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),Se=t.readBoolean(),Se&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(ue=t.readBits(32),fe=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const xn=t.readBoolean(),St=t.readBoolean();let At=!1;(xn||St)&&(At=t.readBoolean(),At&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),At&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let En=0;En<=r;En++){ce=t.readBoolean();const mr=ce||t.readBoolean();let Sn=!1;mr?t.readEG():Sn=t.readBoolean();const Jt=Sn?1:t.readUEG()+1;if(xn)for(let Zt=0;Zt<Jt;Zt++)t.readUEG(),t.readUEG(),At&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(St)for(let Zt=0;Zt<Jt;Zt++)t.readUEG(),t.readUEG(),At&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),D=t.readUEG())}let Ae=C,Pe=F;if(k){let pe=1,Fe=1;R===1?pe=Fe=2:R==2&&(pe=2),Ae=C-pe*M-pe*N,Pe=F-Fe*H-Fe*O}const De=s?["A","B","C"][s]:"",Te=l<<24|u<<16|d<<8|f;let xe=0;for(let pe=0;pe<32;pe++)xe=(xe|(Te>>pe&1)<<31-pe)>>>0;let _e=xe.toString(16);return o===1&&_e==="2"&&(_e="6"),{codecString:`hvc1.${De}${o}.${_e}.${i?"H":"L"}${b}.B0`,params:{general_tier_flag:i,general_profile_idc:o,general_profile_space:s,general_profile_compatibility_flags:[l,u,d,f],general_constraint_indicator_flags:[h,m,v,g,x,E],general_level_idc:b,bit_depth:Z+8,bit_depth_luma_minus8:Z,bit_depth_chroma_minus8:se,min_spatial_segmentation_idc:D,chroma_format_idc:R,frame_rate:{fixed:ce,fps:fe/ue}},width:Ae,height:Pe,pixelRatio:[$,ie]}}readPPS(e){const t=new ul(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const s=t.readBoolean(),i=t.readBoolean();let o=1;return i&&s?o=0:i?o=3:s&&(o=2),{parallelismType:o}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Ft=188;class Vs{constructor(e,t,r,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=s,this.videoParser=null}static probe(e,t){const r=Vs.syncOffset(e);return r>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const t=e.length;let r=Math.min(Ft*5,t-Ft)+1,s=0;for(;s<r;){let i=!1,o=-1,l=0;for(let u=s;u<t;u+=Ft)if(e[u]===71&&(t-u===Ft||e[u+Ft]===71)){if(l++,o===-1&&(o=u,o!==0&&(r=Math.min(o+Ft*99,e.length-Ft)+1)),i||(i=yg(e,u)===0),i&&l>1&&(o===0&&l>2||u+Ft>r))return o}else{if(l)return-1;break}s++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:i_[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Vs.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=Vs.createTrack("audio",s),this._id3Track=Vs.createTrack("id3"),this._txtTrack=Vs.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,s=!1){r||(this.sampleAes=null);let i;const o=this._videoTrack,l=this._audioTrack,u=this._id3Track,d=this._txtTrack;let f=o.pid,h=o.pesData,m=l.pid,v=u.pid,g=l.pesData,x=u.pesData,E=null,b=this.pmtParsed,I=this._pmtId,A=e.length;if(this.remainderData&&(e=qn(this.remainderData,e),A=e.length,this.remainderData=null),A<Ft&&!s)return this.remainderData=e,{audioTrack:l,videoTrack:o,id3Track:u,textTrack:d};const R=Math.max(0,Vs.syncOffset(e));A-=(A-R)%Ft,A<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,A,e.buffer.byteLength-A));let C=0;for(let k=R;k<A;k+=Ft)if(e[k]===71){const N=!!(e[k+1]&64),M=yg(e,k),O=(e[k+3]&48)>>4;let H;if(O>1){if(H=k+5+e[k+4],H===k+Ft)continue}else H=k+4;switch(M){case f:N&&(h&&(i=So(h,this.logger))&&(this.readyVideoParser(o.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(o,d,i,!1)),h={data:[],size:0}),h&&(h.data.push(e.subarray(H,k+Ft)),h.size+=k+Ft-H);break;case m:if(N){if(g&&(i=So(g,this.logger)))switch(l.segmentCodec){case"aac":this.parseAACPES(l,i);break;case"mp3":this.parseMPEGPES(l,i);break;case"ac3":this.parseAC3PES(l,i);break}g={data:[],size:0}}g&&(g.data.push(e.subarray(H,k+Ft)),g.size+=k+Ft-H);break;case v:N&&(x&&(i=So(x,this.logger))&&this.parseID3PES(u,i),x={data:[],size:0}),x&&(x.data.push(e.subarray(H,k+Ft)),x.size+=k+Ft-H);break;case 0:N&&(H+=e[H]+1),I=this._pmtId=LV(e,H);break;case I:{N&&(H+=e[H]+1);const Z=CV(e,H,this.typeSupported,r,this.observer,this.logger);f=Z.videoPid,f>0&&(o.pid=f,o.segmentCodec=Z.segmentVideoCodec),m=Z.audioPid,m>0&&(l.pid=m,l.segmentCodec=Z.segmentAudioCodec),v=Z.id3Pid,v>0&&(u.pid=v),E!==null&&!b&&(this.logger.warn(`MPEG-TS PMT found at ${k} after unknown PID '${E}'. Backtracking to sync byte @${R} to parse all TS packets.`),E=null,k=R-188),b=this.pmtParsed=!0;break}case 17:case 8191:break;default:E=M;break}}else C++;C>0&&vg(this.observer,new Error(`Found ${C} TS packet/s that do not start with 0x47`),void 0,this.logger),o.pesData=h,l.pesData=g,u.pesData=x;const F={audioTrack:l,videoTrack:o,id3Track:u,textTrack:d};return s&&this.extractRemainingSamples(F),F}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:s,textTrack:i}=e,o=r.pesData,l=t.pesData,u=s.pesData;let d;if(o&&(d=So(o,this.logger))?(this.readyVideoParser(r.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(r,i,d,!0),r.pesData=null)):r.pesData=o,l&&(d=So(l,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,d);break;case"mp3":this.parseMPEGPES(t,d);break;case"ac3":this.parseAC3PES(t,d);break}t.pesData=null}else l!=null&&l.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=l;u&&(d=So(u,this.logger))?(this.parseID3PES(s,d),s.pesData=null):s.pesData=u}demuxSampleAes(e,t,r){const s=this.demux(e,r,!0,!this.config.progressive),i=this.sampleAes=new AV(this.observer,this.config,t);return this.decrypt(s,i)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new _V:e==="hevc"&&(this.videoParser=new RV))}decrypt(e,t){return new Promise(r=>{const{audioTrack:s,videoTrack:i}=e;s.samples&&s.segmentCodec==="aac"?t.decryptAacSamples(s.samples,0,()=>{i.samples?t.decryptAvcSamples(i.samples,0,0,()=>{r(e)}):r(e)}):i.samples&&t.decryptAvcSamples(i.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let r=0;const s=this.aacOverFlow;let i=t.data;if(s){this.aacOverFlow=null;const h=s.missing,m=s.sample.unit.byteLength;if(h===-1)i=qn(s.sample.unit,i);else{const v=m-h;s.sample.unit.set(i.subarray(0,h),v),e.samples.push(s.sample),r=s.missing}}let o,l;for(o=r,l=i.length;o<l-1&&!Md(i,o);o++);if(o!==r){let h;const m=o<l-1;if(m?h=`AAC PES did not start with ADTS header,offset:${o}`:h="No ADTS header found in AAC PES",vg(this.observer,new Error(h),m,this.logger),!m)return}V_(e,this.observer,i,o,this.audioCodec);let u;if(t.pts!==void 0)u=t.pts;else if(s){const h=G_(e.samplerate);u=s.sample.pts+h}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let d=0,f;for(;o<l;)if(f=H_(e,i,o,u,d),o+=f.length,f.missing){this.aacOverFlow=f;break}else for(d++;o<l-1&&!Md(i,o);o++);}parseMPEGPES(e,t){const r=t.data,s=r.length;let i=0,o=0;const l=t.pts;if(l===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<s;)if(q_(r,o)){const u=z_(e,r,o,l,i);if(u)o+=u.length,i++;else break}else o++}parseAC3PES(e,t){{const r=t.data,s=t.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const i=r.length;let o=0,l=0,u;for(;l<i&&(u=J_(e,r,l,s,o++))>0;)l+=u}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=rt({},t,{type:this._videoTrack?Ln.emsg:Ln.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function yg(n,e){return((n[e+1]&31)<<8)+n[e+2]}function LV(n,e){return(n[e+10]&31)<<8|n[e+11]}function CV(n,e,t,r,s,i){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},l=(n[e+1]&15)<<8|n[e+2],u=e+3+l-4,d=(n[e+10]&15)<<8|n[e+11];for(e+=12+d;e<u;){const f=yg(n,e),h=(n[e+3]&15)<<8|n[e+4];switch(n[e]){case 207:if(!r){sm("ADTS AAC",i);break}case 15:o.audioPid===-1&&(o.audioPid=f);break;case 21:o.id3Pid===-1&&(o.id3Pid=f);break;case 219:if(!r){sm("H.264",i);break}case 27:o.videoPid===-1&&(o.videoPid=f);break;case 3:case 4:!t.mpeg&&!t.mp3?i.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=f,o.segmentAudioCodec="mp3");break;case 193:if(!r){sm("AC-3",i);break}case 129:t.ac3?o.audioPid===-1&&(o.audioPid=f,o.segmentAudioCodec="ac3"):i.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&h>0){let m=e+5,v=h;for(;v>2;){switch(n[m]){case 106:t.ac3!==!0?i.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=f,o.segmentAudioCodec="ac3");break}const x=n[m+1]+2;m+=x,v-=x}}break;case 194:case 135:return vg(s,new Error("Unsupported EC-3 in M2TS found"),void 0,i),o;case 36:o.videoPid===-1&&(o.videoPid=f,o.segmentVideoCodec="hevc",i.log("HEVC in M2TS found"));break}e+=h+5}return o}function vg(n,e,t,r){r.warn(`parsing error: ${e.message}`),n.emit(_.ERROR,_.ERROR,{type:we.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function sm(n,e){e.log(`${n} with AES-128-CBC encryption found in unencrypted stream`)}function So(n,e){let t=0,r,s,i,o,l;const u=n.data;if(!n||n.size===0)return null;for(;u[0].length<19&&u.length>1;)u[0]=qn(u[0],u[1]),u.splice(1,1);if(r=u[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(s=(r[4]<<8)+r[5],s&&s>n.size-6)return null;const f=r[7];f&192&&(o=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,f&64?(l=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,o-l>60*9e4&&(e.warn(`${Math.round((o-l)/9e4)}s delta between PTS and DTS, align them`),o=l)):l=o),i=r[8];let h=i+9;if(n.size<=h)return null;n.size-=h;const m=new Uint8Array(n.size);for(let v=0,g=u.length;v<g;v++){r=u[v];let x=r.byteLength;if(h)if(h>x){h-=x;continue}else r=r.subarray(h),x-=h,h=0;m.set(r,t),t+=x}return s&&(s-=i+3),{data:m,pts:o,dts:l,len:s}}return null}class kV{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Fs=Math.pow(2,32)-1;class K{static init(){K.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in K.types)K.types.hasOwnProperty(e)&&(K.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);K.HDLR_TYPES={video:t,audio:r};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);K.STTS=K.STSC=K.STCO=i,K.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),K.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),K.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),K.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);K.FTYP=K.box(K.types.ftyp,o,u,o,l),K.DINF=K.box(K.types.dinf,K.box(K.types.dref,s))}static box(e,...t){let r=8,s=t.length;const i=s;for(;s--;)r+=t[s].byteLength;const o=new Uint8Array(r);for(o[0]=r>>24&255,o[1]=r>>16&255,o[2]=r>>8&255,o[3]=r&255,o.set(e,4),s=0,r=8;s<i;s++)o.set(t[s],r),r+=t[s].byteLength;return o}static hdlr(e){return K.box(K.types.hdlr,K.HDLR_TYPES[e])}static mdat(e){return K.box(K.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(Fs+1)),s=Math.floor(t%(Fs+1));return K.box(K.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(e){return K.box(K.types.mdia,K.mdhd(e.timescale||0,e.duration||0),K.hdlr(e.type),K.minf(e))}static mfhd(e){return K.box(K.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?K.box(K.types.minf,K.box(K.types.smhd,K.SMHD),K.DINF,K.stbl(e)):K.box(K.types.minf,K.box(K.types.vmhd,K.VMHD),K.DINF,K.stbl(e))}static moof(e,t,r){return K.box(K.types.moof,K.mfhd(e),K.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=K.trak(e[t]);return K.box.apply(null,[K.types.moov,K.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(K.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=K.trex(e[t]);return K.box.apply(null,[K.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(Fs+1)),s=Math.floor(t%(Fs+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return K.box(K.types.mvhd,i)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let s,i;for(s=0;s<t.length;s++)i=t[s].flags,r[s+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return K.box(K.types.sdtp,r)}static stbl(e){return K.box(K.types.stbl,K.stsd(e),K.box(K.types.stts,K.STTS),K.box(K.types.stsc,K.STSC),K.box(K.types.stsz,K.STSZ),K.box(K.types.stco,K.STCO))}static avc1(e){let t=[],r=[],s,i,o;for(s=0;s<e.sps.length;s++)i=e.sps[s],o=i.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(i));for(s=0;s<e.pps.length;s++)i=e.pps[s],o=i.byteLength,r.push(o>>>8&255),r.push(o&255),r=r.concat(Array.prototype.slice.call(i));const l=K.box(K.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),u=e.width,d=e.height,f=e.pixelRatio[0],h=e.pixelRatio[1];return K.box(K.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,u&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,K.box(K.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),K.box(K.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,h>>24,h>>16&255,h>>8&255,h&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return K.box(K.types.mp4a,K.audioStsd(e),K.box(K.types.esds,K.esds(e)))}static mp3(e){return K.box(K.types[".mp3"],K.audioStsd(e))}static ac3(e){return K.box(K.types["ac-3"],K.audioStsd(e),K.box(K.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return K.box(K.types.stsd,K.STSD,K.mp4a(e));if(t==="ac3"&&e.config)return K.box(K.types.stsd,K.STSD,K.ac3(e));if(t==="mp3"&&e.codec==="mp3")return K.box(K.types.stsd,K.STSD,K.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return K.box(K.types.stsd,K.STSD,K.avc1(e));if(t==="hevc"&&e.vps)return K.box(K.types.stsd,K.STSD,K.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,r=(e.duration||0)*(e.timescale||0),s=e.width||0,i=e.height||0,o=Math.floor(r/(Fs+1)),l=Math.floor(r%(Fs+1));return K.box(K.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,l>>24,l>>16&255,l>>8&255,l&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,i>>8&255,i&255,0,0]))}static traf(e,t){const r=K.sdtp(e),s=e.id,i=Math.floor(t/(Fs+1)),o=Math.floor(t%(Fs+1));return K.box(K.types.traf,K.box(K.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),K.box(K.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,o>>24,o>>16&255,o>>8&255,o&255])),K.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,K.box(K.types.trak,K.tkhd(e),K.mdia(e))}static trex(e){const t=e.id;return K.box(K.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],s=r.length,i=12+16*s,o=new Uint8Array(i);let l,u,d,f,h,m;for(t+=8+i,o.set([e.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),l=0;l<s;l++)u=r[l],d=u.duration,f=u.size,h=u.flags,m=u.cts,o.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,h.degradPrio&61440,h.degradPrio&15,m>>>24&255,m>>>16&255,m>>>8&255,m&255],12+16*l);return K.box(K.types.trun,o)}static initSegment(e){K.types||K.init();const t=K.moov(e);return qn(K.FTYP,t)}static hvc1(e){const t=e.params,r=[e.vps,e.sps,e.pps],s=4,i=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),s-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),r.length]);let o=i.length;for(let g=0;g<r.length;g+=1){o+=3;for(let x=0;x<r[g].length;x+=1)o+=2+r[g][x].length}const l=new Uint8Array(o);l.set(i,0),o=i.length;const u=r.length-1;for(let g=0;g<r.length;g+=1){l.set(new Uint8Array([32+g|(g===u?128:0),0,r[g].length]),o),o+=3;for(let x=0;x<r[g].length;x+=1)l.set(new Uint8Array([r[g][x].length>>8,r[g][x].length&255]),o),o+=2,l.set(r[g][x],o),o+=r[g][x].length}const d=K.box(K.types.hvcC,l),f=e.width,h=e.height,m=e.pixelRatio[0],v=e.pixelRatio[1];return K.box(K.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,h>>8&255,h&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,K.box(K.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),K.box(K.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,v>>24,v>>16&255,v>>8&255,v&255])))}}K.types=void 0;K.HDLR_TYPES=void 0;K.STTS=void 0;K.STSC=void 0;K.STCO=void 0;K.STSZ=void 0;K.VMHD=void 0;K.SMHD=void 0;K.STSD=void 0;K.FTYP=void 0;K.DINF=void 0;const eR=9e4;function ty(n,e,t=1,r=!1){const s=n*e*t;return r?Math.round(s):s}function PV(n,e,t=1,r=!1){return ty(n,e,1/t,r)}function qa(n,e=!1){return ty(n,1e3,1/eR,e)}function DV(n,e=1){return ty(n,eR,1/e)}function gb(n){const{baseTime:e,timescale:t,trackId:r}=n;return`${e/t} (${e}/${t}) trackId: ${r}`}const NV=10*1e3,OV=1024,MV=1152,FV=1536;let To=null,im=null;function yb(n,e,t,r){return{duration:e,size:t,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:n?2:1,isNonSync:n?0:1}}}class Qu extends Xn{constructor(e,t,r,s){if(super("mp4-remuxer",s),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,To===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);To=o?parseInt(o[1]):0}if(im===null){const i=navigator.userAgent.match(/Safari\/(\d+)/i);im=i?parseInt(i[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;(!t||!e||e.trackId!==t.trackId||e.baseTime!==t.baseTime||e.timescale!==t.timescale)&&this.log(`Reset initPTS: ${t&&gb(t)} > ${e&&gb(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const r=e[0].pts,s=e.reduce((i,o)=>{let l=o.pts,u=l-i;return u<-4294967296&&(t=!0,l=Rn(l,r),u=l-i),u>0?i:l},r);return t&&this.debug("PTS rollover detected"),s}remux(e,t,r,s,i,o,l,u){let d,f,h,m,v,g,x=i,E=i;const b=e.pid>-1,I=t.pid>-1,A=t.samples.length,R=e.samples.length>0,C=l&&A>0||A>1;if((!b||R)&&(!I||C)||this.ISGenerated||l){if(this.ISGenerated){var k,N,M,O;const U=this.videoTrackConfig;(U&&(t.width!==U.width||t.height!==U.height||((k=t.pixelRatio)==null?void 0:k[0])!==((N=U.pixelRatio)==null?void 0:N[0])||((M=t.pixelRatio)==null?void 0:M[1])!==((O=U.pixelRatio)==null?void 0:O[1]))||!U&&C||this.nextAudioTs===null&&R)&&this.resetInitSegment()}this.ISGenerated||(h=this.generateIS(e,t,i,o));const H=this.isVideoContiguous;let Z=-1,se;if(C&&(Z=BV(t.samples),!H&&this.config.forceKeyFrameOnDiscontinuity))if(g=!0,Z>0){this.warn(`Dropped ${Z} out of ${A} video samples due to a missing keyframe`);const U=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(Z),t.dropped+=Z,E+=(t.samples[0].pts-U)/t.inputTimeScale,se=E}else Z===-1&&(this.warn(`No keyframe found out of ${A} video samples`),g=!1);if(this.ISGenerated){if(R&&C){const U=this.getVideoStartPts(t.samples),q=(Rn(e.samples[0].pts,U)-U)/t.inputTimeScale;x+=Math.max(0,q),E+=Math.max(0,-q)}if(R){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),h=this.generateIS(e,t,i,o)),f=this.remuxAudio(e,x,this.isAudioContiguous,o,I||C||u===ge.AUDIO?E:void 0),C){const U=f?f.endPTS-f.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),h=this.generateIS(e,t,i,o)),d=this.remuxVideo(t,E,H,U)}}else C&&(d=this.remuxVideo(t,E,H,0));d&&(d.firstKeyFrame=Z,d.independent=Z!==-1,d.firstKeyFramePTS=se)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(v=tR(r,i,this._initPTS,this._initDTS)),s.samples.length&&(m=nR(s,i,this._initPTS))),{audio:f,video:d,initSegment:h,independent:g,text:m,id3:v}}computeInitPts(e,t,r,s){const i=Math.round(r*t);let o=Rn(e,i);if(o<i+t)for(this.log(`Adjusting PTS for rollover in timeline near ${(i-o)/t} ${s}`);o<i+t;)o+=8589934592;return o-i}generateIS(e,t,r,s){const i=e.samples,o=t.samples,l=this.typeSupported,u={},d=this._initPTS;let f=!d||s,h="audio/mp4",m,v,g,x=-1;if(f&&(m=v=1/0),e.config&&i.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":l.mpeg?(h="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}u.audio={id:"audio",container:h,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&l.mpeg?new Uint8Array(0):K.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(x=e.id,g=e.inputTimeScale,!d||g!==d.timescale?m=v=this.computeInitPts(i[0].pts,g,r,"audio"):f=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,u.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:K.initSegment([t]),metadata:{width:t.width,height:t.height}},f)if(x=t.id,g=t.inputTimeScale,!d||g!==d.timescale){const E=this.getVideoStartPts(o),b=Rn(o[0].dts,E),I=this.computeInitPts(b,g,r,"video"),A=this.computeInitPts(E,g,r,"video");v=Math.min(v,I),m=Math.min(m,A)}else f=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(u).length)return this.ISGenerated=!0,f?(d&&this.warn(`Timestamps at playlist time: ${s?"":"~"}${r} ${m/g} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${r} offset: ${m/g} (${m}/${g}) trackId: ${x}`),this._initPTS={baseTime:m,timescale:g,trackId:x},this._initDTS={baseTime:v,timescale:g,trackId:x}):m=g=void 0,{tracks:u,initPTS:m,timescale:g,trackId:x}}remuxVideo(e,t,r,s){const i=e.inputTimeScale,o=e.samples,l=[],u=o.length,d=this._initPTS,f=d.baseTime*i/d.timescale;let h=this.nextVideoTs,m=8,v=this.videoSampleDuration,g,x,E=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,I=!1;if(!r||h===null){const D=f+t*i,$=o[0].pts-Rn(o[0].dts,o[0].pts);To&&h!==null&&Math.abs(D-$-(h+f))<15e3?r=!0:h=D-$-f}const A=h+f;for(let D=0;D<u;D++){const $=o[D];$.pts=Rn($.pts,A),$.dts=Rn($.dts,A),$.dts<o[D>0?D-1:D].dts&&(I=!0)}I&&o.sort(function(D,$){const ie=D.dts-$.dts,ce=D.pts-$.pts;return ie||ce}),g=o[0].dts,x=o[o.length-1].dts;const R=x-g,C=R?Math.round(R/(u-1)):v||e.inputTimeScale/30;if(r){const D=g-A,$=D>C,ie=D<-1;if(($||ie)&&($?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${qa(D,!0)} ms (${D}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${qa(-D,!0)} ms (${D}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!ie||A>=o[0].pts||To)){g=A;const ce=o[0].pts-D;if($)o[0].dts=g,o[0].pts=ce;else{let ue=!0;for(let fe=0;fe<o.length&&!(o[fe].dts>ce&&ue);fe++){const Se=o[fe].pts;if(o[fe].dts-=D,o[fe].pts-=D,fe<o.length-1){const ye=o[fe+1].pts,Ae=o[fe].pts,Pe=ye<=Ae,De=ye<=Se;ue=Pe==De}}}this.log(`Video: Initial PTS/DTS adjusted: ${qa(ce,!0)}/${qa(g,!0)}, delta: ${qa(D,!0)} ms`)}}g=Math.max(0,g);let F=0,k=0,N=g;for(let D=0;D<u;D++){const $=o[D],ie=$.units,ce=ie.length;let ue=0;for(let fe=0;fe<ce;fe++)ue+=ie[fe].data.length;k+=ue,F+=ce,$.length=ue,$.dts<N?($.dts=N,N+=C/4|0||1):N=$.dts,E=Math.min($.pts,E),b=Math.max($.pts,b)}x=o[u-1].dts;const M=k+4*F+8;let O;try{O=new Uint8Array(M)}catch(D){this.observer.emit(_.ERROR,_.ERROR,{type:we.MUX_ERROR,details:W.REMUX_ALLOC_ERROR,fatal:!1,error:D,bytes:M,reason:`fail allocating video mdat ${M}`});return}const H=new DataView(O.buffer);H.setUint32(0,M),O.set(K.types.mdat,4);let Z=!1,se=Number.POSITIVE_INFINITY,U=Number.POSITIVE_INFINITY,ne=Number.NEGATIVE_INFINITY,q=Number.NEGATIVE_INFINITY;for(let D=0;D<u;D++){const $=o[D],ie=$.units;let ce=0;for(let Se=0,ye=ie.length;Se<ye;Se++){const Ae=ie[Se],Pe=Ae.data,De=Ae.data.byteLength;H.setUint32(m,De),m+=4,O.set(Pe,m),m+=De,ce+=4+De}let ue;if(D<u-1)v=o[D+1].dts-$.dts,ue=o[D+1].pts-$.pts;else{const Se=this.config,ye=D>0?$.dts-o[D-1].dts:C;if(ue=D>0?$.pts-o[D-1].pts:C,Se.stretchShortVideoTrack&&this.nextAudioTs!==null){const Ae=Math.floor(Se.maxBufferHole*i),Pe=(s?E+s*i:this.nextAudioTs+f)-$.pts;Pe>Ae?(v=Pe-ye,v<0?v=ye:Z=!0,this.log(`It is approximately ${Pe/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=ye}else v=ye}const fe=Math.round($.pts-$.dts);se=Math.min(se,v),ne=Math.max(ne,v),U=Math.min(U,ue),q=Math.max(q,ue),l.push(yb($.key,v,ce,fe))}if(l.length){if(To){if(To<70){const D=l[0].flags;D.dependsOn=2,D.isNonSync=0}}else if(im&&q-U<ne-se&&C/ne<.025&&l[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let D=g;for(let $=0,ie=l.length;$<ie;$++){const ce=D+l[$].duration,ue=D+l[$].cts;if($<ie-1){const fe=ce+l[$+1].cts;l[$].duration=fe-ue}else l[$].duration=$?l[$-1].duration:C;l[$].cts=0,D=ce}}}v=Z||!v?C:v;const te=x+v;this.nextVideoTs=h=te-f,this.videoSampleDuration=v,this.isVideoContiguous=!0;const ee={data1:K.moof(e.sequenceNumber++,g,rt(e,{samples:l})),data2:O,startPTS:(E-f)/i,endPTS:(b+v-f)/i,startDTS:(g-f)/i,endDTS:h/i,type:"video",hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ee}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return MV;case"ac3":return FV;default:return OV}}remuxAudio(e,t,r,s,i){const o=e.inputTimeScale,l=e.samplerate?e.samplerate:o,u=o/l,d=this.getSamplesPerFrame(e),f=d*u,h=this._initPTS,m=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,v=[],g=i!==void 0;let x=e.samples,E=m?0:8,b=this.nextAudioTs||-1;const I=h.baseTime*o/h.timescale,A=I+t*o;if(this.isAudioContiguous=r=r||x.length&&b>0&&(s&&Math.abs(A-(b+I))<9e3||Math.abs(Rn(x[0].pts,A)-(b+I))<20*f),x.forEach(function(q){q.pts=Rn(q.pts,A)}),!r||b<0){const q=x.length;if(x=x.filter(te=>te.pts>=0),q!==x.length&&this.warn(`Removed ${x.length-q} of ${q} samples (initPTS ${I} / ${o})`),!x.length)return;i===0?b=0:s&&!g?b=Math.max(0,A-I):b=x[0].pts-I}if(e.segmentCodec==="aac"){const q=this.config.maxAudioFramesDrift;for(let te=0,G=b+I;te<x.length;te++){const Q=x[te],ee=Q.pts,D=ee-G,$=Math.abs(1e3*D/o);if(D<=-q*f&&g)te===0&&(this.warn(`Audio frame @ ${(ee/o).toFixed(3)}s overlaps marker by ${Math.round(1e3*D/o)} ms.`),this.nextAudioTs=b=ee-I,G=ee);else if(D>=q*f&&$<NV&&g){let ie=Math.round(D/f);for(G=ee-ie*f;G<0&&ie&&f;)ie--,G+=f;te===0&&(this.nextAudioTs=b=G-I),this.warn(`Injecting ${ie} audio frames @ ${((G-I)/o).toFixed(3)}s due to ${Math.round(1e3*D/o)} ms gap.`);for(let ce=0;ce<ie;ce++){let ue=kV.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);ue||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),ue=Q.unit.subarray()),x.splice(te,0,{unit:ue,pts:G}),G+=f,te++}}Q.pts=G,G+=f}}let R=null,C=null,F,k=0,N=x.length;for(;N--;)k+=x[N].unit.byteLength;for(let q=0,te=x.length;q<te;q++){const G=x[q],Q=G.unit;let ee=G.pts;if(C!==null){const $=v[q-1];$.duration=Math.round((ee-C)/u)}else if(r&&e.segmentCodec==="aac"&&(ee=b+I),R=ee,k>0){k+=E;try{F=new Uint8Array(k)}catch($){this.observer.emit(_.ERROR,_.ERROR,{type:we.MUX_ERROR,details:W.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:k,reason:`fail allocating audio mdat ${k}`});return}m||(new DataView(F.buffer).setUint32(0,k),F.set(K.types.mdat,4))}else return;F.set(Q,E);const D=Q.byteLength;E+=D,v.push(yb(!0,d,D,0)),C=ee}const M=v.length;if(!M)return;const O=v[v.length-1];b=C-I,this.nextAudioTs=b+u*O.duration;const H=m?new Uint8Array(0):K.moof(e.sequenceNumber++,R/u,rt({},e,{samples:v}));e.samples=[];const Z=(R-I)/o,se=this.nextAudioTs/o,ne={data1:H,data2:F,startPTS:Z,endPTS:se,startDTS:Z,endDTS:se,type:"audio",hasAudio:!0,hasVideo:!1,nb:M};return this.isAudioContiguous=!0,ne}}function Rn(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function BV(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function tR(n,e,t,r){const s=n.samples.length;if(!s)return;const i=n.inputTimeScale;for(let l=0;l<s;l++){const u=n.samples[l];u.pts=Rn(u.pts-t.baseTime*i/t.timescale,e*i)/i,u.dts=Rn(u.dts-r.baseTime*i/r.timescale,e*i)/i}const o=n.samples;return n.samples=[],{samples:o}}function nR(n,e,t){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let o=0;o<r;o++){const l=n.samples[o];l.pts=Rn(l.pts-t.baseTime*s/t.timescale,e*s)/s}n.samples.sort((o,l)=>o.pts-l.pts);const i=n.samples;return n.samples=[],{samples:i}}class UV extends Xn{constructor(e,t,r,s){super("passthrough-remuxer",s),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,r,s){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(e,s),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:r,videoCodec:s}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:i,video:o}=this.initData=l_(e);if(t)A6(e,t);else{const u=i||o;u!=null&&u.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${u.codec}")!`)}i&&(r=vb(i,it.AUDIO,this)),o&&(s=vb(o,it.VIDEO,this));const l={};i&&o?l.audiovideo={container:"video/mp4",codec:r+","+s,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:i?l.audio={container:"audio/mp4",codec:r,encrypted:i.encrypted,initSegment:e,id:"audio"}:o?l.video={container:"video/mp4",codec:s,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=l}remux(e,t,r,s,i,o){var l,u;let{initPTS:d,lastEndTime:f}=this;const h={audio:void 0,video:void 0,text:s,id3:r,initSegment:void 0};he(f)||(f=this.lastEndTime=i||0);const m=t.samples;if(!m.length)return h;const v={initPTS:void 0,timescale:void 0,trackId:void 0};let g=this.initData;if((l=g)!=null&&l.length||(this.generateInitSegment(m),g=this.initData),!((u=g)!=null&&u.length))return this.warn("Failed to generate initSegment."),h;this.emitInitSegment&&(v.tracks=this.initTracks,this.emitInitSegment=!1);const x=R6(m,g,this),E=g.audio?x[g.audio.id]:null,b=g.video?x[g.video.id]:null,I=Iu(b,1/0),A=Iu(E,1/0),R=Iu(b,0,!0),C=Iu(E,0,!0);let F=i,k=0;const N=E&&(!b||!d&&A<I||d&&d.trackId===g.audio.id),M=N?E:b;if(M){const G=M.timescale,Q=M.start-i*G,ee=N?g.audio.id:g.video.id;F=M.start/G,k=N?C-A:R-I,(o||!d)&&($V(d,F,i,k)||G!==d.timescale)&&(d&&this.warn(`Timestamps at playlist time: ${o?"":"~"}${i} ${Q/G} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${F-i} (${Q}/${G}) trackId: ${ee}`),d=null,v.initPTS=Q,v.timescale=G,v.trackId=ee)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${i}`);d?(v.initPTS=d.baseTime,v.timescale=d.timescale,v.trackId=d.trackId):((!v.timescale||v.trackId===void 0||v.initPTS===void 0)&&(this.warn("Could not set initPTS"),v.initPTS=F,v.timescale=1,v.trackId=-1),this.initPTS=d={baseTime:v.initPTS,timescale:v.timescale,trackId:v.trackId});const O=F-d.baseTime/d.timescale,H=O+k;k>0?this.lastEndTime=H:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const Z=!!g.audio,se=!!g.video;let U="";Z&&(U+="audio"),se&&(U+="video");const ne=(g.audio?g.audio.encrypted:!1)||(g.video?g.video.encrypted:!1),q={data1:m,startPTS:O,startDTS:O,endPTS:H,endDTS:H,type:U,hasAudio:Z,hasVideo:se,nb:1,dropped:0,encrypted:ne};h.audio=Z&&!se?q:void 0,h.video=se?q:void 0;const te=b?.sampleCount;if(te){const G=b.keyFrameIndex,Q=G!==-1;q.nb=te,q.dropped=G===0||this.isVideoContiguous?0:Q?G:te,q.independent=Q,q.firstKeyFrame=G,Q&&b.keyFrameStart&&(q.firstKeyFramePTS=(b.keyFrameStart-d.baseTime)/d.timescale),this.isVideoContiguous||(h.independent=Q),this.isVideoContiguous||(this.isVideoContiguous=Q),q.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${G}/${te} dropped: ${q.dropped} start: ${q.firstKeyFramePTS||"NA"}`)}return h.initSegment=v,h.id3=tR(r,i,d,d),s.samples.length&&(h.text=nR(s,i,d)),h}}function Iu(n,e,t=!1){return n?.start!==void 0?(n.start+(t?n.duration:0))/n.timescale:e}function $V(n,e,t,r){if(n===null)return!0;const s=Math.max(r,1),i=e-n.baseTime/n.timescale;return Math.abs(i-t)>s}function vb(n,e,t){const r=n.codec;return r&&r.length>4?r:e===it.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?Rd(r,!1):(t.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(t.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}let Qr;try{Qr=self.performance.now.bind(self.performance)}catch{Qr=Date.now}const Ju=[{demux:IV,remux:UV},{demux:Vs,remux:Qu},{demux:SV,remux:Qu},{demux:bV,remux:Qu}];Ju.splice(2,0,{demux:TV,remux:Qu});class xb{constructor(e,t,r,s,i,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=i,this.logger=o}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,s){const i=r.transmuxing;i.executeStart=Qr();let o=new Uint8Array(e);const{currentTransmuxState:l,transmuxConfig:u}=this;s&&(this.currentTransmuxState=s);const{contiguous:d,discontinuity:f,trackSwitch:h,accurateTimeOffset:m,timeOffset:v,initSegmentChange:g}=s||l,{audioCodec:x,videoCodec:E,defaultInitPts:b,duration:I,initSegmentData:A}=u,R=jV(o,t);if(R&&No(R.method)){const N=this.getDecrypter(),M=W0(R.method);if(N.isSync()){let O=N.softwareDecrypt(o,R.key.buffer,R.iv.buffer,M);if(r.part>-1){const Z=N.flush();O=Z&&Z.buffer}if(!O)return i.executeEnd=Qr(),om(r);o=new Uint8Array(O)}else return this.asyncResult=!0,this.decryptionPromise=N.webCryptoDecrypt(o,R.key.buffer,R.iv.buffer,M).then(O=>{const H=this.push(O,null,r);return this.decryptionPromise=null,H}),this.decryptionPromise}const C=this.needsProbing(f,h);if(C){const N=this.configureTransmuxer(o);if(N)return this.logger.warn(`[transmuxer] ${N.message}`),this.observer.emit(_.ERROR,_.ERROR,{type:we.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!1,error:N,reason:N.message}),i.executeEnd=Qr(),om(r)}(f||h||g||C)&&this.resetInitSegment(A,x,E,I,t),(f||g||C)&&this.resetInitialTimestamp(b),d||this.resetContiguity();const F=this.transmux(o,R,v,m,r);this.asyncResult=Rl(F);const k=this.currentTransmuxState;return k.contiguous=!0,k.discontinuity=!1,k.trackSwitch=!1,i.executeEnd=Qr(),F}flush(e){const t=e.transmuxing;t.executeStart=Qr();const{decrypter:r,currentTransmuxState:s,decryptionPromise:i}=this;if(i)return this.asyncResult=!0,i.then(()=>this.flush(e));const o=[],{timeOffset:l}=s;if(r){const h=r.flush();h&&o.push(this.push(h.buffer,null,e))}const{demuxer:u,remuxer:d}=this;if(!u||!d){t.executeEnd=Qr();const h=[om(e)];return this.asyncResult?Promise.resolve(h):h}const f=u.flush(l);return Rl(f)?(this.asyncResult=!0,f.then(h=>(this.flushRemux(o,h,e),o))):(this.flushRemux(o,f,e),this.asyncResult?Promise.resolve(o):o)}flushRemux(e,t,r){const{audioTrack:s,videoTrack:i,id3Track:o,textTrack:l}=t,{accurateTimeOffset:u,timeOffset:d}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===ge.MAIN?"level":"track"} ${r.level}`);const f=this.remuxer.remux(s,i,o,l,d,u,!0,this.id);e.push({remuxResult:f,chunkMeta:r}),r.transmuxing.executeEnd=Qr()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,s,i){const{demuxer:o,remuxer:l}=this;!o||!l||(o.resetInitSegment(e,t,r,s),l.resetInitSegment(e,t,r,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,s,i){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,r,s,i):o=this.transmuxUnencrypted(e,r,s,i),o}transmuxUnencrypted(e,t,r,s){const{audioTrack:i,videoTrack:o,id3Track:l,textTrack:u}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(i,o,l,u,t,r,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,t,r,s,i){return this.demuxer.demuxSampleAes(e,t,r).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,r,s,!1,this.id),chunkMeta:i}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:s}=this;let i;for(let h=0,m=Ju.length;h<m;h++){var o;if((o=Ju[h].demux)!=null&&o.probe(e,this.logger)){i=Ju[h];break}}if(!i)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,u=this.remuxer,d=i.remux,f=i.demux;(!u||!(u instanceof d))&&(this.remuxer=new d(r,t,s,this.logger)),(!l||!(l instanceof f))&&(this.demuxer=new f(r,t,s,this.logger),this.probe=f.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new H0(this.config)),e}}function jV(n,e){let t=null;return n.byteLength>0&&e?.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const om=n=>({remuxResult:{},chunkMeta:n});function Rl(n){return"then"in n&&n.then instanceof Function}class VV{constructor(e,t,r,s,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=s,this.defaultInitPts=i||null}}class GV{constructor(e,t,r,s,i,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=s,this.timeOffset=i,this.initSegmentChange=o}}let Eb=0;class rR{constructor(e,t,r,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Eb++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=u=>{const d=u.data,f=this.hls;if(!(!f||!(d!=null&&d.event)||d.instanceNo!==this.instanceNo))switch(d.event){case"init":{var h;const m=(h=this.workerContext)==null?void 0:h.objectURL;m&&self.URL.revokeObjectURL(m);break}case"transmuxComplete":{this.handleTransmuxComplete(d.data);break}case"flush":{this.onFlush(d.data);break}case"workerLog":{f.logger[d.data.logType]&&f.logger[d.data.logType](d.data.message);break}default:{d.data=d.data||{},d.data.frag=this.frag,d.data.part=this.part,d.data.id=this.id,f.trigger(d.event,d.data);break}}},this.onWorkerError=u=>{if(!this.hls)return;const d=new Error(`${u.message}  (${u.filename}:${u.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(_.ERROR,{type:we.OTHER_ERROR,details:W.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:d})};const i=e.config;this.hls=e,this.id=t,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=r,this.onFlush=s;const o=(u,d)=>{d=d||{},d.frag=this.frag||void 0,u===_.ERROR&&(d=d,d.parent=this.id,d.part=this.part,this.error=d.error),this.hls.trigger(u,d)};this.observer=new q0,this.observer.on(_.FRAG_DECRYPTED,o),this.observer.on(_.ERROR,o);const l=OT(i.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const u=this.hls.logger;if(i.workerPath||z8()){try{i.workerPath?(u.log(`loading Web Worker ${i.workerPath} for "${t}"`),this.workerContext=q8(i.workerPath)):(u.log(`injecting Web Worker for "${t}"`),this.workerContext=Y8());const{worker:f}=this.workerContext;f.addEventListener("message",this.onWorkerMessage),f.addEventListener("error",this.onWorkerError),f.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:t,config:ot(i)})}catch(f){u.warn(`Error setting up "${t}" Web Worker, fallback to inline`,f),this.terminateWorker(),this.error=null,this.transmuxer=new xb(this.observer,l,i,"",t,e.logger)}return}}this.transmuxer=new xb(this.observer,l,i,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=Eb++;const t=this.hls.config,r=OT(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:ot(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),X8(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,r,s,i,o,l,u,d,f){var h,m;d.transmuxing.start=self.performance.now();const{instanceNo:v,transmuxer:g}=this,x=o?o.start:i.start,E=i.decryptdata,b=this.frag,I=!(b&&i.cc===b.cc),A=!(b&&d.level===b.level),R=b?d.sn-b.sn:-1,C=this.part?d.part-this.part.index:-1,F=R===0&&d.id>1&&d.id===b?.stats.chunkCount,k=!A&&(R===1||R===0&&(C===1||F&&C<=0)),N=self.performance.now();(A||R||i.stats.parsing.start===0)&&(i.stats.parsing.start=N),o&&(C||!k)&&(o.stats.parsing.start=N);const M=!(b&&((h=i.initSegment)==null?void 0:h.url)===((m=b.initSegment)==null?void 0:m.url)),O=new GV(I,k,u,A,x,M);if(!k||I||M){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${i.type} sn: ${d.sn}${d.part>-1?" part: "+d.part:""} ${this.id===ge.MAIN?"level":"track"}: ${d.level} id: ${d.id}
        discontinuity: ${I}
        trackSwitch: ${A}
        contiguous: ${k}
        accurateTimeOffset: ${u}
        timeOffset: ${x}
        initSegmentChange: ${M}`);const H=new VV(r,s,t,l,f);this.configureTransmuxer(H)}if(this.frag=i,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:v,cmd:"demux",data:e,decryptdata:E,chunkMeta:d,state:O},e instanceof ArrayBuffer?[e]:[]);else if(g){const H=g.push(e,E,d,O);Rl(H)?H.then(Z=>{this.handleTransmuxComplete(Z)}).catch(Z=>{this.transmuxerError(Z,d,"transmuxer-interface push error")}):this.handleTransmuxComplete(H)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(r){const s=r.flush(e);Rl(s)?s.then(i=>{this.handleFlushResult(i,e)}).catch(i=>{this.transmuxerError(i,e,"transmuxer-interface flush error")}):this.handleFlushResult(s,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const Sb=100;class HV extends Y0{constructor(e,t,r){super(e,t,r,"audio-stream-controller",ge.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(_.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(_.BUFFER_RESET,this.onBufferReset,this),e.on(_.BUFFER_CREATED,this.onBufferCreated,this),e.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(_.FRAG_LOADING,this.onFragLoading,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(_.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(_.BUFFER_RESET,this.onBufferReset,this),e.off(_.BUFFER_CREATED,this.onBufferCreated,this),e.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(_.FRAG_LOADING,this.onFragLoading,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:i,trackId:o}){if(r===ge.MAIN){const l=t.cc,u=this.fragCurrent;if(this.initPTS[l]={baseTime:s,timescale:i,trackId:o},this.log(`InitPTS for cc: ${l} found from main: ${s/i} (${s}/${i}) trackId: ${o}`),this.mainAnchor=t,this.state===re.WAITING_INIT_PTS){const d=this.waitingData;(!d&&!this.loadingParts||d&&d.frag.cc!==l)&&this.syncWithAnchor(t,d?.frag)}else!this.hls.hasEnoughToStart&&u&&u.cc!==l?(u.abortRequests(),this.syncWithAnchor(t,u)):this.state===re.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var r;const s=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(t&&s?.cc===t.cc)return;const i=(s||e).cc,o=this.getLevelDetails(),l=this.getLoadPosition(),u=x_(o,i,l);u&&(this.log(`Syncing with main frag at ${u.start} cc ${u.cc}`),this.startFragRequested=!1,this.nextLoadPosition=u.start,this.resetLoadingState(),this.state===re.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=re.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(Sb),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=re.IDLE):this.state=re.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case re.IDLE:this.doTickIdle();break;case re.WAITING_TRACK:{const{levels:e,trackId:t}=this,r=e?.[t],s=r?.details;if(s&&!this.waitForLive(r)){if(this.waitForCdnTuneIn(s))break;this.state=re.WAITING_INIT_PTS}break}case re.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case re.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:r,cache:s,complete:i}=e,o=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=re.FRAG_LOADING;const l=s.flush().buffer,u={frag:t,part:r,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),i&&super._handleFragmentLoadComplete(u)}else o&&o.cc!==e.frag.cc&&this.syncWithAnchor(o,e.frag)}else this.state=re.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:r,media:s,trackId:i}=this,o=t.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!o.startFragPrefetch)||!(r!=null&&r[i]))return;const l=r[i],u=l.details;if(!u||this.waitForLive(l)||this.waitForCdnTuneIn(u)){this.state=re.WAITING_TRACK,this.startFragRequested=!1;return}const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,it.AUDIO,ge.AUDIO));const f=this.getFwdBufferInfo(d,ge.AUDIO);if(f===null)return;if(!this.switchingTrack&&this._streamEnded(f,u)){t.trigger(_.BUFFER_EOS,{type:"audio"}),this.state=re.ENDED;return}const h=f.len,m=t.maxBufferLength,v=u.fragments,g=v[0].start,x=this.getLoadPosition(),E=this.flushing?x:f.end;if(this.switchingTrack&&s){const A=x;u.PTSKnown&&A<g&&(f.end>g||f.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=g+.05)}if(h>=m&&!this.switchingTrack&&E<v[v.length-1].start)return;let b=this.getNextFragment(E,u);if(b&&this.isLoopLoading(b,E)&&(b=this.getNextFragmentLoopLoading(b,u,f,ge.MAIN,m)),!b){this.bufferFlushed=!0;return}let I=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&I&&wt(b)&&!b.endList&&(!u.live||!this.loadingParts&&E<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(I)===Pt.OK&&(this.mainFragLoading=I=null),I&&wt(I))){if(b.start>I.end){const R=this.fragmentTracker.getFragAtPos(E,ge.MAIN);R&&R.end>I.end&&(I=R,this.mainFragLoading={frag:R,targetBufferTime:null})}if(b.start>I.end)return}this.loadFragment(b,l,E)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new Il(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==re.STOPPED&&(this.setInterval(Sb),this.state=re.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(_.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,t){var r;const{levels:s}=this,{details:i,id:o,groupId:l,track:u}=t;if(!s){this.warn(`Audio tracks reset while loading track ${o} "${u.name}" of "${l}"`);return}const d=this.mainDetails;if(!d||i.endCC>d.endCC||d.expired){this.cachedTrackLoadedData=t,this.state!==re.STOPPED&&(this.state=re.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${o} "${u.name}" of "${l}" loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""},duration:${i.totalduration}`);const f=s[o];let h=0;if(i.live||(r=f.details)!=null&&r.live){if(this.checkLiveUpdate(i),i.deltaUpdateFailed)return;if(f.details){var m;h=this.alignPlaylists(i,f.details,(m=this.levelLastLoaded)==null?void 0:m.details)}i.alignedSliding||(F_(i,d),i.alignedSliding||Od(i,d),h=i.fragmentStart)}f.details=i,this.levelLastLoaded=f,this.startFragRequested||this.setStartPosition(d,h),this.hls.trigger(_.AUDIO_TRACK_UPDATED,{details:i,id:o,groupId:t.groupId}),this.state===re.WAITING_TRACK&&!this.waitForCdnTuneIn(i)&&(this.state=re.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:s,payload:i}=e,{config:o,trackId:l,levels:u}=this;if(!u){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const d=u[l];if(!d){this.warn("Audio track is undefined on fragment load progress");return}const f=d.details;if(!f){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const h=o.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let m=this.transmuxer;m||(m=this.transmuxer=new rR(this.hls,ge.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const v=this.initPTS[r.cc],g=(t=r.initSegment)==null?void 0:t.data;if(v!==void 0){const E=s?s.index:-1,b=E!==-1,I=new K0(r.level,r.sn,r.stats.chunkCount,i.byteLength,E,b);m.push(i,g,h,"",r,s,f.totalduration,!1,I,v)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${f.startSN} ,${f.endSN}],track ${l}`);const{cache:x}=this.waitingData=this.waitingData||{frag:r,part:s,cache:new B_,complete:!1};x.push(new Uint8Array(i)),this.state!==re.STOPPED&&(this.state=re.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===ge.MAIN&&wt(t.frag)&&(this.mainFragLoading=t,this.state===re.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:r,part:s}=t;if(r.type!==ge.AUDIO){!this.audioOnly&&r.type===ge.MAIN&&!r.elementaryStreams.video&&!r.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(wt(r)){this.fragPrevious=r;const i=this.switchingTrack;i&&(this.bufferedTrack=i,this.switchingTrack=null,this.hls.trigger(_.AUDIO_TRACK_SWITCHED,et({},i)))}this.fragBufferedComplete(r,s),this.media&&this.tick()}onError(e,t){var r;if(t.fatal){this.state=re.ERROR;return}switch(t.details){case W.FRAG_GAP:case W.FRAG_PARSING_ERROR:case W.FRAG_DECRYPT_ERROR:case W.FRAG_LOAD_ERROR:case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_ERROR:case W.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ge.AUDIO,t);break;case W.AUDIO_TRACK_LOAD_ERROR:case W.AUDIO_TRACK_LOAD_TIMEOUT:case W.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===re.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===He.AUDIO_TRACK&&(this.state=re.IDLE);break;case W.BUFFER_ADD_CODEC_ERROR:case W.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case W.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case W.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==it.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==it.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===re.ENDED&&(this.state=re.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,ge.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const r="audio",{hls:s}=this,{remuxResult:i,chunkMeta:o}=e,l=this.getCurrentContext(o);if(!l){this.resetWhenMissingContext(o);return}const{frag:u,part:d,level:f}=l,{details:h}=f,{audio:m,text:v,id3:g,initSegment:x}=i;if(this.fragContextChanged(u)||!h){this.fragmentTracker.removeFragment(u);return}if(this.state=re.PARSING,this.switchingTrack&&m&&this.completeAudioSwitch(this.switchingTrack),x!=null&&x.tracks){const E=u.initSegment||u;if(this.unhandledEncryptionError(x,u))return;this._bufferInitSegment(f,x.tracks,E,o),s.trigger(_.FRAG_PARSING_INIT_SEGMENT,{frag:E,id:r,tracks:x.tracks})}if(m){const{startPTS:E,endPTS:b,startDTS:I,endDTS:A}=m;d&&(d.elementaryStreams[it.AUDIO]={startPTS:E,endPTS:b,startDTS:I,endDTS:A}),u.setElementaryStreamInfo(it.AUDIO,E,b,I,A),this.bufferFragmentData(m,u,d,o)}if(g!=null&&(t=g.samples)!=null&&t.length){const E=rt({id:r,frag:u,details:h},g);s.trigger(_.FRAG_PARSING_METADATA,E)}if(v){const E=rt({id:r,frag:u,details:h},v);s.trigger(_.FRAG_PARSING_USERDATA,E)}}_bufferInitSegment(e,t,r,s){if(this.state!==re.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const i=t.audio;i.id=ge.AUDIO;const o=e.audioCodec;this.log(`Init audio buffer, container:${i.container}, codecs[level/parsed]=[${o}/${i.codec}]`),o&&o.split(",").length===1&&(i.levelCodec=o),this.hls.trigger(_.BUFFER_CODECS,t);const l=i.initSegment;if(l!=null&&l.byteLength){const u={type:"audio",frag:r,part:null,chunkMeta:s,parent:r.type,data:l};this.hls.trigger(_.BUFFER_APPENDING,u)}this.tickImmediate()}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);if(this.switchingTrack||s===Pt.NOT_LOADED||s===Pt.PARTIAL){var i;if(!wt(e))this._loadInitSegment(e,t);else if((i=t.details)!=null&&i.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=re.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragmentStart!==t.details.fragmentStart&&Od(t.details,o)}else super.loadFragment(e,t,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:r,assocLang:s,characteristics:i,audioCodec:o,channels:l}=this.bufferedTrack;Di({name:t,lang:r,assocLang:s,characteristics:i,audioCodec:o,channels:l},e,Ii)||(Cd(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(_.AUDIO_TRACK_SWITCHED,et({},e))}}class ny extends Xn{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){const s=t?.renditionReports;if(s){let i=-1;for(let o=0;o<s.length;o++){const l=s[o];let u;try{u=new self.URL(l.URI,t.url).href}catch(d){this.warn(`Could not construct new URL for Rendition Report: ${d}`),u=l.URI||""}if(u===e){i=o;break}else u===e.substring(0,u.length)&&(i=o)}if(i!==-1){const o=s[i],l=parseInt(o["LAST-MSN"])||t.lastPartSn;let u=parseInt(o["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const f=Math.min(t.age-t.partTarget,t.targetduration);u>=0&&f>t.partTarget&&(u+=1)}const d=r&&MT(r);return new FT(l,u>=0?u:void 0,d)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,t,r){const{details:s,stats:i}=t,o=self.performance.now(),l=i.loading.first?Math.max(0,o-i.loading.first):0;s.advancedDateTime=Date.now()-l;const u=this.hls.config.timelineOffset;if(u!==s.appliedTimelineOffset){const f=Math.max(u||0,0);s.appliedTimelineOffset=f,s.fragments.forEach(h=>{h.setStart(h.playlistOffset+f)})}if(s.live||r!=null&&r.live){const f="levelInfo"in t?t.levelInfo:t.track;if(s.reloaded(r),r&&s.fragments.length>0){M8(r,s,this);const I=s.playlistParsingError;if(I){this.warn(I);const A=this.hls;if(!A.config.ignorePlaylistParsingErrors){var d;const{networkDetails:R}=t;A.trigger(_.ERROR,{type:we.NETWORK_ERROR,details:W.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:I,reason:I.message,level:t.level||void 0,parent:(d=s.fragments[0])==null?void 0:d.type,networkDetails:R,stats:i});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=i.loading.start);const h=this.hls.mainForwardBufferInfo,m=h?h.end-h.len:0,v=(s.edge-m)*1e3,g=P_(s,v);if(s.requestScheduled+g<o?s.requestScheduled=o:s.requestScheduled+=g,this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let x,E,b;if(s.canBlockReload&&s.endSN&&s.advanced){const I=this.hls.config.lowLatencyMode,A=s.lastPartSn,R=s.endSN,C=s.lastPartIndex,F=C!==-1,k=A===R;F?k?(E=R+1,b=I?0:C):(E=A,b=I?C+1:s.maxPartIndex):E=R+1;const N=s.age,M=N+s.ageHeader;let O=Math.min(M-s.partTarget,s.targetduration*1.5);if(O>0){if(M>s.targetduration*3)this.log(`Playlist last advanced ${N.toFixed(2)}s ago. Omitting segment and part directives.`),E=void 0,b=void 0;else if(r!=null&&r.tuneInGoal&&M-s.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${O} with playlist age: ${s.age}`),O=0;else{const H=Math.floor(O/s.targetduration);if(E+=H,b!==void 0){const Z=Math.round(O%s.targetduration/s.partTarget);b+=Z}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${N.toFixed(2)}s goal: ${O} skip sn ${H} to part ${b}`)}s.tuneInGoal=O}if(x=this.getDeliveryDirectives(s,t.deliveryDirectives,E,b),I||!k){s.requestScheduled=o,this.loadingPlaylist(f,x);return}}else(s.canBlockReload||s.canSkipUntil)&&(x=this.getDeliveryDirectives(s,t.deliveryDirectives,E,b));x&&E!==void 0&&s.canBlockReload&&(s.requestScheduled=i.loading.first+Math.max(g-l*2,g/2)),this.scheduleLoading(f,x,s)}else this.clearTimer()}scheduleLoading(e,t,r){const s=r||e.details;if(!s){this.loadingPlaylist(e,t);return}const i=self.performance.now(),o=s.requestScheduled;if(i>=o){this.loadingPlaylist(e,t);return}const l=o-i;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(l)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),l)}getDeliveryDirectives(e,t,r,s){let i=MT(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,s=t.part,i=qu.No),new FT(r,s,i)}checkRetry(e){const t=e.details,r=kd(e),s=e.errorAction,{action:i,retryCount:o=0,retryConfig:l}=s||{},u=!!s&&!!l&&(i===jt.RetryRequest||!s.resolved&&i===jt.SendAlternateToPenaltyBox);if(u){var d;if(o>=l.maxNumRetry)return!1;if(r&&(d=e.context)!=null&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${l.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const f=G0(l,o);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),f),this.warn(`Retrying playlist loading ${o+1}/${l.maxNumRetry} after "${t}" in ${f}ms`)}e.levelRetry=!0,s.resolved=!0}return u}}function sR(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!Ll(n[t].attrs,e[t].attrs))return!1;return!0}function Ll(n,e,t){const r=n["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>n[s]!==e[s])}function xg(n,e){return e.label.toLowerCase()===n.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(n.lang||"").toLowerCase())}class KV extends ny{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.LEVEL_LOADING,this.onLevelLoading,this),e.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.LEVEL_LOADING,this.onLevelLoading,this),e.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(_.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:s,details:i}=t,o=this.tracksInGroup[r];if(!o||o.groupId!==s){this.warn(`Audio track with id:${r} and group:${s} not found in active group ${o?.groupId}`);return}const l=o.details;o.details=t.details,this.log(`Audio track ${r} "${o.name}" lang:${o.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.audioGroups||null,s=this.groupIds;let i=this.currentTrack;if(!r||s?.length!==r?.length||r!=null&&r.some(l=>s?.indexOf(l)===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(m=>!r||r.indexOf(m.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(m=>m.default)&&(this.selectDefaultTrack=!1),l.forEach((m,v)=>{m.id=v});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const u=this.hls.config.audioPreference;if(!i&&u){const m=Rr(u,l,Ii);if(m>-1)i=l[m];else{const v=Rr(u,this.tracks);i=this.tracks[v]}}let d=this.findTrackId(i);d===-1&&i&&(d=this.findTrackId(null));const f={audioTracks:l};this.log(`Updating audio tracks, ${l.length} track(s) found in group(s): ${r?.join(",")}`),this.hls.trigger(_.AUDIO_TRACKS_UPDATED,f);const h=this.trackId;if(d!==-1&&h===-1)this.setAudioTrack(d);else if(l.length&&h===-1){var o;const m=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${l.length}`);this.warn(m.message),this.hls.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:m})}}}onError(e,t){t.fatal||!t.context||t.context.type===He.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const s=this.currentTrack;if(s&&Di(e,s,Ii))return s;const i=Rr(e,this.tracksInGroup,Ii);if(i>-1){const o=this.tracksInGroup[i];return this.setAudioTrack(i),o}else if(s){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const l=r8(e,t.levels,r,o,Ii);if(l===-1)return null;t.nextLoadLevel=l}if(e.channels||e.audioCodec){const o=Rr(e,r);if(o>-1)return r[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,s=t[e],i=s.details&&!s.details.live;if(e===this.trackId&&s===r&&i||(this.log(`Switching to audio-track ${e} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=e,this.currentTrack=s,this.hls.trigger(_.AUDIO_TRACK_SWITCHING,et({},s)),i))return;const o=this.switchParams(s.url,r?.details,s.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if(!(this.selectDefaultTrack&&!s.default)&&(!e||Di(e,s,Ii)))return r}if(e){const{name:r,lang:s,assocLang:i,characteristics:o,audioCodec:l,channels:u}=e;for(let d=0;d<t.length;d++){const f=t[d];if(Di({name:r,lang:s,assocLang:i,characteristics:o,audioCodec:l,channels:u},f,Ii))return d}for(let d=0;d<t.length;d++){const f=t[d];if(Ll(e.attrs,f.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(let d=0;d<t.length;d++){const f=t[d];if(Ll(e.attrs,f.attrs,["LANGUAGE"]))return d}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Cd(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,t),o=e.details,l=o?.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&o.live?" age "+l.toFixed(1)+(o.type&&" "+o.type||""):""} ${i}`),this.hls.trigger(_.AUDIO_TRACK_LOADING,{url:i,id:r,groupId:s,deliveryDirectives:t||null,track:e})}}class WV{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,r){if(this.queues===null||this.tracks===null)return;const s=this.queues[t];s.push(e),s.length===1&&!r&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const r={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const r={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(r)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const r=(t=e[0])==null?void 0:t.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const s=t[0];try{s.execute()}catch(i){var r;if(s.onError(i),this.queues===null||this.tracks===null)return;const o=(r=this.tracks[e])==null?void 0:r.buffer;o!=null&&o.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,r;return(t=this.queues)!=null&&t[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const r=(t=this.tracks)==null?void 0:t[e],s=r?.buffer;return s?`SourceBuffer${s.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(r=>r.label).join(", "))||""}}const Tb=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,iR="HlsJsTrackRemovedError";class zV extends Error{constructor(e){super(e),this.name=iR}}class YV extends Xn{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=r=>{var s;this.hls&&((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=r=>{const{media:s,mediaSource:i}=this;r&&this.log("Media source opened"),!(!s||!i)&&(i.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(_.MEDIA_ATTACHED,{media:s,mediaSource:i}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:s}=this;r!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${r})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=g6(ti(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.BUFFER_RESET,this.onBufferReset,this),e.on(_.BUFFER_APPENDING,this.onBufferAppending,this),e.on(_.BUFFER_CODECS,this.onBufferCodecs,this),e.on(_.BUFFER_EOS,this.onBufferEos,this),e.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(_.FRAG_PARSED,this.onFragParsed,this),e.on(_.FRAG_CHANGED,this.onFragChanged,this),e.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.BUFFER_RESET,this.onBufferReset,this),e.off(_.BUFFER_APPENDING,this.onBufferAppending,this),e.off(_.BUFFER_CODECS,this.onBufferCodecs,this),e.off(_.BUFFER_EOS,this.onBufferEos,this),e.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(_.FRAG_PARSED,this.onFragParsed,this),e.off(_.FRAG_CHANGED,this.onFragChanged,this),e.off(_.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const r={};if(this.operationQueue){const i=this.isUpdating();i||this.operationQueue.removeBlockers();const o=this.isQueued();(i||o)&&this.warn(`Transfering MediaSource with${o?" operations in queue":""}${i?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===t?rt(r,s.tracks):this.sourceBuffers.forEach(i=>{const[o]=i;o&&(r[o]=rt({},this.tracks[o]),this.removeBuffer(o)),i[0]=i[1]=null}),{media:e,mediaSource:t,tracks:r}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var r;let s=2;(t.audio&&!t.video||!t.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(e,t){const r=this.media=t.media;this.transferData=this.overrides=void 0;const s=ti(this.appendSource);if(s){const i=!!t.mediaSource;(i||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const o=this.mediaSource=t.mediaSource||new s;if(this.assignMediaSource(o),i)this._objectUrl=r.src,this.attachTransferred();else{const l=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{r.removeAttribute("src");const u=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||u&&o instanceof u,bb(r),qV(r,l),r.load()}catch{r.src=l}else r.src=l}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,r;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const r=this.tracks,s=t.tracks,i=s?Object.keys(s):null,o=i?i.length:0,l=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(s&&i&&o){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${ot(r,(u,d)=>u==="initSegment"?void 0:d)};
transfer tracks: ${ot(s,(u,d)=>u==="initSegment"?void 0:d)}}`),!t_(s,r)){t.mediaSource=null,t.tracks=void 0;const u=e.currentTime,d=this.details,f=Math.max(u,d?.fragments[0].start||0);if(f-u>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${u} -> ${f}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(r)}") start time: ${f} currentTime: ${u}`),this.onMediaDetaching(_.MEDIA_DETACHING,{}),this.onMediaAttaching(_.MEDIA_ATTACHING,t),e.currentTime=f;return}this.transferData=void 0,i.forEach(u=>{const d=u,f=s[d];if(f){const h=f.buffer;if(h){const m=this.fragmentTracker,v=f.id;if(m.hasFragments(v)||m.hasParts(v)){const E=Me.getBuffered(h);m.detectEvictedFragments(d,E,v,null,!0)}const g=am(d),x=[d,h];this.sourceBuffers[g]=x,h.updating&&this.operationQueue&&this.operationQueue.prependBlocker(d),this.trackSourceBuffer(d,f)}}}),l(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),l()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const r=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:i,_objectUrl:o}=this;if(i){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([l])=>{l&&this.removeBuffer(l)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const l=i.readyState==="open";try{const u=i.sourceBuffers;for(let d=u.length;d--;)l&&u[d].abort(),i.removeSourceBuffer(u[d]);l&&i.endOfStream()}catch(u){this.warn(`onMediaDetaching: ${u.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.removeEventListener("startstreaming",this._onStartStreaming),i.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),r||(o&&self.URL.revokeObjectURL(o),this.mediaSrc===o?(s.removeAttribute("src"),this.appendSource&&bb(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(_.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const r=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),r)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(i){this.warn(`onBufferReset ${e}`,i)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[am(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new WV(this.tracks)}onBufferCodecs(e,t){var r;const s=this.tracks,i=Object.keys(t);this.log(`BUFFER_CODECS: "${i}" (current SB count ${this.sourceBufferCount})`);const o="audiovideo"in t&&(s.audio||s.video)||s.audiovideo&&("audio"in t||"video"in t),l=!o&&this.sourceBufferCount&&this.media&&i.some(u=>!s[u]);if(o||l){this.warn(`Unsupported transition between "${Object.keys(s)}" and "${i}" SourceBuffers`);return}i.forEach(u=>{var d,f;const h=t[u],{id:m,codec:v,levelCodec:g,container:x,metadata:E,supplemental:b}=h;let I=s[u];const A=(d=this.transferData)==null||(d=d.tracks)==null?void 0:d[u],R=A!=null&&A.buffer?A:I,C=R?.pendingCodec||R?.codec,F=R?.levelCodec;I||(I=s[u]={buffer:void 0,listeners:[],codec:v,supplemental:b,container:x,levelCodec:g,metadata:E,id:m});const k=Yu(C,F),N=k?.replace(Tb,"$1");let M=Yu(v,g);const O=(f=M)==null?void 0:f.replace(Tb,"$1");M&&k&&N!==O&&(u.slice(0,5)==="audio"&&(M=Rd(M,this.appendSource)),this.log(`switching codec ${C} to ${M}`),M!==(I.pendingCodec||I.codec)&&(I.pendingCodec=M),I.container=x,this.appendChangeType(u,x,M))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&((r=t.audio)==null?void 0:r.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const r=this.tracks[t];return e[t]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,t,r){const s=`${t};codecs=${r}`,i={label:`change-type=${s}`,execute:()=>{const o=this.tracks[e];if(o){const l=o.buffer;l!=null&&l.changeType&&(this.log(`changing ${e} sourceBuffer type to ${s}`),l.changeType(s),o.codec=r,o.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${e} SourceBuffer type`,o)}};this.append(i,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const r=e.start,s=r+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(r,ge.MAIN))==null?void 0:t.gap)===!0)return;const o={label:"block-audio",execute:()=>{var l;const u=this.tracks.video;(this.lastVideoAppendEnd>s||u!=null&&u.buffer&&Me.isBuffered(u.buffer,s)||((l=this.fragmentTracker.getAppendedFrag(s,ge.MAIN))==null?void 0:l.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn("Error executing block-audio operation",l)}};this.blockedAudioAppend={op:o,frag:e},this.append(o,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:r}=this,{data:s,type:i,parent:o,frag:l,part:u,chunkMeta:d,offset:f}=t,h=d.buffering[i],{sn:m,cc:v}=l,g=self.performance.now();h.start=g;const x=l.stats.buffering,E=u?u.stats.buffering:null;x.start===0&&(x.start=g),E&&E.start===0&&(E.start=g);const b=r.audio;let I=!1;i==="audio"&&b?.container==="audio/mpeg"&&(I=!this.lastMpegAudioChunk||d.id===1||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const A=r.video,R=A?.buffer;if(R&&m!=="initSegment"){const k=u||l,N=this.blockedAudioAppend;if(i==="audio"&&o!=="main"&&!this.blockedAudioAppend&&!(A.ending||A.ended)){const O=k.start+k.duration*.05,H=R.buffered,Z=this.currentOp("video");!H.length&&!Z?this.blockAudio(k):!Z&&!Me.isBuffered(R,O)&&this.lastVideoAppendEnd<O&&this.blockAudio(k)}else if(i==="video"){const M=k.end;if(N){const O=N.frag.start;(M>O||M<this.lastVideoAppendEnd||Me.isBuffered(R,O))&&this.unblockAudio()}this.lastVideoAppendEnd=M}}const C=(u||l).start,F={label:`append-${i}`,execute:()=>{var k;h.executeStart=self.performance.now();const N=(k=this.tracks[i])==null?void 0:k.buffer;N&&(I?this.updateTimestampOffset(N,C,.1,i,m,v):f!==void 0&&he(f)&&this.updateTimestampOffset(N,f,1e-6,i,m,v)),this.appendExecutor(s,i)},onStart:()=>{},onComplete:()=>{const k=self.performance.now();h.executeEnd=h.end=k,x.first===0&&(x.first=k),E&&E.first===0&&(E.first=k);const N={};this.sourceBuffers.forEach(([M,O])=>{M&&(N[M]=Me.getBuffered(O))}),this.appendErrors[i]=0,i==="audio"||i==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(_.BUFFER_APPENDED,{type:i,frag:l,part:u,chunkMeta:d,parent:l.type,timeRanges:N})},onError:k=>{var N;const M={type:we.MEDIA_ERROR,parent:l.type,details:W.BUFFER_APPEND_ERROR,sourceBufferName:i,frag:l,part:u,chunkMeta:d,error:k,err:k,fatal:!1},O=(N=this.media)==null?void 0:N.error;if(k.code===DOMException.QUOTA_EXCEEDED_ERR||k.name=="QuotaExceededError"||"quota"in k)M.details=W.BUFFER_FULL_ERROR;else if(k.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!O)M.errorAction=Do(!0);else if(k.name===iR&&this.sourceBufferCount===0)M.errorAction=Do(!0);else{const H=++this.appendErrors[i];this.warn(`Failed ${H}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${i}" sourceBuffer (${O||"no media error"})`),(H>=this.hls.config.appendErrorMaxRetry||O)&&(M.fatal=!0)}this.hls.trigger(_.ERROR,M)}};this.log(`queuing "${i}" append sn: ${m}${u?" p: "+u.index:""} of ${l.type===ge.MAIN?"level":"track"} ${l.level} cc: ${v}`),this.append(F,i,this.isPending(this.tracks[i]))}getFlushOp(e,t,r){return this.log(`queuing "${e}" remove ${t}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(_.BUFFER_FLUSHED,{type:e})},onError:s=>{this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`,s)}}}onBufferFlushing(e,t){const{type:r,startOffset:s,endOffset:i}=t;r?this.append(this.getFlushOp(r,s,i),r):this.sourceBuffers.forEach(([o])=>{o&&this.append(this.getFlushOp(o,s,i),o)})}onFragParsed(e,t){const{frag:r,part:s}=t,i=[],o=s?s.elementaryStreams:r.elementaryStreams;o[it.AUDIOVIDEO]?i.push("audiovideo"):(o[it.AUDIO]&&i.push("audio"),o[it.VIDEO]&&i.push("video"));const l=()=>{const u=self.performance.now();r.stats.buffering.end=u,s&&(s.stats.buffering.end=u);const d=s?s.stats:r.stats;this.hls.trigger(_.FRAG_BUFFERED,{frag:r,part:s,stats:d,id:r.type})};i.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(l,i).catch(u=>{this.warn(`Fragment buffered callback ${u}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var r;this.sourceBuffers.forEach(([o])=>{if(o){const l=this.tracks[o];(!t.type||t.type===o)&&(l.ending=!0,l.ended||(l.ended=!0,this.log(`${o} buffer reached EOS`)))}});const s=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([o])=>{var l;return o&&!((l=this.tracks[o])!=null&&l.ended)})?s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),o.endOfStream(),this.hls.trigger(_.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(_.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===W.BUFFER_APPEND_ERROR&&t.frag){var r;const s=(r=t.errorAction)==null?void 0:r.nextAutoLevel;he(s)&&s!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:r}=this;if(!r||t===null||!this.sourceBufferCount)return;const s=e.config,i=r.currentTime,o=t.levelTargetDuration,l=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(he(l)&&l>=0){const d=Math.max(l,o),f=Math.floor(i/o)*o-d;this.flushBackBuffer(i,o,f)}const u=s.frontBufferFlushThreshold;if(he(u)&&u>0){const d=Math.max(s.maxBufferLength,u),f=Math.max(d,o),h=Math.floor(i/o)*o+f;this.flushFrontBuffer(i,o,h)}}flushBackBuffer(e,t,r){this.sourceBuffers.forEach(([s,i])=>{if(i){const l=Me.getBuffered(i);if(l.length>0&&r>l.start(0)){var o;this.hls.trigger(_.BACK_BUFFER_REACHED,{bufferEnd:r});const u=this.tracks[s];if((o=this.details)!=null&&o.live)this.hls.trigger(_.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(u!=null&&u.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(_.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:s})}}})}flushFrontBuffer(e,t,r){this.sourceBuffers.forEach(([s,i])=>{if(i){const o=Me.getBuffered(i),l=o.length;if(l<2)return;const u=o.start(l-1),d=o.end(l-1);if(r>u||e>=u&&e<=d)return;this.hls.trigger(_.BUFFER_FLUSHING,{startOffset:u,endOffset:1/0,type:s})}})}getDurationAndRange(){var e;const{details:t,mediaSource:r}=this;if(!t||!this.media||r?.readyState!=="open")return null;const s=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&r.setLiveSeekableRange){const d=Math.max(0,t.fragmentStart),f=Math.max(d,s);return{duration:1/0,start:d,end:f}}return{duration:1/0}}const i=(e=this.overrides)==null?void 0:e.duration;if(i)return he(i)?{duration:i}:null;const o=this.media.duration,l=he(r.duration)?r.duration:0;return s>l&&s>o||!he(o)?{duration:s}:null}updateMediaSource({duration:e,start:t,end:r}){const s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==e&&(he(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),s.duration=e),t!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${t}-${r}.`),s.setLiveSeekableRange(t,r)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${ot(r)}`),this.tracksReady){var s;const i=(s=this.transferData)==null?void 0:s.tracks;i&&Object.keys(i).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,r])=>{if(t){const s=this.tracks[t];e[t]={buffer:r,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(_.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const i in e){const o=i,l=e[o];if(this.isPending(l)){const u=this.getTrackCodec(l,o),d=`${l.container};codecs=${u}`;l.codec=u,this.log(`creating sourceBuffer(${d})${this.currentOp(o)?" Queued":""} ${ot(l)}`);try{const f=r.addSourceBuffer(d),h=am(o),m=[o,f];t[h]=m,l.buffer=f}catch(f){var s;this.error(`error while trying to add sourceBuffer: ${f.message}`),this.shiftAndExecuteNext(o),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[o],this.hls.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:f,sourceBufferName:o,mimeType:d,parent:l.id});return}this.trackSourceBuffer(o,l)}}this.bufferCreated()}getTrackCodec(e,t){const r=e.supplemental;let s=e.codec;r&&(t==="video"||t==="audiovideo")&&bl(r,"video")&&(s=B6(s,r));const i=Yu(s,e.levelCodec);return i?t.slice(0,5)==="audio"?Rd(i,this.appendSource):i:""}trackSourceBuffer(e,t){const r=t.buffer;if(!r)return;const s=this.getTrackCodec(t,e);this.tracks[e]={buffer:r,codec:s,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(i,o)=>{const l=o.removedRanges;l!=null&&l.length&&this.hls.trigger(_.BUFFER_FLUSHED,{type:i})})}get mediaSrc(){var e,t;const r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r?.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var r;const s=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${s}`,t),this.hls.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:s,fatal:!1});const i=this.currentOp(e);i&&i.onError(s)}updateTimestampOffset(e,t,r,s,i,o){const l=t-e.timestampOffset;Math.abs(l)>=r&&(this.log(`Updating ${s} SourceBuffer timestampOffset to ${t} (sn: ${i} cc: ${o})`),e.timestampOffset=t)}removeExecutor(e,t,r){const{media:s,mediaSource:i}=this,o=this.tracks[e],l=o?.buffer;if(!s||!i||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const u=he(s.duration)?s.duration:1/0,d=he(i.duration)?i.duration:1/0,f=Math.max(0,t),h=Math.min(r,u,d);h>f&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${f},${h}] from the ${e} SourceBuffer`),l.remove(f,h)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const r=this.tracks[t],s=r?.buffer;if(!s)throw new zV(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,s.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:r}=this,s=t.map(o=>this.appendBlocker(o));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(o=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var r;const s=(r=this.tracks[t])==null?void 0:r.buffer;!s||s.updating||this.shiftAndExecuteNext(t)})}append(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,r){const s=this.tracks[e];if(!s)return;const i=s.buffer;if(!i)return;const o=r.bind(this,e);s.listeners.push({event:t,listener:o}),i.addEventListener(t,o)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const r=t.buffer;r&&(t.listeners.forEach(s=>{r.removeEventListener(s.event,s.listener)}),t.listeners.length=0)}}function bb(n){const e=n.querySelectorAll("source");[].slice.call(e).forEach(t=>{n.removeChild(t)})}function qV(n,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,n.appendChild(t)}function am(n){return n==="audio"?1:0}class ry{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(_.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(_.BUFFER_CODECS,this.onBufferCodecs,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(_.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(_.BUFFER_CODECS,this.onBufferCodecs,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&he(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((s,i)=>this.isLevelAllowed(s)&&i<=e);return this.clientRect=null,ry.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const s=(l,u)=>u?l.width!==u.width||l.height!==u.height:!0;let i=e.length-1;const o=Math.max(t,r);for(let l=0;l<e.length;l+=1){const u=e[l];if((u.width>=o||u.height>=o)&&s(u,e[l+1])){i=l;break}}return i}}const XV={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},hn=XV,QV={HLS:"h"},JV=QV;class Nr{constructor(e,t){Array.isArray(e)&&(e=e.map(r=>r instanceof Nr?r:new Nr(r))),this.value=e,this.params=t}}const ZV="Dict";function eG(n){return Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":typeof n=="object"?JSON.stringify(n):String(n)}function tG(n,e,t,r){return new Error(`failed to ${n} "${eG(e)}" as ${t}`,{cause:r})}function Or(n,e,t){return tG("serialize",n,e,t)}class oR{constructor(e){this.description=e}}const wb="Bare Item",nG="Boolean";function rG(n){if(typeof n!="boolean")throw Or(n,nG);return n?"?1":"?0"}function sG(n){return btoa(String.fromCharCode(...n))}const iG="Byte Sequence";function oG(n){if(ArrayBuffer.isView(n)===!1)throw Or(n,iG);return`:${sG(n)}:`}const aG="Integer";function lG(n){return n<-999999999999999||999999999999999<n}function aR(n){if(lG(n))throw Or(n,aG);return n.toString()}function cG(n){return`@${aR(n.getTime()/1e3)}`}function lR(n,e){if(n<0)return-lR(-n,e);const t=Math.pow(10,e);if(Math.abs(n*t%1-.5)<Number.EPSILON){const s=Math.floor(n*t);return(s%2===0?s:s+1)/t}else return Math.round(n*t)/t}const uG="Decimal";function dG(n){const e=lR(n,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Or(n,uG);const t=e.toString();return t.includes(".")?t:`${t}.0`}const fG="String",hG=/[\x00-\x1f\x7f]+/;function pG(n){if(hG.test(n))throw Or(n,fG);return`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function mG(n){return n.description||n.toString().slice(7,-1)}const gG="Token";function Ib(n){const e=mG(n);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Or(e,gG);return e}function Eg(n){switch(typeof n){case"number":if(!he(n))throw Or(n,wb);return Number.isInteger(n)?aR(n):dG(n);case"string":return pG(n);case"symbol":return Ib(n);case"boolean":return rG(n);case"object":if(n instanceof Date)return cG(n);if(n instanceof Uint8Array)return oG(n);if(n instanceof oR)return Ib(n);default:throw Or(n,wb)}}const yG="Key";function Sg(n){if(/^[a-z*][a-z0-9\-_.*]*$/.test(n)===!1)throw Or(n,yG);return n}function sy(n){return n==null?"":Object.entries(n).map(([e,t])=>t===!0?`;${Sg(e)}`:`;${Sg(e)}=${Eg(t)}`).join("")}function cR(n){return n instanceof Nr?`${Eg(n.value)}${sy(n.params)}`:Eg(n)}function vG(n){return`(${n.value.map(cR).join(" ")})${sy(n.params)}`}function xG(n,e={whitespace:!0}){if(typeof n!="object"||n==null)throw Or(n,ZV);const t=n instanceof Map?n.entries():Object.entries(n),r=e?.whitespace?" ":"";return Array.from(t).map(([s,i])=>{i instanceof Nr||(i=new Nr(i));let o=Sg(s);return i.value===!0?o+=sy(i.params):(o+="=",Array.isArray(i.value)?o+=vG(i):o+=cR(i)),o}).join(`,${r}`)}function uR(n,e){return xG(n,e)}const br="CMCD-Object",Et="CMCD-Request",xi="CMCD-Session",Bs="CMCD-Status",EG={br,ab:br,d:br,ot:br,tb:br,tpb:br,lb:br,tab:br,lab:br,url:br,pb:Et,bl:Et,tbl:Et,dl:Et,ltc:Et,mtp:Et,nor:Et,nrr:Et,rc:Et,sn:Et,sta:Et,su:Et,ttfb:Et,ttfbb:Et,ttlb:Et,cmsdd:Et,cmsds:Et,smrt:Et,df:Et,cs:Et,ts:Et,cid:xi,pr:xi,sf:xi,sid:xi,st:xi,v:xi,msd:xi,bs:Bs,bsd:Bs,cdn:Bs,rtp:Bs,bg:Bs,pt:Bs,ec:Bs,e:Bs},SG={REQUEST:Et};function TG(n){return Object.keys(n).reduce((e,t)=>{var r;return(r=n[t])===null||r===void 0||r.forEach(s=>e[s]=t),e},{})}function bG(n,e){const t={};if(!n)return t;const r=Object.keys(n),s=e?TG(e):{};return r.reduce((i,o)=>{var l;const u=EG[o]||s[o]||SG.REQUEST,d=(l=i[u])!==null&&l!==void 0?l:i[u]={};return d[o]=n[o],i},t)}function wG(n){return["ot","sf","st","e","sta"].includes(n)}function IG(n){return typeof n=="number"?he(n):n!=null&&n!==""&&n!==!1}const dR="event";function AG(n,e){const t=new URL(n),r=new URL(e);if(t.origin!==r.origin)return n;const s=t.pathname.split("/").slice(1),i=r.pathname.split("/").slice(1,-1);for(;s[0]===i[0];)s.shift(),i.shift();for(;i.length;)i.shift(),s.unshift("..");return s.join("/")+t.search+t.hash}const Zu=n=>Math.round(n),Tg=(n,e)=>Array.isArray(n)?n.map(t=>Tg(t,e)):n instanceof Nr&&typeof n.value=="string"?new Nr(Tg(n.value,e),n.params):(e.baseUrl&&(n=AG(n,e.baseUrl)),e.version===1?encodeURIComponent(n):n),Au=n=>Zu(n/100)*100,_G=(n,e)=>{let t=n;return e.version>=2&&(n instanceof Nr&&typeof n.value=="string"?t=new Nr([n]):typeof n=="string"&&(t=[n])),Tg(t,e)},RG={br:Zu,d:Zu,bl:Au,dl:Au,mtp:Au,nor:_G,rtp:Au,tb:Zu},fR="request",hR="response",iy=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],LG=["e"],CG=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function yf(n){return CG.test(n)}function kG(n){return iy.includes(n)||LG.includes(n)||yf(n)}const pR=["d","dl","nor","ot","rtp","su"];function PG(n){return iy.includes(n)||pR.includes(n)||yf(n)}const DG=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function NG(n){return iy.includes(n)||pR.includes(n)||DG.includes(n)||yf(n)}const OG=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function MG(n){return OG.includes(n)||yf(n)}const FG={[hR]:NG,[dR]:kG,[fR]:PG};function mR(n,e={}){const t={};if(n==null||typeof n!="object")return t;const r=e.version||n.v||1,s=e.reportingMode||fR,i=r===1?MG:FG[s];let o=Object.keys(n).filter(i);const l=e.filter;typeof l=="function"&&(o=o.filter(l));const u=s===hR||s===dR;u&&!o.includes("ts")&&o.push("ts"),r>1&&!o.includes("v")&&o.push("v");const d=rt({},RG,e.formatters),f={version:r,reportingMode:s,baseUrl:e.baseUrl};return o.sort().forEach(h=>{let m=n[h];const v=d[h];if(typeof v=="function"&&(m=v(m,f)),h==="v"){if(r===1)return;m=r}h=="pr"&&m===1||(u&&h==="ts"&&!he(m)&&(m=Date.now()),IG(m)&&(wG(h)&&typeof m=="string"&&(m=new oR(m)),t[h]=m))}),t}function BG(n,e={}){const t={};if(!n)return t;const r=mR(n,e),s=bG(r,e?.customHeaderMap);return Object.entries(s).reduce((i,[o,l])=>{const u=uR(l,{whitespace:!1});return u&&(i[o]=u),i},t)}function UG(n,e,t){return rt(n,BG(e,t))}const $G="CMCD";function jG(n,e={}){return n?uR(mR(n,e),{whitespace:!1}):""}function VG(n,e={}){if(!n)return"";const t=jG(n,e);return encodeURIComponent(t)}function GG(n,e={}){if(!n)return"";const t=VG(n,e);return`${$G}=${t}`}const Ab=/CMCD=[^&#]+/;function HG(n,e,t){const r=GG(e,t);if(!r)return n;if(Ab.test(n))return n.replace(Ab,r);const s=n.includes("?")?"&":"?";return`${n}${s}${r}`}class KG{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:hn.MANIFEST,su:!this.initialized})}catch(i){this.hls.logger.warn("Could not generate manifest CMCD data.",i)}},this.applyFragmentData=s=>{try{const{frag:i,part:o}=s,l=this.hls.levels[i.level],u=this.getObjectType(i),d={d:(o||i).duration*1e3,ot:u};(u===hn.VIDEO||u===hn.AUDIO||u==hn.MUXED)&&(d.br=l.bitrate/1e3,d.tb=this.getTopBandwidth(u)/1e3,d.bl=this.getBufferLength(u));const f=o?this.getNextPart(o):this.getNextFrag(i);f!=null&&f.url&&f.url!==i.url&&(d.nor=f.url),this.apply(s,d)}catch(i){this.hls.logger.warn("Could not generate segment CMCD data.",i)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHED,this.onMediaDetached,this),e.on(_.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHED,this.onMediaDetached,this),e.off(_.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,s;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(s=t.tracks.video)==null?void 0:s.buffer}createData(){var e;return{v:1,sf:JV.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){rt(t,this.createData());const r=t.ot===hn.INIT||t.ot===hn.VIDEO||t.ot===hn.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:s}=this;s&&(t=Object.keys(t).reduce((o,l)=>(s.includes(l)&&(o[l]=t[l]),o),{}));const i={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),UG(e.headers,t,i)):e.url=HG(e.url,t,i)}getNextFrag(e){var t;const r=(t=this.hls.levels[e.level])==null?void 0:t.details;if(r){const s=e.sn-r.startSN;return r.fragments[s+1]}}getNextPart(e){var t;const{index:r,fragment:s}=e,i=(t=this.hls.levels[s.level])==null||(t=t.details)==null?void 0:t.partList;if(i){const{sn:o}=s;for(let l=i.length-1;l>=0;l--){const u=i[l];if(u.index===r&&u.fragment.sn===o)return i[l+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return hn.TIMED_TEXT;if(e.sn==="initSegment")return hn.INIT;if(t==="audio")return hn.AUDIO;if(t==="main")return this.hls.audioTracks.length?hn.VIDEO:hn.MUXED}getTopBandwidth(e){let t=0,r;const s=this.hls;if(e===hn.AUDIO)r=s.audioTracks;else{const i=s.maxAutoLevel,o=i>-1?i+1:s.levels.length;r=s.levels.slice(0,o)}return r.forEach(i=>{i.bitrate>t&&(t=i.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,r=e===hn.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:Me.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,o,l){t(i),this.loader.load(i,o,l)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,o,l){t(i),this.loader.load(i,o,l)}}}}const WG=3e5;class zG extends Xn{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if(r?.action===jt.SendAlternateToPenaltyBox&&r.flags===_n.MoveAllAlternatesMatchingHost){const s=this.levels;let i=this._pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:l,pathwayId:u,type:d}=t.context;l&&s?o=this.getPathwayForGroupId(l,d,o):u&&(o=u)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!i&&s&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),r.resolved=this.pathwayId!==o),t.details===W.BUFFER_APPEND_ERROR&&!t.fatal?r.resolved=!0:r.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${s&&s.length} priorities: ${ot(i)} penalized: ${ot(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const r=this.penalizedPathways,s=performance.now();Object.keys(r).forEach(i=>{s-r[i]>WG&&delete r[i]});for(let i=0;i<e.length;i++){const o=e[i];if(o in r)continue;if(o===this.pathwayId)return;const l=this.hls.nextLoadLevel,u=this.hls.levels[l];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,O_(t),this.hls.trigger(_.LEVELS_UPDATED,{levels:t});const d=this.hls.levels[l];u&&d&&this.levels&&(d.attrs["STABLE-VARIANT-ID"]!==u.attrs["STABLE-VARIANT-ID"]&&d.bitrate!==u.bitrate&&this.log(`Unstable Pathways change from bitrate ${u.bitrate} to ${d.bitrate}`),this.hls.nextLoadLevel=l);break}}}getPathwayForGroupId(e,t,r){const s=this.getLevelsForPathway(r).concat(this.levels||[]);for(let i=0;i<s.length;i++)if(t===He.AUDIO_TRACK&&s[i].hasAudioGroup(e)||t===He.SUBTITLE_TRACK&&s[i].hasSubtitleGroup(e))return s[i].pathwayId;return r}clonePathways(e){const t=this.levels;if(!t)return;const r={},s={};e.forEach(i=>{const{ID:o,"BASE-ID":l,"URI-REPLACEMENT":u}=i;if(t.some(f=>f.pathwayId===o))return;const d=this.getLevelsForPathway(l).map(f=>{const h=new mt(f.attrs);h["PATHWAY-ID"]=o;const m=h.AUDIO&&`${h.AUDIO}_clone_${o}`,v=h.SUBTITLES&&`${h.SUBTITLES}_clone_${o}`;m&&(r[h.AUDIO]=m,h.AUDIO=m),v&&(s[h.SUBTITLES]=v,h.SUBTITLES=v);const g=gR(f.uri,h["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",u),x=new Il({attrs:h,audioCodec:f.audioCodec,bitrate:f.bitrate,height:f.height,name:f.name,url:g,videoCodec:f.videoCodec,width:f.width});if(f.audioGroups)for(let E=1;E<f.audioGroups.length;E++)x.addGroupId("audio",`${f.audioGroups[E]}_clone_${o}`);if(f.subtitleGroups)for(let E=1;E<f.subtitleGroups.length;E++)x.addGroupId("text",`${f.subtitleGroups[E]}_clone_${o}`);return x});t.push(...d),_b(this.audioTracks,r,u,o),_b(this.subtitleTracks,s,u,o)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let s;try{s=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(s.protocol!=="data:"){const f=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+f)}const i={responseType:"json",url:s.href},o=t.steeringManifestLoadPolicy.default,l=o.errorRetry||o.timeoutRetry||{},u={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},d={onSuccess:(f,h,m,v)=>{this.log(`Loaded steering manifest: "${s}"`);const g=f.data;if(g?.VERSION!==1){this.log(`Steering VERSION ${g.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=g.TTL;const{"RELOAD-URI":x,"PATHWAY-CLONES":E,"PATHWAY-PRIORITY":b}=g;if(x)try{this.uri=new self.URL(x,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${x}`);return}this.scheduleRefresh(this.uri||m.url),E&&this.clonePathways(E);const I={steeringManifest:g,url:s.toString()};this.hls.trigger(_.STEERING_MANIFEST_LOADED,I),b&&this.updatePathwayPriority(b)},onError:(f,h,m,v)=>{if(this.log(`Error loading steering manifest: ${f.code} ${f.text} (${h.url})`),this.stopLoad(),f.code===410){this.enabled=!1,this.log(`Steering manifest ${h.url} no longer available`);return}let g=this.timeToLoad*1e3;if(f.code===429){const x=this.loader;if(typeof x?.getResponseHeader=="function"){const E=x.getResponseHeader("Retry-After");E&&(g=parseFloat(E)*1e3)}this.log(`Steering manifest ${h.url} rate limited`);return}this.scheduleRefresh(this.uri||h.url,g)},onTimeout:(f,h,m)=>{this.log(`Timeout loading steering manifest (${h.url})`),this.scheduleRefresh(this.uri||h.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(i,u,d)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const s=(r=this.hls)==null?void 0:r.media;if(s&&!s.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function _b(n,e,t,r){n&&Object.keys(e).forEach(s=>{const i=n.filter(o=>o.groupId===s).map(o=>{const l=rt({},o);return l.details=void 0,l.attrs=new mt(l.attrs),l.url=l.attrs.URI=gR(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),l.groupId=l.attrs["GROUP-ID"]=e[s],l.attrs["PATHWAY-ID"]=r,l});n.push(...i)})}function gR(n,e,t,r){const{HOST:s,PARAMS:i,[t]:o}=r;let l;e&&(l=o?.[e],l&&(n=l));const u=new self.URL(n);return s&&!l&&(u.host=s),i&&Object.keys(i).sort().forEach(d=>{d&&u.searchParams.set(d,i[d])}),u.href}class Oo extends Xn{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Oo.CDMCleanupPromise?[Oo.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:r,initData:s}=t,i=`"${t.type}" event: init data type: "${r}"`;if(this.debug(i),s!==null){if(!this.keyFormatPromise){let o=Object.keys(this.keySystemAccessPromises);o.length||(o=el(this.config));const l=o.map(Zp).filter(u=>!!u);this.keyFormatPromise=this.getKeyFormatPromise(l)}this.keyFormatPromise.then(o=>{const l=Xu(o);if(r!=="sinf"||l!==gt.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${r}" for selected key-system ${l}`);return}let u;try{const v=kt(new Uint8Array(s)),g=z0(JSON.parse(v).sinf),x=u_(g);if(!x)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");u=new Uint8Array(x.subarray(8,24))}catch(v){this.warn(`${i} Failed to parse sinf: ${v}`);return}const d=Vt(u),{keyIdToKeySessionPromise:f,mediaKeySessions:h}=this;let m=f[d];for(let v=0;v<h.length;v++){const g=h[v],x=g.decryptdata;if(!x.keyId)continue;const E=Vt(x.keyId);if(Dd(u,x.keyId)||x.uri.replace(/-/g,"").indexOf(d)!==-1){if(m=f[E],!m)continue;if(x.pssh)break;delete f[E],x.pssh=new Uint8Array(s),x.keyId=u,m=f[d]=m.then(()=>this.generateRequestWithPreferredKeySession(g,r,s,"encrypted-event-key-match")),m.catch(b=>this.handleError(b));break}}m||this.handleError(new Error(`Key ID ${d} not encountered in playlist. Key-system sessions ${h.length}.`))}).catch(o=>this.handleError(o))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(_.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(_.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(_.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(_.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,s=t?.[e];if(s)return s.licenseUrl;if(e===gt.WIDEVINE&&r)return r}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t?.[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(o,l,u)=>!!o&&u.indexOf(o)===l,s=t.map(o=>o.audioCodec).filter(r),i=t.map(o=>o.videoCodec).filter(r);return s.length+i.length===0&&i.push("avc1.42e01e"),new Promise((o,l)=>{const u=d=>{const f=d.shift();this.getMediaKeysPromise(f,s,i).then(h=>o({keySystem:f,mediaKeys:h})).catch(h=>{d.length?u(d):h instanceof An?l(h):l(new An({type:we.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_ACCESS,error:h,fatal:!0},h.message))})};u(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${r}`;return __===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return r(e,t)}getMediaKeysPromise(e,t,r){var s;const i=_8(e,t,r,this.config.drmSystemOptions||{});let o=this.keySystemAccessPromises[e],l=(s=o)==null?void 0:s.keySystemAccess;if(!l){this.log(`Requesting encrypted media "${e}" key-system access with config: ${ot(i)}`),l=this.requestMediaKeySystemAccess(e,i);const u=o=this.keySystemAccessPromises[e]={keySystemAccess:l};return l.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),l.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const f=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const h=u.mediaKeys=d.createMediaKeys().then(m=>(this.log(`Media-keys created for "${e}"`),u.hasMediaKeys=!0,f.then(v=>v?this.setMediaKeysServerCertificate(m,e,v):m)));return h.catch(m=>{this.error(`Failed to create media-keys for "${e}"}: ${m}`)}),h})}return l.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${Vt(e.keyId||[])} keyUri: ${e.uri}`);const s=r.createSession(),i={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),s=_u(t),i="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(r,i,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyId ${Vt(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),r.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Zp(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:r})=>this.attemptSetMediaKeys(t,r))}selectKeySystem(e){return new Promise((t,r)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:s})=>{const i=Zp(s);i?t(i):r(new Error(`Unable to find format for key-system "${s}"`))}).catch(r)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=el(this.config),r=e.map(Xu).filter(s=>!!s&&t.indexOf(s)!==-1);return this.selectKeySystem(r)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let r=0;r<t.length;r++){const s=YG(e,t[r]);if(s)return s}}loadKey(e){const t=e.keyInfo.decryptdata,r=_u(t),s=this.bannedKeyIds[r];if(s||this.getKeyStatus(t)==="internal-error"){const l=Rb(s||"internal-error",t);return this.handleError(l,e.frag),Promise.reject(l)}const i=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);const o=this.keyIdToKeySessionPromise[r];if(!o){const l=this.getKeySystemForKeyPromise(t).then(({keySystem:u,mediaKeys:d})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(u,d).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:u,mediaKeys:d,decryptdata:t}))))).then(u=>{const d="cenc",f=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(u,d,f,"playlist-key")});return l.catch(u=>this.handleError(u,e.frag)),this.keyIdToKeySessionPromise[r]=l,l}return o.catch(l=>{if(l instanceof An){const u=et({},l.data);this.getKeyStatus(t)==="internal-error"&&(u.decryptdata=t);const d=new An(u,l.message);this.handleError(d,e.frag)}}),o}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof An){t&&(e.data.frag=t);const r=e.data.decryptdata;this.error(`${e.message}${r?` (${Vt(r.keyId||[])})`:""}`),this.hls.trigger(_.ERROR,e.data)}else this.error(e.message),this.hls.trigger(_.ERROR,{type:we.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=_u(e),r=this.keyIdToKeySessionPromise[t];if(!r){const s=Xu(e.keyFormat),i=s?[s]:el(this.config);return this.attemptKeySystemAccess(i)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=el(this.config)),e.length===0)throw new An({type:we.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${ot({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(r).then(()=>this.media?this.media.setMediaKeys(t):new Promise((i,o)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return o(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=t,this.media.setMediaKeys(t).then(i).catch(o)}}));return this.mediaKeys=t,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(i=>r.indexOf(i)===-1)})}generateRequestWithPreferredKeySession(e,t,r,s){var i;const o=(i=this.config.drmSystems)==null||(i=i[e.keySystem])==null?void 0:i.generateRequest;if(o)try{const g=o.call(this.hls,t,r,e);if(!g)throw new Error("Invalid response from configured generateRequest filter");t=g.initDataType,r=g.initData?g.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(g){if(this.warn(g.message),this.hls&&this.hls.config.debug)throw g}if(r===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const l=_u(e.decryptdata),u=e.decryptdata.uri;this.log(`Generating key-session request for "${s}" keyId: ${l} URI: ${u} (init data type: ${t} length: ${r.byteLength})`);const d=new q0,f=e._onmessage=g=>{const x=e.mediaKeysSession;if(!x){d.emit("error",new Error("invalid state"));return}const{messageType:E,message:b}=g;this.log(`"${E}" message event for session "${x.sessionId}" message size: ${b.byteLength}`),E==="license-request"||E==="license-renewal"?this.renewLicense(e,b).catch(I=>{d.eventNames().length?d.emit("error",I):this.handleError(I)}):E==="license-release"?e.keySystem===gt.FAIRPLAY&&this.updateKeySession(e,pg("acknowledged")).then(()=>this.removeSession(e)).catch(I=>this.handleError(I)):this.warn(`unhandled media key message type "${E}"`)},h=(g,x)=>{x.keyStatus=g;let E;g.startsWith("usable")?d.emit("resolved"):g==="internal-error"||g==="output-restricted"||g==="output-downscaled"?E=Rb(g,x.decryptdata):g==="expired"?E=new Error(`key expired (keyId: ${l})`):g==="released"?E=new Error("key released"):g==="status-pending"||this.warn(`unhandled key status change "${g}" (keyId: ${l})`),E&&(d.eventNames().length?d.emit("error",E):this.handleError(E))},m=e._onkeystatuseschange=g=>{if(!e.mediaKeysSession){d.emit("error",new Error("invalid state"));return}const E=this.getKeyStatuses(e);if(!Object.keys(E).some(R=>E[R]!=="status-pending"))return;if(E[l]==="expired"){this.log(`Expired key ${ot(E)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let I=E[l];if(I)h(I,e);else{var A;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(A=e.keyStatusTimeouts)[l]||(A[l]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const C=this.getKeyStatus(e.decryptdata);if(C&&C!=="status-pending")return this.log(`No status for keyId ${l} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${C} from other session.`),h(C,e);this.log(`key status for ${l} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),I="internal-error",h(I,e)},1e3)),this.log(`No status for keyId ${l} (${ot(E)}).`)}};rn(e.mediaKeysSession,"message",f),rn(e.mediaKeysSession,"keystatuseschange",m);const v=new Promise((g,x)=>{d.on("error",x),d.on("resolved",g)});return e.mediaKeysSession.generateRequest(t,r).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${l} URI: ${u}`)}).catch(g=>{throw new An({type:we.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_SESSION,error:g,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${g}`)}).then(()=>v).catch(g=>(d.removeAllListeners(),this.removeSession(e).then(()=>{throw g}))).then(()=>(d.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((r,s)=>{if(typeof s=="string"&&typeof r=="object"){const l=s;s=r,r=l}const i="buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s);if(e.keySystem===gt.PLAYREADY&&i.length===16){const l=Vt(i);t[l]=r,I_(i)}const o=Vt(i);r==="internal-error"&&(this.bannedKeyIds[o]=r),this.log(`key status change "${r}" for keyStatuses keyId: ${o} key-session "${e.mediaKeysSession.sessionId}"`),t[o]=r}),t}fetchServerCertificate(e){const t=this.config,r=t.loader,s=new r(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,l)=>{const u={responseType:"arraybuffer",url:i},d=t.certLoadPolicy.default,f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(m,v,g,x)=>{o(m.data)},onError:(m,v,g,x)=>{l(new An({type:we.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:et({url:u.url,data:void 0},m)},`"${e}" certificate request failed (${i}). Status: ${m.code} (${m.text})`))},onTimeout:(m,v,g)=>{l(new An({type:we.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:{url:u.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(m,v,g)=>{l(new Error("aborted"))}};s.load(u,f,h)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((s,i)=>{e.setServerCertificate(r).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${r.byteLength}) on "${t}"`),s(e)}).catch(o=>{i(new An({type:we.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(s=>{throw new An({type:we.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:s,fatal:!1},s.message)}))}unpackPlayReadyKeyMessage(e,t){const r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const s=new DOMParser().parseFromString(r,"application/xml"),i=s.querySelectorAll("HttpHeader");if(i.length>0){let f;for(let h=0,m=i.length;h<m;h++){var o,l;f=i[h];const v=(o=f.querySelector("name"))==null?void 0:o.textContent,g=(l=f.querySelector("value"))==null?void 0:l.textContent;v&&g&&e.setRequestHeader(v,g)}}const u=s.querySelector("Challenge"),d=u?.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return pg(atob(d))}setupLicenseXHR(e,t,r,s){const i=this.config.licenseXhrSetup;return i?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return i.call(this.hls,e,t,r,s)}).catch(o=>{if(!r.decryptdata)throw o;return e.open("POST",t,!0),i.call(this.hls,e,t,r,s)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||s})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((s,i)=>{const o=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${o}`);const l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(l.readyState===4)if(l.status===200){this._requestLicenseFailureCount=0;let u=l.response;this.log(`License received ${u instanceof ArrayBuffer?u.byteLength:u}`);const d=this.config.licenseResponseCallback;if(d)try{u=d.call(this.hls,l,o,e)}catch(f){this.error(f)}s(u)}else{const u=r.errorRetry,d=u?u.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||l.status>=400&&l.status<500)i(new An({type:we.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:l,response:{url:o,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${o}). Status: ${l.status} (${l.statusText})`));else{const f=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${f} attempts left`),this.requestLicense(e,t).then(s,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=l,this.setupLicenseXHR(l,o,e,t).then(({xhr:u,licenseChallenge:d})=>{e.keySystem==gt.PLAYREADY&&(d=this.unpackPlayReadyKeyMessage(u,d)),u.send(d)}).catch(i)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,rn(r,"encrypted",this.onMediaEncrypted),rn(r,"waitingforkey",this.onWaitingForKey);const s=this.mediaResolved;s?s():this.mediaKeys=r.mediaKeys}onMediaDetached(){const e=this.media;e&&(mn(e,"encrypted",this.onMediaEncrypted),mn(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const t=this.mediaResolved;if(t&&t(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const r=this.media,s=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Qs.clearKeyUriToKeyIdMap();const i=s.length;Oo.CDMCleanupPromise=Promise.all(s.map(o=>this.removeSession(o)).concat((r==null||(e=r.setMediaKeys(null))==null?void 0:e.catch(o=>{this.log(`Could not clear media keys: ${o}`),this.hls&&this.hls.trigger(_.ERROR,{type:we.OTHER_ERROR,details:W.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${o}`)})}))||Promise.resolve())).catch(o=>{this.log(`Could not close sessions and clear media keys: ${o}`),this.hls&&this.hls.trigger(_.ERROR,{type:we.OTHER_ERROR,details:W.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${o}`)})}).then(()=>{i&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((s,i)=>(s.indexOf(i.keyFormat)===-1&&s.push(i.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r,decryptdata:s}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${Vt(s?.keyId||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);i>-1&&this.mediaKeySessions.splice(i,1);const{keyStatusTimeouts:o}=e;o&&Object.keys(o).forEach(d=>self.clearTimeout(o[d]));const{drmSystemOptions:l}=this.config;return(L8(l)?new Promise((d,f)=>{self.setTimeout(()=>f(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(d).catch(f)}):Promise.resolve()).catch(d=>{this.log(`Could not remove session: ${d}`),this.hls&&this.hls.trigger(_.ERROR,{type:we.OTHER_ERROR,details:W.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${d}`)})}).then(()=>t.close()).catch(d=>{this.log(`Could not close session: ${d}`),this.hls&&this.hls.trigger(_.ERROR,{type:we.OTHER_ERROR,details:W.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${d}`)})})}return Promise.resolve()}}Oo.CDMCleanupPromise=void 0;function _u(n){if(!n)throw new Error("Could not read keyId of undefined decryptdata");if(n.keyId===null)throw new Error("keyId is null");return Vt(n.keyId)}function YG(n,e){if(n.keyId&&e.mediaKeysSession.keyStatuses.has(n.keyId))return e.mediaKeysSession.keyStatuses.get(n.keyId);if(n.matches(e.decryptdata))return e.keyStatus}class An extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function Rb(n,e){const t=n==="output-restricted",r=t?W.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:W.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new An({type:we.KEY_SYSTEM_ERROR,details:r,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${n}"`)}class qG{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(_.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(_.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const s=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,r){const s=performance.now();if(t){if(this.lastTime){const i=s-this.lastTime,o=r-this.lastDroppedFrames,l=t-this.lastDecodedFrames,u=1e3*o/i,d=this.hls;if(d.trigger(_.FPS_DROP,{currentDropped:o,currentDecoded:l,totalDroppedFrames:r}),u>0&&o>d.config.fpsDroppedMonitoringThreshold*l){let f=d.currentLevel;d.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),f>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=f)&&(f=f-1,d.trigger(_.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:d.currentLevel}),d.autoLevelCapping=f,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function yR(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function vR(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){tt.debug(`[texttrack-utils]: ${r}`);try{const s=new self.TextTrackCue(e.startTime,e.endTime,e.text);s.id=e.id,n.addCue(s)}catch(s){tt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}t==="disabled"&&(n.mode=t)}function Ro(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues)for(let r=n.cues.length;r--;)e&&n.cues[r].removeEventListener("enter",e),n.removeCue(n.cues[r]);t==="disabled"&&(n.mode=t)}function bg(n,e,t,r){const s=n.mode;if(s==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const i=QG(n.cues,e,t);for(let o=0;o<i.length;o++)(!r||r(i[o]))&&n.removeCue(i[o])}s==="disabled"&&(n.mode=s)}function XG(n,e){if(e<=n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let r=0,s=t,i;for(;r<=s;)if(i=Math.floor((s+r)/2),e<n[i].startTime)s=i-1;else if(e>n[i].startTime&&r<t)r=i+1;else return i;return n[r].startTime-e<e-n[s].startTime?r:s}function QG(n,e,t){const r=[],s=XG(n,e);if(s>-1)for(let i=s,o=n.length;i<o;i++){const l=n[i];if(l.startTime>=e&&l.endTime<=t)r.push(l);else if(l.startTime>t)return r}return r}function ed(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(n[t])}return e}class JG extends ny{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const r=ed(this.media.textTracks);for(let i=0;i<r.length;i++)if(r[i].mode==="hidden")t=r[i];else if(r[i].mode==="showing"){t=r[i];break}const s=this.findTrackForTextTrack(t);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.LEVEL_LOADING,this.onLevelLoading,this),e.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.LEVEL_LOADING,this.onLevelLoading,this),e.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(_.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const r=this.media;if(!r)return;const s=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;ed(r.textTracks).forEach(o=>{Ro(o)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,groupId:s,details:i}=t,o=this.tracksInGroup[r];if(!o||o.groupId!==s){this.warn(`Subtitle track with id:${r} and group:${s} not found in active group ${o?.groupId}`);return}const l=o.details;o.details=t.details,this.log(`Subtitle track ${r} "${o.name}" lang:${o.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.subtitleGroups||null,s=this.groupIds;let i=this.currentTrack;if(!r||s?.length!==r?.length||r!=null&&r.some(o=>s?.indexOf(o)===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(f=>!r||r.indexOf(f.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(f=>f.default)&&(this.selectDefaultTrack=!1),o.forEach((f,h)=>{f.id=h});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const l=this.hls.config.subtitlePreference;if(!i&&l){this.selectDefaultTrack=!1;const f=Rr(l,o);if(f>-1)i=o[f];else{const h=Rr(l,this.tracks);i=this.tracks[h]}}let u=this.findTrackId(i);u===-1&&i&&(u=this.findTrackId(null));const d={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${r?.join(",")}" group-id`),this.hls.trigger(_.SUBTITLE_TRACKS_UPDATED,d),u!==-1&&this.trackId===-1&&this.setSubtitleTrack(u)}}findTrackId(e){const t=this.tracksInGroup,r=this.selectDefaultTrack;for(let s=0;s<t.length;s++){const i=t[s];if(!(r&&!i.default||!r&&!e)&&(!e||Di(i,e)))return s}if(e){for(let s=0;s<t.length;s++){const i=t[s];if(Ll(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<t.length;s++){const i=t[s];if(Ll(e.attrs,i.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if(xg(s,e))return r}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===He.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const r=this.currentTrack;if(r&&Di(e,r))return r;const s=Rr(e,this.tracksInGroup);if(s>-1){const i=this.tracksInGroup[s];return this.setSubtitleTrack(s),i}else{if(r)return null;{const i=Rr(e,t);if(i>-1)return t[i]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,t),o=e.details,l=o?.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&o.live?" age "+l.toFixed(1)+(o.type&&" "+o.type||""):""} ${i}`),this.hls.trigger(_.SUBTITLE_TRACK_LOADING,{url:i,id:r,groupId:s,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=ed(e.textTracks),r=this.currentTrack;let s;if(r&&(s=t.filter(i=>xg(r,i))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(t).forEach(i=>{i.mode!=="disabled"&&i!==s&&(i.mode="disabled")}),s){const i=this.subtitleDisplay?"showing":"hidden";s.mode!==i&&(s.mode=i)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!he(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,s=t[e]||null;if(this.trackId=e,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(_.SUBTITLE_TRACK_SWITCH,{id:e});return}const i=!!s.details&&!s.details.live;if(e===this.trackId&&s===r&&i)return;this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:o,groupId:l="",name:u,type:d,url:f}=s;this.hls.trigger(_.SUBTITLE_TRACK_SWITCH,{id:o,groupId:l,name:u,type:d,url:f});const h=this.switchParams(s.url,r?.details,s.details);this.loadPlaylist(h)}}function ZG(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const i=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s=="x"?i:i&3|8).toString(16)})}}}function dl(n){let e=5381,t=n.length;for(;t;)e=e*33^n.charCodeAt(--t);return(e>>>0).toString()}const Mo=.025;let Fd=(function(n){return n[n.Point=0]="Point",n[n.Range=1]="Range",n})({});function eH(n,e,t){return`${n.identifier}-${t+1}-${dl(e)}`}class tH{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const r=this.playoutLimit;return e<=0||isNaN(r)?!1:r===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>r}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return lm(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,r=lm(t,e);return t-r<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=he(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return lm(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Mo))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Fd.Range:Fd.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return nH(this)}}function lm(n,e){return n-e.start<e.duration/2&&!(Math.abs(n-(e.start+e.duration))<Mo)?e.start:e.start+e.duration}function xR(n,e,t){const r=new self.URL(n,t);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function cm(n,e){for(;(t=n.assetList[++e])!=null&&t.error;)var t;return e}function nH(n){return`["${n.identifier}" ${n.cue.pre?"<pre>":n.cue.post?"<post>":""}${n.timelineStart.toFixed(2)}-${n.resumeTime.toFixed(2)}]`}function bo(n){const e=n.timelineStart,t=n.duration||0;return`["${n.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class rH{constructor(e,t,r,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(_.PLAYOUT_LIMIT_REACHED,{})};const i=this.hls=new e(t);this.interstitial=r,this.assetItem=s;const o=()=>{this.hasDetails=!0};i.once(_.LEVEL_LOADED,o),i.once(_.AUDIO_TRACK_LOADED,o),i.once(_.SUBTITLE_TRACK_LOADED,o),i.on(_.MEDIA_ATTACHING,(l,{media:u})=>{this.removeMediaListeners(),this.mediaAttached=u,this.interstitial.playoutLimit&&(u.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&i.on(_.BUFFER_APPENDED,()=>{const f=this.bufferedEnd;this.reachedPlayout(f)&&(this._bufferedEosTime=f,i.trigger(_.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=xR(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const r=Math.min(this._bufferedEosTime||1/0,this.duration),s=this.timelineOffset,i=Me.bufferInfo(e,s,0);return this.getAssetTime(i.end)>=r-.02}reachedPlayout(e){const r=this.interstitial.playoutLimit;return this.startOffset+e>=r}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Me.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const r=t-this.startOffset;if(r>0&&r<e)return r}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const r=e-t;if(Math.abs(r)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=r=>delete r.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,r){var s;(s=this.hls)==null||s.on(e,t)}once(e,t,r){var s;(s=this.hls)==null||s.once(e,t)}off(e,t,r){var s;(s=this.hls)==null||s.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${bo(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const Lb=.033;class sH extends Xn{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((r,s)=>e<=s.startOffset&&t>s.startOffset?(delete s.error,r+1):r,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);const s=this.items;if(s)for(s[r]||(t===void 0&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&(i=s[r])!=null&&i.event;){var i;r--}return r}findItemIndexAtTime(e,t){const r=this.items;if(r)for(let s=0;s<r.length;s++){let i=r[s];if(t&&t!=="primary"&&(i=i[t]),e===i.start||e>i.start&&e<i.end)return s}return-1}findJumpRestrictedIndex(e,t){const r=this.items;if(r)for(let s=e;s<=t&&r[s];s++){const i=r[s].event;if(i!=null&&i.restrictions.jump&&!i.appendInPlace)return s}return-1}findEventIndex(e){const t=this.items;if(t)for(let s=t.length;s--;){var r;if(((r=t[s].event)==null?void 0:r.identifier)===e)return s}return-1}findAssetIndex(e,t){const r=e.assetList,s=r.length;if(s>1)for(let i=0;i<s;i++){const o=r[i];if(!o.error){const l=o.timelineStart;if(t===l||t>l&&(t<l+(o.duration||0)||i===s-1))return i}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const r=t.assetList,s=r[r.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(e,t){const r=e.main.details,{dateRanges:s}=r,i=this.events,o=this.parseDateRanges(s,{url:r.url},t),l=Object.keys(s),u=i?i.filter(d=>!l.includes(d.identifier)):[];o.length&&o.sort((d,f)=>{const h=d.cue.pre,m=d.cue.post,v=f.cue.pre,g=f.cue.post;if(h&&!v)return-1;if(v&&!h||m&&!g)return 1;if(g&&!m)return-1;if(!h&&!v&&!m&&!g){const x=d.startTime,E=f.startTime;if(x!==E)return x-E}return d.dateRange.tagOrder-f.dateRange.tagOrder}),this.events=o,u.forEach(d=>{this.removeEvent(d)}),this.updateSchedule(e,u)}updateSchedule(e,t=[],r=!1){const s=this.events||[];if(s.length||t.length||this.length<2){const i=this.items,o=this.parseSchedule(s,e);(r||t.length||i?.length!==o.length||o.some((u,d)=>Math.abs(u.playout.start-i[d].playout.start)>.005||Math.abs(u.playout.end-i[d].playout.end)>.005))&&(this.items=o,this.onScheduleUpdate(t,i))}}parseDateRanges(e,t,r){const s=[],i=Object.keys(e);for(let o=0;o<i.length;o++){const l=i[o],u=e[l];if(u.isInterstitial){let d=this.eventMap[l];d?d.setDateRange(u):(d=new tH(u,t),this.eventMap[l]=d,r===!1&&(d.appendInPlace=r)),s.push(d)}}return s}parseSchedule(e,t){const r=[],s=t.main.details,i=s.live?1/0:s.edge;let o=0;if(e=e.filter(u=>!u.error&&!(u.cue.once&&u.hasPlayed)),e.length){this.resolveOffsets(e,t);let u=0,d=0;if(e.forEach((f,h)=>{const m=f.cue.pre,v=f.cue.post,g=e[h-1]||null,x=f.appendInPlace,E=v?i:f.startOffset,b=f.duration,I=f.timelineOccupancy===Fd.Range?b:0,A=f.resumptionOffset,R=g?.startTime===E,C=E+f.cumulativeDuration;let F=x?C+b:E+A;if(m||!v&&E<=0){const N=d;d+=I,f.timelineStart=C;const M=o;o+=b,r.push({event:f,start:C,end:F,playout:{start:M,end:o},integrated:{start:N,end:d}})}else if(E<=i){if(!R){const O=E-u;if(O>Lb){const H=u,Z=d;d+=O;const se=o;o+=O;const U={previousEvent:e[h-1]||null,nextEvent:f,start:H,end:H+O,playout:{start:se,end:o},integrated:{start:Z,end:d}};r.push(U)}else O>0&&g&&(g.cumulativeDuration+=O,r[r.length-1].end=E)}v&&(F=C),f.timelineStart=C;const N=d;d+=I;const M=o;o+=b,r.push({event:f,start:C,end:F,playout:{start:M,end:o},integrated:{start:N,end:d}})}else return;const k=f.resumeTime;v||k>i?u=i:u=k}),u<i){var l;const f=u,h=d,m=i-u;d+=m;const v=o;o+=m,r.push({previousEvent:((l=r[r.length-1])==null?void 0:l.event)||null,nextEvent:null,start:u,end:f+m,playout:{start:v,end:o},integrated:{start:h,end:d}})}this.setDurations(i,o,d)}else r.push({previousEvent:null,nextEvent:null,start:0,end:i,playout:{start:0,end:i},integrated:{start:0,end:i}}),this.setDurations(i,i,i);return r}setDurations(e,t,r){this.durations={primary:e,playout:t,integrated:r}}resolveOffsets(e,t){const r=t.main.details,s=r.live?1/0:r.edge;let i=0,o=-1;e.forEach((l,u)=>{const d=l.cue.pre,f=l.cue.post,h=d?0:f?s:l.startTime;this.updateAssetDurations(l),o===h?l.cumulativeDuration=i:(i=0,o=h),!f&&l.snapOptions.in&&(l.resumeAnchor=ji(null,r.fragments,l.startOffset+l.resumptionOffset,0,0)||void 0),l.appendInPlace&&!l.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(l,t)||(l.appendInPlace=!1)),!l.appendInPlace&&u+1<e.length&&e[u+1].startTime-e[u].resumeTime<Lb&&(e[u+1].appendInPlace=!1,e[u+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${l}`));const v=he(l.resumeOffset)?l.resumeOffset:l.duration;i+=v})}primaryCanResumeInPlaceAt(e,t){const r=e.resumeTime,s=e.startTime+e.resumptionOffset;return Math.abs(r-s)>Mo?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${s}`),!1):!Object.keys(t).some(o=>{const l=t[o].details,u=l.edge;if(r>=u)return this.log(`"${e.identifier}" resumption ${r} past ${o} playlist end ${u}`),!1;const d=ji(null,l.fragments,r);if(!d)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${o} playlist (${l.fragStart}-${l.fragmentEnd})`),!0;const f=o==="audio"?.175:0;return Math.abs(d.start-r)<Mo+f||Math.abs(d.end-r)<Mo+f?!1:(this.log(`"${e.identifier}" resumption ${r} not aligned with ${o} fragment bounds (${d.start}-${d.end} sn: ${d.sn} cc: ${d.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let r=0,s=!1,i=!1;for(let o=0;o<e.assetList.length;o++){const l=e.assetList[o],u=t+r;l.startOffset=r,l.timelineStart=u,s||(s=l.duration===null),i||(i=!!l.error);const d=l.error?0:l.duration||0;r+=d}s&&!i?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function sr(n){return`[${n.event?'"'+n.event.identifier+'"':"primary"}: ${n.start.toFixed(2)}-${n.end.toFixed(2)}]`}class iH{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const r=e.assetListUrl;let s;try{s=xR(r,this.hls.sessionId,e.baseUrl)}catch(m){const v=this.assignAssetListError(e,W.ASSET_LIST_LOAD_ERROR,m,r);this.hls.trigger(_.ERROR,v);return}t&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+t);const i=this.hls.config,o=i.loader,l=new o(i),u={responseType:"json",url:s.href},d=i.interstitialAssetListLoadPolicy.default,f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(m,v,g,x)=>{const E=m.data,b=E?.ASSETS;if(!Array.isArray(b)){const I=this.assignAssetListError(e,W.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),g.url,v,x);this.hls.trigger(_.ERROR,I);return}e.assetListResponse=E,this.hls.trigger(_.ASSET_LIST_LOADED,{event:e,assetListResponse:E,networkDetails:x})},onError:(m,v,g,x)=>{const E=this.assignAssetListError(e,W.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${m.code} ${m.text} (${v.url})`),v.url,x,g);this.hls.trigger(_.ERROR,E)},onTimeout:(m,v,g)=>{const x=this.assignAssetListError(e,W.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${v.url})`),v.url,m,g);this.hls.trigger(_.ERROR,x)}};return l.load(u,f,h),this.hls.trigger(_.ASSET_LIST_LOADING,{event:e}),l}assignAssetListError(e,t,r,s,i,o){return e.error=r,{type:we.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:s,error:r,networkDetails:o,stats:i}}}function Cb(n){var e;n==null||(e=n.play())==null||e.catch(()=>{})}function Ru(n,e){return`[${n}] Advancing timeline position to ${e}`}class oH extends Xn{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled||!this.schedule)return;const s=r-this.timelinePos;if(Math.abs(s)<1/7056e5)return;const o=s<=-.01;this.timelinePos=r,this.bufferedPos=r;const l=this.playingItem;if(!l){this.checkBuffer();return}if(o&&this.schedule.resetErrorsInRange(r,r-s)&&this.updateSchedule(!0),this.checkBuffer(),o&&r<l.start||r>=l.end){var u;const v=this.findItemIndex(l);let g=this.schedule.findItemIndexAtTime(r);if(g===-1&&(g=v+(o?-1:1),this.log(`seeked ${o?"back ":""}to position not covered by schedule ${r} (resolving from ${v} to ${g})`)),!this.isInterstitial(l)&&(u=this.media)!=null&&u.paused&&(this.shouldPlay=!1),!o&&g>v){const x=this.schedule.findJumpRestrictedIndex(v+1,g);if(x>v){this.setSchedulePosition(x);return}}this.setSchedulePosition(g);return}const d=this.playingAsset;if(!d){if(this.playingLastItem&&this.isInterstitial(l)){const v=l.event.assetList[0];v&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(r,v))}return}const f=d.timelineStart,h=d.duration||0;if(o&&r<f||r>=f+h){var m;(m=l.event)!=null&&m.appendInPlace&&(this.clearAssetPlayers(l.event,l),this.flushFrontBuffer(r)),this.setScheduleToAssetAtTime(r,d)}},this.onTimeupdate=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;if(r>this.timelinePos)this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();else return;const s=this.playingItem;if(!s||this.playingLastItem)return;if(r>=s.end){this.timelinePos=s.end;const l=this.findItemIndex(s);this.setSchedulePosition(l+1)}const i=this.playingAsset;if(!i)return;const o=i.timelineStart+(i.duration||0);r>=o&&this.setScheduleToAssetAtTime(r,i)},this.onScheduleUpdate=(r,s)=>{const i=this.schedule;if(!i)return;const o=this.playingItem,l=i.events||[],u=i.items||[],d=i.durations,f=r.map(x=>x.identifier),h=!!(l.length||f.length);(h||s)&&this.log(`INTERSTITIALS_UPDATED (${l.length}): ${l}
Schedule: ${u.map(x=>sr(x))} pos: ${this.timelinePos}`),f.length&&this.log(`Removed events ${f}`);let m=null,v=null;o&&(m=this.updateItem(o,this.timelinePos),this.itemsMatch(o,m)?this.playingItem=m:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const g=this.bufferingItem;if(g&&(v=this.updateItem(g,this.bufferedPos),this.itemsMatch(g,v)?this.bufferingItem=v:g.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(g.event,null))),r.forEach(x=>{x.assetList.forEach(E=>{this.clearAssetPlayer(E.identifier,null)})}),this.playerQueue.forEach(x=>{if(x.interstitial.appendInPlace){const E=x.assetItem.timelineStart,b=x.timelineOffset-E;if(b)try{x.timelineOffset=E}catch(I){Math.abs(b)>Mo&&this.warn(`${I} ("${x.assetId}" ${x.timelineOffset}->${E})`)}}}),h||s){if(this.hls.trigger(_.INTERSTITIALS_UPDATED,{events:l.slice(0),schedule:u.slice(0),durations:d,removedIds:f}),this.isInterstitial(o)&&f.includes(o.event.identifier)){this.warn(`Interstitial "${o.event.identifier}" removed while playing`),this.primaryFallback(o.event);return}o&&this.trimInPlace(m,o),g&&v!==m&&this.trimInPlace(v,g),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new iH(e),this.schedule=new sH(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(_.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(_.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(_.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(_.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(_.BUFFER_APPENDED,this.onBufferAppended,this),e.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(_.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(_.MEDIA_ENDED,this.onMediaEnded,this),e.on(_.ERROR,this.onError,this),e.on(_.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(_.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(_.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(_.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(_.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(_.BUFFER_CODECS,this.onBufferCodecs,this),e.off(_.BUFFER_APPENDED,this.onBufferAppended,this),e.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(_.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(_.MEDIA_ENDED,this.onMediaEnded,this),e.off(_.ERROR,this.onError,this),e.off(_.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){mn(e,"play",this.onPlay),mn(e,"pause",this.onPause),mn(e,"seeking",this.onSeeking),mn(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const r=this.media=t.media;rn(r,"seeking",this.onSeeking),rn(r,"timeupdate",this.onTimeupdate),rn(r,"play",this.onPlay),rn(r,"pause",this.onPause)}onMediaAttached(e,t){const r=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!s){this.clearScheduleState();const i=this.findItemIndex(r);this.setSchedulePosition(i)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const r=!!t.transferMedia,s=this.media;if(this.media=null,!r&&(s&&this.removeMediaListeners(s),this.detachedData)){const i=this.getBufferingPlayer();i&&(this.log(`Removing schedule state for detachedData and ${i}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,i.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,r=h=>h&&e.getAssetPlayer(h.identifier),s=(h,m,v,g,x)=>{if(h){let E=h[m].start;const b=h.event;if(b){if(m==="playout"||b.timelineOccupancy!==Fd.Point){const I=r(v);I?.interstitial===b&&(E+=I.assetItem.startOffset+I[x])}}else{const I=g==="bufferedPos"?o():e[g];E+=I-h.start}return E}return 0},i=(h,m)=>{var v;if(h!==0&&m!=="primary"&&(v=e.schedule)!=null&&v.length){var g;const x=e.schedule.findItemIndexAtTime(h),E=(g=e.schedule.items)==null?void 0:g[x];if(E){const b=E[m].start-E.start;return h+b}}return h},o=()=>{const h=e.bufferedPos;return h===Number.MAX_VALUE?l("primary"):Math.max(h,0)},l=h=>{var m,v;return(m=e.primaryDetails)!=null&&m.live?e.primaryDetails.edge:((v=e.schedule)==null?void 0:v.durations[h])||0},u=(h,m)=>{var v,g;const x=e.effectivePlayingItem;if(x!=null&&(v=x.event)!=null&&v.restrictions.skip||!e.schedule)return;e.log(`seek to ${h} "${m}"`);const E=e.effectivePlayingItem,b=e.schedule.findItemIndexAtTime(h,m),I=(g=e.schedule.items)==null?void 0:g[b],A=e.getBufferingPlayer(),R=A?.interstitial,C=R?.appendInPlace,F=E&&e.itemsMatch(E,I);if(E&&(C||F)){const k=r(e.playingAsset),N=k?.media||e.primaryMedia;if(N){const M=m==="primary"?N.currentTime:s(E,m,e.playingAsset,"timelinePos","currentTime"),O=h-M,H=(C?M:N.currentTime)+O;if(H>=0&&(!k||C||H<=k.duration)){N.currentTime=H;return}}}if(I){let k=h;if(m!=="primary"){const M=I[m].start,O=h-M;k=I.start+O}const N=!e.isInterstitial(I);if((!e.isInterstitial(E)||E.event.appendInPlace)&&(N||I.event.appendInPlace)){const M=e.media||(C?A?.media:null);M&&(M.currentTime=k)}else if(E){const M=e.findItemIndex(E);if(b>M){const H=e.schedule.findJumpRestrictedIndex(M+1,b);if(H>M){e.setSchedulePosition(H);return}}let O=0;if(N)e.timelinePos=k,e.checkBuffer();else{const H=I.event.assetList,Z=h-(I[m]||I).start;for(let se=H.length;se--;){const U=H[se];if(U.duration&&Z>=U.startOffset&&Z<U.startOffset+U.duration){O=se;break}}}e.setSchedulePosition(b,O)}}},d=()=>{const h=e.effectivePlayingItem;if(e.isInterstitial(h))return h;const m=t();return e.isInterstitial(m)?m:null},f={get bufferedEnd(){const h=t(),m=e.bufferingItem;if(m&&m===h){var v;return s(m,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-m.playout.start||((v=e.bufferingAsset)==null?void 0:v.startOffset)||0}return 0},get currentTime(){const h=d(),m=e.effectivePlayingItem;return m&&m===h?s(m,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-m.playout.start:0},set currentTime(h){const m=d(),v=e.effectivePlayingItem;v&&v===m&&u(h+v.playout.start,"playout")},get duration(){const h=d();return h?h.playout.end-h.playout.start:0},get assetPlayers(){var h;const m=(h=d())==null?void 0:h.event.assetList;return m?m.map(v=>e.getAssetPlayer(v.identifier)):[]},get playingIndex(){var h;const m=(h=d())==null?void 0:h.event;return m&&e.effectivePlayingAsset?m.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return d()}};return this.manager={get events(){var h;return((h=e.schedule)==null||(h=h.events)==null?void 0:h.slice(0))||[]},get schedule(){var h;return((h=e.schedule)==null||(h=h.items)==null?void 0:h.slice(0))||[]},get interstitialPlayer(){return d()?f:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const h=t();return e.findItemIndex(h)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const h=e.effectivePlayingItem;return e.findItemIndex(h)},primary:{get bufferedEnd(){return o()},get currentTime(){const h=e.timelinePos;return h>0?h:0},set currentTime(h){u(h,"primary")},get duration(){return l("primary")},get seekableStart(){var h;return((h=e.primaryDetails)==null?void 0:h.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(h){u(h,"integrated")},get duration(){return l("integrated")},get seekableStart(){var h;return i(((h=e.primaryDetails)==null?void 0:h.fragmentStart)||0,"integrated")}},skip:()=>{const h=e.effectivePlayingItem,m=h?.event;if(m&&!m.restrictions.skip){const v=e.findItemIndex(h);if(m.appendInPlace){const g=h.playout.start+h.event.duration;u(g+.001,"playout")}else e.advanceAfterAssetEnded(m,v,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!r?!1:this.findItemIndex(t)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let s=this.media;!s&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(s=this.primaryMedia);const i=(t=s)==null?void 0:t.currentTime;if(!(i===void 0||!he(i)))return i}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}transferMediaFromPlayer(e,t){const r=e.interstitial.appendInPlace,s=e.media;if(r&&s===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&s){this.detachedData={media:s};return}const i=e.transferMedia();this.log(`transfer MediaSource from ${e} ${ot(i)}`),this.detachedData=i}else t&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(e,t){var r,s;if(e.media===t)return;let i=null;const o=this.hls,l=e!==o,u=l&&e.interstitial.appendInPlace,d=(r=this.detachedData)==null?void 0:r.mediaSource;let f;if(o.media)u&&(i=o.transferMedia(),this.detachedData=i),f="Primary";else if(d){const g=this.getBufferingPlayer();g?(i=g.transferMedia(),f=`${g}`):f="detached MediaSource"}else f="detached media";if(!i){if(d)i=this.detachedData,this.log(`using detachedData: MediaSource ${ot(i)}`);else if(!this.detachedData||o.media===t){const g=this.playerQueue;g.length>1&&g.forEach(x=>{if(l&&x.interstitial.appendInPlace!==u){const E=x.interstitial;this.clearInterstitial(x.interstitial,null),E.appendInPlace=!1,E.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${E}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const h=i&&"mediaSource"in i&&((s=i.mediaSource)==null?void 0:s.readyState)!=="closed",m=h&&i?i:t;this.log(`${h?"transfering MediaSource":"attaching media"} to ${l?e:"Primary"} from ${f} (media.currentTime: ${t.currentTime})`);const v=this.schedule;if(m===i&&v){const g=l&&e.assetId===v.assetIdAtEnd;m.overrides={duration:v.duration,endOfStream:!l||g,cueRemoval:!l}}e.attachMedia(m)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e?.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const r=this.timelinePos,s=this.effectivePlayingItem;if(r===-1){const i=this.hls.startPosition;if(this.log(Ru("checkStart",i)),this.timelinePos=i,t.length&&t[0].cue.pre){const o=e.findEventIndex(t[0].identifier);this.setSchedulePosition(o)}else if(i>=0||!this.primaryLive){const o=this.timelinePos=i>0?i:0,l=e.findItemIndexAtTime(o);this.setSchedulePosition(l)}}else if(s&&!this.playingItem){const i=e.findItemIndex(s);this.setSchedulePosition(i)}}advanceAssetBuffering(e,t){const r=e.event,s=r.findAssetIndex(t),i=cm(r,s);if(!r.isAssetPastPlayoutLimit(i))this.bufferedToEvent(e,i);else if(this.schedule){var o;const l=(o=this.schedule.items)==null?void 0:o[this.findItemIndex(e)+1];l&&this.bufferedToItem(l)}}advanceAfterAssetEnded(e,t,r){const s=cm(e,r);if(e.isAssetPastPlayoutLimit(s)){if(this.schedule){const i=this.schedule.items;if(i){const o=t+1,l=i.length;if(o>=l){this.setSchedulePosition(-1);return}const u=e.resumeTime;this.timelinePos<u&&(this.log(Ru("advanceAfterAssetEnded",u)),this.timelinePos=u,e.appendInPlace&&this.advanceInPlace(u),this.checkBuffer(this.bufferedPos<u)),this.setSchedulePosition(o)}}}else{if(e.appendInPlace){const i=e.assetList[s];i&&this.advanceInPlace(i.timelineStart)}this.setSchedulePosition(t,s)}}setScheduleToAssetAtTime(e,t){const r=this.schedule;if(!r)return;const s=t.parentIdentifier,i=r.getEvent(s);if(i){const o=r.findEventIndex(s),l=r.findAssetIndex(i,e);this.advanceAfterAssetEnded(i,o,l-1)}}setSchedulePosition(e,t){var r;const s=(r=this.schedule)==null?void 0:r.items;if(!s||this.playbackDisabled)return;const i=e>=0?s[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${i&&sr(i)}) pos: ${this.timelinePos}`);const o=this.waitingItem||this.playingItem,l=this.playingLastItem;if(this.isInterstitial(o)){const f=o.event,h=this.playingAsset,m=h?.identifier,v=m?this.getAssetPlayer(m):null;if(v&&m&&(!this.eventItemsMatch(o,i)||t!==void 0&&m!==f.assetList[t].identifier)){var u;const g=f.findAssetIndex(h);if(this.log(`INTERSTITIAL_ASSET_ENDED ${g+1}/${f.assetList.length} ${bo(h)}`),this.endedAsset=h,this.playingAsset=null,this.hls.trigger(_.INTERSTITIAL_ASSET_ENDED,{asset:h,assetListIndex:g,event:f,schedule:s.slice(0),scheduleIndex:e,player:v}),o!==this.playingItem){this.itemsMatch(o,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(f,this.findItemIndex(this.playingItem),g);return}this.retreiveMediaSource(m,i),v.media&&!((u=this.detachedData)!=null&&u.mediaSource)&&v.detachMedia()}if(!this.eventItemsMatch(o,i)&&(this.endedItem=o,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${f} ${sr(o)}`),f.hasPlayed=!0,this.hls.trigger(_.INTERSTITIAL_ENDED,{event:f,schedule:s.slice(0),scheduleIndex:e}),f.cue.once)){var d;this.updateSchedule();const g=(d=this.schedule)==null?void 0:d.items;if(i&&g){const x=this.findItemIndex(i);this.advanceSchedule(x,g,t,o,l)}return}}this.advanceSchedule(e,s,t,o,l)}advanceSchedule(e,t,r,s,i){const o=this.schedule;if(!o)return;const l=t[e]||null,u=this.primaryMedia,d=this.playerQueue;if(d.length&&d.forEach(f=>{const h=f.interstitial,m=o.findEventIndex(h.identifier);(m<e||m>e+1)&&this.clearInterstitial(h,l)}),this.isInterstitial(l)){this.timelinePos=Math.min(Math.max(this.timelinePos,l.start),l.end);const f=l.event;if(r===void 0){r=o.findAssetIndex(f,this.timelinePos);const g=cm(f,r-1);if(f.isAssetPastPlayoutLimit(g)||f.appendInPlace&&this.timelinePos===l.end){this.advanceAfterAssetEnded(f,e,r);return}r=g}const h=this.waitingItem;this.assetsBuffered(l,u)||this.setBufferingItem(l);let m=this.preloadAssets(f,r);if(this.eventItemsMatch(l,h||s)||(this.waitingItem=l,this.log(`INTERSTITIAL_STARTED ${sr(l)} ${f.appendInPlace?"append in place":""}`),this.hls.trigger(_.INTERSTITIAL_STARTED,{event:f,schedule:t.slice(0),scheduleIndex:e})),!f.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${f}`);return}if(f.assetListLoader&&(f.assetListLoader.destroy(),f.assetListLoader=void 0),!u){this.log(`Waiting for attachMedia to start Interstitial ${f}`);return}this.waitingItem=this.endedItem=null,this.playingItem=l;const v=f.assetList[r];if(!v){this.advanceAfterAssetEnded(f,e,r||0);return}if(m||(m=this.getAssetPlayer(v.identifier)),m===null||m.destroyed){const g=f.assetList.length;this.warn(`asset ${r+1}/${g} player destroyed ${f}`),m=this.createAssetPlayer(f,v,r),m.loadSource()}if(!this.eventItemsMatch(l,this.bufferingItem)&&f.appendInPlace&&this.isAssetBuffered(v))return;this.startAssetPlayer(m,r,t,e,u),this.shouldPlay&&Cb(m.media)}else l?(this.resumePrimary(l,e,s),this.shouldPlay&&Cb(this.hls.media)):i&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(o.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,r){var s,i;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${sr(e)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let l=this.timelinePos;(l<e.start||l>=e.end)&&(l=this.getPrimaryResumption(e,t),this.log(Ru("resumePrimary",l)),this.timelinePos=l),this.attachPrimary(l,e)}if(!r)return;const o=(i=this.schedule)==null?void 0:i.items;o&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${sr(e)}`),this.hls.trigger(_.INTERSTITIALS_PRIMARY_RESUMED,{schedule:o.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const r=e.start;if(this.primaryLive){const s=this.primaryDetails;if(t===0)return this.hls.startPosition;if(s&&(r<s.fragmentStart||r>s.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Me.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const i=this.hls;i.media?this.checkBuffer():(this.transferMediaTo(i,s),r&&this.startLoadingPrimaryAt(e,r)),r||(this.log(Ru("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,t){var r;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((r=s.mainForwardBufferInfo)==null?void 0:r.start)||s.media.currentTime)-e)>.5?s.startLoad(e,t):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(_.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(_.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const r=this.hls.levels[t.level];if(!r.details)return;const s=et(et({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const r=this.hls.audioTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=et(et({},this.altSelection),{},{audio:r});return}const i=et(et({},s),{},{audio:r});this.mediaSelection=i}onSubtitleTrackUpdated(e,t){const r=this.hls.subtitleTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=et(et({},this.altSelection),{},{subtitles:r});return}const i=et(et({},s),{},{subtitles:r});this.mediaSelection=i}onAudioTrackSwitching(e,t){const r=UT(t);this.playerQueue.forEach(({hls:s})=>s&&(s.setAudioOption(t)||s.setAudioOption(r)))}onSubtitleTrackSwitch(e,t){const r=UT(t);this.playerQueue.forEach(({hls:s})=>s&&(s.setSubtitleOption(t)||t.id!==-1&&s.setSubtitleOption(r)))}onBufferCodecs(e,t){const r=t.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let s=0;s<t.length;s++){const i=t[s];if(i.cue.post){var r;const o=this.schedule.findEventIndex(i.identifier),l=(r=this.schedule.items)==null?void 0:r[o];this.isInterstitial(l)&&this.eventItemsMatch(l,this.bufferingItem)&&this.bufferedToItem(l,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,t){var r;const s=(r=this.schedule)==null?void 0:r.items;if(e&&s){const i=this.findItemIndex(e,t);return s[i]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((i,o)=>{e.event.isAssetPastPlayoutLimit(o)&&this.clearAssetPlayer(i.identifier,null)});const r=e.end+.25,s=Me.bufferInfo(this.primaryMedia,r,0);(s.end>r||(s.nextStart||0)>r)&&(this.log(`trim buffered interstitial ${sr(e)} (was ${sr(t)})`),this.attachPrimary(r,null,!0),this.flushFrontBuffer(r))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var r;return!!t&&(e===t||e.event.identifier===((r=t.event)==null?void 0:r.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const r=this.mediaSelection;r&&((t=this.schedule)==null||t.updateSchedule(r,[],e))}checkBuffer(e){var t;const r=(t=this.schedule)==null?void 0:t.items;if(!r)return;const s=Me.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=s.len<1),this.updateBufferedPos(s.end,r,e)}updateBufferedPos(e,t,r){const s=this.schedule,i=this.bufferingItem;if(this.bufferedPos>e||!s)return;if(t.length===1&&this.itemsMatch(t[0],i)){this.bufferedPos=e;return}const o=this.playingItem,l=this.findItemIndex(o);let u=s.findItemIndexAtTime(e);if(this.bufferedPos<e){var d;const f=this.findItemIndex(i),h=Math.min(f+1,t.length-1),m=t[h];if((u===-1&&i&&e>=i.end||(d=m.event)!=null&&d.appendInPlace&&e+.01>=m.start)&&(u=h),this.isInterstitial(i)){const v=i.event;if(h-l>1&&v.appendInPlace===!1||v.assetList.length===0&&v.assetListLoader)return}if(this.bufferedPos=e,u>f&&u>l)this.bufferedToItem(m);else{const v=this.primaryDetails;this.primaryLive&&v&&e>v.edge-v.targetduration&&m.start<v.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(m)&&this.preloadAssets(m.event,0)}}else r&&o&&!this.itemsMatch(o,i)&&(u===l?this.bufferedToItem(o):u===l+1&&this.bufferedToItem(t[u]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(s=>{const i=this.getAssetPlayer(s.identifier);return!(i!=null&&i.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,r=this.schedule;if(!this.itemsMatch(e,t)&&r){const{items:s,events:i}=r;if(!s||!i)return t;const o=this.isInterstitial(e),l=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const u=l?l.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${sr(e)}`+(t?` (${u.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(o){const d=r.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((f,h)=>{const m=this.getAssetPlayer(f.identifier);m&&(h===d&&m.loadSource(),m.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(d=>d.pauseBuffering());this.hls.trigger(_.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:i.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(r!==null){this.bufferingAsset=null;const s=this.detachedData;s?s.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,t){const r=e.event,s=r.assetList.length===0&&!r.assetListLoader,i=r.cue.once;if(s||!i){const o=this.preloadAssets(r,t);if(o!=null&&o.interstitial.appendInPlace){const l=this.primaryMedia;l&&this.bufferAssetPlayer(o,l)}}}preloadAssets(e,t){const r=e.assetUrl,s=e.assetList.length,i=s===0&&!e.assetListLoader,o=e.cue.once;if(i){const u=e.timelineStart;if(e.appendInPlace){var l;const m=this.playingItem;!this.isInterstitial(m)&&(m==null||(l=m.nextEvent)==null?void 0:l.identifier)===e.identifier&&this.flushFrontBuffer(u+.25)}let d,f=0;if(!this.playingItem&&this.primaryLive&&(f=this.hls.startPosition,f===-1&&(f=this.hls.liveSyncPosition||0)),f&&!(e.cue.pre||e.cue.post)){const m=f-u;m>0&&(d=Math.round(m*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${r?1:s} ${e}${d?` live-start: ${f} start-offset: ${d}`:""}`),r)return this.createAsset(e,0,0,u,e.duration,r);const h=this.assetListLoader.loadAssetList(e,d);h&&(e.assetListLoader=h)}else if(!o&&s){for(let d=t;d<s;d++){const f=e.assetList[d],h=this.getAssetPlayerQueueIndex(f.identifier);(h===-1||this.playerQueue[h].destroyed)&&!f.error&&this.createAssetPlayer(e,f,d)}const u=e.assetList[t];if(u){const d=this.getAssetPlayer(u.identifier);return d&&d.loadSource(),d}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(s=>{this.hls.trigger(_.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let r=0;r<e.length;r++)if(e[r].media===t)return e[r]}return null}createAsset(e,t,r,s,i,o){const l={parentIdentifier:e.identifier,identifier:eH(e,o,t),duration:i,startOffset:r,timelineStart:s,uri:o};return this.createAssetPlayer(e,l,t)}createAssetPlayer(e,t,r){const s=this.hls,i=s.userConfig;let o=i.videoPreference;const l=s.loadLevelObj||s.levels[s.currentLevel];(o||l)&&(o=rt({},o),l.videoCodec&&(o.videoCodec=l.videoCodec),l.videoRange&&(o.allowedVideoRanges=[l.videoRange]));const u=s.audioTracks[s.audioTrack],d=s.subtitleTracks[s.subtitleTrack];let f=0;if(this.primaryLive||e.appendInPlace){const R=this.timelinePos-t.timelineStart;if(R>1){const C=t.duration;C&&R<C&&(f=R)}}const h=t.identifier,m=et(et({},i),{},{maxMaxBufferLength:Math.min(180,s.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:h,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:f,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:u||i.audioPreference,subtitlePreference:d||i.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(m.timelineOffset=t.timelineStart));const v=m.cmcd;v!=null&&v.sessionId&&v.contentId&&(m.cmcd=rt({},v,{contentId:dl(t.uri)})),this.getAssetPlayer(h)&&this.warn(`Duplicate date range identifier ${e} and asset ${h}`);const g=new rH(this.HlsPlayerClass,m,e,t);this.playerQueue.push(g),e.assetList[r]=t;let x=!0;const E=R=>{if(R.live){var C;const N=new Error(`Interstitials MUST be VOD assets ${e}`),M={fatal:!0,type:we.OTHER_ERROR,details:W.INTERSTITIAL_ASSET_ITEM_ERROR,error:N},O=((C=this.schedule)==null?void 0:C.findEventIndex(e.identifier))||-1;this.handleAssetItemError(M,e,O,r,N.message);return}const F=R.edge-R.fragmentStart,k=t.duration;(x||k===null||F>k)&&(x=!1,this.log(`Interstitial asset "${h}" duration change ${k} > ${F}`),t.duration=F,this.updateSchedule())};g.on(_.LEVEL_UPDATED,(R,{details:C})=>E(C)),g.on(_.LEVEL_PTS_UPDATED,(R,{details:C})=>E(C)),g.on(_.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const b=(R,C)=>{const F=this.getAssetPlayer(h);if(F&&C.tracks){F.off(_.BUFFER_CODECS,b),F.tracks=C.tracks;const k=this.primaryMedia;this.bufferingAsset===F.assetItem&&k&&!F.media&&this.bufferAssetPlayer(F,k)}};g.on(_.BUFFER_CODECS,b);const I=()=>{var R;const C=this.getAssetPlayer(h);if(this.log(`buffered to end of asset ${C}`),!C||!this.schedule)return;const F=this.schedule.findEventIndex(e.identifier),k=(R=this.schedule.items)==null?void 0:R[F];this.isInterstitial(k)&&this.advanceAssetBuffering(k,t)};g.on(_.BUFFERED_TO_END,I);const A=R=>()=>{if(!this.getAssetPlayer(h)||!this.schedule)return;this.shouldPlay=!0;const F=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,F,R)};return g.once(_.MEDIA_ENDED,A(r)),g.once(_.PLAYOUT_LIMIT_REACHED,A(1/0)),g.on(_.ERROR,(R,C)=>{if(!this.schedule)return;const F=this.getAssetPlayer(h);if(C.details===W.BUFFER_STALLED_ERROR){if(F!=null&&F.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(C,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${C.error} ${e}`)}),g.on(_.DESTROYING,()=>{if(!this.getAssetPlayer(h)||!this.schedule)return;const C=new Error(`Asset player destroyed unexpectedly ${h}`),F={fatal:!0,type:we.OTHER_ERROR,details:W.INTERSTITIAL_ASSET_ITEM_ERROR,error:C};this.handleAssetItemError(F,e,this.schedule.findEventIndex(e.identifier),r,C.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${bo(t)}`),this.hls.trigger(_.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:g}),g}clearInterstitial(e,t){this.clearAssetPlayers(e,t),e.reset()}clearAssetPlayers(e,t){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,t)})}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,t){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){const s=this.playerQueue[r];this.log(`clear ${s} toSegment: ${t&&sr(t)}`),this.transferMediaFromPlayer(s,t),this.playerQueue.splice(r,1),s.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,r,s,i){const{interstitial:o,assetItem:l,assetId:u}=e,d=o.assetList.length,f=this.playingAsset;this.endedAsset=null,this.playingAsset=l,(!f||f.identifier!==u)&&(f&&(this.clearAssetPlayer(f.identifier,r[s]),delete f.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${d} ${bo(l)}`),this.hls.trigger(_.INTERSTITIAL_ASSET_STARTED,{asset:l,assetListIndex:t,event:o,schedule:r.slice(0),scheduleIndex:s,player:e})),this.bufferAssetPlayer(e,i)}bufferAssetPlayer(e,t){var r,s;if(!this.schedule)return;const{interstitial:i,assetItem:o}=e,l=this.schedule.findEventIndex(i.identifier),u=(r=this.schedule.items)==null?void 0:r[l];if(!u)return;e.loadSource(),this.setBufferingItem(u),this.bufferingAsset=o;const d=this.getBufferingPlayer();if(d===e)return;const f=i.appendInPlace;if(f&&d?.interstitial.appendInPlace===!1)return;const h=d?.tracks||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(f&&o!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(h&&!t_(h,e.tracks)){const m=new Error(`Asset ${bo(o)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(h)}')`),v={fatal:!0,type:we.OTHER_ERROR,details:W.INTERSTITIAL_ASSET_ITEM_ERROR,error:m},g=i.findAssetIndex(o);this.handleAssetItemError(v,i,l,g,m.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,r=this.primaryMedia;if(!t||!r)return;const s=r.currentTime,i=t.findAssetIndex(e,s),o=e.assetList[i];if(o){const l=this.getAssetPlayer(o.identifier);if(l){const u=l.currentTime||s-o.timelineStart,d=l.duration-u;if(this.warn(`Stalled at ${u} of ${u+d} in ${l} ${e} (media.currentTime: ${s})`),u&&(d/r.playbackRate<.5||l.bufferedInPlaceToEnd(r))&&l.hls){const f=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,f,i)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,r,s,i){if(e.details===W.BUFFER_STALLED_ERROR)return;const o=t.assetList[s]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${o&&bo(o)} ${e.error}`),!this.schedule)return;const l=o?.identifier||"",u=this.getAssetPlayerQueueIndex(l),d=this.playerQueue[u]||null,f=this.schedule.items,h=rt({},e,{fatal:!1,errorAction:Do(!0),asset:o,assetListIndex:s,event:t,schedule:f,scheduleIndex:r,player:d});if(this.hls.trigger(_.INTERSTITIAL_ASSET_ERROR,h),!e.fatal)return;const m=this.playingAsset,v=this.bufferingAsset,g=new Error(i);if(o&&(this.clearAssetPlayer(l,null),o.error=g),!t.assetList.some(x=>!x.error))t.error=g;else for(let x=s;x<t.assetList.length;x++)this.resetAssetPlayer(t.assetList[x].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):m&&m.identifier===l?this.advanceAfterAssetEnded(t,r,s):v&&v.identifier===l&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,v)}primaryFallback(e){const t=e.timelineStart,r=this.effectivePlayingItem;let s=this.timelinePos;if(r){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${s} playing: ${sr(r)} error: ${e.error}`),s===-1&&(s=this.hls.startPosition);const o=this.updateItem(r,s);this.itemsMatch(r,o)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}else if(s===-1){this.checkStart();return}if(!this.schedule)return;const i=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(i)}onAssetListLoaded(e,t){var r,s;const i=t.event,o=i.identifier,l=t.assetListResponse.ASSETS;if(!((r=this.schedule)!=null&&r.hasEvent(o)))return;const u=i.timelineStart,d=i.duration;let f=0;l.forEach((x,E)=>{const b=parseFloat(x.DURATION);this.createAsset(i,E,f,u+f,b,x.URI),f+=b}),i.duration=f,this.log(`Loaded asset-list with duration: ${f} (was: ${d}) ${i}`);const h=this.waitingItem,m=h?.event.identifier===o;this.updateSchedule();const v=(s=this.bufferingItem)==null?void 0:s.event;if(m){var g;const x=this.schedule.findEventIndex(o),E=(g=this.schedule.items)==null?void 0:g[x];if(E){if(!this.playingItem&&this.timelinePos>E.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==x){i.error=new Error(`Interstitial ${l.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${i}`),this.log(i.error.message),this.updateSchedule(!0),this.primaryFallback(i);return}this.setBufferingItem(E)}this.setSchedulePosition(x)}else if(v?.identifier===o){const x=i.assetList[0];if(x){const E=this.getAssetPlayer(x.identifier);if(v.appendInPlace){const b=this.primaryMedia;E&&b&&this.bufferAssetPlayer(E,b)}else E&&E.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case W.ASSET_LIST_PARSING_ERROR:case W.ASSET_LIST_LOAD_ERROR:case W.ASSET_LIST_LOAD_TIMEOUT:{const r=t.interstitial;r&&(this.updateSchedule(!0),this.primaryFallback(r));break}case W.BUFFER_STALLED_ERROR:{const r=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&r.event.appendInPlace){this.handleInPlaceStall(r.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const kb=500;class aH extends Y0{constructor(e,t,r){super(e,t,r,"subtitle-stream-controller",ge.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(_.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(_.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=re.IDLE,this.setInterval(kb),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:s}=t;if(this.fragContextChanged(r)||(wt(r)&&(this.fragPrevious=r),this.state=re.IDLE),!s)return;const i=this.tracksBuffered[this.currentTrackId];if(!i)return;let o;const l=r.start;for(let d=0;d<i.length;d++)if(l>=i[d].start&&l<=i[d].end){o=i[d];break}const u=r.start+r.duration;o?o.end=u:(o={start:l,end:u},i.push(o)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:r,endOffset:s}=t;if(r===0&&s!==Number.POSITIVE_INFINITY){const i=s-1;if(i<=0)return;t.endOffsetSubtitles=Math.max(0,i),this.tracksBuffered.forEach(o=>{for(let l=0;l<o.length;){if(o[l].end<=i){o.shift();continue}else if(o[l].start<i)o[l].start=i;else break;l++}}),this.fragmentTracker.removeFragmentsInRange(r,i,ge.SUBTITLE)}}onError(e,t){const r=t.frag;r?.type===ge.SUBTITLE&&(t.details===W.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==re.STOPPED&&(this.state=re.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&sR(this.levels,t)){this.levels=t.map(r=>new Il(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const s=new Il(r);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ge.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==re.STOPPED&&this.setInterval(kb)}onSubtitleTrackLoaded(e,t){var r;const{currentTrackId:s,levels:i}=this,{details:o,id:l}=t;if(!i){this.warn(`Subtitle tracks were reset while loading level ${l}`);return}const u=i[l];if(l>=i.length||!u)return;this.log(`Subtitle track ${l} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(o.live||(r=u.details)!=null&&r.live){if(o.deltaUpdateFailed)return;const h=this.mainDetails;if(!h){this.startFragRequested=!1;return}const m=h.fragments[0];if(!u.details)o.hasProgramDateTime&&h.hasProgramDateTime?(Od(o,h),d=o.fragmentStart):m&&(d=m.start,gg(o,d));else{var f;d=this.alignPlaylists(o,u.details,(f=this.levelLastLoaded)==null?void 0:f.details),d===0&&m&&(d=m.start,gg(o,d))}h&&!this.startFragRequested&&this.setStartPosition(h,d)}u.details=o,this.levelLastLoaded=u,l===s&&(this.hls.trigger(_.SUBTITLE_TRACK_UPDATED,{details:o,id:l,groupId:t.groupId}),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===re.IDLE&&(ji(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),u.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,s=t.decryptdata,i=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&s!=null&&s.key&&s.iv&&No(s.method)){const o=performance.now();this.decrypter.decrypt(new Uint8Array(r),s.key.buffer,s.iv.buffer,W0(s.method)).catch(l=>{throw i.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:t}),l}).then(l=>{const u=performance.now();i.trigger(_.FRAG_DECRYPTED,{frag:t,payload:l,stats:{tstart:o,tdecrypt:u}})}).catch(l=>{this.warn(`${l.name}: ${l.message}`),this.state=re.IDLE})}}doTick(){if(!this.media){this.state=re.IDLE;return}if(this.state===re.IDLE){const{currentTrackId:e,levels:t}=this,r=t?.[e];if(!r||!t.length||!r.details||this.waitForLive(r))return;const{config:s}=this,i=this.getLoadPosition(),o=Me.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,s.maxBufferHole),{end:l,len:u}=o,d=r.details,f=this.hls.maxBufferLength+d.levelTargetDuration;if(u>f)return;const h=d.fragments,m=h.length,v=d.edge;let g=null;const x=this.fragPrevious;if(l<v){const I=s.maxFragLookUpTolerance,A=l>v-I?0:I;g=ji(x,h,Math.max(h[0].start,l),A),!g&&x&&x.start<h[0].start&&(g=h[0])}else g=h[m-1];if(g=this.filterReplacedPrimary(g,r.details),!g)return;const E=g.sn-d.startSN,b=h[E-1];if(b&&b.cc===g.cc&&this.fragmentTracker.getState(b)===Pt.NOT_LOADED&&(g=b),this.fragmentTracker.getState(g)===Pt.NOT_LOADED){const I=this.mapToInitFragWhenRequired(g);I&&this.loadFragment(I,r,l)}}}loadFragment(e,t,r){wt(e)?super.loadFragment(e,t,r):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new lH(this.tracksBuffered[this.currentTrackId]||[])}}class lH{constructor(e){this.buffered=void 0;const t=(r,s,i)=>{if(s=s>>>0,s>i-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${i})`);return e[s][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}const cH={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},ER=n=>String.fromCharCode(cH[n]||n),ir=15,qr=100,uH={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},dH={17:2,18:4,21:6,22:8,23:10,19:13,20:15},fH={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},hH={25:2,26:4,29:6,30:8,31:10,27:13,28:15},pH=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class mH{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;tt.log(`${this.time} [${e}] ${r}`)}}}const Ei=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class SR{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const s=t[r];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class gH{constructor(){this.uchar=" ",this.penState=new SR}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class yH{constructor(e){this.chars=[],this.pos=0,this.currPenState=new SR,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<qr;t++)this.chars.push(new gH);this.logger=e}equals(e){for(let t=0;t<qr;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<qr;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<qr;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>qr&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=qr)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=ER(e);if(this.pos>=qr){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<qr;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<qr;r++){const s=this.chars[r].uchar;s!==" "&&(t=!1),e.push(s)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class um{constructor(e){this.rows=[],this.currRow=ir-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<ir;t++)this.rows.push(new yH(e));this.logger=e}reset(){for(let e=0;e<ir;e++)this.rows[e].clear();this.currRow=ir-1}equals(e){let t=!0;for(let r=0;r<ir;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<ir;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<ir;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+ot(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let l=0;l<ir;l++)this.rows[l].clear();const i=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const l=o.rows[i].cueStartTime,u=this.logger.time;if(l!==null&&u!==null&&l<u)for(let d=0;d<this.nrRollUpRows;d++)this.rows[t-this.nrRollUpRows+d+1].copy(o.rows[i+d])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const i=e.indent,o=Math.max(i-1,0);r.setCursor(e.indent),e.color=r.chars[o].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+ot(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",s=-1;for(let i=0;i<ir;i++){const o=this.rows[i].getTextString();o&&(s=i+1,e?t.push("Row "+s+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class Pb{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new um(r),this.nonDisplayedMemory=new um(r),this.lastOutputScreen=new um(r),this.currRollUpRow=this.displayedMemory.rows[ir-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[ir-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=s[r]}this.logger.log(2,"MIDROW: "+ot(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Db{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=xH(),this.logger=void 0;const s=this.logger=new mH;this.channels=[null,new Pb(e,t,s),new Pb(e+1,r,s)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let r=0;r<t.length;r+=2){const s=t[r]&127,i=t[r+1]&127;let o=!1,l=null;if(s===0&&i===0)continue;this.logger.log(3,()=>"["+Ei([t[r],t[r+1]])+"] -> ("+Ei([s,i])+")");const u=this.cmdHistory;if(s>=16&&s<=31){if(vH(s,i,u)){Lu(null,null,u),this.logger.log(3,()=>"Repeated command ("+Ei([s,i])+") is dropped");continue}Lu(s,i,this.cmdHistory),o=this.parseCmd(s,i),o||(o=this.parseMidrow(s,i)),o||(o=this.parsePAC(s,i)),o||(o=this.parseBackgroundAttributes(s,i))}else Lu(null,null,u);if(!o&&(l=this.parseChars(s,i),l)){const f=this.currentChannel;f&&f>0?this.channels[f].insertChars(l):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!l&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Ei([s,i])+" orig: "+Ei([t[r],t[r+1]]))}}parseCmd(e,t){const r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(r||s))return!1;const i=e===20||e===21||e===23?1:2,o=this.channels[i];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=i,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[r];return s?(s.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Ei([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,i=(e===16||e===24)&&t>=64&&t<=95;if(!(s||i))return!1;const o=e<=23?1:2;t>=64&&t<=95?r=o===1?uH[e]:fH[e]:r=o===1?dH[e]:hH[e];const l=this.channels[o];return l?(l.setPAC(this.interpretPAC(r,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let r;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,s.underline=(r&1)===1,r<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((r-16)/2)*4,s}parseChars(e,t){let r,s=null,i=null;if(e>=25?(r=2,i=e-8):(r=1,i=e),i>=17&&i<=19){let o;i===17?o=t+80:i===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+ER(o)+"' in channel "+r),s=[o]}else e>=32&&e<=127&&(s=t===0?[e]:[e,t]);return s&&this.logger.log(3,()=>"Char codes =  "+Ei(s).join(",")),s}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=45&&t<=47;if(!(r||s))return!1;let i;const o={};e===16||e===24?(i=Math.floor((t-32)/2),o.background=pH[i],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const l=e<=23?1:2;return this.channels[l].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Lu(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function Lu(n,e,t){t.a=n,t.b=e}function vH(n,e,t){return t.a===n&&t.b===e}function xH(){return{a:null,b:null}}var oy=(function(){if(Nd!=null&&Nd.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(l,u){if(typeof u!="string"||!Array.isArray(l))return!1;const d=u.toLowerCase();return~l.indexOf(d)?d:!1}function r(l){return t(n,l)}function s(l){return t(e,l)}function i(l,...u){let d=1;for(;d<arguments.length;d++){const f=arguments[d];for(const h in f)l[h]=f[h]}return l}function o(l,u,d){const f=this,h={enumerable:!0};f.hasBeenReset=!1;let m="",v=!1,g=l,x=u,E=d,b=null,I="",A=!0,R="auto",C="start",F=50,k="middle",N=50,M="middle";Object.defineProperty(f,"id",i({},h,{get:function(){return m},set:function(O){m=""+O}})),Object.defineProperty(f,"pauseOnExit",i({},h,{get:function(){return v},set:function(O){v=!!O}})),Object.defineProperty(f,"startTime",i({},h,{get:function(){return g},set:function(O){if(typeof O!="number")throw new TypeError("Start time must be set to a number.");g=O,this.hasBeenReset=!0}})),Object.defineProperty(f,"endTime",i({},h,{get:function(){return x},set:function(O){if(typeof O!="number")throw new TypeError("End time must be set to a number.");x=O,this.hasBeenReset=!0}})),Object.defineProperty(f,"text",i({},h,{get:function(){return E},set:function(O){E=""+O,this.hasBeenReset=!0}})),Object.defineProperty(f,"region",i({},h,{get:function(){return b},set:function(O){b=O,this.hasBeenReset=!0}})),Object.defineProperty(f,"vertical",i({},h,{get:function(){return I},set:function(O){const H=r(O);if(H===!1)throw new SyntaxError("An invalid or illegal string was specified.");I=H,this.hasBeenReset=!0}})),Object.defineProperty(f,"snapToLines",i({},h,{get:function(){return A},set:function(O){A=!!O,this.hasBeenReset=!0}})),Object.defineProperty(f,"line",i({},h,{get:function(){return R},set:function(O){if(typeof O!="number"&&O!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");R=O,this.hasBeenReset=!0}})),Object.defineProperty(f,"lineAlign",i({},h,{get:function(){return C},set:function(O){const H=s(O);if(!H)throw new SyntaxError("An invalid or illegal string was specified.");C=H,this.hasBeenReset=!0}})),Object.defineProperty(f,"position",i({},h,{get:function(){return F},set:function(O){if(O<0||O>100)throw new Error("Position must be between 0 and 100.");F=O,this.hasBeenReset=!0}})),Object.defineProperty(f,"positionAlign",i({},h,{get:function(){return k},set:function(O){const H=s(O);if(!H)throw new SyntaxError("An invalid or illegal string was specified.");k=H,this.hasBeenReset=!0}})),Object.defineProperty(f,"size",i({},h,{get:function(){return N},set:function(O){if(O<0||O>100)throw new Error("Size must be between 0 and 100.");N=O,this.hasBeenReset=!0}})),Object.defineProperty(f,"align",i({},h,{get:function(){return M},set:function(O){const H=s(O);if(!H)throw new SyntaxError("An invalid or illegal string was specified.");M=H,this.hasBeenReset=!0}})),f.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o})();class EH{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function TR(n){function e(r,s,i,o){return(r|0)*3600+(s|0)*60+(i|0)+parseFloat(o||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class SH{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let s=0;s<r.length;++s)if(t===r[s]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function bR(n,e,t,r){const s=r?n.split(r):[n];for(const i in s){if(typeof s[i]!="string")continue;const o=s[i].split(t);if(o.length!==2)continue;const l=o[0],u=o[1];e(l,u)}}const wg=new oy(0,0,""),Cu=wg.align==="middle"?"middle":"center";function TH(n,e,t){const r=n;function s(){const l=TR(n);if(l===null)throw new Error("Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),l}function i(l,u){const d=new SH;bR(l,function(m,v){let g;switch(m){case"region":for(let x=t.length-1;x>=0;x--)if(t[x].id===v){d.set(m,t[x].region);break}break;case"vertical":d.alt(m,v,["rl","lr"]);break;case"line":g=v.split(","),d.integer(m,g[0]),d.percent(m,g[0])&&d.set("snapToLines",!1),d.alt(m,g[0],["auto"]),g.length===2&&d.alt("lineAlign",g[1],["start",Cu,"end"]);break;case"position":g=v.split(","),d.percent(m,g[0]),g.length===2&&d.alt("positionAlign",g[1],["start",Cu,"end","line-left","line-right","auto"]);break;case"size":d.percent(m,v);break;case"align":d.alt(m,v,["start",Cu,"end","left","right"]);break}},/:/,/\s/),u.region=d.get("region",null),u.vertical=d.get("vertical","");let f=d.get("line","auto");f==="auto"&&wg.line===-1&&(f=-1),u.line=f,u.lineAlign=d.get("lineAlign","start"),u.snapToLines=d.get("snapToLines",!0),u.size=d.get("size",100),u.align=d.get("align",Cu);let h=d.get("position","auto");h==="auto"&&wg.position===50&&(h=u.align==="start"||u.align==="left"?0:u.align==="end"||u.align==="right"?100:50),u.position=h}function o(){n=n.replace(/^\s+/,"")}if(o(),e.startTime=s(),o(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);n=n.slice(3),o(),e.endTime=s(),o(),i(n,e)}function wR(n){return n.replace(/<br(?: \/)?>/gi,`
`)}class bH{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new EH,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let i=t.buffer,o=0;for(i=wR(i);o<i.length&&i[o]!=="\r"&&i[o]!==`
`;)++o;const l=i.slice(0,o);return i[o]==="\r"&&++o,i[o]===`
`&&++o,t.buffer=i.slice(o),l}function s(i){bR(i,function(o,l){},/:/)}try{let i="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;i=r();const l=i.match(/^()?WEBVTT([ \t].*)?$/);if(!(l!=null&&l[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:i=r(),t.state){case"HEADER":/:/.test(i)?s(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new oy(0,0,""),t.state="CUE",i.indexOf("-->")===-1){t.cue.id=i;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{TH(i,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const l=i.indexOf("-->")!==-1;if(!i||l&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=i}continue;case"BADCUE":i||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const wH=/\r\n|\n\r|\n|\r/g,dm=function(e,t,r=0){return e.slice(r,r+t.length)===t},IH=function(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!he(t)||!he(r)||!he(s)||!he(i))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*s,t+=3600*1e3*i,t};function ay(n,e,t){return dl(n.toString())+dl(e.toString())+dl(t)}const AH=function(e,t,r){let s=e[t],i=e[s.prevCC];if(!i||!i.new&&s.new){e.ccOffset=e.presentationOffset=s.start,s.new=!1;return}for(;(o=i)!=null&&o.new;){var o;e.ccOffset+=s.start-i.start,s.new=!1,s=i,i=e[s.prevCC]}e.presentationOffset=r};function _H(n,e,t,r,s,i,o){const l=new bH,u=Dn(new Uint8Array(n)).trim().replace(wH,`
`).split(`
`),d=[],f=e?DV(e.baseTime,e.timescale):0;let h="00:00.000",m=0,v=0,g,x=!0;l.oncue=function(E){const b=t[r];let I=t.ccOffset;const A=(m-f)/9e4;if(b!=null&&b.new&&(v!==void 0?I=t.ccOffset=b.start:AH(t,r,A)),A){if(!e){g=new Error("Missing initPTS for VTT MPEGTS");return}I=A-t.presentationOffset}const R=E.endTime-E.startTime,C=Rn((E.startTime+I-v)*9e4,s*9e4)/9e4;E.startTime=Math.max(C,0),E.endTime=Math.max(C+R,0);const F=E.text.trim();E.text=decodeURIComponent(encodeURIComponent(F)),E.id||(E.id=ay(E.startTime,E.endTime,F)),E.endTime>0&&d.push(E)},l.onparsingerror=function(E){g=E},l.onflush=function(){if(g){o(g);return}i(d)},u.forEach(E=>{if(x)if(dm(E,"X-TIMESTAMP-MAP=")){x=!1,E.slice(16).split(",").forEach(b=>{dm(b,"LOCAL:")?h=b.slice(6):dm(b,"MPEGTS:")&&(m=parseInt(b.slice(7)))});try{v=IH(h)/1e3}catch(b){g=b}return}else E===""&&(x=!1);l.parse(E+`
`)}),l.flush()}const fm="stpp.ttml.im1t",IR=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,AR=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,RH={left:"start",center:"center",right:"end",start:"start",end:"end"};function Nb(n,e,t,r){const s=$e(new Uint8Array(n),["mdat"]);if(s.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const i=s.map(l=>Dn(l)),o=PV(e.baseTime,1,e.timescale);try{i.forEach(l=>t(LH(l,o)))}catch(l){r(l)}}function LH(n,e){const s=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(i).reduce((h,m)=>(h[m]=s.getAttribute(`ttp:${m}`)||i[m],h),{}),l=s.getAttribute("xml:space")!=="preserve",u=Ob(hm(s,"styling","style")),d=Ob(hm(s,"layout","region")),f=hm(s,"body","[begin]");return[].map.call(f,h=>{const m=_R(h,l);if(!m||!h.hasAttribute("begin"))return null;const v=mm(h.getAttribute("begin"),o),g=mm(h.getAttribute("dur"),o);let x=mm(h.getAttribute("end"),o);if(v===null)throw Mb(h);if(x===null){if(g===null)throw Mb(h);x=v+g}const E=new oy(v-e,x-e,m);E.id=ay(E.startTime,E.endTime,E.text);const b=d[h.getAttribute("region")],I=u[h.getAttribute("style")],A=CH(b,I,u),{textAlign:R}=A;if(R){const C=RH[R];C&&(E.lineAlign=C),E.align=R}return rt(E,A),E}).filter(h=>h!==null)}function hm(n,e,t){const r=n.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function Ob(n){return n.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function _R(n,e){return[].slice.call(n.childNodes).reduce((t,r,s)=>{var i;return r.nodeName==="br"&&s?t+`
`:(i=r.childNodes)!=null&&i.length?_R(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function CH(n,e,t){const r="http://www.w3.org/ns/ttml#styling";let s=null;const i=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(s=t[o]),i.reduce((l,u)=>{const d=pm(e,r,u)||pm(n,r,u)||pm(s,r,u);return d&&(l[u]=d),l},{})}function pm(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function Mb(n){return new Error(`Could not parse ttml timestamp ${n}`)}function mm(n,e){if(!n)return null;let t=TR(n);return t===null&&(IR.test(n)?t=kH(n,e):AR.test(n)&&(t=PH(n,e))),t}function kH(n,e){const t=IR.exec(n),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function PH(n,e){const t=AR.exec(n),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class ku{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class DH{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Bb(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(_.FRAG_LOADING,this.onFragLoading,this),e.on(_.FRAG_LOADED,this.onFragLoaded,this),e.on(_.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(_.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(_.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(_.FRAG_LOADING,this.onFragLoading,this),e.off(_.FRAG_LOADED,this.onFragLoaded,this),e.off(_.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(_.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(_.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new ku(this,"textTrack1"),t=new ku(this,"textTrack2"),r=new ku(this,"textTrack3"),s=new ku(this,"textTrack4");this.cea608Parser1=new Db(1,e,t),this.cea608Parser2=new Db(3,r,s)}addCues(e,t,r,s,i){let o=!1;for(let l=i.length;l--;){const u=i[l],d=NH(u[0],u[1],t,r);if(d>=0&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],r),o=!0,d/(r-t)>.5))return}if(o||i.push([t,r]),this.config.renderTextTracksNatively){const l=this.captionsTracks[e];this.Cues.newCue(l,t,r,s)}else{const l=this.Cues.newCue(null,t,r,s);this.hls.trigger(_.CUES_PARSED,{type:"captions",cues:l,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:i,trackId:o}){const{unparsedVttFrags:l}=this;r===ge.MAIN&&(this.initPTS[t.cc]={baseTime:s,timescale:i,trackId:o}),l.length&&(this.unparsedVttFrags=[],l.forEach(u=>{this.initPTS[u.frag.cc]?this.onFragLoaded(_.FRAG_LOADED,u):this.hls.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:u.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:r}=this;if(r)for(let s=0;s<r.textTracks.length;s++){const i=r.textTracks[s];if(Fb(i,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:s}=this,{label:i,languageCode:o}=t[e],l=this.getExistingTrack(i,o);if(l)r[e]=l,Ro(r[e]),yR(r[e],s);else{const u=this.createTextTrack("captions",i,o);u&&(u[e]=!0,r[e]=u)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,s={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=s,this.hls.trigger(_.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(e,t,r){const s=this.media;if(s)return s.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const r=!!t.transferMedia;if(this.media=null,r)return;const{captionsTracks:s}=this;Object.keys(s).forEach(i=>{Ro(s[i]),delete s[i]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Bb(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)Ro(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],s=r.some(i=>i.textCodec===fm);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(sR(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const o=this.media,l=o?ed(o.textTracks):null;if(this.tracks.forEach((u,d)=>{let f;if(l){let h=null;for(let m=0;m<l.length;m++)if(l[m]&&Fb(l[m],u)){h=l[m],l[m]=null;break}h&&(f=h)}if(f)Ro(f);else{const h=RR(u);f=this.createTextTrack(h,u.name,u.lang),f&&(f.mode="disabled")}f&&this.textTracks.push(f)}),l!=null&&l.length){const u=l.filter(d=>d!==null).map(d=>d.label);u.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${u.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(l=>({label:l.name,kind:l.type.toLowerCase(),default:l.default,subtitleTrack:l}));this.hls.trigger(_.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const s=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!s)return;const i=`textTrack${s[1]}`,o=this.captionsProperties[i];o&&(o.label=r.name,r.lang&&(o.languageCode=r.lang),o.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ge.MAIN){var r,s;const{cea608Parser1:i,cea608Parser2:o,lastSn:l}=this,{cc:u,sn:d}=t.frag,f=(r=(s=t.part)==null?void 0:s.index)!=null?r:-1;i&&o&&(d!==l+1||d===l&&f!==this.lastPartIndex+1||u!==this.lastCc)&&(i.reset(),o.reset()),this.lastCc=u,this.lastSn=d,this.lastPartIndex=f}}onFragLoaded(e,t){const{frag:r,payload:s}=t;if(r.type===ge.SUBTITLE)if(s.byteLength){const i=r.decryptdata,o="stats"in t;if(i==null||!i.encrypted||o){const l=this.tracks[r.level],u=this.vttCCs;u[r.cc]||(u[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),l&&l.textCodec===fm?this._parseIMSC1(r,s):this._parseVTTs(t)}}else this.hls.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;Nb(t,this.initPTS[e.cc],s=>{this._appendCues(s,e.level),r.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},s=>{r.logger.log(`Failed to parse IMSC1: ${s}`),r.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:s})})}_parseVTTs(e){var t;const{frag:r,payload:s}=e,{initPTS:i,unparsedVttFrags:o}=this,l=i.length-1;if(!i[r.cc]&&l===-1){o.push(e);return}const u=this.hls,d=(t=r.initSegment)!=null&&t.data?qn(r.initSegment.data,new Uint8Array(s)).buffer:s;_H(d,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,f=>{this._appendCues(f,r.level),u.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},f=>{const h=f.message==="Missing initPTS for VTT MPEGTS";h?o.push(e):this._fallbackToIMSC1(r,s),u.logger.log(`Failed to parse VTT cue: ${f}`),!(h&&l>r.cc)&&u.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:f})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||Nb(t,this.initPTS[e.cc],()=>{r.textCodec=fm,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[t];if(!s||s.mode==="disabled")return;e.forEach(i=>vR(s,i))}else{const s=this.tracks[t];if(!s)return;const i=s.default?"default":"subtitles"+t;r.trigger(_.CUES_PARSED,{type:"subtitles",cues:e,track:i})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===ge.SUBTITLE&&this.onFragLoaded(_.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:s}=t;if(!(r.type===ge.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let i=0;i<s.length;i++){const o=s[i].bytes;if(o){this.cea608Parser1||this.initCea608Parsers();const l=this.extractCea608Data(o);this.cea608Parser1.addData(s[i].pts,l[0]),this.cea608Parser2.addData(s[i].pts,l[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:s,type:i}){const{media:o}=this;if(!(!o||o.currentTime<r)){if(!i||i==="video"){const{captionsTracks:l}=this;Object.keys(l).forEach(u=>bg(l[u],t,r))}if(this.config.renderTextTracksNatively&&t===0&&s!==void 0){const{textTracks:l}=this;Object.keys(l).forEach(u=>bg(l[u],t,s))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let s=2;for(let i=0;i<r;i++){const o=e[s++],l=127&e[s++],u=127&e[s++];if(l===0&&u===0)continue;if((4&o)!==0){const f=3&o;(f===0||f===1)&&(t[f].push(l),t[f].push(u))}}return t}}function RR(n){return n.characteristics&&/transcribes-spoken-dialog/gi.test(n.characteristics)&&/describes-music-and-sound/gi.test(n.characteristics)?"captions":"subtitles"}function Fb(n,e){return!!n&&n.kind===RR(e)&&xg(e,n)}function NH(n,e,t,r){return Math.min(e,r)-Math.max(n,t)}function Bb(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const OH=/\s/,MH={newCue(n,e,t,r){const s=[];let i,o,l,u,d;const f=self.VTTCue||self.TextTrackCue;for(let m=0;m<r.rows.length;m++)if(i=r.rows[m],l=!0,u=0,d="",!i.isEmpty()){var h;for(let x=0;x<i.chars.length;x++)OH.test(i.chars[x].uchar)&&l?u++:(d+=i.chars[x].uchar,l=!1);i.cueStartTime=e,e===t&&(t+=1e-4),u>=16?u--:u++;const v=wR(d.trim()),g=ay(e,t,v);n!=null&&(h=n.cues)!=null&&h.getCueById(g)||(o=new f(e,t,v),o.id=g,o.line=m+1,o.align="left",o.position=10+Math.min(80,Math.floor(u*8/32)*10),s.push(o))}return n&&s.length&&(s.sort((m,v)=>m.line==="auto"||v.line==="auto"?0:m.line>8&&v.line>8?v.line-m.line:m.line-v.line),s.forEach(m=>vR(n,m))),s}};function FH(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const BH=/(\d+)-(\d+)\/(\d+)/;class Ub{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||VH,this.controller=new self.AbortController,this.stats=new U0}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const i=UH(e,this.controller.signal),o=e.responseType==="arraybuffer",l=o?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),t.timeout=u&&he(u)?u:d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},t.timeout),(Rl(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(h=>{var m;this.response=this.loader=h;const v=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},d-(v-s.loading.start)),!h.ok){const{status:x,statusText:E}=h;throw new GH(E||"fetch, bad network response",x,h)}s.loading.first=v,s.total=jH(h.headers)||s.total;const g=(m=this.callbacks)==null?void 0:m.onProgress;return g&&he(t.highWaterMark)?this.loadProgressively(h,s,e,t.highWaterMark,g):o?h.arrayBuffer():e.responseType==="json"?h.json():h.text()}).then(h=>{var m,v;const g=this.response;if(!g)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const x=h[l];x&&(s.loaded=s.total=x);const E={url:g.url,data:h,code:g.status},b=(m=this.callbacks)==null?void 0:m.onProgress;b&&!he(t.highWaterMark)&&b(s,e,h,g),(v=this.callbacks)==null||v.onSuccess(E,s,e,g)}).catch(h=>{var m;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const v=h&&h.code||0,g=h?h.message:null;(m=this.callbacks)==null||m.onError({code:v,text:g},e,h?h.details:null,s)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,s=0,i){const o=new B_,l=e.body.getReader(),u=()=>l.read().then(d=>{if(d.done)return o.dataLength&&i(t,r,o.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const f=d.value,h=f.length;return t.loaded+=h,h<s||o.dataLength?(o.push(f),o.dataLength>=s&&i(t,r,o.flush().buffer,e)):i(t,r,f.buffer,e),u()}).catch(()=>Promise.reject());return u()}}function UH(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(rt({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function $H(n){const e=BH.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function jH(n){const e=n.get("Content-Range");if(e){const r=$H(e);if(he(r))return r}const t=n.get("Content-Length");if(t)return parseInt(t)}function VH(n,e){return new self.Request(n.url,e)}class GH extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const HH=/^age:\s*[\d.]+\s*$/im;class LR{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new U0,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const r=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const i=this.xhrSetup;i?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return i(r,t.url)}).catch(o=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",t.url,!0),i(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(o=>{var l;(l=this.callbacks)==null||l.onError({code:r.status,text:o.message},t,r,s)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const s=t.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:o}=r.loadPolicy;if(s)for(const l in s)e.setRequestHeader(l,s[l]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=i&&he(i)?i:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const s=t.readyState,i=this.config;if(!r.aborted&&s>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const d=t.status,f=t.responseType==="text"?t.responseText:null;if(d>=200&&d<300){const g=f??t.response;if(g!=null){var o,l;r.loading.end=Math.max(self.performance.now(),r.loading.first);const x=t.responseType==="arraybuffer"?g.byteLength:g.length;r.loaded=r.total=x,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first);const E=(o=this.callbacks)==null?void 0:o.onProgress;E&&E(r,e,g,t);const b={url:t.responseURL,data:g,code:d};(l=this.callbacks)==null||l.onSuccess(b,r,e,t);return}}const h=i.loadPolicy.errorRetry,m=r.retry,v={url:e.url,data:void 0,code:d};if(Pd(h,m,!1,v))this.retry(h);else{var u;tt.error(`${d} while loading ${e.url}`),(u=this.callbacks)==null||u.onError({code:d,text:t.statusText},e,t,r)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Pd(e,t,!0))this.retry(e);else{var r;tt.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=G0(e,r.retry),r.retry++,tt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&HH.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const KH={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},WH=et(et({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:LR,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:s8,bufferController:YV,capLevelController:ry,errorController:c8,fpsController:qG,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:__,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:KH},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},zH()),{},{subtitleStreamController:aH,subtitleTrackController:JG,timelineController:DH,audioStreamController:HV,audioTrackController:KV,emeController:Oo,cmcdController:KG,contentSteeringController:zG,interstitialsController:oH});function zH(){return{cueHandler:MH,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function YH(n,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=Ig(n),s=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(o=>{const l=`${o==="level"?"playlist":o}LoadPolicy`,u=e[l]===void 0,d=[];i.forEach(f=>{const h=`${o}Loading${f}`,m=e[h];if(m!==void 0&&u){d.push(h);const v=r[l].default;switch(e[l]={default:v},f){case"TimeOut":v.maxLoadTimeMs=m,v.maxTimeToFirstByteMs=m;break;case"MaxRetry":v.errorRetry.maxNumRetry=m,v.timeoutRetry.maxNumRetry=m;break;case"RetryDelay":v.errorRetry.retryDelayMs=m,v.timeoutRetry.retryDelayMs=m;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=m,v.timeoutRetry.maxRetryDelayMs=m;break}}}),d.length&&t.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${l}": ${ot(e[l])}`)}),et(et({},r),e)}function Ig(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(Ig):Object.keys(n).reduce((e,t)=>(e[t]=Ig(n[t]),e),{}):n}function qH(n,e){const t=n.loader;t!==Ub&&t!==LR?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):FH()&&(n.loader=Ub,n.progressive=!0,n.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const td=2,XH=.1,QH=.05,JH=100;class ZH extends T_{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var r;(r=this.media)!=null&&r.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var r;this.ended=((r=this.media)==null?void 0:r.currentTime)||1,this.hls.trigger(_.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(JH),this.mediaSource=t.mediaSource;const r=this.media=t.media;rn(r,"playing",this.onMediaPlaying),rn(r,"waiting",this.onMediaWaiting),rn(r,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:r}=this;r&&(mn(r,"playing",this.onMediaPlaying),mn(r,"waiting",this.onMediaWaiting),mn(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var r,s;const i=(r=this.hls)==null?void 0:r.config;if(!i)return;const o=this.media;if(!o)return;const{seeking:l}=o,u=this.seeking&&!l,d=!this.seeking&&l,f=o.paused&&!l||o.ended||o.playbackRate===0;if(this.seeking=l,e!==t){t&&(this.ended=0),this.moved=!0,l||(this.nudgeRetry=0,i.nudgeOnVideoHole&&!f&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(d||u){u&&this.stallResolved(e);return}if(f){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&o.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(_.MEDIA_ENDED,{stalled:!1}));return}if(!Me.getBuffered(o).length){this.nudgeRetry=0;return}const h=Me.bufferInfo(o,e,0),m=h.nextStart||0,v=this.fragmentTracker;if(l&&v&&this.hls){const F=$b(this.hls.inFlightFragments,e),k=h.len>td,N=!m||F||m-e>td&&!v.getPartialFragment(e);if(k||N)return;this.moved=!1}const g=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&v){if(!(h.len>0)&&!m)return;const k=Math.max(m,h.start||0)-e,M=!!(g!=null&&g.live)?g.targetduration*2:td,O=Pu(e,v);if(k>0&&(k<=M||O)){o.paused||this._trySkipBufferHole(O);return}}const x=i.detectStallWithCurrentTimeMs,E=self.performance.now(),b=this.waiting;let I=this.stalled;if(I===null)if(b>0&&E-b<x)I=this.stalled=b;else{this.stalled=E;return}const A=E-I;if(!l&&(A>=x||b)&&this.hls){var R;if(((R=this.mediaSource)==null?void 0:R.readyState)==="ended"&&!(g!=null&&g.live)&&Math.abs(e-(g?.edge||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(_.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(h),!this.media||!this.hls)return}const C=Me.bufferInfo(o,e,i.maxBufferHole);this._tryFixBufferStall(C,A,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const r=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(_.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var r;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&s&&s.length>1&&e>s.end(0)){const i=Me.bufferedInfo(Me.timeRangesToArray(this.buffered.audio),e,0);if(i.len>1&&t>=i.start){const o=Me.timeRangesToArray(s),l=Me.bufferedInfo(o,t,0).bufferedIndex;if(l>-1&&l<o.length-1){const u=Me.bufferedInfo(o,e,0).bufferedIndex,d=o[l].end,f=o[l+1].start;if((u===-1||u>l)&&f-d<1&&e-d<2){const h=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${d} -> ${f} buffered index: ${u}`);this.warn(h.message),this.media.currentTime+=1e-6;let m=Pu(e,this.fragmentTracker);m&&"fragment"in m?m=m.fragment:m||(m=void 0);const v=Me.bufferInfo(this.media,e,0);this.hls.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:h,reason:h.message,frag:m,buffer:v.len,bufferInfo:v})}}}}}_tryFixBufferStall(e,t,r){var s,i;const{fragmentTracker:o,media:l}=this,u=(s=this.hls)==null?void 0:s.config;if(!l||!o||!u)return;const d=(i=this.hls)==null?void 0:i.latestLevelDetails,f=Pu(r,o);if((f||d!=null&&d.live&&r<d.fragmentStart)&&(this._trySkipBufferHole(f)||!this.media))return;const h=e.buffered,m=this.adjacentTraversal(e,r);(h&&h.length>1&&e.len>u.maxBufferHole||e.nextStart&&(e.nextStart-r<u.maxBufferHole||m))&&(t>u.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const r=this.fragmentTracker,s=e.nextStart;if(r&&s){const i=r.getFragAtPos(t,ge.MAIN),o=r.getFragAtPos(s,ge.MAIN);if(i&&o)return o.sn-i.sn<2}return!1}_reportStall(e){const{hls:t,media:r,stallReported:s,stalled:i}=this;if(!s&&i!==null&&r&&t){this.stallReported=!0;const o=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${ot(e)})`);this.warn(o.message),t.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:e.len,bufferInfo:e,stalled:{start:i}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:r,media:s}=this,i=(t=this.hls)==null?void 0:t.config;if(!s||!r||!i)return 0;const o=s.currentTime,l=Me.bufferInfo(s,o,0),u=o<l.start?l.start:l.nextStart;if(u&&this.hls){const f=l.len<=i.maxBufferHole,h=l.len>0&&l.len<1&&s.readyState<3,m=u-o;if(m>0&&(f||h)){if(m>i.maxBufferHole){let g=!1;if(o===0){const x=r.getAppendedFrag(0,ge.MAIN);x&&u<x.end&&(g=!0)}if(!g&&e){var d;if(!((d=this.hls.loadLevelObj)!=null&&d.details)||$b(this.hls.inFlightFragments,u))return 0;let E=!1,b=e.end;for(;b<u;){const I=Pu(b,r);if(I)b+=I.duration;else{E=!0;break}}if(E)return 0}}const v=Math.max(u+QH,o+XH);if(this.warn(`skipping hole, adjusting currentTime from ${o} to ${v}`),this.moved=!0,s.currentTime=v,!(e!=null&&e.gap)){const g=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${v}`),x={type:we.MEDIA_ERROR,details:W.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:g,reason:g.message,buffer:l.len,bufferInfo:l};e&&("fragment"in e?x.part=e:x.frag=e),this.hls.trigger(_.ERROR,x)}return v}}return 0}_tryNudgeBuffer(e){const{hls:t,media:r,nudgeRetry:s}=this,i=t?.config;if(!r||!i)return 0;const o=r.currentTime;if(this.nudgeRetry++,s<i.nudgeMaxRetry){const l=o+(s+1)*i.nudgeOffset,u=new Error(`Nudging 'currentTime' from ${o} to ${l}`);this.warn(u.message),r.currentTime=l,t.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.BUFFER_NUDGE_ON_STALL,error:u,fatal:!1,buffer:e.len,bufferInfo:e})}else{const l=new Error(`Playhead still not moving while enough data buffered @${o} after ${i.nudgeMaxRetry} nudges`);this.error(l.message),t.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.BUFFER_STALLED_ERROR,error:l,fatal:!0,buffer:e.len,bufferInfo:e})}}}function $b(n,e){const t=jb(n.main);if(t&&t.start<=e)return t;const r=jb(n.audio);return r&&r.start<=e?r:null}function jb(n){if(!n)return null;switch(n.state){case re.IDLE:case re.STOPPED:case re.ENDED:case re.ERROR:return null}return n.frag}function Pu(n,e){return e.getAppendedFrag(n,ge.MAIN)||e.getPartialFragment(n)}const eK=.25;function Ag(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function gm(n,e,t,r,s){let i=new n(e,t,"");try{i.value=r,s&&(i.type=s)}catch{i=new n(e,t,ot(s?et({type:s},r):r))}return i}const Du=(()=>{const n=Ag();try{n&&new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class tK{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(_.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(_.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(_.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var r;this.media=t.media,((r=t.overrides)==null?void 0:r.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&Ro(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return yR(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:r,enableID3MetadataCues:s}=this.hls.config;if(!r&&!s)return;const{samples:i}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=Ag();if(o)for(let l=0;l<i.length;l++){const u=i[l].type;if(u===Ln.emsg&&!r||!s)continue;const d=K_(i[l].data),f=i[l].pts;let h=f+i[l].duration;h>Du&&(h=Du),h-f<=0&&(h=f+eK);for(let v=0;v<d.length;v++){const g=d[v];if(!W_(g)){this.updateId3CueEnds(f,u);const x=gm(o,f,h,g,u);x&&this.id3Track.addCue(x)}}}}updateId3CueEnds(e,t){var r;const s=(r=this.id3Track)==null?void 0:r.cues;if(s)for(let i=s.length;i--;){const o=s[i];o.type===t&&o.startTime<e&&o.endTime===Du&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:s}){const{id3Track:i,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:l,enableID3MetadataCues:u}}=o;if(i&&(l||u)){let d;s==="audio"?d=f=>f.type===Ln.audioId3&&u:s==="video"?d=f=>f.type===Ln.emsg&&l:d=f=>f.type===Ln.audioId3&&u||f.type===Ln.emsg&&l,bg(i,t,r,d)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:r,timelineOffset:s,enableDateRangeMetadataCues:i,interstitialsController:o}=this.hls.config;if(!i)return;const l=Ag();if(r&&s&&!o){const{fragmentStart:x,fragmentEnd:E}=e;let b=this.assetCue;b?(b.startTime=x,b.endTime=E):l&&(b=this.assetCue=gm(l,x,E,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),b&&(b.id=r,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(b),b.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:u}=this,{dateRanges:d}=e,f=Object.keys(d);let h=this.dateRangeCuesAppended;if(u&&t){var m;if((m=u.cues)!=null&&m.length){const x=Object.keys(h).filter(E=>!f.includes(E));for(let E=x.length;E--;){var v;const b=x[E],I=(v=h[b])==null?void 0:v.cues;delete h[b],I&&Object.keys(I).forEach(A=>{const R=I[A];if(R){R.removeEventListener("enter",this.onEventCueEnter);try{u.removeCue(R)}catch{}}})}}else h=this.dateRangeCuesAppended={}}const g=e.fragments[e.fragments.length-1];if(!(f.length===0||!he(g?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let x=0;x<f.length;x++){const E=f[x],b=d[E],I=b.startTime,A=h[E],R=A?.cues||{};let C=A?.durationKnown||!1,F=Du;const{duration:k,endDate:N}=b;if(N&&k!==null)F=I+k,C=!0;else if(b.endOnNext&&!C){const O=f.reduce((H,Z)=>{if(Z!==b.id){const se=d[Z];if(se.class===b.class&&se.startDate>b.startDate&&(!H||b.startDate<H.startDate))return se}return H},null);O&&(F=O.startTime,C=!0)}const M=Object.keys(b.attr);for(let O=0;O<M.length;O++){const H=M[O];if(!T8(H))continue;const Z=R[H];if(Z)C&&!(A!=null&&A.durationKnown)?Z.endTime=F:Math.abs(Z.startTime-I)>.01&&(Z.startTime=I,Z.endTime=F);else if(l){let se=b.attr[H];b8(H)&&(se=n_(se));const ne=gm(l,I,F,{key:H,data:se},Ln.dateRange);ne&&(ne.id=E,this.id3Track.addCue(ne),R[H]=ne,o&&(H==="X-ASSET-LIST"||H==="X-ASSET-URL")&&ne.addEventListener("enter",this.onEventCueEnter))}}h[E]={cues:R,dateRange:b,durationKnown:C}}}}}class nK{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,r=this.levelDetails;if(!t||!r)return;this.currentTime=t.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:o}=this.config;if(!i||o===1||!r.live)return;const l=this.targetLatency;if(l===null)return;const u=s-l,d=Math.min(this.maxLatency,l+r.targetduration);if(u<d&&u>.05&&this.forwardBufferLength>1){const h=Math.min(2,Math.max(1,o)),m=Math.round(2/(1+Math.exp(-.75*u-this.edgeStalled))*20)/20,v=Math.min(h,Math.max(1,m));this.changeMediaPlaybackRate(t,v)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:r,targetduration:s}=e,{liveSyncDuration:i,liveSyncDurationCount:o,lowLatencyMode:l}=this.config,u=this.hls.userConfig;let d=l&&r||t;(this._targetLatencyUpdated||u.liveSyncDuration||u.liveSyncDurationCount||d===0)&&(d=i!==void 0?i:o*s);const f=s;return d+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,f)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const r=this.levelDetails;if(r===null)return null;const s=r.edge,i=e-t-this.edgeStalled,o=s-r.totalduration,l=s-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(o,i),l)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(_.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(_.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var r;t.details===W.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(r=this.levelDetails)!=null&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var r,s;e.playbackRate!==t&&((r=this.hls)==null||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class rK extends ny{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this),e.on(_.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this),e.off(_.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=this.hls.config.preferManagedMediaSource,s=[],i={},o={};let l=!1,u=!1,d=!1;t.levels.forEach(f=>{const h=f.attrs;let{audioCodec:m,videoCodec:v}=f;m&&(f.audioCodec=m=Rd(m,r)||void 0),v&&(v=f.videoCodec=U6(v));const{width:g,height:x,unknownCodecs:E}=f,b=E?.length||0;if(l||(l=!!(g&&x)),u||(u=!!v),d||(d=!!m),b||m&&!this.isAudioSupported(m)||v&&!this.isVideoSupported(v)){this.log(`Some or all CODECS not supported "${h.CODECS}"`);return}const{CODECS:I,"FRAME-RATE":A,"HDCP-LEVEL":R,"PATHWAY-ID":C,RESOLUTION:F,"VIDEO-RANGE":k}=h,M=`${`${C||"."}-`}${f.bitrate}-${F}-${A}-${I}-${k}-${R}`;if(i[M])if(i[M].uri!==f.url&&!f.attrs["PATHWAY-ID"]){const O=o[M]+=1;f.attrs["PATHWAY-ID"]=new Array(O+1).join(".");const H=this.createLevel(f);i[M]=H,s.push(H)}else i[M].addGroupId("audio",h.AUDIO),i[M].addGroupId("text",h.SUBTITLES);else{const O=this.createLevel(f);i[M]=O,o[M]=1,s.push(O)}}),this.filterAndSortMediaOptions(s,t,l,u,d)}createLevel(e){const t=new Il(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){const s=new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(s.message),t.supportedResult=p_(s,[])}return t}isAudioSupported(e){return bl(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return bl(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,r,s,i){var o;let l=[],u=[],d=e;const f=((o=t.stats)==null?void 0:o.parsing)||{};if((r||s)&&i&&(d=d.filter(({videoCodec:I,videoRange:A,width:R,height:C})=>(!!I||!!(R&&C))&&q6(A))),d.length===0){Promise.resolve().then(()=>{if(this.hls){let I="no level with compatible codecs found in manifest",A=I;t.levels.length&&(A=`one or more CODECS in variant not supported: ${ot(t.levels.map(C=>C.attrs.CODECS).filter((C,F,k)=>k.indexOf(C)===F))}`,this.warn(A),I+=` (${A})`);const R=new Error(I);this.hls.trigger(_.ERROR,{type:we.MEDIA_ERROR,details:W.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:R,reason:A})}}),f.end=performance.now();return}t.audioTracks&&(l=t.audioTracks.filter(I=>!I.audioCodec||this.isAudioSupported(I.audioCodec)),Vb(l)),t.subtitles&&(u=t.subtitles,Vb(u));const h=d.slice(0);d.sort((I,A)=>{if(I.attrs["HDCP-LEVEL"]!==A.attrs["HDCP-LEVEL"])return(I.attrs["HDCP-LEVEL"]||"")>(A.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&I.height!==A.height)return I.height-A.height;if(I.frameRate!==A.frameRate)return I.frameRate-A.frameRate;if(I.videoRange!==A.videoRange)return Ld.indexOf(I.videoRange)-Ld.indexOf(A.videoRange);if(I.videoCodec!==A.videoCodec){const R=DT(I.videoCodec),C=DT(A.videoCodec);if(R!==C)return C-R}if(I.uri===A.uri&&I.codecSet!==A.codecSet){const R=_d(I.codecSet),C=_d(A.codecSet);if(R!==C)return C-R}return I.averageBitrate!==A.averageBitrate?I.averageBitrate-A.averageBitrate:0});let m=h[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==h.length)){for(let I=0;I<h.length;I++)if(h[I].pathwayId===d[0].pathwayId){m=h[I];break}}this._levels=d;for(let I=0;I<d.length;I++)if(d[I]===m){var v;this._firstLevel=I;const A=m.bitrate,R=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${A}`),((v=this.hls.userConfig)==null?void 0:v.abrEwmaDefaultEstimate)===void 0){const C=Math.min(A,this.hls.config.abrEwmaDefaultEstimateMax);C>R&&R===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=C)}break}const g=i&&!s,x=this.hls.config,E=!!(x.audioStreamController&&x.audioTrackController),b={levels:d,audioTracks:l,subtitleTracks:u,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:i,video:s,altAudio:E&&!g&&l.some(I=>!!I.url)};f.end=performance.now(),this.hls.trigger(_.MANIFEST_PARSED,b)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const f=new Error("invalid level idx"),h=e<0;if(this.hls.trigger(_.ERROR,{type:we.OTHER_ERROR,details:W.LEVEL_SWITCH_ERROR,level:e,fatal:h,error:f,reason:f.message}),h)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,s=this.currentLevel,i=s?s.attrs["PATHWAY-ID"]:void 0,o=t[e],l=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,r===e&&s&&i===l)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${l?" with Pathway "+l:""} from level ${r}${i?" with Pathway "+i:""}`);const u={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(_.LEVEL_SWITCHING,u);const d=o.details;if(!d||d.live){const f=this.switchParams(o.uri,s?.details,d);this.loadPlaylist(f)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),r=e.filter(s=>t.indexOf(s)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=r}}onError(e,t){t.fatal||!t.context||t.context.type===He.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===ge.MAIN){const r=t.elementaryStreams;if(!Object.keys(r).some(i=>!!r[i]))return;const s=this._levels[t.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(e,t){var r;const{level:s,details:i}=t,o=t.levelInfo;if(!o){var l;this.warn(`Invalid level index ${s}`),(l=t.deliveryDirectives)!=null&&l.skip&&(i.deltaUpdateFailed=!0);return}if(o===this.currentLevel||t.withoutMultiVariant){o.fragmentError===0&&(o.loadError=0);let u=o.details;u===t.details&&u.advanced&&(u=void 0),this.playlistLoaded(s,t,u)}else(r=t.deliveryDirectives)!=null&&r.skip&&(i.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=this.getUrlWithDirectives(e.uri,t),s=this.currentLevelIndex,i=e.attrs["PATHWAY-ID"],o=e.details,l=o?.age;this.log(`Loading level index ${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${i?" Pathway "+i:""}${l&&o.live?" age "+l.toFixed(1)+(o.type&&" "+o.type||""):""} ${r}`),this.hls.trigger(_.LEVEL_LOADING,{url:r,level:s,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const r=this._levels.filter((i,o)=>o!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(l=>l.level=-1)),!1));O_(r),this._levels=r,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=r.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(_.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(_.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function Vb(n){const e={};n.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}function CR(){return self.SourceBuffer||self.WebKitSourceBuffer}function kR(){if(!ti())return!1;const e=CR();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function sK(){if(!kR())return!1;const n=ti();return typeof n?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>n.isTypeSupported(wl(e,"video")))||["mp4a.40.2","fLaC"].some(e=>n.isTypeSupported(wl(e,"audio"))))}function iK(){var n;const e=CR();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}const oK=100;class aK extends Y0{constructor(e,t,r){super(e,t,r,"stream-controller",ge.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const s=this.media,i=s?s.currentTime:null;if(i===null||!he(i)||(this.log(`Media seeked to ${i.toFixed(3)}`),!this.getBufferedFrag(i)))return;const o=this.getFwdBufferInfoAtPos(s,i,ge.MAIN,0);if(o===null||o.len===0){this.warn(`Main forward buffer length at ${i} on "seeked" event ${o?o.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.LEVEL_LOADING,this.onLevelLoading,this),e.on(_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(_.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(_.BUFFER_CREATED,this.onBufferCreated,this),e.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(_.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(_.BUFFER_CREATED,this.onBufferCreated,this),e.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:r,hls:s}=this;if(this.stopLoad(),this.setInterval(oK),this.level=-1,!this.startFragRequested){let i=s.startLevel;i===-1&&(s.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=s.firstAutoLevel),s.nextLoadLevel=i,this.level=s.loadLevel,this._hasEnoughToStart=!!t}r>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=re.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=re.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case re.WAITING_LEVEL:{const{levels:e,level:t}=this,r=e?.[t],s=r?.details;if(s&&(!s.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(s))break;this.state=re.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=re.IDLE;break}break}case re.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===re.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:s}=this;if(t===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const i=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(r!=null&&r[i]))return;const o=r[i],l=this.getMainFwdBufferInfo();if(l===null)return;const u=this.getLevelDetails();if(u&&this._streamEnded(l,u)){const x={};this.altAudio===2&&(x.type="video"),this.hls.trigger(_.BUFFER_EOS,x),this.state=re.ENDED;return}if(!this.buffering)return;e.loadLevel!==i&&e.manualLevel===-1&&this.log(`Adapting to level ${i} from level ${this.level}`),this.level=e.nextLoadLevel=i;const d=o.details;if(!d||this.state===re.WAITING_LEVEL||this.waitForLive(o)){this.level=i,this.state=re.WAITING_LEVEL,this.startFragRequested=!1;return}const f=l.len,h=this.getMaxBufferLength(o.maxBitrate);if(f>=h)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);const m=this.backtrackFragment?this.backtrackFragment.start:l.end;let v=this.getNextFragment(m,d);if(this.couldBacktrack&&!this.fragPrevious&&v&&wt(v)&&this.fragmentTracker.getState(v)!==Pt.OK){var g;const E=((g=this.backtrackFragment)!=null?g:v).sn-d.startSN,b=d.fragments[E-1];b&&v.cc===b.cc&&(v=b,this.fragmentTracker.removeFragment(b))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(v&&this.isLoopLoading(v,m)){if(!v.gap){const E=this.audioOnly&&!this.altAudio?it.AUDIO:it.VIDEO,b=(E===it.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;b&&this.afterBufferFlushed(b,E,ge.MAIN)}v=this.getNextFragmentLoopLoading(v,d,l,ge.MAIN,h)}v&&(v.initSegment&&!v.initSegment.data&&!this.bitrateTest&&(v=v.initSegment),this.loadFragment(v,o,m))}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);s===Pt.NOT_LOADED||s===Pt.PARTIAL?wt(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,r):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ge.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const s=this.getAppendedFrag(t.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const i=this.getLevelDetails();if(i!=null&&i.live){const l=this.getMainFwdBufferInfo();if(!l||l.len<i.targetduration*2)return}if(!t.paused&&e){const l=this.hls.nextLoadLevel,u=e[l],d=this.fragLastKbps;d&&this.fragCurrent?r=this.fragCurrent.duration*u.maxBitrate/(1e3*d)+1:r=0}else r=0;const o=this.getBufferedFrag(t.currentTime+r);if(o){const l=this.followingBufferedFrag(o);if(l){this.abortCurrentFrag();const u=l.maxStartPTS?l.maxStartPTS:l.start,d=l.duration,f=Math.max(o.end,u+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(f,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case re.KEY_LOADING:case re.FRAG_LOADING:case re.FRAG_LOADING_WAITING_RETRY:case re.PARSING:case re.PARSED:this.state=re.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;rn(r,"playing",this.onMediaPlaying),rn(r,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:r}=this;r&&(mn(r,"playing",this.onMediaPlaying),mn(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(_.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let r=!1,s=!1;for(let i=0;i<t.levels.length;i++){const o=t.levels[i].audioCodec;o&&(r=r||o.indexOf("mp4a.40.2")!==-1,s=s||o.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=r&&s&&!iK(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==re.IDLE)return;const s=t.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=re.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:s,startFragRequested:i}=this,o=t.level,l=t.details,u=l.totalduration;if(!s){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""}, cc [${l.startCC}, ${l.endCC}] duration:${u}`);const d=t.levelInfo,f=this.fragCurrent;f&&(this.state===re.FRAG_LOADING||this.state===re.FRAG_LOADING_WAITING_RETRY)&&f.level!==t.level&&f.loader&&this.abortCurrentFrag();let h=0;if(l.live||(r=d.details)!=null&&r.live){var m;if(this.checkLiveUpdate(l),l.deltaUpdateFailed)return;h=this.alignPlaylists(l,d.details,(m=this.levelLastLoaded)==null?void 0:m.details)}if(d.details=l,this.levelLastLoaded=d,i||this.setStartPosition(l,h),this.hls.trigger(_.LEVEL_UPDATED,{details:l,level:o}),this.state===re.WAITING_LEVEL){if(this.waitForCdnTuneIn(l))return;this.state=re.IDLE}i&&l.live&&this.synchronizeToLiveEdge(l),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const s=this.hls.liveSyncPosition,i=this.getLoadPosition(),o=e.fragmentStart,l=e.edge,u=i>=o-t.maxFragLookUpTolerance&&i<=l;if(s!==null&&r.duration>s&&(i<s||!u)){const f=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!u&&r.readyState<4||i<l-f)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),r.readyState))if(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${l}, reset currentTime to : ${s.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var d;const h=Me.bufferInfo(r,s,0);if(!((d=h.buffered)!=null&&d.length)){r.currentTime=s;return}if(h.start<=i){r.currentTime=s;return}const{nextStart:v}=Me.bufferedInfo(h.buffered,i,0);v&&(r.currentTime=v)}else r.currentTime=s}}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:s,payload:i}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const l=o[r.level];if(!l){this.warn(`Level ${r.level} not found on progress`);return}const u=l.details;if(!u){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const d=l.videoCodec,f=u.PTSKnown||!u.live,h=(t=r.initSegment)==null?void 0:t.data,m=this._getAudioCodec(l),v=this.transmuxer=this.transmuxer||new rR(this.hls,ge.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),g=s?s.index:-1,x=g!==-1,E=new K0(r.level,r.sn,r.stats.chunkCount,i.byteLength,g,x),b=this.initPTS[r.cc];v.push(i,h,m,d,r,s,u.totalduration,f,E,b)}onAudioTrackSwitching(e,t){const r=this.hls,s=this.altAudio!==0;if(Cd(t.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.altAudio=0,this.fragmentTracker.removeAllFragments(),r.once(_.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(_.AUDIO_TRACK_SWITCHED,t)}),r.trigger(_.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}r.trigger(_.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=Cd(t.url,this.hls);if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r?2:0,this.tick()}onBufferCreated(e,t){const r=t.tracks;let s,i,o=!1;for(const l in r){const u=r[l];if(u.id==="main"){if(i=l,s=u,l==="video"){const d=r[l];d&&(this.videoBuffer=d.buffer)}}else o=!0}o&&s?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:s}=t,i=r.type===ge.MAIN;if(i){if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===re.PARSED&&(this.state=re.IDLE);return}const l=s?s.stats:r.stats;this.fragLastKbps=Math.round(8*l.total/(l.buffering.end-l.loading.first)),wt(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,s)}const o=this.media;o&&(!this._hasEnoughToStart&&Me.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),i&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var r;if(t.fatal){this.state=re.ERROR;return}switch(t.details){case W.FRAG_GAP:case W.FRAG_PARSING_ERROR:case W.FRAG_DECRYPT_ERROR:case W.FRAG_LOAD_ERROR:case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_ERROR:case W.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ge.MAIN,t);break;case W.LEVEL_LOAD_ERROR:case W.LEVEL_LOAD_TIMEOUT:case W.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===re.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===He.LEVEL&&(this.state=re.IDLE);break;case W.BUFFER_ADD_CODEC_ERROR:case W.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case W.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case W.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=re.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==it.AUDIO||!this.altAudio){const r=(t===it.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;r&&(this.afterBufferFlushed(r,t,ge.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const s=this.timelineOffset;s&&r&&(r+=s);const i=this.getLevelDetails(),o=Me.getBuffered(e),l=o.length?o.start(0):0,u=l-r,d=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||u>0&&(u<d||this.loadingParts&&u<2*(i?.partTarget||0)))&&(this.log(`adjusting start position by ${u} to match buffer start`),r+=u,this.startPosition=r),t<r&&(this.log(`seek to target start position ${r} from current time ${t} buffer start ${l}`),e.currentTime=r)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:s}=this,i=r?.frag;if(!i||this.fragContextChanged(i))return;t.fragmentError=0,this.state=re.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=i.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),s.trigger(_.FRAG_LOADED,r),i.bitrateTest=!1}).catch(r=>{this.state===re.STOPPED||this.state===re.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:r}=this,{remuxResult:s,chunkMeta:i}=e,o=this.getCurrentContext(i);if(!o){this.resetWhenMissingContext(i);return}const{frag:l,part:u,level:d}=o,{video:f,text:h,id3:m,initSegment:v}=s,{details:g}=d,x=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=re.PARSING,v){const E=v.tracks;if(E){const R=l.initSegment||l;if(this.unhandledEncryptionError(v,l))return;this._bufferInitSegment(d,E,R,i),r.trigger(_.FRAG_PARSING_INIT_SEGMENT,{frag:R,id:t,tracks:E})}const b=v.initPTS,I=v.timescale,A=this.initPTS[l.cc];if(he(b)&&(!A||A.baseTime!==b||A.timescale!==I)){const R=v.trackId;this.initPTS[l.cc]={baseTime:b,timescale:I,trackId:R},r.trigger(_.INIT_PTS_FOUND,{frag:l,id:t,initPTS:b,timescale:I,trackId:R})}}if(f&&g){x&&f.type==="audiovideo"&&this.logMuxedErr(l);const E=g.fragments[l.sn-1-g.startSN],b=l.sn===g.startSN,I=!E||l.cc>E.cc;if(s.independent!==!1){const{startPTS:A,endPTS:R,startDTS:C,endDTS:F}=f;if(u)u.elementaryStreams[f.type]={startPTS:A,endPTS:R,startDTS:C,endDTS:F};else if(f.firstKeyFrame&&f.independent&&i.id===1&&!I&&(this.couldBacktrack=!0),f.dropped&&f.independent){const k=this.getMainFwdBufferInfo(),N=(k?k.end:this.getLoadPosition())+this.config.maxBufferHole,M=f.firstKeyFramePTS?f.firstKeyFramePTS:A;if(!b&&N<M-this.config.maxBufferHole&&!I){this.backtrack(l);return}else I&&(l.gap=!0);l.setElementaryStreamInfo(f.type,l.start,R,l.start,F,!0)}else b&&A-(g.appliedTimelineOffset||0)>td&&(l.gap=!0);l.setElementaryStreamInfo(f.type,A,R,C,F),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(f,l,u,i,b||I)}else if(b||I)l.gap=!0;else{this.backtrack(l);return}}if(x){const{startPTS:E,endPTS:b,startDTS:I,endDTS:A}=x;u&&(u.elementaryStreams[it.AUDIO]={startPTS:E,endPTS:b,startDTS:I,endDTS:A}),l.setElementaryStreamInfo(it.AUDIO,E,b,I,A),this.bufferFragmentData(x,l,u,i)}if(g&&m!=null&&m.samples.length){const E={id:t,frag:l,details:g,samples:m.samples};r.trigger(_.FRAG_PARSING_METADATA,E)}if(g&&h){const E={id:t,frag:l,details:g,samples:h.samples};r.trigger(_.FRAG_PARSING_USERDATA,E)}}logMuxedErr(e){this.warn(`${wt(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,r,s){if(this.state!==re.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));const{audio:i,video:o,audiovideo:l}=t;if(i){const d=e.audioCodec;let f=Yu(i.codec,d);f==="mp4a"&&(f="mp4a.40.5");const h=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){f&&(f.indexOf("mp4a.40.5")!==-1?f="mp4a.40.2":f="mp4a.40.5");const m=i.metadata;m&&"channelCount"in m&&(m.channelCount||1)!==1&&h.indexOf("firefox")===-1&&(f="mp4a.40.5")}f&&f.indexOf("mp4a.40.5")!==-1&&h.indexOf("android")!==-1&&i.container!=="audio/mpeg"&&(f="mp4a.40.2",this.log(`Android: force audio codec to ${f}`)),d&&d!==f&&this.log(`Swapping manifest audio codec "${d}" for "${f}"`),i.levelCodec=f,i.id=ge.MAIN,this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${f||""}/${d||""}/${i.codec}]`),delete t.audiovideo}if(o){o.levelCodec=e.videoCodec,o.id=ge.MAIN;const d=o.codec;if(d?.length===4)switch(d){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${d}]${o.codec!==d?" parsed-corrected="+o.codec:""}${o.supplemental?" supplemental="+o.supplemental:""}`),delete t.audiovideo}l&&(this.log(`Init audiovideo buffer, container:${l.container}, codecs[level/parsed]=[${e.codecs}/${l.codec}]`),delete t.video,delete t.audio);const u=Object.keys(t);if(u.length){if(this.hls.trigger(_.BUFFER_CODECS,t),!this.hls)return;u.forEach(d=>{const h=t[d].initSegment;h!=null&&h.byteLength&&this.hls.trigger(_.BUFFER_APPENDING,{type:d,data:h,frag:r,part:null,chunkMeta:s,parent:r.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ge.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,r=e?.[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=re.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(Me.isBuffered(e,r)?t=this.getAppendedFrag(r):Me.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const s=this.fragPlaying,i=t.level;(!s||t.sn!==s.sn||s.level!==i)&&(this.fragPlaying=t,this.hls.trigger(_.FRAG_CHANGED,{frag:t}),(!s||s.level!==i)&&this.hls.trigger(_.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return he(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(he(t)){const r=this.getLevelDetails(),s=this.currentFrag||(r?ji(null,r.fragments,t):null);if(s){const i=s.programDateTime;if(i!==null){const o=i+(t-s.start)*1e3;return new Date(o)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class lK extends Xn{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const r in this.keyIdToKeyInfo){const s=this.keyIdToKeyInfo[r].loader;if(s){var t;if(e&&e!==((t=s.context)==null?void 0:t.frag.type))return;s.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=W.KEY_LOAD_ERROR,r,s,i){return new Xr({type:we.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:r,networkDetails:s})}loadClear(e,t,r){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let s=0,i=t.length;s<i;s++){const o=t[s];if(e.cc<=o.cc&&(!wt(e)||!wt(o)||e.sn<o.sn)||!r&&s==i-1)return this.emeController.selectKeySystemFormat(o).then(l=>{if(!this.emeController)return;o.setKeyFormat(l);const u=Xu(l);if(u)return this.emeController.getKeySystemAccess([u])})}if(this.config.requireKeySystemAccessOnStart){const s=el(this.config);if(s.length)return this.emeController.getKeySystemAccess(s)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,s;t&&e.setKeyFormat(t);const i=e.decryptdata;if(!i){const d=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,W.KEY_LOAD_ERROR,d))}const o=i.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,W.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));const l=ym(i);let u=this.keyIdToKeyInfo[l];if((r=u)!=null&&r.decryptdata.key)return i.key=u.decryptdata.key,Promise.resolve({frag:e,keyInfo:u});if(this.emeController&&(s=u)!=null&&s.keyLoadPromise)switch(this.emeController.getKeyStatus(u.decryptdata)){case"usable":case"usable-in-future":return u.keyLoadPromise.then(f=>{const{keyInfo:h}=f;return i.key=h.decryptdata.key,{frag:e,keyInfo:h}})}switch(this.log(`${this.keyIdToKeyInfo[l]?"Rel":"L"}oading${i.keyId?" keyId: "+Vt(i.keyId):""} URI: ${i.uri} from ${e.type} ${e.level}`),u=this.keyIdToKeyInfo[l]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return i.keyFormat==="identity"?this.loadKeyHTTP(u,e):this.loadKeyEME(u,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(u,e);default:return Promise.reject(this.createKeyLoadError(e,W.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var s;if(!e.decryptdata.keyId&&(s=t.initSegment)!=null&&s.data){const o=_6(t.initSegment.data);if(o.length){let l=o[0];l.some(u=>u!==0)?(this.log(`Using keyId found in init segment ${Vt(l)}`),Qs.setKeyIdForUri(e.decryptdata.uri,l)):(l=Qs.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${Vt(l)}`)),e.decryptdata.keyId=l}}if(!e.decryptdata.keyId&&!wt(t))return Promise.resolve(r);const i=this.emeController.loadKey(r);return(e.keyLoadPromise=i.then(o=>(e.mediaKeySessionContext=o,r))).catch(o=>{throw e.keyLoadPromise=null,"data"in o&&(o.data.frag=t),o})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,s=r.loader,i=new s(r);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((o,l)=>{const u={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},d=r.keyLoadPolicy.default,f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(m,v,g,x)=>{const{frag:E,keyInfo:b}=g,I=ym(b.decryptdata);if(!E.decryptdata||b!==this.keyIdToKeyInfo[I])return l(this.createKeyLoadError(E,W.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),x));b.decryptdata.key=E.decryptdata.key=new Uint8Array(m.data),E.keyLoader=null,b.loader=null,o({frag:E,keyInfo:b})},onError:(m,v,g,x)=>{this.resetLoader(v),l(this.createKeyLoadError(t,W.KEY_LOAD_ERROR,new Error(`HTTP Error ${m.code} loading key ${m.text}`),g,et({url:u.url,data:void 0},m)))},onTimeout:(m,v,g)=>{this.resetLoader(v),l(this.createKeyLoadError(t,W.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),g))},onAbort:(m,v,g)=>{this.resetLoader(v),l(this.createKeyLoadError(t,W.INTERNAL_ABORTED,new Error("key loading aborted"),g))}};i.load(u,f,h)})}resetLoader(e){const{frag:t,keyInfo:r,url:s}=e,i=r.loader;t.keyLoader===i&&(t.keyLoader=null,r.loader=null);const o=ym(r.decryptdata)||s;delete this.keyIdToKeyInfo[o],i&&i.destroy()}}function ym(n){if(n.keyFormat!==Gt.FAIRPLAY){const e=n.keyId;if(e)return Vt(e)}return n.uri}function Gb(n){const{type:e}=n;switch(e){case He.AUDIO_TRACK:return ge.AUDIO;case He.SUBTITLE_TRACK:return ge.SUBTITLE;default:return ge.MAIN}}function vm(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class cK{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.LEVEL_LOADING,this.onLevelLoading,this),e.on(_.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(_.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.LEVEL_LOADING,this.onLevelLoading,this),e.off(_.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(_.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,s=t.loader,i=r||s,o=new i(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:He.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:r,level:s,pathwayId:i,url:o,deliveryDirectives:l,levelInfo:u}=t;this.load({id:r,level:s,pathwayId:i,responseType:"text",type:He.LEVEL,url:o,deliveryDirectives:l,levelOrTrack:u})}onAudioTrackLoading(e,t){const{id:r,groupId:s,url:i,deliveryDirectives:o,track:l}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:He.AUDIO_TRACK,url:i,deliveryDirectives:o,levelOrTrack:l})}onSubtitleTrackLoading(e,t){const{id:r,groupId:s,url:i,deliveryDirectives:o,track:l}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:He.SUBTITLE_TRACK,url:i,deliveryDirectives:o,levelOrTrack:l})}onLevelsUpdated(e,t){const r=this.loaders[He.LEVEL];if(r){const s=r.context;s&&!t.levels.some(i=>i===s.levelOrTrack)&&(r.abort(),delete this.loaders[He.LEVEL])}}load(e){var t;const r=this.hls.config;let s=this.getInternalLoader(e);if(s){const d=this.hls.logger,f=s.context;if(f&&f.levelOrTrack===e.levelOrTrack&&(f.url===e.url||f.deliveryDirectives&&!e.deliveryDirectives)){f.url===e.url?d.log(`[playlist-loader]: ignore ${e.url} ongoing request`):d.log(`[playlist-loader]: ignore ${e.url} in favor of ${f.url}`);return}d.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}let i;if(e.type===He.MANIFEST?i=r.manifestLoadPolicy.default:i=rt({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),he((t=e.deliveryDirectives)==null?void 0:t.part)){let d;if(e.type===He.LEVEL&&e.level!==null?d=this.hls.levels[e.level].details:e.type===He.AUDIO_TRACK&&e.id!==null?d=this.hls.audioTracks[e.id].details:e.type===He.SUBTITLE_TRACK&&e.id!==null&&(d=this.hls.subtitleTracks[e.id].details),d){const f=d.partTarget,h=d.targetduration;if(f&&h){const m=Math.max(f*3,h*.8)*1e3;i=rt({},i,{maxTimeToFirstByteMs:Math.min(m,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(m,i.maxTimeToFirstByteMs)})}}}const o=i.errorRetry||i.timeoutRetry||{},l={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},u={onSuccess:(d,f,h,m)=>{const v=this.getInternalLoader(h);this.resetInternalLoader(h.type);const g=d.data;f.parsing.start=performance.now(),Lr.isMediaPlaylist(g)||h.type!==He.MANIFEST?this.handleTrackOrLevelPlaylist(d,f,h,m||null,v):this.handleMasterPlaylist(d,f,h,m)},onError:(d,f,h,m)=>{this.handleNetworkError(f,h,!1,d,m)},onTimeout:(d,f,h)=>{this.handleNetworkError(f,h,!0,void 0,d)}};s.load(e,l,u)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:r}=this.hls;(e||r)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,r,s){const i=this.hls,o=e.data,l=vm(e,r),u=Lr.parseMasterPlaylist(o,l);if(u.playlistParsingError){t.parsing.end=performance.now(),this.handleManifestParsingError(e,r,u.playlistParsingError,s,t);return}const{contentSteering:d,levels:f,sessionData:h,sessionKeys:m,startTimeOffset:v,variableList:g}=u;this.variableList=g,f.forEach(I=>{const{unknownCodecs:A}=I;if(A){const{preferManagedMediaSource:R}=this.hls.config;let{audioCodec:C,videoCodec:F}=I;for(let k=A.length;k--;){const N=A[k];bl(N,"audio",R)?(I.audioCodec=C=C?`${C},${N}`:N,Go.audio[C.substring(0,4)]=2,A.splice(k,1)):bl(N,"video",R)&&(I.videoCodec=F=F?`${F},${N}`:N,Go.video[F.substring(0,4)]=2,A.splice(k,1))}}});const{AUDIO:x=[],SUBTITLES:E,"CLOSED-CAPTIONS":b}=Lr.parseMasterPlaylistMedia(o,l,u);x.length&&!x.some(A=>!A.url)&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),x.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new mt({}),bitrate:0,url:""})),i.trigger(_.MANIFEST_LOADED,{levels:f,audioTracks:x,subtitles:E,captions:b,contentSteering:d,url:l,stats:t,networkDetails:s,sessionData:h,sessionKeys:m,startTimeOffset:v,variableList:g})}handleTrackOrLevelPlaylist(e,t,r,s,i){const o=this.hls,{id:l,level:u,type:d}=r,f=vm(e,r),h=he(u)?u:he(l)?l:0,m=Gb(r),v=Lr.parseLevelPlaylist(e.data,f,h,m,0,this.variableList);if(d===He.MANIFEST){const g={attrs:new mt({}),bitrate:0,details:v,name:"",url:f};v.requestScheduled=t.loading.start+P_(v,0),o.trigger(_.MANIFEST_LOADED,{levels:[g],audioTracks:[],url:f,stats:t,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=v,this.handlePlaylistLoaded(v,e,t,r,s,i)}handleManifestParsingError(e,t,r,s,i){this.hls.trigger(_.ERROR,{type:we.NETWORK_ERROR,details:W.MANIFEST_PARSING_ERROR,fatal:t.type===He.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:s,stats:i})}handleNetworkError(e,t,r=!1,s,i){let o=`A network ${r?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===He.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===He.AUDIO_TRACK||e.type===He.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const l=new Error(o);this.hls.logger.warn(`[playlist-loader]: ${o}`);let u=W.UNKNOWN,d=!1;const f=this.getInternalLoader(e);switch(e.type){case He.MANIFEST:u=r?W.MANIFEST_LOAD_TIMEOUT:W.MANIFEST_LOAD_ERROR,d=!0;break;case He.LEVEL:u=r?W.LEVEL_LOAD_TIMEOUT:W.LEVEL_LOAD_ERROR,d=!1;break;case He.AUDIO_TRACK:u=r?W.AUDIO_TRACK_LOAD_TIMEOUT:W.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case He.SUBTITLE_TRACK:u=r?W.SUBTITLE_TRACK_LOAD_TIMEOUT:W.SUBTITLE_LOAD_ERROR,d=!1;break}f&&this.resetInternalLoader(e.type);const h={type:we.NETWORK_ERROR,details:u,fatal:d,url:e.url,loader:f,context:e,error:l,networkDetails:t,stats:i};if(s){const m=t?.url||e.url;h.response=et({url:m,data:void 0},s)}this.hls.trigger(_.ERROR,h)}handlePlaylistLoaded(e,t,r,s,i,o){const l=this.hls,{type:u,level:d,levelOrTrack:f,id:h,groupId:m,deliveryDirectives:v}=s,g=vm(t,s),x=Gb(s);let E=typeof s.level=="number"&&x===ge.MAIN?d:void 0;const b=e.playlistParsingError;if(b){if(this.hls.logger.warn(`${b} ${e.url}`),!l.config.ignorePlaylistParsingErrors){l.trigger(_.ERROR,{type:we.NETWORK_ERROR,details:W.LEVEL_PARSING_ERROR,fatal:!1,url:g,error:b,reason:b.message,response:t,context:s,level:E,parent:x,networkDetails:i,stats:r});return}e.playlistParsingError=null}if(!e.fragments.length){const I=e.playlistParsingError=new Error("No Segments found in Playlist");l.trigger(_.ERROR,{type:we.NETWORK_ERROR,details:W.LEVEL_EMPTY_ERROR,fatal:!1,url:g,error:I,reason:I.message,response:t,context:s,level:E,parent:x,networkDetails:i,stats:r});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),u){case He.MANIFEST:case He.LEVEL:if(E){if(!f)E=0;else if(f!==l.levels[E]){const I=l.levels.indexOf(f);I>-1&&(E=I)}}l.trigger(_.LEVEL_LOADED,{details:e,levelInfo:f||l.levels[0],level:E||0,id:h||0,stats:r,networkDetails:i,deliveryDirectives:v,withoutMultiVariant:u===He.MANIFEST});break;case He.AUDIO_TRACK:l.trigger(_.AUDIO_TRACK_LOADED,{details:e,track:f,id:h||0,groupId:m||"",stats:r,networkDetails:i,deliveryDirectives:v});break;case He.SUBTITLE_TRACK:l.trigger(_.SUBTITLE_TRACK_LOADED,{details:e,track:f,id:h||0,groupId:m||"",stats:r,networkDetails:i,deliveryDirectives:v});break}}}class pn{static get version(){return Al}static isMSESupported(){return kR()}static isSupported(){return sK()}static getMediaSource(){return ti()}static get Events(){return _}static get MetadataSchema(){return Ln}static get ErrorTypes(){return we}static get ErrorDetails(){return W}static get DefaultConfig(){return pn.defaultConfig?pn.defaultConfig:WH}static set DefaultConfig(e){pn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new q0,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=m6(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=YH(pn.DefaultConfig,e,t);this.userConfig=e,r.progressive&&qH(r,t);const{abrController:s,bufferController:i,capLevelController:o,errorController:l,fpsController:u}=r,d=new l(this),f=this.abrController=new s(this),h=new u8(this),m=r.interstitialsController,v=m?this.interstitialsController=new m(this,pn):null,g=this.bufferController=new i(this,h),x=this.capLevelController=new o(this),E=new u(this),b=new cK(this),I=r.contentSteeringController,A=I?new I(this):null,R=this.levelController=new rK(this,A),C=new tK(this),F=new lK(this.config,this.logger),k=this.streamController=new aK(this,h,F),N=this.gapController=new ZH(this,h);x.setStreamController(k),E.setStreamController(k);const M=[b,R,k];v&&M.splice(1,0,v),A&&M.splice(1,0,A),this.networkControllers=M;const O=[f,g,N,x,E,C,h];this.audioTrackController=this.createController(r.audioTrackController,M);const H=r.audioStreamController;H&&M.push(this.audioStreamController=new H(this,h,F)),this.subtitleTrackController=this.createController(r.subtitleTrackController,M);const Z=r.subtitleStreamController;Z&&M.push(this.subtititleStreamController=new Z(this,h,F)),this.createController(r.timelineController,O),F.emeController=this.emeController=this.createController(r.emeController,O),this.cmcdController=this.createController(r.cmcdController,O),this.latencyController=this.createController(nK,O),this.coreComponents=O,M.push(d);const se=d.onErrorOut;typeof se=="function"&&this.on(_.ERROR,se,d),this.on(_.MANIFEST_LOADED,b.onManifestLoaded,b)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,s){this._emitter.off(e,t,r,s)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;const s=e===_.ERROR;this.trigger(_.ERROR,{type:we.OTHER_ERROR,details:W.INTERNAL_EXCEPTION,fatal:s,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(_.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const i=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(_.ERROR,{type:we.OTHER_ERROR,details:W.ATTACH_MEDIA_ERROR,fatal:!0,error:i});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,r=t?e.media:e,s=t?e:{media:r};this._media=r,this.trigger(_.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(_.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(_.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,r=this._url,s=this._url=B0.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),t&&r&&(r!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(_.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),!(!this.started||!this.networkControllers));r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ge.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[ge.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[ge.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=ZG()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Y6(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let s=0;s<r;s++)if(e[s].maxBitrate>=t)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let s;if(t===-1&&e!=null&&e.length?s=e.length-1:s=t,r)for(let i=s;i--;){const o=e[i].attrs["HDCP-LEVEL"];if(o&&o<=r)return i}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const r=y_(t);return m_(e,r,navigator.mediaCapabilities)}}pn.defaultConfig=void 0;const uK=()=>{const[n,e]=P.useState(null),[t,r]=P.useState(null),[s,i]=P.useState(!1),o=P.useRef(null),l=P.useRef(null),u=[{id:"starsports",name:"Star Sports",logo:"https://upload.wikimedia.org/wikipedia/en/thumb/5/5b/Star_Sports_logo.svg/1200px-Star_Sports_logo.svg.png",streamUrl:"http://192.168.91.8/streams/118/index.m3u8",country:" India",category:"Sports"}];P.useEffect(()=>{if(!n||!o.current)return;const m=o.current;if(i(!0),r(null),l.current&&(l.current.destroy(),l.current=null),console.log("Loading stream:",n.streamUrl),pn.isSupported()){const v=new pn({debug:!0,enableWorker:!0,lowLatencyMode:!1,backBufferLength:90,maxBufferLength:30,maxMaxBufferLength:600,xhrSetup:function(g,x){g.withCredentials=!1}});l.current=v,v.on(pn.Events.MANIFEST_PARSED,(g,x)=>{console.log("Manifest parsed, levels:",x.levels),i(!1),m.play().then(()=>console.log("Playing successfully")).catch(E=>{console.error("Autoplay failed:",E),r("Click play button to start")})}),v.on(pn.Events.ERROR,(g,x)=>{if(console.error("HLS Error event:",g,x),x.fatal)switch(i(!1),x.type){case pn.ErrorTypes.NETWORK_ERROR:console.error("Network error - Cannot load stream"),r("Network error: Cannot connect to stream. Check if URL is accessible."),setTimeout(()=>{console.log("Trying to recover from network error..."),v.startLoad()},3e3);break;case pn.ErrorTypes.MEDIA_ERROR:console.error("Media error - trying to recover"),r("Media error: Attempting to recover..."),v.recoverMediaError();break;default:console.error("Fatal error - cannot recover"),r("Fatal error: Unable to play stream"),v.destroy();break}}),v.on(pn.Events.FRAG_LOADED,()=>{console.log("Fragment loaded successfully")}),v.loadSource(n.streamUrl),v.attachMedia(m)}else m.canPlayType("application/vnd.apple.mpegurl")?(console.log("Using Safari native HLS"),m.src=n.streamUrl,m.addEventListener("loadedmetadata",()=>{i(!1),m.play().catch(v=>{console.error("Safari autoplay failed:",v),r("Click play button to start")})}),m.addEventListener("error",v=>{console.error("Safari video error:",v),r("Error loading video stream"),i(!1)})):(r("HLS not supported in this browser"),i(!1));return()=>{l.current&&(l.current.destroy(),l.current=null)}},[n]);const d=m=>{e(m),r(null)},f=()=>{o.current&&o.current.play().catch(m=>console.error("Manual play failed:",m))},h=()=>{o.current&&o.current.requestFullscreen&&o.current.requestFullscreen()};return S.jsx("div",{className:"min-h-screen bg-black pt-20 pb-16",children:S.jsxs("div",{className:"max-w-7xl mx-auto mobile-padding sm:px-6",children:[S.jsxs("div",{className:"mb-6 sm:mb-8",children:[S.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[S.jsx(fd,{className:"text-red-600 w-6 h-6 sm:w-8 sm:h-8"}),S.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-white",children:"Live TV"}),S.jsxs("div",{className:"flex items-center gap-2 px-2 sm:px-3 py-1 bg-red-600/20 border border-red-600 rounded-full",children:[S.jsxs("span",{className:"relative flex h-2 w-2",children:[S.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-75"}),S.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-red-600"})]}),S.jsx("span",{className:"text-red-500 text-xs font-bold uppercase",children:"Live"})]})]}),S.jsx("p",{className:"text-gray-400 text-sm sm:text-lg",children:"Watch live TV channels streaming now"})]}),n?S.jsx("div",{className:"mb-8",children:S.jsxs("div",{className:"relative bg-black rounded-lg overflow-hidden border-2 border-red-600/50 shadow-2xl shadow-red-600/20",children:[S.jsxs("div",{className:"relative aspect-video bg-black",children:[S.jsx("video",{ref:o,className:"w-full h-full",controls:!0,playsInline:!0,autoPlay:!0,muted:!1}),s&&S.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-red-600 border-r-transparent mb-4"}),S.jsx("p",{className:"text-white text-lg font-semibold",children:"Loading stream..."}),S.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Please wait"})]})}),t&&S.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/90 backdrop-blur-sm",children:S.jsxs("div",{className:"text-center max-w-md mx-4",children:[S.jsx(Q2,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),S.jsx("h3",{className:"text-white text-xl font-bold mb-2",children:"Stream Error"}),S.jsx("p",{className:"text-gray-300 text-sm mb-4",children:t}),S.jsxs("button",{onClick:f,className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold transition-colors flex items-center gap-2 mx-auto",children:[S.jsx(kn,{className:"w-5 h-5"}),"Retry Stream"]})]})})]}),S.jsx("div",{className:"bg-neutral-900/95 backdrop-blur-sm p-4 border-t border-neutral-800",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("img",{src:n.logo,alt:n.name,className:"w-12 h-12 object-contain bg-white rounded-lg p-1"}),S.jsxs("div",{children:[S.jsx("h3",{className:"text-white font-bold text-lg",children:n.name}),S.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[S.jsx("span",{children:n.country}),S.jsx("span",{children:""}),S.jsx("span",{className:"text-red-500",children:n.category}),S.jsx("span",{children:""}),S.jsxs("div",{className:"flex items-center gap-1",children:[S.jsxs("span",{className:"relative flex h-2 w-2",children:[S.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-75"}),S.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-red-600"})]}),S.jsx("span",{className:"text-red-500 font-semibold",children:"LIVE"})]})]})]})]}),S.jsx("div",{className:"flex items-center gap-2",children:S.jsx("button",{onClick:h,className:"p-2 bg-neutral-800 hover:bg-neutral-700 rounded-lg transition-colors touch-target",children:S.jsx(oM,{className:"w-5 h-5 text-white"})})})]})})]})}):null,S.jsxs("div",{children:[S.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Available Channels"}),S.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:u.map(m=>S.jsxs("button",{onClick:()=>d(m),className:`group relative bg-neutral-900 rounded-lg overflow-hidden border-2 transition-all hover:scale-105 hover:shadow-2xl ${n?.id===m.id?"border-red-600 shadow-xl shadow-red-600/20":"border-neutral-800 hover:border-red-600/50"}`,children:[S.jsx("div",{className:"aspect-square p-4 flex items-center justify-center bg-white",children:S.jsx("img",{src:m.logo,alt:m.name,className:"w-full h-full object-contain"})}),S.jsxs("div",{className:"p-3 bg-neutral-900",children:[S.jsx("h3",{className:"text-white font-semibold text-sm mb-1 truncate",children:m.name}),S.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400",children:[S.jsxs("span",{className:"relative flex h-1.5 w-1.5",children:[S.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-75"}),S.jsx("span",{className:"relative inline-flex rounded-full h-1.5 w-1.5 bg-red-600"})]}),S.jsx("span",{className:"text-red-500 font-semibold",children:"LIVE"})]}),S.jsx("p",{className:"text-xs text-gray-500 mt-1",children:m.category})]}),n?.id===m.id&&S.jsx("div",{className:"absolute top-2 right-2",children:S.jsx("div",{className:"p-1.5 bg-red-600 rounded-full",children:S.jsx(kn,{className:"w-3 h-3 text-white"})})})]},m.id))})]}),!n&&S.jsx("div",{className:"mt-12 text-center",children:S.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-neutral-900 border border-neutral-800 rounded-full",children:[S.jsx(fd,{className:"text-red-600"}),S.jsx("span",{className:"text-gray-400 text-sm",children:"Select a channel to start watching"})]})})]})})},dK=()=>{const[n,e]=P.useState(!1),[t,r]=P.useState("signup"),s=()=>{r("signup"),e(!0)},i=()=>{r("login"),e(!0)};return S.jsxs("div",{className:"relative min-h-screen bg-black overflow-hidden",children:[S.jsxs("div",{className:"absolute inset-0",children:[S.jsx("div",{className:"absolute inset-0 bg-cover bg-center scale-110",style:{backgroundImage:"url(https://image.tmdb.org/t/p/original/3V4kLQg0kSqPLctI5ziYWabAZYF.jpg)"}}),S.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent"}),S.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/80 via-transparent to-black/80"}),S.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),S.jsx("header",{className:"relative z-50 px-4 md:px-12 py-6",children:S.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[S.jsxs(Ke.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center gap-2",children:[S.jsx(kn,{className:"text-red-600 text-3xl md:text-4xl"}),S.jsx("span",{className:"text-3xl md:text-4xl font-black text-red-600",style:{letterSpacing:"0.05em"},children:"SANVITV"})]}),S.jsx(Ke.button,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},onClick:i,className:"px-5 py-2 bg-red-600 text-white rounded font-semibold hover:bg-red-700 transition-colors text-sm md:text-base",children:"Sign In"})]})}),S.jsx("div",{className:"relative z-10 min-h-[calc(100vh-88px)] flex items-center px-4 md:px-12",children:S.jsxs("div",{className:"max-w-2xl",children:[S.jsx(Ke.h1,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"text-4xl md:text-6xl lg:text-7xl font-black text-white mb-6 leading-tight",children:"Unlimited movies, TV shows, and more"}),S.jsx(Ke.p,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"text-xl md:text-2xl text-white mb-6",children:"Watch anywhere. Cancel anytime."}),S.jsx(Ke.p,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},className:"text-base md:text-lg text-neutral-300 mb-8",children:"Ready to watch? Enter your email to create or restart your membership."}),S.jsx(Ke.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.8,delay:.8},className:"flex flex-col sm:flex-row gap-4",children:S.jsxs("button",{onClick:s,className:"group px-8 py-4 bg-red-600 text-white text-lg md:text-xl font-bold rounded flex items-center justify-center gap-2 hover:bg-red-700 transition-all transform hover:scale-105",children:["Get Started",S.jsx(V1,{className:"text-2xl group-hover:translate-x-1 transition-transform"})]})})]})}),S.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-black to-transparent z-10"}),S.jsx(BA,{isOpen:n,onClose:()=>e(!1),initialMode:t})]})};class fK extends P.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t)}render(){return this.state.hasError?S.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:S.jsxs("div",{className:"text-center",children:[S.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Something went wrong"}),S.jsx("p",{className:"text-gray-300 mb-6",children:this.state.error?.message}),S.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Try Again"})]})}):this.props.children}}const hK=({children:n})=>{const{user:e,loading:t}=ql();return t?S.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:S.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-red-600"})}):e?S.jsx(S.Fragment,{children:n}):S.jsx(uw,{to:"/welcome",replace:!0})};function pK(){const{user:n,loading:e}=ql();return e?S.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:S.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-red-600"})}):S.jsxs(iE,{children:[S.jsx(wr,{path:"/welcome",element:n?S.jsx(uw,{to:"/",replace:!0}):S.jsx(dK,{})}),S.jsx(wr,{path:"/*",element:S.jsx(hK,{children:S.jsx("div",{className:"min-h-screen bg-black overflow-x-hidden antialiased",children:S.jsxs("div",{className:"flex flex-col min-h-screen",children:[S.jsx(w4,{}),S.jsx("main",{className:"flex-1 pb-20 md:pb-8",children:S.jsxs(iE,{children:[S.jsx(wr,{path:"/",element:S.jsx(X5,{})}),S.jsx(wr,{path:"/movies",element:S.jsx(t6,{})}),S.jsx(wr,{path:"/series",element:S.jsx(i6,{})}),S.jsx(wr,{path:"/new-popular",element:S.jsx(o6,{})}),S.jsx(wr,{path:"/live-tv",element:S.jsx(uK,{})}),S.jsx(wr,{path:"/movie/:id",element:S.jsx(AT,{})}),S.jsx(wr,{path:"/tv/:id",element:S.jsx(AT,{})})]})}),S.jsx(I4,{})]})})})})]})}function mK(){return S.jsx(p4,{children:S.jsx(fK,{children:S.jsx(SP,{children:S.jsx(pK,{})})})})}function $t(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var gK=typeof Symbol=="function"&&Symbol.observable||"@@observable",Hb=gK,xm=()=>Math.random().toString(36).substring(7).split("").join("."),yK={INIT:`@@redux/INIT${xm()}`,REPLACE:`@@redux/REPLACE${xm()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${xm()}`},Bd=yK;function ly(n){if(typeof n!="object"||n===null)return!1;let e=n;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e||Object.getPrototypeOf(n)===null}function PR(n,e,t){if(typeof n!="function")throw new Error($t(2));if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error($t(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error($t(1));return t(PR)(n,e)}let r=n,s=e,i=new Map,o=i,l=0,u=!1;function d(){o===i&&(o=new Map,i.forEach((E,b)=>{o.set(b,E)}))}function f(){if(u)throw new Error($t(3));return s}function h(E){if(typeof E!="function")throw new Error($t(4));if(u)throw new Error($t(5));let b=!0;d();const I=l++;return o.set(I,E),function(){if(b){if(u)throw new Error($t(6));b=!1,d(),o.delete(I),i=null}}}function m(E){if(!ly(E))throw new Error($t(7));if(typeof E.type>"u")throw new Error($t(8));if(typeof E.type!="string")throw new Error($t(17));if(u)throw new Error($t(9));try{u=!0,s=r(s,E)}finally{u=!1}return(i=o).forEach(I=>{I()}),E}function v(E){if(typeof E!="function")throw new Error($t(10));r=E,m({type:Bd.REPLACE})}function g(){const E=h;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error($t(11));function I(){const R=b;R.next&&R.next(f())}return I(),{unsubscribe:E(I)}},[Hb](){return this}}}return m({type:Bd.INIT}),{dispatch:m,subscribe:h,getState:f,replaceReducer:v,[Hb]:g}}function vK(n){Object.keys(n).forEach(e=>{const t=n[e];if(typeof t(void 0,{type:Bd.INIT})>"u")throw new Error($t(12));if(typeof t(void 0,{type:Bd.PROBE_UNKNOWN_ACTION()})>"u")throw new Error($t(13))})}function xK(n){const e=Object.keys(n),t={};for(let i=0;i<e.length;i++){const o=e[i];typeof n[o]=="function"&&(t[o]=n[o])}const r=Object.keys(t);let s;try{vK(t)}catch(i){s=i}return function(o={},l){if(s)throw s;let u=!1;const d={};for(let f=0;f<r.length;f++){const h=r[f],m=t[h],v=o[h],g=m(v,l);if(typeof g>"u")throw l&&l.type,new Error($t(14));d[h]=g,u=u||g!==v}return u=u||r.length!==Object.keys(o).length,u?d:o}}function Ud(...n){return n.length===0?e=>e:n.length===1?n[0]:n.reduce((e,t)=>(...r)=>e(t(...r)))}function EK(...n){return e=>(t,r)=>{const s=e(t,r);let i=()=>{throw new Error($t(15))};const o={getState:s.getState,dispatch:(u,...d)=>i(u,...d)},l=n.map(u=>u(o));return i=Ud(...l)(s.dispatch),{...s,dispatch:i}}}function SK(n){return ly(n)&&"type"in n&&typeof n.type=="string"}var DR=Symbol.for("immer-nothing"),Kb=Symbol.for("immer-draftable"),On=Symbol.for("immer-state");function or(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Ko=Object.getPrototypeOf;function Vi(n){return!!n&&!!n[On]}function ps(n){return n?NR(n)||Array.isArray(n)||!!n[Kb]||!!n.constructor?.[Kb]||Jl(n)||xf(n):!1}var TK=Object.prototype.constructor.toString();function NR(n){if(!n||typeof n!="object")return!1;const e=Ko(n);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===TK}function $d(n,e){vf(n)===0?Reflect.ownKeys(n).forEach(t=>{e(t,n[t],n)}):n.forEach((t,r)=>e(r,t,n))}function vf(n){const e=n[On];return e?e.type_:Array.isArray(n)?1:Jl(n)?2:xf(n)?3:0}function _g(n,e){return vf(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function OR(n,e,t){const r=vf(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function bK(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function Jl(n){return n instanceof Map}function xf(n){return n instanceof Set}function Ai(n){return n.copy_||n.base_}function Rg(n,e){if(Jl(n))return new Map(n);if(xf(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=NR(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[On];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],l=r[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(r[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Ko(n),r)}else{const r=Ko(n);if(r!==null&&t)return{...n};const s=Object.create(r);return Object.assign(s,n)}}function cy(n,e=!1){return Ef(n)||Vi(n)||!ps(n)||(vf(n)>1&&Object.defineProperties(n,{set:{value:Nu},add:{value:Nu},clear:{value:Nu},delete:{value:Nu}}),Object.freeze(n),e&&Object.values(n).forEach(t=>cy(t,!0))),n}function Nu(){or(2)}function Ef(n){return Object.isFrozen(n)}var wK={};function Gi(n){const e=wK[n];return e||or(0,n),e}var Cl;function MR(){return Cl}function IK(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Wb(n,e){e&&(Gi("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Lg(n){Cg(n),n.drafts_.forEach(AK),n.drafts_=null}function Cg(n){n===Cl&&(Cl=n.parent_)}function zb(n){return Cl=IK(Cl,n)}function AK(n){const e=n[On];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Yb(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[On].modified_&&(Lg(e),or(4)),ps(n)&&(n=jd(e,n),e.parent_||Vd(e,n)),e.patches_&&Gi("Patches").generateReplacementPatches_(t[On].base_,n,e.patches_,e.inversePatches_)):n=jd(e,t,[]),Lg(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==DR?n:void 0}function jd(n,e,t){if(Ef(e))return e;const r=e[On];if(!r)return $d(e,(s,i)=>qb(n,r,e,s,i,t)),e;if(r.scope_!==n)return e;if(!r.modified_)return Vd(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,o=!1;r.type_===3&&(i=new Set(s),s.clear(),o=!0),$d(i,(l,u)=>qb(n,r,s,l,u,t,o)),Vd(n,s,!1),t&&n.patches_&&Gi("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function qb(n,e,t,r,s,i,o){if(Vi(s)){const l=i&&e&&e.type_!==3&&!_g(e.assigned_,r)?i.concat(r):void 0,u=jd(n,s,l);if(OR(t,r,u),Vi(u))n.canAutoFreeze_=!1;else return}else o&&t.add(s);if(ps(s)&&!Ef(s)){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1)return;jd(n,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(Jl(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&Vd(n,s)}}function Vd(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&cy(e,t)}function _K(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:MR(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=uy;t&&(s=[r],i=kl);const{revoke:o,proxy:l}=Proxy.revocable(s,i);return r.draft_=l,r.revoke_=o,l}var uy={get(n,e){if(e===On)return n;const t=Ai(n);if(!_g(t,e))return RK(n,t,e);const r=t[e];return n.finalized_||!ps(r)?r:r===Em(n.base_,e)?(Sm(n),n.copy_[e]=Pg(r,n)):r},has(n,e){return e in Ai(n)},ownKeys(n){return Reflect.ownKeys(Ai(n))},set(n,e,t){const r=FR(Ai(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const s=Em(Ai(n),e),i=s?.[On];if(i&&i.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(bK(t,s)&&(t!==void 0||_g(n.base_,e)))return!0;Sm(n),kg(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return Em(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,Sm(n),kg(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Ai(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){or(11)},getPrototypeOf(n){return Ko(n.base_)},setPrototypeOf(){or(12)}},kl={};$d(uy,(n,e)=>{kl[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});kl.deleteProperty=function(n,e){return kl.set.call(this,n,e,void 0)};kl.set=function(n,e,t){return uy.set.call(this,n[0],e,t,n[0])};function Em(n,e){const t=n[On];return(t?Ai(t):n)[e]}function RK(n,e,t){const r=FR(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function FR(n,e){if(!(e in n))return;let t=Ko(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=Ko(t)}}function kg(n){n.modified_||(n.modified_=!0,n.parent_&&kg(n.parent_))}function Sm(n){n.copy_||(n.copy_=Rg(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var LK=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const i=t;t=e;const o=this;return function(u=i,...d){return o.produce(u,f=>t.call(this,f,...d))}}typeof t!="function"&&or(6),r!==void 0&&typeof r!="function"&&or(7);let s;if(ps(e)){const i=zb(this),o=Pg(e,void 0);let l=!0;try{s=t(o),l=!1}finally{l?Lg(i):Cg(i)}return Wb(i,r),Yb(s,i)}else if(!e||typeof e!="object"){if(s=t(e),s===void 0&&(s=e),s===DR&&(s=void 0),this.autoFreeze_&&cy(s,!0),r){const i=[],o=[];Gi("Patches").generateReplacementPatches_(e,s,i,o),r(i,o)}return s}else or(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let r,s;return[this.produce(e,t,(o,l)=>{r=o,s=l}),r,s]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy)}createDraft(n){ps(n)||or(8),Vi(n)&&(n=CK(n));const e=zb(this),t=Pg(n,void 0);return t[On].isManual_=!0,Cg(e),t}finishDraft(n,e){const t=n&&n[On];(!t||!t.isManual_)&&or(9);const{scope_:r}=t;return Wb(r,e),Yb(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const s=e[t];if(s.path.length===0&&s.op==="replace"){n=s.value;break}}t>-1&&(e=e.slice(t+1));const r=Gi("Patches").applyPatches_;return Vi(n)?r(n,e):this.produce(n,s=>r(s,e))}};function Pg(n,e){const t=Jl(n)?Gi("MapSet").proxyMap_(n,e):xf(n)?Gi("MapSet").proxySet_(n,e):_K(n,e);return(e?e.scope_:MR()).drafts_.push(t),t}function CK(n){return Vi(n)||or(10,n),BR(n)}function BR(n){if(!ps(n)||Ef(n))return n;const e=n[On];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Rg(n,e.scope_.immer_.useStrictShallowCopy_)}else t=Rg(n,!0);return $d(t,(r,s)=>{OR(t,r,BR(s))}),e&&(e.finalized_=!1),t}var kK=new LK,UR=kK.produce;function $R(n){return({dispatch:t,getState:r})=>s=>i=>typeof i=="function"?i(t,r,n):s(i)}var PK=$R(),DK=$R,NK=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Ud:Ud.apply(null,arguments)};function Xb(n,e){function t(...r){if(e){let s=e(...r);if(!s)throw new Error(ls(0));return{type:n,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:n,payload:r[0]}}return t.toString=()=>`${n}`,t.type=n,t.match=r=>SK(r)&&r.type===n,t}var jR=class tl extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,tl.prototype)}static get[Symbol.species](){return tl}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new tl(...e[0].concat(this)):new tl(...e.concat(this))}};function Qb(n){return ps(n)?UR(n,()=>{}):n}function Ou(n,e,t){return n.has(e)?n.get(e):n.set(e,t(e)).get(e)}function OK(n){return typeof n=="boolean"}var MK=()=>function(e){const{thunk:t=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new jR;return t&&(OK(t)?o.push(PK):o.push(DK(t.extraArgument))),o},FK="RTK_autoBatch",Jb=n=>e=>{setTimeout(e,n)},BK=(n={type:"raf"})=>e=>(...t)=>{const r=e(...t);let s=!0,i=!1,o=!1;const l=new Set,u=n.type==="tick"?queueMicrotask:n.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Jb(10):n.type==="callback"?n.queueNotification:Jb(n.timeout),d=()=>{o=!1,i&&(i=!1,l.forEach(f=>f()))};return Object.assign({},r,{subscribe(f){const h=()=>s&&f(),m=r.subscribe(h);return l.add(f),()=>{m(),l.delete(f)}},dispatch(f){try{return s=!f?.meta?.[FK],i=!s,i&&(o||(o=!0,u(d))),r.dispatch(f)}finally{s=!0}}})},UK=n=>function(t){const{autoBatch:r=!0}=t??{};let s=new jR(n);return r&&s.push(BK(typeof r=="object"?r:void 0)),s};function $K(n){const e=MK(),{reducer:t=void 0,middleware:r,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=n||{};let l;if(typeof t=="function")l=t;else if(ly(t))l=xK(t);else throw new Error(ls(1));let u;typeof r=="function"?u=r(e):u=e();let d=Ud;s&&(d=NK({trace:!1,...typeof s=="object"&&s}));const f=EK(...u),h=UK(f);let m=typeof o=="function"?o(h):h();const v=d(...m);return PR(l,i,v)}function VR(n){const e={},t=[];let r;const s={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(ls(28));if(l in e)throw new Error(ls(29));return e[l]=o,s},addAsyncThunk(i,o){return o.pending&&(e[i.pending.type]=o.pending),o.rejected&&(e[i.rejected.type]=o.rejected),o.fulfilled&&(e[i.fulfilled.type]=o.fulfilled),o.settled&&t.push({matcher:i.settled,reducer:o.settled}),s},addMatcher(i,o){return t.push({matcher:i,reducer:o}),s},addDefaultCase(i){return r=i,s}};return n(s),[e,t,r]}function jK(n){return typeof n=="function"}function VK(n,e){let[t,r,s]=VR(e),i;if(jK(n))i=()=>Qb(n());else{const l=Qb(n);i=()=>l}function o(l=i(),u){let d=[t[u.type],...r.filter(({matcher:f})=>f(u)).map(({reducer:f})=>f)];return d.filter(f=>!!f).length===0&&(d=[s]),d.reduce((f,h)=>{if(h)if(Vi(f)){const v=h(f,u);return v===void 0?f:v}else{if(ps(f))return UR(f,m=>h(m,u));{const m=h(f,u);if(m===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return f},l)}return o.getInitialState=i,o}var GK=Symbol.for("rtk-slice-createasyncthunk");function HK(n,e){return`${n}/${e}`}function KK({creators:n}={}){const e=n?.asyncThunk?.[GK];return function(r){const{name:s,reducerPath:i=s}=r;if(!s)throw new Error(ls(11));const o=(typeof r.reducers=="function"?r.reducers(YK()):r.reducers)||{},l=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(A,R){const C=typeof A=="string"?A:A.type;if(!C)throw new Error(ls(12));if(C in u.sliceCaseReducersByType)throw new Error(ls(13));return u.sliceCaseReducersByType[C]=R,d},addMatcher(A,R){return u.sliceMatchers.push({matcher:A,reducer:R}),d},exposeAction(A,R){return u.actionCreators[A]=R,d},exposeCaseReducer(A,R){return u.sliceCaseReducersByName[A]=R,d}};l.forEach(A=>{const R=o[A],C={reducerName:A,type:HK(s,A),createNotation:typeof r.reducers=="function"};XK(R)?JK(C,R,d,e):qK(C,R,d)});function f(){const[A={},R=[],C=void 0]=typeof r.extraReducers=="function"?VR(r.extraReducers):[r.extraReducers],F={...A,...u.sliceCaseReducersByType};return VK(r.initialState,k=>{for(let N in F)k.addCase(N,F[N]);for(let N of u.sliceMatchers)k.addMatcher(N.matcher,N.reducer);for(let N of R)k.addMatcher(N.matcher,N.reducer);C&&k.addDefaultCase(C)})}const h=A=>A,m=new Map,v=new WeakMap;let g;function x(A,R){return g||(g=f()),g(A,R)}function E(){return g||(g=f()),g.getInitialState()}function b(A,R=!1){function C(k){let N=k[A];return typeof N>"u"&&R&&(N=Ou(v,C,E)),N}function F(k=h){const N=Ou(m,R,()=>new WeakMap);return Ou(N,k,()=>{const M={};for(const[O,H]of Object.entries(r.selectors??{}))M[O]=WK(H,k,()=>Ou(v,k,E),R);return M})}return{reducerPath:A,getSelectors:F,get selectors(){return F(C)},selectSlice:C}}const I={name:s,reducer:x,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:E,...b(i),injectInto(A,{reducerPath:R,...C}={}){const F=R??i;return A.inject({reducerPath:F,reducer:x},C),{...I,...b(F,!0)}}};return I}}function WK(n,e,t,r){function s(i,...o){let l=e(i);return typeof l>"u"&&r&&(l=t()),n(l,...o)}return s.unwrapped=n,s}var zK=KK();function YK(){function n(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return n.withTypes=()=>n,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}},asyncThunk:n}}function qK({type:n,reducerName:e,createNotation:t},r,s){let i,o;if("reducer"in r){if(t&&!QK(r))throw new Error(ls(17));i=r.reducer,o=r.prepare}else i=r;s.addCase(n,i).exposeCaseReducer(e,i).exposeAction(e,o?Xb(n,o):Xb(n))}function XK(n){return n._reducerDefinitionType==="asyncThunk"}function QK(n){return n._reducerDefinitionType==="reducerWithPrepare"}function JK({type:n,reducerName:e},t,r,s){if(!s)throw new Error(ls(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:u,settled:d,options:f}=t,h=s(n,i,f);r.exposeAction(e,h),o&&r.addCase(h.fulfilled,o),l&&r.addCase(h.pending,l),u&&r.addCase(h.rejected,u),d&&r.addMatcher(h.settled,d),r.exposeCaseReducer(e,{fulfilled:o||Mu,pending:l||Mu,rejected:u||Mu,settled:d||Mu})}function Mu(){}function ls(n){return`Minified Redux Toolkit error #${n}; visit https://redux-toolkit.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}const ZK={isScrolled:!1,isSearchActive:!1,searchQuery:"",isSearching:!1,isProfileOpen:!1,isNotificationOpen:!1,isMoviesMenuOpen:!1,isQuickActionsOpen:!1,searchHistory:[]},GR=zK({name:"ui",initialState:ZK,reducers:{setScrolled(n,e){n.isScrolled=e.payload},setSearchActive(n,e){n.isSearchActive=e.payload},toggleSearch(n){n.isSearchActive=!n.isSearchActive},setSearchQuery(n,e){n.searchQuery=e.payload},setSearching(n,e){n.isSearching=e.payload},toggleProfile(n){n.isProfileOpen=!n.isProfileOpen},toggleNotification(n){n.isNotificationOpen=!n.isNotificationOpen},toggleMoviesMenu(n){n.isMoviesMenuOpen=!n.isMoviesMenuOpen},setMoviesMenu(n,e){n.isMoviesMenuOpen=e.payload},toggleQuickActions(n){n.isQuickActionsOpen=!n.isQuickActionsOpen},setQuickActions(n,e){n.isQuickActionsOpen=e.payload},addSearchHistory(n,e){const t=e.payload.trim();if(!t)return;const r=n.searchHistory.findIndex(s=>s.toLowerCase()===t.toLowerCase());r!==-1&&n.searchHistory.splice(r,1),n.searchHistory.unshift(t),n.searchHistory.length>6&&(n.searchHistory=n.searchHistory.slice(0,6))},removeSearchHistoryItem(n,e){n.searchHistory=n.searchHistory.filter(t=>t.toLowerCase()!==e.payload.trim().toLowerCase())},clearSearchHistory(n){n.searchHistory=[]},closeAllOverlays(n){n.isSearchActive=!1,n.isProfileOpen=!1,n.isNotificationOpen=!1,n.isMoviesMenuOpen=!1,n.isQuickActionsOpen=!1}}}),{setScrolled:wW,setSearchActive:IW,toggleSearch:AW,setSearchQuery:_W,setSearching:RW,toggleProfile:LW,toggleNotification:CW,toggleMoviesMenu:kW,setMoviesMenu:PW,toggleQuickActions:DW,setQuickActions:NW,addSearchHistory:OW,removeSearchHistoryItem:MW,clearSearchHistory:FW,closeAllOverlays:BW}=GR.actions,eW=GR.reducer,tW=$K({reducer:{ui:eW}});KC.createRoot(document.getElementById("root")).render(S.jsx(Cn.StrictMode,{children:S.jsx(lk,{store:tW,children:S.jsx(mK,{})})}));
